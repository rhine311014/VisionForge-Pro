# VisionForge Pro 工位配置工具使用说明书

## 一、概述

工位配置工具（VisionInspectConfigTool）是 VisionForge Pro 的预配置模块，用于在软件启动前配置视觉检测系统的工位、相机、位置等参数。参考 VisionASM 设计，提供直观的树形配置界面。

### 1.1 启动时机

| 场景 | 行为 |
|------|------|
| 首次运行（无配置） | **自动弹出**配置工具，必须配置后才能进入主界面 |
| 已有配置 | 直接进入主界面 |
| 命令行 `--config` 或 `-c` | **强制显示**配置工具 |
| 命令行 `--skip-config` 或 `-s` | **跳过**配置工具 |

### 1.2 界面布局

```
┌─────────────────────────────────────────────────────────────────┐
│  VisionInspectConfigTool                                    [X] │
├─────────────────────┬───────────────────────────────────────────┤
│                     │  ┌─ 平台设置 ──────────────────────────┐  │
│  视觉检测系统       │  │                                     │  │
│  └─ 平台1           │  │  平台序:        [1        ▼]       │  │
│     ├─ 相机数量: 1  │  │                                     │  │
│     ├─ 场景数量: 2  │  │  相机数:        [1        ▼] ☐相机  │  │
│     ├─ 位置数量: 4  │  │                        是否共享系统  │  │
│     ├─ 视窗显示模式 │  │                                     │  │
│     │   :按位置数显示│  │  场景数量:      [2        ▼]       │  │
│     ├─ 产品数量: 5  │  │                                     │  │
│     ├─ 产品预加载   │  │  位置数量:      [4        ▼]       │  │
│     │   数量: 1     │  │                                     │  │
│     └─ 是否为共享   │  │  显示模式:      [按照位置显示 ▼]   │  │
│         相机: 否    │  │                                     │  │
│                     │  │  产品数量:      [5        ▼]       │  │
│                     │  │                                     │  │
│                     │  │  产品预加载数量:[1        ▼]       │  │
│                     │  │                                     │  │
│                     │  └─────────────────────────────────────┘  │
│                     │                                           │
│                     │  [新增平台]  [删除平台]                   │
│                     │                                           │
│                     │                    [保存退出]  [取消退出] │
└─────────────────────┴───────────────────────────────────────────┘
```

---

## 二、界面说明

### 2.1 左侧树形区域

显示当前系统所有平台（工位）的配置信息：

- **根节点**：视觉检测系统（不可选中）
- **平台节点**：平台1、平台2...（可选中编辑）
- **信息子节点**：显示该平台的详细配置（只读）

**操作方式**：
- 单击平台节点 → 右侧显示该平台的设置参数
- 单击信息子节点 → 自动选中其父平台节点

### 2.2 右侧设置面板

编辑当前选中平台的参数：

| 参数 | 取值范围 | 说明 |
|------|----------|------|
| **平台序** | 1-6 | 平台编号，不可重复 |
| **相机数** | 1-8 | 该平台使用的相机数量 |
| **相机是否共享系统** | 是/否 | 是否与其他平台共享相机 |
| **场景数量** | 1-8 | 检测场景数量 |
| **位置数量** | 1-8 | 拍照位置数量 |
| **显示模式** | 按位置/按相机 | 多画面显示方式 |
| **产品数量** | 1-20 | 产品种类数量 |
| **产品预加载数量** | 1-5 | 预加载的产品配置数量 |

### 2.3 按钮说明

| 按钮 | 功能 |
|------|------|
| **新增平台** | 添加一个新平台（最多6个） |
| **删除平台** | 删除当前选中的平台（至少保留1个） |
| **保存退出** | 保存配置并进入主程序 |
| **取消退出** | 放弃修改（首次运行时会退出程序） |

---

## 三、操作流程

### 3.1 首次配置（新系统）

```
1. 启动 VisionForge Pro
   ↓
2. 自动弹出工位配置工具
   ↓
3. 系统已默认创建"平台1"
   ↓
4. 根据实际设备配置参数：
   - 设置相机数量
   - 设置位置数量
   - 选择显示模式
   ↓
5. 如需多个平台，点击 [新增平台]
   ↓
6. 配置完成后点击 [保存退出]
   ↓
7. 进入主程序
```

### 3.2 修改现有配置

```
方法一：命令行启动
> VisionForge.exe --config
或
> VisionForge.exe -c

方法二：删除配置文件后启动
配置文件位置：%APPDATA%/VisionForge/stations/
```

### 3.3 跳过配置工具

```
> VisionForge.exe --skip-config
或
> VisionForge.exe -s
```

---

## 四、参数详解

### 4.1 平台序

- **含义**：平台的唯一编号
- **规则**：1-6，不可重复
- **建议**：按设备物理顺序编号

### 4.2 相机数

- **含义**：该平台连接的相机数量
- **范围**：1-8
- **示例**：
  - 单相机检测：设置为 1
  - 双相机上下料：设置为 2
  - 四相机对位：设置为 4

### 4.3 相机是否共享系统

- **含义**：多个平台是否共用同一套相机
- **场景**：
  - **不共享（默认）**：每个平台有独立的相机
  - **共享**：多个平台轮流使用同一套相机（如旋转台）

### 4.4 场景数量

- **含义**：检测流程中的不同场景数
- **示例**：
  - 场景1：正面检测
  - 场景2：侧面检测

### 4.5 位置数量

- **含义**：拍照位置的数量
- **说明**：对应多点对位中的拍照点
- **示例**：
  - 4点对位：设置为 4
  - 9点标定：设置为 9

### 4.6 显示模式

| 模式 | 说明 |
|------|------|
| **按照位置显示** | 每个位置一个画面，适合多点对位 |
| **按照相机显示** | 每个相机一个画面，适合多相机同步 |

### 4.7 产品数量

- **含义**：可配置的产品种类数量
- **用途**：快速切换不同产品的检测参数

### 4.8 产品预加载数量

- **含义**：启动时预加载的产品配置数
- **建议**：设为 1（只预加载当前产品）

---

## 五、配置示例

### 5.1 单工位单相机检测

```
平台设置：
├─ 平台序: 1
├─ 相机数: 1
├─ 相机共享: 否
├─ 场景数量: 1
├─ 位置数量: 1
├─ 显示模式: 按位置显示
├─ 产品数量: 5
└─ 产品预加载: 1
```

### 5.2 双工位四点对位

```
平台1 设置：
├─ 平台序: 1
├─ 相机数: 2
├─ 相机共享: 否
├─ 场景数量: 2
├─ 位置数量: 4
├─ 显示模式: 按位置显示
├─ 产品数量: 5
└─ 产品预加载: 1

平台2 设置：
├─ 平台序: 2
├─ 相机数: 2
├─ 相机共享: 否
├─ 场景数量: 2
├─ 位置数量: 4
├─ 显示模式: 按位置显示
├─ 产品数量: 5
└─ 产品预加载: 1
```

### 5.3 共享相机系统

```
平台1 设置（主平台）：
├─ 平台序: 1
├─ 相机数: 4
├─ 相机共享: 否  ← 主平台不勾选
└─ ...

平台2 设置（共享平台）：
├─ 平台序: 2
├─ 相机数: 4
├─ 相机共享: 是  ← 勾选共享
└─ ...
```

---

## 六、配置文件说明

### 6.1 存储位置

```
Windows: %APPDATA%/VisionForge/stations/
```

### 6.2 文件结构

```
stations/
├─ stations.json          # 工位索引文件
├─ WS0/
│   └─ station.json       # 平台1配置
├─ WS1/
│   └─ station.json       # 平台2配置
└─ ...
```

### 6.3 重置配置

删除 `stations` 文件夹后重新启动程序即可重新配置。

---

## 七、常见问题

### Q1: 配置工具不显示？

**原因**：已有配置文件
**解决**：使用 `--config` 参数启动，或删除配置文件

### Q2: 无法保存配置？

**原因**：可能是磁盘权限问题
**解决**：以管理员身份运行程序

### Q3: 平台序号冲突？

**提示**：会弹出警告对话框
**解决**：选择未被使用的平台序号

### Q4: 取消后程序退出了？

**原因**：首次运行时，取消配置会直接退出
**说明**：这是正常行为，需要至少配置一个平台

### Q5: 如何备份配置？

**方法**：复制 `%APPDATA%/VisionForge/stations/` 文件夹

---

## 八、快速参考

### 命令行参数

| 参数 | 说明 |
|------|------|
| `--config` 或 `-c` | 强制显示配置工具 |
| `--skip-config` 或 `-s` | 跳过配置工具 |

### 参数限制

| 参数 | 最小值 | 最大值 |
|------|--------|--------|
| 平台数 | 1 | 6 |
| 相机数 | 1 | 8 |
| 场景数 | 1 | 8 |
| 位置数 | 1 | 8 |
| 产品数 | 1 | 20 |
| 预加载数 | 1 | 5 |

---

**文档版本**：v1.0
**更新日期**：2025-12-23
**适用版本**：VisionForge Pro v1.3.0+
