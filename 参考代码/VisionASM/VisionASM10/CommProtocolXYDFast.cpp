// CommProtocolXYDFast.cpp: implementation of the CCommProtocolXYD class.
//
//////////////////////////////////////////////////////////////////////

#include "stdafx.h"
#include "VisionASM.h"
#include "CommProtocolXYDFast.h"
#include <math.h>

#include "CommProRegModbusSerialAscii.h"
#include "CommProRegModbusSerialRtu.h"
#include "CommProRegModbusSocketTcp.h"
#include "CommProRegMitsQSerialAscii.h"
#include "CommProRegMitsQSocketAscii.h"
#include "CommProRegMitsQSocketBinary.h"
#include "CommProRegMitsFXSerialAscii.h"
#include "CommProRegPanaSerialMewtocol.h"
#include "CommProRegYokoSocketAscii.h"
#include "CommProRegYask.h"

#include "CommProRegKeyenceSerialAscii.h"
#include "CommProRegKeyenceSerialPCLink.h"
#include "CommProRegKeyenceSocketAscii.h"
#include "CommProRegKeyenceSocketBinary.h"
#include "CommProRegKeyenceSocketPCLink.h"

#include "CommProRegFuJiSPHSocket.h"

#include "CommProRegYokoSocketBinary.h"
#include "CommProRegMitsFXSocketBinaryMC1E.h"

#include "CommProRegOmronSerialHostLink.h"
#include "CommProRegOmronSocketFins.h"

#include "CommProRegDeltaModbusSerialAscii.h"
#include "CommProRegDeltaModbusSerialRtu.h"
#include "CommProRegDeltaModbusSocketTcp.h"

#ifdef _DEBUG
#undef THIS_FILE
static char THIS_FILE[]=__FILE__;
#define new DEBUG_NEW
#endif



const int COMMCMDSTRINGNUM = 88;
CString g_strCommCmdString[COMMCMDSTRINGNUM][2]=
{
	{ COMM_CMD_STRING_FVPC, COMM_CMD_STRING_VVPC},
	{ COMM_CMD_STRING_FSPC, COMM_CMD_STRING_VSPC},
	{ COMM_CMD_STRING_FSSV, COMM_CMD_STRING_VSSV},
	{ COMM_CMD_STRING_FGSP, COMM_CMD_STRING_VGSP},
	{ COMM_CMD_STRING_FVAS, COMM_CMD_STRING_VVAS},
	{ COMM_CMD_STRING_FCLB, COMM_CMD_STRING_VCLB},
	{ COMM_CMD_STRING_FCBS, COMM_CMD_STRING_VCBS},
	{ COMM_CMD_STRING_FCBR, COMM_CMD_STRING_VCBR},
	{ COMM_CMD_STRING_FTGT, COMM_CMD_STRING_VTGT},
	{ COMM_CMD_STRING_FTGS, COMM_CMD_STRING_VTGS},
	{ COMM_CMD_STRING_FTGC, COMM_CMD_STRING_VTGC},
	{ COMM_CMD_STRING_FTGR, COMM_CMD_STRING_VTGR},
	{ COMM_CMD_STRING_FTGG, COMM_CMD_STRING_VTGG},
	{ COMM_CMD_STRING_FGAP, COMM_CMD_STRING_VGAP},
	{ COMM_CMD_STRING_FGTC, COMM_CMD_STRING_VGTC},
	{ COMM_CMD_STRING_FCNT, COMM_CMD_STRING_VCNT},
	{ COMM_CMD_STRING_FTGD, COMM_CMD_STRING_VTGD},
	{ COMM_CMD_STRING_FOBJ, COMM_CMD_STRING_VOBJ},
	{ COMM_CMD_STRING_FOBC, COMM_CMD_STRING_VOBC},
	{ COMM_CMD_STRING_FOBG, COMM_CMD_STRING_VOBG},
	{ COMM_CMD_STRING_FMSC, COMM_CMD_STRING_VMSC},
	{ COMM_CMD_STRING_FWLD, COMM_CMD_STRING_VWLD},
	{ COMM_CMD_STRING_FGAL, COMM_CMD_STRING_VGAL},
	{ COMM_CMD_STRING_FALL, COMM_CMD_STRING_VALL},
	{ COMM_CMD_STRING_FGAC, COMM_CMD_STRING_VGAC},
	{ COMM_CMD_STRING_FALC, COMM_CMD_STRING_VALC},
	{ COMM_CMD_STRING_FAAL, COMM_CMD_STRING_VAAL},
	{ COMM_CMD_STRING_FXYA, COMM_CMD_STRING_VXYA},
	{ COMM_CMD_STRING_FAAB, COMM_CMD_STRING_VAAB},
	{ COMM_CMD_STRING_FAAC, COMM_CMD_STRING_VAAC},
	{ COMM_CMD_STRING_FAHL, COMM_CMD_STRING_VAHL},
	{ COMM_CMD_STRING_FANS, COMM_CMD_STRING_VANS},
	{ COMM_CMD_STRING_FALG, COMM_CMD_STRING_VALG},
	{ COMM_CMD_STRING_FALP, COMM_CMD_STRING_VALP},
	{ COMM_CMD_STRING_FALJ, COMM_CMD_STRING_VALJ},
	{ COMM_CMD_STRING_FACO, COMM_CMD_STRING_VACO},
	{ COMM_CMD_STRING_FAAO, COMM_CMD_STRING_VAAO},
	{ COMM_CMD_STRING_FOLC, COMM_CMD_STRING_VOLC},
	{ COMM_CMD_STRING_FABO, COMM_CMD_STRING_VABO},
	{ COMM_CMD_STRING_FAOF, COMM_CMD_STRING_VAOF},
	{ COMM_CMD_STRING_FGOF, COMM_CMD_STRING_VGOF},
	{ COMM_CMD_STRING_FOFS, COMM_CMD_STRING_VOFS},
	{ COMM_CMD_STRING_FSFT, COMM_CMD_STRING_VSFT},
	{ COMM_CMD_STRING_FGSF, COMM_CMD_STRING_VGSF},
	{ COMM_CMD_STRING_FMPS, COMM_CMD_STRING_VMPS},
	{ COMM_CMD_STRING_FMVA, COMM_CMD_STRING_VMVA},
	{ COMM_CMD_STRING_FMVR, COMM_CMD_STRING_VMVR},
	{ COMM_CMD_STRING_FGPO, COMM_CMD_STRING_VGPO},
	{ COMM_CMD_STRING_FALM, COMM_CMD_STRING_VALM},
	{ COMM_CMD_STRING_FRST, COMM_CMD_STRING_VRST},
	{ COMM_CMD_STRING_FSAC, COMM_CMD_STRING_VSAC},
	{ COMM_CMD_STRING_FSCO, COMM_CMD_STRING_VSCO},
	{ COMM_CMD_STRING_FCHK, COMM_CMD_STRING_VCHK},
	{ COMM_CMD_STRING_FAOT, COMM_CMD_STRING_VAOT},
	{ COMM_CMD_STRING_FALX, COMM_CMD_STRING_VALX},
	{ COMM_CMD_STRING_FWDR, COMM_CMD_STRING_VWDR},
	{ COMM_CMD_STRING_FGOW, COMM_CMD_STRING_VGOW},
	{ COMM_CMD_STRING_FCNO, COMM_CMD_STRING_VCNO},
	{ COMM_CMD_STRING_FPCB, COMM_CMD_STRING_VPCB},
	{ COMM_CMD_STRING_FPIS, COMM_CMD_STRING_VPIS},
	{ COMM_CMD_STRING_FCPI, COMM_CMD_STRING_VCPI},
	{ COMM_CMD_STRING_FMCO, COMM_CMD_STRING_VMCO},
	{ COMM_CMD_STRING_FCCI, COMM_CMD_STRING_VCCI},
	// 暂无
	{ COMM_CMD_STRING_FHMS, COMM_CMD_STRING_VHMS},
	{ COMM_CMD_STRING_FHOM, COMM_CMD_STRING_VHOM},
	{ COMM_CMD_STRING_FPNT, COMM_CMD_STRING_VPNT},
	{ COMM_CMD_STRING_FMAP, COMM_CMD_STRING_VMAP},
	{ COMM_CMD_STRING_FRCT, COMM_CMD_STRING_VRCT},
	{ COMM_CMD_STRING_FISP, COMM_CMD_STRING_VISP},
	{ COMM_CMD_STRING_FOLG, COMM_CMD_STRING_VOLG},
	{ COMM_CMD_STRING_FTLG, COMM_CMD_STRING_VTLG},
	{ COMM_CMD_STRING_FCHB, COMM_CMD_STRING_VCHB},
	{ COMM_CMD_STRING_FCHC, COMM_CMD_STRING_VCHC},
	{ COMM_CMD_STRING_FDRP, COMM_CMD_STRING_VDRP},
	{ COMM_CMD_STRING_FSPE, COMM_CMD_STRING_VSPE},
	{ COMM_CMD_STRING_FWEL, COMM_CMD_STRING_VWEL},
	{ COMM_CMD_STRING_FMPB, COMM_CMD_STRING_VMPB},
	{ COMM_CMD_STRING_FCPR, COMM_CMD_STRING_VCPR},
	{ COMM_CMD_STRING_FQRC, COMM_CMD_STRING_VQRC},	
	{ COMM_CMD_STRING_FINS, COMM_CMD_STRING_VINS},
	{ COMM_CMD_STRING_FCBP, COMM_CMD_STRING_VCBP},
	{ COMM_CMD_STRING_FGTW, COMM_CMD_STRING_VGTW},
	{ COMM_CMD_STRING_FAFO, COMM_CMD_STRING_VAFO},
	{ COMM_CMD_STRING_FGTP, COMM_CMD_STRING_VGTP},
	{ COMM_CMD_STRING_FPEP, COMM_CMD_STRING_VPEP},
	{ COMM_CMD_STRING_FPCP, COMM_CMD_STRING_VPCP},
	{ COMM_CMD_STRING_FPRN, COMM_CMD_STRING_VPRN},
	{ COMM_CMD_STRING_FQRI, COMM_CMD_STRING_VQRI},
};



//////////////////////////////////////////////////////////////////////
// Construction/Destruction
//////////////////////////////////////////////////////////////////////


CCommProtocolXYDFast::CCommProtocolXYDFast()
{
	// #ifdef CommProtocol_YAMAHA
	// 	m_strHead = "S";
	// 	m_strTail = "E";
	// #else
	// 	m_strHead = char(0x02);	// STX
	// 	m_strTail = char(0x03); // ETX
	// #endif

	m_strHead = char(0x02);	// STX
	m_strTail = char(0x03); // ETX
	m_strSeparator = _T(" "); // 空格
	//m_dstrTranlateResultInfo = _T(" ");   // 空格
	m_dstrTranlateResultInfo.clear();
	// yamaha机器人
	m_strRobotHead = _T("@");			// 指令头
	m_strRobotTail = char(0x03);		// 指令尾
	m_strRobotSeparator = _T(" ");		// 分隔符
	m_strRobotEqual = _T("=");			// 等号
	m_strRobotQuery = _T("?");			// 问号
	m_vstL2LDistanceResult.resize(8);
	m_bCmdAxisPosReady = FALSE;
	m_nCurCodeIndex = -1;
	m_nCurRegTriggerIndex = -1;

	m_bEnableMulRegTrigger = FALSE;
	
}

CCommProtocolXYDFast::~CCommProtocolXYDFast()
{

}

// 设置、获取协议类型
void CCommProtocolXYDFast::SetProtocolType(ProtocolType ptProtocolType)
{
	m_eProtocolType = ptProtocolType;

	if (m_eProtocolType == eProCmdFast)			// 通用无协议
	{
		m_strHead = char(0x02);	// STX
		m_strTail = char(0x03); // ETX
		m_strSeparator = _T(" "); // 空格
		//lzk 0408
		m_FSPCParam.m_strCmd = COMM_CMD_STRING_FVPC;

		m_FSPCParam.m_strCmd = COMM_CMD_STRING_FSPC;// 1、 FSPC：产品切换的设定，将产品切换至指定的产品No.
		m_FSSVParam.m_strCmd = COMM_CMD_STRING_FSSV;// 2、 FSSV：指定产品No.的保存，将目前使用的产品数据保存在指定的产品No.并保存在CF 记忆卡中
		m_FGSPParam.m_strCmd = COMM_CMD_STRING_FGSP;// 3、 FGSP：产品No.的取得，取得目前正在执行的产品No.
		m_FVASParam.m_strCmd = COMM_CMD_STRING_FVAS;// 3、 FVAS：产品虚拟Mark设定.

		m_FCLBParam.m_strCmd = COMM_CMD_STRING_FCLB;// 1、FCLB:Calibration 的执行 执行Calibration
		m_FCBSParam.m_strCmd = COMM_CMD_STRING_FCBS;// 1、FCBS:Calibration 的执行 执行Calibration
		m_FCBRParam.m_strCmd = COMM_CMD_STRING_FCBR;// 1、FCBR:Calibration 的执行 执行Calibration
		m_FCPRParam.m_strCmd = COMM_CMD_STRING_FCPR;// 1、FCPR:相机轴标定
		m_FCBPParam.m_strCmd = COMM_CMD_STRING_FCBP;// 1、FCBP:自动关联

		m_FTGTParam.m_strCmd = COMM_CMD_STRING_FTGT;// 1、FTGT:目标 Mark 位置的取得，取得目标 Mark（目标）位置
		m_FTGSParam.m_strCmd = COMM_CMD_STRING_FTGS;// 1.1、FTGT:目标 Mark 位置的取得，取得目标 Mark（目标）位置
		m_FTGCParam.m_strCmd = COMM_CMD_STRING_FTGC;// 2、FTGC:目标 Mark 位置的取得（候补搜索），利用候补搜索取得目标 Mark（目标）位置
		m_FTGRParam.m_strCmd = COMM_CMD_STRING_FTGR;// 3、FTGR:目标 Mark 位置的登录，将目前使用的产品数据保存在指定的产品No.中并保存在CF 记忆卡
		m_FTGGParam.m_strCmd = COMM_CMD_STRING_FTGG;// 4、FTGG:目标 Mark 画素的取得，取得执行“ＦＴＧＴ”结果的画素
		m_FTGDParam.m_strCmd = COMM_CMD_STRING_FTGD;// 5、FTGD:目标 Mark 指示线的全画面显示，在指定目标 Mark No.的目标 Mark 位置上显示全画面的指示线及刻度
		m_FOBJParam.m_strCmd = COMM_CMD_STRING_FOBJ;// 1、FOBJ:物体 Mark 位置的取得，取得物体 Mark（对准靶标）位置
		m_FOBCParam.m_strCmd = COMM_CMD_STRING_FOBC;// 2、FOBC:物体 Mark 位置的取得（候补搜索），利用候补搜索取得物体 Mark（对准靶标）位置
		m_FOBGParam.m_strCmd = COMM_CMD_STRING_FOBG;// 3、FOBG:物体 Mark 画素的取得，取得执行“ＦＯＢＪ”结果的画素
		m_FMSCParam.m_strCmd = COMM_CMD_STRING_FMSC;// 4、FMSC:手动搜索位置的取得，在自动对准时，当目标 Mark 或物体 Mark 搜索失败时，可利用手动方法（鼠标）指定Mark 位置
		m_FWLDParam.m_strCmd = COMM_CMD_STRING_FWLD;// 5、FWLD：取得目标（目标靶标）或对象（对象靶标）的平台坐标上的位置
		m_FGAPParam.m_strCmd = COMM_CMD_STRING_FGAP;// 4、FGAP:目标 Mark 画素的取得，取得执行结果的画素
		m_FCNTParam.m_strCmd = COMM_CMD_STRING_FCNT;// 4、FCNT:物体 Mark 位置的取得，取得物体 Mark（对准靶标）位置
		m_FGTCParam.m_strCmd = COMM_CMD_STRING_FGTC;// 5、FGTC:获取目标相对于图像中心的图像坐标偏差

		m_FCNOParam.m_strCmd = COMM_CMD_STRING_FCNO;


		m_FGALParam.m_strCmd = COMM_CMD_STRING_FGAL;// 1、FGAL:对准精度判定设定的取得，取得对准精度的判定设定
		m_FALLParam.m_strCmd = COMM_CMD_STRING_FALL;// 2、FALL:对准精度判定的更新，更新对准时的对准精度的判定
		m_FGACParam.m_strCmd = COMM_CMD_STRING_FGAC;// 3、FGAC:对准最多次数的取得，取得设定对准最多次数
		m_FALCParam.m_strCmd = COMM_CMD_STRING_FALC;// 4、FALC:对准最多次数的更新，执行自动对准时，容许最多对准次数的更新
		m_FAALParam.m_strCmd = COMM_CMD_STRING_FAAL;// 5、FAAL:自动对准的执行，执行自动对准（连续对准）
		m_FXYAParam.m_strCmd = COMM_CMD_STRING_FXYA;// 5、FXYA:自动对准的执行，执行自动对准（连续对准）
		m_FAABParam.m_strCmd = COMM_CMD_STRING_FAAB;// 5、FAAB:自动对准的执行，执行自动对准（连续对准），增加内部图像十字中心基准对位过程
		m_FAACParam.m_strCmd = COMM_CMD_STRING_FAAC;// 5、FAAC:自动对准的执行，执行自动对准（连续对准），对象候补搜索
		m_FACBParam.m_strCmd = COMM_CMD_STRING_FACB;// 5、FACB:自动对准的执行，执行自动对准（连续对准），对象候补搜索，增加内部图像十字中心基准对位过程
		m_FAHLParam.m_strCmd = COMM_CMD_STRING_FAHL;// 5、FAHL:背光叠片机自动对准的执行，执行自动对准（连续对准）
		m_FANSParam.m_strCmd = COMM_CMD_STRING_FANS;// 6、FANS:对准后的偏移量的取得，取得对准后平台坐标系的偏移量
		m_FALGParam.m_strCmd = COMM_CMD_STRING_FALG;// 7、FALG:１次对准移动量的取得，取得１次对准移动量
		m_FALPParam.m_strCmd = COMM_CMD_STRING_FALP;// 7、FALP:１次对准拾取移动量的取得，取得１次对准拾取移动量
		m_FALJParam.m_strCmd = COMM_CMD_STRING_FALJ;// 8、FALJ:1:次对准精度判定与对准移动量的取得，对准移动量是否在对准精度内的判定与对准移动量的取得
		m_FACOParam.m_strCmd = COMM_CMD_STRING_FACO;// 9、FACO:偏移量的取得，取得目标 Mark 及物体 Mark 之间中心的平台坐标系偏移量
		m_FAAOParam.m_strCmd = COMM_CMD_STRING_FAAO;
		m_FOLCParam.m_strCmd = COMM_CMD_STRING_FOLC;// 9、FACO:偏移量的取得，取得目标 Mark 及物体 Mark 之间中心的平台坐标系偏移量
		m_FABOParam.m_strCmd = COMM_CMD_STRING_FABO;// 9、FABO:偏移量的取得，取得目标 Mark 及物体 Mark 之间中心的平台坐标系偏移量
		m_FAOFParam.m_strCmd = COMM_CMD_STRING_FAOF;// 1、FAOF:自动补偿量值的取得，对准偏移量以补偿量值取得
		m_FGOFParam.m_strCmd = COMM_CMD_STRING_FGOF;// 2、FGOF:补偿量值的取得，取得设定的补偿量值
		m_FOFSParam.m_strCmd = COMM_CMD_STRING_FOFS;// 3、FOFS:补偿量值的设定，设定补偿量值
		m_FSFTParam.m_strCmd = COMM_CMD_STRING_FSFT;// 4、FSFT:平台Shift 移动动作，选择内部转移量的设定值，并依照设定值将目前平台的位置做相对移动
		m_FGSFParam.m_strCmd = COMM_CMD_STRING_FGSF;// 5、FGSF:对准Shift 移动量的取得，取得对准转移量
		m_FGPOParam.m_strCmd = COMM_CMD_STRING_FGPO;// 8、FGPO:获取连续对位最终精度
		m_FALMParam.m_strCmd = COMM_CMD_STRING_FALM;// 1、FALM:Alarm资料的取得，取得错误发生的数据代码
		m_FRSTParam.m_strCmd = COMM_CMD_STRING_FRST;// 2、FRST:重新设定（清除错误等），清除各种错误及显示重新设定
		m_FSACParam.m_strCmd = COMM_CMD_STRING_FSAC;// 3、FSAC：保存校正、定位时的数据。所保存的数据为最近500次操作时的数据（不到500次时保存实际次数的数据）
		m_FSCOParam.m_strCmd = COMM_CMD_STRING_FSCO;// 4、FSCO：保存指令收发的历史纪录。所保存的数据为最近500次操作时的数据（不到500次时保存实际次数的数据）
		m_FAOTParam.m_strCmd = COMM_CMD_STRING_FAOT;// 5、FAOT:自动对准的执行，执行自动对准（连续对准），对象候补搜索,目标候补搜索
		m_FALXParam.m_strCmd = COMM_CMD_STRING_FALX;// 5、FALX:自动对准的执行，执行自动对准（连续对准），对象候补搜索
		m_FWDRParam.m_strCmd = COMM_CMD_STRING_FWDR;// 5.1、FWDR:获取目标/对象Mark的平台坐标系半径（相对于旋转中心的距离）
		m_FGOWParam.m_strCmd = COMM_CMD_STRING_FGOW;// 6、FGOW:拍照取得对象（对象靶标）的平台坐标上的位置
		m_FCHBParam.m_strCmd = COMM_CMD_STRING_FCHB;
		m_FCHCParam.m_strCmd = COMM_CMD_STRING_FCHC;
		m_FDRPParam.m_strCmd = COMM_CMD_STRING_FDRP;// 7、FDRP:计算基准拾取位置自动流程


		m_MNPSParam.m_strCmd = COMM_CMD_STRING_FMPS;// 6、MNPS:平台现在位置的取得，取得平台现在位置
		m_MMVAParam.m_strCmd = COMM_CMD_STRING_FMVA;// 7、MMVA:平台~对准置移动量的设定，设定平台~对准置移动量
		m_MMVRParam.m_strCmd = COMM_CMD_STRING_FMVR;// 8、MMVR:平台相对准置移动量的设定，设定平台相对准置移动量

		m_MPSBParam.m_strCmd = COMM_CMD_STRING_FMPB;
		m_FSPEParam.m_strCmd = COMM_CMD_STRING_FSPE;
		m_FWELParam.m_strCmd = COMM_CMD_STRING_FWEL;
		m_FPCBParam.m_strCmd = COMM_CMD_STRING_FPCB;
		m_FPISParam.m_strCmd = COMM_CMD_STRING_FPIS;
		m_FCPIParam.m_strCmd = COMM_CMD_STRING_FCPI;
		m_FQRCParam.m_strCmd = COMM_CMD_STRING_FQRC;
		m_FQRIParam.m_strCmd = COMM_CMD_STRING_FQRI;
		m_FMCOParam.m_strCmd = COMM_CMD_STRING_FMCO;
		//lzk 0408
		m_FCCIParam.m_strCmd = COMM_CMD_STRING_FCCI;
		m_FINSParam.m_strCmd = COMM_CMD_STRING_FINS;

		// yamaha机器人
		m_strRobotHead = _T("@");			// 指令头
		m_strRobotTail = char(0x03);		// 指令尾
		m_strRobotSeparator = _T(" ");		// 分隔符
		m_strRobotEqual = _T("=");			// 等号
		m_strRobotQuery = _T("?");			// 问号
	}
	else if(m_eProtocolType == eProCmdVS)
	{
		m_strHead = char(0x02);	// STX
		m_strTail = char(0x03); // ETX
		m_strSeparator = _T(" "); // 空格
		m_FSPCParam.m_strCmd = COMM_CMD_STRING_VVPC;

		m_FSPCParam.m_strCmd = COMM_CMD_STRING_VSPC;// 1、 FSPC：产品切换的设定，将产品切换至指定的产品No.
		m_FSSVParam.m_strCmd = COMM_CMD_STRING_VSSV;// 2、 FSSV：指定产品No.的保存，将目前使用的产品数据保存在指定的产品No.并保存在CF 记忆卡中
		m_FGSPParam.m_strCmd = COMM_CMD_STRING_VGSP;// 3、 FGSP：产品No.的取得，取得目前正在执行的产品No.
		m_FVASParam.m_strCmd = COMM_CMD_STRING_VSPC;// 1、 FSPC：产品切换的设定，将产品切换至指定的产品No.

		m_FCLBParam.m_strCmd = COMM_CMD_STRING_VCLB;// 1、FCLB:Calibration 的执行 执行Calibration
		m_FCBSParam.m_strCmd = COMM_CMD_STRING_VCBS;// 1、FCBS:Calibration 的执行 执行Calibration
		m_FCBRParam.m_strCmd = COMM_CMD_STRING_VCBR;// 1、FCBR:Calibration 的执行 执行Calibration
		m_FCPRParam.m_strCmd = COMM_CMD_STRING_VCPR;// 1、FCPR:相机轴标定
		m_FCBPParam.m_strCmd = COMM_CMD_STRING_VCBP;// 1、FCBP:自动关联

		m_FTGTParam.m_strCmd = COMM_CMD_STRING_VTGT;// 1、FTGT:目标 Mark 位置的取得，取得目标 Mark（目标）位置
		m_FTGSParam.m_strCmd = COMM_CMD_STRING_VTGS;// 1.1、FTGT:目标 Mark 位置的取得，取得目标 Mark（目标）位置
		m_FTGCParam.m_strCmd = COMM_CMD_STRING_VTGC;// 2、FTGC:目标 Mark 位置的取得（候补搜索），利用候补搜索取得目标 Mark（目标）位置
		m_FTGRParam.m_strCmd = COMM_CMD_STRING_VTGR;// 3、FTGR:目标 Mark 位置的登录，将目前使用的产品数据保存在指定的产品No.中并保存在CF 记忆卡
		m_FTGGParam.m_strCmd = COMM_CMD_STRING_VTGG;// 4、FTGG:目标 Mark 画素的取得，取得执行“ＦＴＧＴ”结果的画素
		m_FTGDParam.m_strCmd = COMM_CMD_STRING_VTGD;// 5、FTGD:目标 Mark 指示线的全画面显示，在指定目标 Mark No.的目标 Mark 位置上显示全画面的指示线及刻度
		m_FOBJParam.m_strCmd = COMM_CMD_STRING_VOBJ;// 1、FOBJ:物体 Mark 位置的取得，取得物体 Mark（对准靶标）位置
		m_FOBCParam.m_strCmd = COMM_CMD_STRING_VOBC;// 2、FOBC:物体 Mark 位置的取得（候补搜索），利用候补搜索取得物体 Mark（对准靶标）位置
		m_FOBGParam.m_strCmd = COMM_CMD_STRING_VOBG;// 3、FOBG:物体 Mark 画素的取得，取得执行“ＦＯＢＪ”结果的画素
		m_FMSCParam.m_strCmd = COMM_CMD_STRING_VMSC;// 4、FMSC:手动搜索位置的取得，在自动对准时，当目标 Mark 或物体 Mark 搜索失败时，可利用手动方法（鼠标）指定Mark 位置
		m_FWLDParam.m_strCmd = COMM_CMD_STRING_VWLD;// 5、FWLD：取得目标（目标靶标）或对象（对象靶标）的平台坐标上的位置
		m_FGOWParam.m_strCmd = COMM_CMD_STRING_VGOW;// 6、FGOW:拍照取得对象（对象靶标）的平台坐标上的位置
		m_FGAPParam.m_strCmd = COMM_CMD_STRING_VGAP;// 4、FGAP:目标 Mark 画素的取得，取得执行结果的画素
		m_FCNTParam.m_strCmd = COMM_CMD_STRING_VCNT;// 4、FGAP:目标 Mark 画素的取得，取得执行结果的画素
		m_FGTCParam.m_strCmd = COMM_CMD_STRING_VGTC;// 5、FGTC:获取目标相对于图像中心的图像坐标偏差

		m_FCNOParam.m_strCmd = COMM_CMD_STRING_VCNO;

		m_FGALParam.m_strCmd = COMM_CMD_STRING_VGAL;// 1、FGAL:对准精度判定设定的取得，取得对准精度的判定设定
		m_FALLParam.m_strCmd = COMM_CMD_STRING_VALL;// 2、FALL:对准精度判定的更新，更新对准时的对准精度的判定
		m_FGACParam.m_strCmd = COMM_CMD_STRING_VGAC;// 3、FGAC:对准最多次数的取得，取得设定对准最多次数
		m_FALCParam.m_strCmd = COMM_CMD_STRING_VALC;// 4、FALC:对准最多次数的更新，执行自动对准时，容许最多对准次数的更新
		m_FAALParam.m_strCmd = COMM_CMD_STRING_VAAL;// 5、FAAL:自动对准的执行，执行自动对准（连续对准）
		m_FXYAParam.m_strCmd = COMM_CMD_STRING_VXYA;// 5、FXYA:自动对准的执行，执行自动对准（连续对准）
		m_FAABParam.m_strCmd = COMM_CMD_STRING_VAAB;// 5、FAAB:自动对准的执行，执行自动对准（连续对准），增加内部图像十字中心基准对位过程
		m_FACBParam.m_strCmd = COMM_CMD_STRING_VACB;// 5、FACB:自动对准的执行，执行自动对准（连续对准），对象候补搜索，增加内部图像十字中心基准对位过程
		m_FAACParam.m_strCmd = COMM_CMD_STRING_VAAC;// 5、FAAC:自动对准的执行，执行自动对准（连续对准），对象候补搜索
		m_FAHLParam.m_strCmd = COMM_CMD_STRING_VAHL;// 5、FAHL:背光叠片机自动对准的执行，执行自动对准（连续对准）
		m_FANSParam.m_strCmd = COMM_CMD_STRING_VANS;// 6、FANS:对准后的偏移量的取得，取得对准后平台坐标系的偏移量
		m_FALGParam.m_strCmd = COMM_CMD_STRING_VALG;// 7、FALG:１次对准移动量的取得，取得１次对准移动量
		m_FALPParam.m_strCmd = COMM_CMD_STRING_VALP;// 7、FALP:１次对准拾取移动量的取得，取得１次对准拾取移动量
		m_FALJParam.m_strCmd = COMM_CMD_STRING_VALJ;// 8、FALJ:1:次对准精度判定与对准移动量的取得，对准移动量是否在对准精度内的判定与对准移动量的取得
		m_FACOParam.m_strCmd = COMM_CMD_STRING_VACO;// 9、FACO:偏移量的取得，取得目标 Mark 及物体 Mark 之间中心的平台坐标系偏移量
		m_FOLCParam.m_strCmd = COMM_CMD_STRING_VOLC;// 9、FOLC:偏移量的取得，取得目标 Mark 及物体 Mark 之间中心的平台坐标系偏移量
		m_FABOParam.m_strCmd = COMM_CMD_STRING_VABO;// 9、FABO:偏移量的取得，取得目标 Mark 及物体 Mark 之间中心的平台坐标系偏移量
		m_FAOFParam.m_strCmd = COMM_CMD_STRING_VAOF;// 1、FAOF:自动补偿量值的取得，对准偏移量以补偿量值取得
		m_FGOFParam.m_strCmd = COMM_CMD_STRING_VGOF;// 2、FGOF:补偿量值的取得，取得设定的补偿量值
		m_FOFSParam.m_strCmd = COMM_CMD_STRING_VOFS;// 3、FOFS:补偿量值的设定，设定补偿量值
		m_FSFTParam.m_strCmd = COMM_CMD_STRING_VSFT;// 4、FSFT:平台Shift 移动动作，选择内部转移量的设定值，并依照设定值将目前平台的位置做相对移动
		m_FGSFParam.m_strCmd = COMM_CMD_STRING_VGSF;// 5、FGSF:对准Shift 移动量的取得，取得对准转移量
		m_FGPOParam.m_strCmd = COMM_CMD_STRING_VGPO;// 8、FGPO:获取连续对位最终精度
		m_FALMParam.m_strCmd = COMM_CMD_STRING_VALM;// 1、FALM:Alarm资料的取得，取得错误发生的数据代码
		m_FRSTParam.m_strCmd = COMM_CMD_STRING_VRST;// 2、FRST:重新设定（清除错误等），清除各种错误及显示重新设定
		m_FSACParam.m_strCmd = COMM_CMD_STRING_VSAC;// 3、FSAC：保存校正、定位时的数据。所保存的数据为最近500次操作时的数据（不到500次时保存实际次数的数据）
		m_FSCOParam.m_strCmd = COMM_CMD_STRING_VSCO;// 4、FSCO：保存指令收发的历史纪录。所保存的数据为最近500次操作时的数据（不到500次时保存实际次数的数据）
		m_FAOTParam.m_strCmd = COMM_CMD_STRING_VAOT;// 5、FAOT:自动对准的执行，执行自动对准（连续对准），对象候补搜索
		m_FALXParam.m_strCmd = COMM_CMD_STRING_VALX;// 5、FALX:自动对准的执行，执行自动对准（连续对准），对象候补搜索
		m_FWDRParam.m_strCmd = COMM_CMD_STRING_VWDR;// 5.1、FWDR:获取目标/对象Mark的平台坐标系半径（相对于旋转中心的距离）



		m_FCHKParam.m_strCmd = COMM_CMD_STRING_VCHK;// 2、FCHK:握手命令
		m_FCHBParam.m_strCmd = COMM_CMD_STRING_VCHB;
		m_FCHCParam.m_strCmd = COMM_CMD_STRING_VCHC;
		m_FDRPParam.m_strCmd = COMM_CMD_STRING_VDRP;

		m_MNPSParam.m_strCmd = COMM_CMD_STRING_VMPS;// 6、MNPS:平台现在位置的取得，取得平台现在位置
		m_MMVAParam.m_strCmd = COMM_CMD_STRING_VMVA;// 7、MMVA:平台~对准置移动量的设定，设定平台~对准置移动量
		m_MMVRParam.m_strCmd = COMM_CMD_STRING_VMVR;// 8、MMVR:平台相对准置移动量的设定，设定平台相对准置移动量

		m_MPSBParam.m_strCmd = COMM_CMD_STRING_VMPB;
		m_FSPEParam.m_strCmd = COMM_CMD_STRING_VSPE;
		m_FWELParam.m_strCmd = COMM_CMD_STRING_VWEL;
		m_FPCBParam.m_strCmd = COMM_CMD_STRING_VPCB;
		m_FPISParam.m_strCmd = COMM_CMD_STRING_VPIS;
		m_FCPIParam.m_strCmd = COMM_CMD_STRING_VCPI;
		m_FQRCParam.m_strCmd = COMM_CMD_STRING_VQRC;//读取二维码
		m_FQRIParam.m_strCmd = COMM_CMD_STRING_VQRI;//检测二维码
		m_FMCOParam.m_strCmd = COMM_CMD_STRING_VMCO;

		m_FINSParam.m_strCmd = COMM_CMD_STRING_VINS;
		//lzk
		m_FCCIParam.m_strCmd = COMM_CMD_STRING_VCCI;
		// yamaha机器人
		m_strRobotHead = _T("@");			// 指令头
		m_strRobotTail = char(0x03);		// 指令尾
		m_strRobotSeparator = _T(" ");		// 分隔符
		m_strRobotEqual = _T("=");			// 等号
		m_strRobotQuery = _T("?");			// 问号

	}
	else if (m_eProtocolType == eProCmdYamaha)	// 雅马哈机器人无协议
	{
		m_strHead = "S";
		m_strTail = "E";
		m_strSeparator = _T(" "); // 空格
		m_FSPCParam.m_strCmd = COMM_CMD_STRING_FVPC;

		m_FSPCParam.m_strCmd = COMM_CMD_STRING_FSPC;// 1、 FSPC：产品切换的设定，将产品切换至指定的产品No.
		m_FSSVParam.m_strCmd = COMM_CMD_STRING_FSSV;// 2、 FSSV：指定产品No.的保存，将目前使用的产品数据保存在指定的产品No.并保存在CF 记忆卡中
		m_FGSPParam.m_strCmd = COMM_CMD_STRING_FGSP;// 3、 FGSP：产品No.的取得，取得目前正在执行的产品No.
		m_FVASParam.m_strCmd = COMM_CMD_STRING_FVAS;// 3、 FVAS：产品虚拟Mark设定.

		m_FCLBParam.m_strCmd = COMM_CMD_STRING_FCLB;// 1、FCLB:Calibration 的执行 执行Calibration
		m_FCBSParam.m_strCmd = COMM_CMD_STRING_FCBS;// 1、FCBS:Calibration 的执行 执行Calibration
		m_FCBRParam.m_strCmd = COMM_CMD_STRING_FCBR;// 1、FCBR:Calibration 的执行 执行Calibration
		m_FCPRParam.m_strCmd = COMM_CMD_STRING_FCPR;// 1、FCPR:相机轴标定
		m_FCBPParam.m_strCmd = COMM_CMD_STRING_FCBP;// 1、FCBP:自动关联

		m_FTGTParam.m_strCmd = COMM_CMD_STRING_FTGT;// 1、FTGT:目标 Mark 位置的取得，取得目标 Mark（目标）位置
		m_FTGSParam.m_strCmd = COMM_CMD_STRING_FTGS;// 1.1、FTGT:目标 Mark 位置的取得，取得目标 Mark（目标）位置
		m_FTGCParam.m_strCmd = COMM_CMD_STRING_FTGC;// 2、FTGC:目标 Mark 位置的取得（候补搜索），利用候补搜索取得目标 Mark（目标）位置
		m_FTGRParam.m_strCmd = COMM_CMD_STRING_FTGR;// 3、FTGR:目标 Mark 位置的登录，将目前使用的产品数据保存在指定的产品No.中并保存在CF 记忆卡
		m_FTGGParam.m_strCmd = COMM_CMD_STRING_FTGG;// 4、FTGG:目标 Mark 画素的取得，取得执行“ＦＴＧＴ”结果的画素
		m_FTGDParam.m_strCmd = COMM_CMD_STRING_FTGD;// 5、FTGD:目标 Mark 指示线的全画面显示，在指定目标 Mark No.的目标 Mark 位置上显示全画面的指示线及刻度
		m_FOBJParam.m_strCmd = COMM_CMD_STRING_FOBJ;// 1、FOBJ:物体 Mark 位置的取得，取得物体 Mark（对准靶标）位置
		m_FOBCParam.m_strCmd = COMM_CMD_STRING_FOBC;// 2、FOBC:物体 Mark 位置的取得（候补搜索），利用候补搜索取得物体 Mark（对准靶标）位置
		m_FOBGParam.m_strCmd = COMM_CMD_STRING_FOBG;// 3、FOBG:物体 Mark 画素的取得，取得执行“ＦＯＢＪ”结果的画素
		m_FMSCParam.m_strCmd = COMM_CMD_STRING_FMSC;// 4、FMSC:手动搜索位置的取得，在自动对准时，当目标 Mark 或物体 Mark 搜索失败时，可利用手动方法（鼠标）指定Mark 位置
		m_FWLDParam.m_strCmd = COMM_CMD_STRING_FWLD;// 5、FWLD：取得目标（目标靶标）或对象（对象靶标）的平台坐标上的位置
		m_FGOWParam.m_strCmd = COMM_CMD_STRING_FGOW;// 6、FGOW:拍照取得对象（对象靶标）的平台坐标上的位置
		m_FGAPParam.m_strCmd = COMM_CMD_STRING_FGAP;// 4、FGAP:目标 Mark 画素的取得，取得执行结果的画素
		m_FCNTParam.m_strCmd = COMM_CMD_STRING_FCNT;// 4、FGAP:目标 Mark 画素的取得，取得执行结果的画素
		m_FGTCParam.m_strCmd = COMM_CMD_STRING_FGTC;// 5、FGTC:获取目标相对于图像中心的图像坐标偏差

		m_FCNOParam.m_strCmd = COMM_CMD_STRING_FCNO;

		m_FGALParam.m_strCmd = COMM_CMD_STRING_FGAL;// 1、FGAL:对准精度判定设定的取得，取得对准精度的判定设定
		m_FALLParam.m_strCmd = COMM_CMD_STRING_FALL;// 2、FALL:对准精度判定的更新，更新对准时的对准精度的判定
		m_FGACParam.m_strCmd = COMM_CMD_STRING_FGAC;// 3、FGAC:对准最多次数的取得，取得设定对准最多次数
		m_FALCParam.m_strCmd = COMM_CMD_STRING_FALC;// 4、FALC:对准最多次数的更新，执行自动对准时，容许最多对准次数的更新
		m_FAALParam.m_strCmd = COMM_CMD_STRING_FAAL;// 5、FAAL:自动对准的执行，执行自动对准（连续对准）
		m_FXYAParam.m_strCmd = COMM_CMD_STRING_FXYA;// 5、FXYA:自动对准的执行，执行自动对准（连续对准）
		m_FAABParam.m_strCmd = COMM_CMD_STRING_FAAB;// 5、FAAB:自动对准的执行，执行自动对准（连续对准），增加内部图像十字中心基准对位过程
		m_FACBParam.m_strCmd = COMM_CMD_STRING_FACB;// 5、FACB:自动对准的执行，执行自动对准（连续对准），对象候补搜索，增加内部图像十字中心基准对位过程
		m_FAACParam.m_strCmd = COMM_CMD_STRING_FAAC;// 5、FAAC:自动对准的执行，执行自动对准（连续对准），对象候补搜索
		m_FAHLParam.m_strCmd = COMM_CMD_STRING_FAHL;// 5、FAHL:背光叠片机自动对准的执行，执行自动对准（连续对准）
		m_FANSParam.m_strCmd = COMM_CMD_STRING_FANS;// 6、FANS:对准后的偏移量的取得，取得对准后平台坐标系的偏移量
		m_FALGParam.m_strCmd = COMM_CMD_STRING_FALG;// 7、FALG:１次对准移动量的取得，取得１次对准移动量
		m_FALPParam.m_strCmd = COMM_CMD_STRING_FALP;// 7、FALP:１次对准拾取移动量的取得，取得１次对准拾取移动量
		m_FALJParam.m_strCmd = COMM_CMD_STRING_FALJ;// 8、FALJ:1:次对准精度判定与对准移动量的取得，对准移动量是否在对准精度内的判定与对准移动量的取得
		m_FACOParam.m_strCmd = COMM_CMD_STRING_FACO;// 9、FACO:偏移量的取得，取得目标 Mark 及物体 Mark 之间中心的平台坐标系偏移量
		m_FAAOParam.m_strCmd = COMM_CMD_STRING_FAAO;
		m_FOLCParam.m_strCmd = COMM_CMD_STRING_FOLC;// 9、FOLC:偏移量的取得，取得目标 Mark 及物体 Mark 之间中心的平台坐标系偏移量
		m_FABOParam.m_strCmd = COMM_CMD_STRING_FABO;// 9、FABO:偏移量的取得，取得目标 Mark 及物体 Mark 之间中心的平台坐标系偏移量
		m_FAOFParam.m_strCmd = COMM_CMD_STRING_FAOF;// 1、FAOF:自动补偿量值的取得，对准偏移量以补偿量值取得
		m_FGOFParam.m_strCmd = COMM_CMD_STRING_FGOF;// 2、FGOF:补偿量值的取得，取得设定的补偿量值
		m_FOFSParam.m_strCmd = COMM_CMD_STRING_FOFS;// 3、FOFS:补偿量值的设定，设定补偿量值
		m_FSFTParam.m_strCmd = COMM_CMD_STRING_FSFT;// 4、FSFT:平台Shift 移动动作，选择内部转移量的设定值，并依照设定值将目前平台的位置做相对移动
		m_FGSFParam.m_strCmd = COMM_CMD_STRING_FGSF;// 5、FGSF:对准Shift 移动量的取得，取得对准转移量
		m_FGPOParam.m_strCmd = COMM_CMD_STRING_FGPO;// 8、FGPO:获取连续对位最终精度
		m_FALMParam.m_strCmd = COMM_CMD_STRING_FALM;// 1、FALM:Alarm资料的取得，取得错误发生的数据代码
		m_FRSTParam.m_strCmd = COMM_CMD_STRING_FRST;// 2、FRST:重新设定（清除错误等），清除各种错误及显示重新设定
		m_FSACParam.m_strCmd = COMM_CMD_STRING_FSAC;// 3、FSAC：保存校正、定位时的数据。所保存的数据为最近500次操作时的数据（不到500次时保存实际次数的数据）
		m_FSCOParam.m_strCmd = COMM_CMD_STRING_FSCO;// 4、FSCO：保存指令收发的历史纪录。所保存的数据为最近500次操作时的数据（不到500次时保存实际次数的数据）
		m_FAOTParam.m_strCmd = COMM_CMD_STRING_FAOT;// 5、FAOT:自动对准的执行，执行自动对准（连续对准），对象候补搜索，目标候补搜索
		m_FALXParam.m_strCmd = COMM_CMD_STRING_FALX;// 5、FALX:自动对准的执行，执行自动对准（连续对准），对象候补搜索
		m_FWDRParam.m_strCmd = COMM_CMD_STRING_FWDR;// 5.1、FWDR:获取Mark的平台坐标系半径（相对于旋转中心的距离）


		m_MNPSParam.m_strCmd = COMM_CMD_STRING_FMPS;// 6、MNPS:平台现在位置的取得，取得平台现在位置
		m_MMVAParam.m_strCmd = COMM_CMD_STRING_FMVA;// 7、MMVA:平台~对准置移动量的设定，设定平台~对准置移动量
		m_MMVRParam.m_strCmd = COMM_CMD_STRING_FMVR;// 8、MMVR:平台相对准置移动量的设定，设定平台相对准置移动量
		m_FCHBParam.m_strCmd = COMM_CMD_STRING_FCHB;
		m_FCHCParam.m_strCmd = COMM_CMD_STRING_FCHC;
		m_FDRPParam.m_strCmd = COMM_CMD_STRING_FDRP;// 7、FDRP:计算基准拾取位置自动流程
		m_MPSBParam.m_strCmd = COMM_CMD_STRING_FMPB;
		m_FSPEParam.m_strCmd = COMM_CMD_STRING_FSPE;
		m_FWELParam.m_strCmd = COMM_CMD_STRING_FWEL;
		m_FPCBParam.m_strCmd = COMM_CMD_STRING_FPCB;
		m_FPISParam.m_strCmd = COMM_CMD_STRING_FPIS;
		m_FCPIParam.m_strCmd = COMM_CMD_STRING_FCPI;
		m_FQRCParam.m_strCmd = COMM_CMD_STRING_FQRC;//读取二维码
		m_FMCOParam.m_strCmd = COMM_CMD_STRING_FMCO;

		m_FINSParam.m_strCmd = COMM_CMD_STRING_FINS;
		//lzk
		m_FCCIParam.m_strCmd = COMM_CMD_STRING_FCCI;
		// yamaha机器人
		m_strRobotHead = _T("@");			// 指令头
		m_strRobotTail = char(0x03);		// 指令尾
		m_strRobotSeparator = _T(" ");		// 分隔符
		m_strRobotEqual = _T("=");			// 等号
		m_strRobotQuery = _T("?");			// 问号

	}
	else if (m_eProtocolType == eProCmdEpson)	// 爱普生机器人无协议
	{
		m_strHead = "S";
		m_strTail = "E";
		m_strSeparator = _T(" "); // 空格
		m_FSPCParam.m_strCmd = COMM_CMD_STRING_FVPC;
		m_FSPCParam.m_strCmd = COMM_CMD_STRING_FSPC;// 1、 FSPC：产品切换的设定，将产品切换至指定的产品No.
		m_FSSVParam.m_strCmd = COMM_CMD_STRING_FSSV;// 2、 FSSV：指定产品No.的保存，将目前使用的产品数据保存在指定的产品No.并保存在CF 记忆卡中
		m_FGSPParam.m_strCmd = COMM_CMD_STRING_FGSP;// 3、 FGSP：产品No.的取得，取得目前正在执行的产品No.
		m_FVASParam.m_strCmd = COMM_CMD_STRING_FVAS;// 3、 FVAS：产品虚拟Mark设定.

		m_FCLBParam.m_strCmd = COMM_CMD_STRING_FCLB;// 1、FCLB:Calibration 的执行 执行Calibration
		m_FCBSParam.m_strCmd = COMM_CMD_STRING_FCBS;// 1、FCBS:Calibration 的执行 执行Calibration
		m_FCBRParam.m_strCmd = COMM_CMD_STRING_FCBR;// 1、FCBR:Calibration 的执行 执行Calibration
		m_FCPRParam.m_strCmd = COMM_CMD_STRING_FCPR;// 1、FCPR:相机轴标定
		m_FCBPParam.m_strCmd = COMM_CMD_STRING_FCBP;// 1、FCBP:自动关联

		m_FTGTParam.m_strCmd = COMM_CMD_STRING_FTGT;// 1、FTGT:目标 Mark 位置的取得，取得目标 Mark（目标）位置
		m_FTGSParam.m_strCmd = COMM_CMD_STRING_FTGS;// 1.1、FTGT:目标 Mark 位置的取得，取得目标 Mark（目标）位置
		m_FTGCParam.m_strCmd = COMM_CMD_STRING_FTGC;// 2、FTGC:目标 Mark 位置的取得（候补搜索），利用候补搜索取得目标 Mark（目标）位置
		m_FTGRParam.m_strCmd = COMM_CMD_STRING_FTGR;// 3、FTGR:目标 Mark 位置的登录，将目前使用的产品数据保存在指定的产品No.中并保存在CF 记忆卡
		m_FTGGParam.m_strCmd = COMM_CMD_STRING_FTGG;// 4、FTGG:目标 Mark 画素的取得，取得执行“ＦＴＧＴ”结果的画素
		m_FTGDParam.m_strCmd = COMM_CMD_STRING_FTGD;// 5、FTGD:目标 Mark 指示线的全画面显示，在指定目标 Mark No.的目标 Mark 位置上显示全画面的指示线及刻度
		m_FOBJParam.m_strCmd = COMM_CMD_STRING_FOBJ;// 1、FOBJ:物体 Mark 位置的取得，取得物体 Mark（对准靶标）位置
		m_FOBCParam.m_strCmd = COMM_CMD_STRING_FOBC;// 2、FOBC:物体 Mark 位置的取得（候补搜索），利用候补搜索取得物体 Mark（对准靶标）位置
		m_FOBGParam.m_strCmd = COMM_CMD_STRING_FOBG;// 3、FOBG:物体 Mark 画素的取得，取得执行“ＦＯＢＪ”结果的画素
		m_FMSCParam.m_strCmd = COMM_CMD_STRING_FMSC;// 4、FMSC:手动搜索位置的取得，在自动对准时，当目标 Mark 或物体 Mark 搜索失败时，可利用手动方法（鼠标）指定Mark 位置
		m_FWLDParam.m_strCmd = COMM_CMD_STRING_FWLD;// 5、FWLD：取得目标（目标靶标）或对象（对象靶标）的平台坐标上的位置
		m_FGOWParam.m_strCmd = COMM_CMD_STRING_FGOW;// 6、FGOW:拍照取得对象（对象靶标）的平台坐标上的位置
		m_FGAPParam.m_strCmd = COMM_CMD_STRING_FGAP;// 4、FGAP:目标 Mark 画素的取得，取得执行结果的画素
		m_FCNTParam.m_strCmd = COMM_CMD_STRING_FCNT;// 4、FGAP:目标 Mark 画素的取得，取得执行结果的画素
		m_FGTCParam.m_strCmd = COMM_CMD_STRING_FGTC;// 5、FGTC:获取目标相对于图像中心的图像坐标偏差

		m_FCNOParam.m_strCmd = COMM_CMD_STRING_FCNO;

		m_FGALParam.m_strCmd = COMM_CMD_STRING_FGAL;// 1、FGAL:对准精度判定设定的取得，取得对准精度的判定设定
		m_FALLParam.m_strCmd = COMM_CMD_STRING_FALL;// 2、FALL:对准精度判定的更新，更新对准时的对准精度的判定
		m_FGACParam.m_strCmd = COMM_CMD_STRING_FGAC;// 3、FGAC:对准最多次数的取得，取得设定对准最多次数
		m_FALCParam.m_strCmd = COMM_CMD_STRING_FALC;// 4、FALC:对准最多次数的更新，执行自动对准时，容许最多对准次数的更新
		m_FAALParam.m_strCmd = COMM_CMD_STRING_FAAL;// 5、FAAL:自动对准的执行，执行自动对准（连续对准）
		m_FXYAParam.m_strCmd = COMM_CMD_STRING_FXYA;// 5、FXYA:自动对准的执行，执行自动对准（连续对准）
		m_FAABParam.m_strCmd = COMM_CMD_STRING_FAAB;// 5、FAAB:自动对准的执行，执行自动对准（连续对准），增加内部图像十字中心基准对位过程
		m_FACBParam.m_strCmd = COMM_CMD_STRING_FACB;// 5、FACB:自动对准的执行，执行自动对准（连续对准），对象候补搜索，增加内部图像十字中心基准对位过程
		m_FAACParam.m_strCmd = COMM_CMD_STRING_FAAC;// 5、FAAC:自动对准的执行，执行自动对准（连续对准），对象候补搜索
		m_FAHLParam.m_strCmd = COMM_CMD_STRING_FAHL;// 5、FAHL:背光叠片机自动对准的执行，执行自动对准（连续对准）
		m_FANSParam.m_strCmd = COMM_CMD_STRING_FANS;// 6、FANS:对准后的偏移量的取得，取得对准后平台坐标系的偏移量
		m_FALGParam.m_strCmd = COMM_CMD_STRING_FALG;// 7、FALG:１次对准移动量的取得，取得１次对准移动量
		m_FALPParam.m_strCmd = COMM_CMD_STRING_FALP;// 7、FALP:１次对准拾取移动量的取得，取得１次对准拾取移动量
		m_FALJParam.m_strCmd = COMM_CMD_STRING_FALJ;// 8、FALJ:1:次对准精度判定与对准移动量的取得，对准移动量是否在对准精度内的判定与对准移动量的取得
		m_FACOParam.m_strCmd = COMM_CMD_STRING_FACO;// 9、FACO:偏移量的取得，取得目标 Mark 及物体 Mark 之间中心的平台坐标系偏移量
		m_FAAOParam.m_strCmd = COMM_CMD_STRING_FAAO;
		m_FOLCParam.m_strCmd = COMM_CMD_STRING_FOLC;// 9、FOLC:偏移量的取得，取得目标 Mark 及物体 Mark 之间中心的平台坐标系偏移量
		m_FABOParam.m_strCmd = COMM_CMD_STRING_FABO;// 9、FABO:偏移量的取得，取得目标 Mark 及物体 Mark 之间中心的平台坐标系偏移量
		m_FAOFParam.m_strCmd = COMM_CMD_STRING_FAOF;// 1、FAOF:自动补偿量值的取得，对准偏移量以补偿量值取得
		m_FGOFParam.m_strCmd = COMM_CMD_STRING_FGOF;// 2、FGOF:补偿量值的取得，取得设定的补偿量值
		m_FOFSParam.m_strCmd = COMM_CMD_STRING_FOFS;// 3、FOFS:补偿量值的设定，设定补偿量值
		m_FSFTParam.m_strCmd = COMM_CMD_STRING_FSFT;// 4、FSFT:平台Shift 移动动作，选择内部转移量的设定值，并依照设定值将目前平台的位置做相对移动
		m_FGSFParam.m_strCmd = COMM_CMD_STRING_FGSF;// 5、FGSF:对准Shift 移动量的取得，取得对准转移量
		m_FGPOParam.m_strCmd = COMM_CMD_STRING_FGPO;// 8、FGPO:获取连续对位最终精度
		m_FALMParam.m_strCmd = COMM_CMD_STRING_FALM;// 1、FALM:Alarm资料的取得，取得错误发生的数据代码
		m_FRSTParam.m_strCmd = COMM_CMD_STRING_FRST;// 2、FRST:重新设定（清除错误等），清除各种错误及显示重新设定
		m_FSACParam.m_strCmd = COMM_CMD_STRING_FSAC;// 3、FSAC：保存校正、定位时的数据。所保存的数据为最近500次操作时的数据（不到500次时保存实际次数的数据）
		m_FSCOParam.m_strCmd = COMM_CMD_STRING_FSCO;// 4、FSCO：保存指令收发的历史纪录。所保存的数据为最近500次操作时的数据（不到500次时保存实际次数的数据）
		m_FAOTParam.m_strCmd = COMM_CMD_STRING_FAOT;// 5、FAOT:自动对准的执行，执行自动对准（连续对准），对象候补搜索，目标候补搜索
		m_FALXParam.m_strCmd = COMM_CMD_STRING_FALX;// 5、FALX:自动对准的执行，执行自动对准（连续对准），对象候补搜索
		m_FWDRParam.m_strCmd = COMM_CMD_STRING_FWDR;// 5.1、FWDR:获取Mark的平台坐标系半径（相对于旋转中心的距离）
		m_FCHBParam.m_strCmd = COMM_CMD_STRING_FCHB;
		m_FCHCParam.m_strCmd = COMM_CMD_STRING_FCHC;
		m_FDRPParam.m_strCmd = COMM_CMD_STRING_FDRP;// 7、FDRP:计算基准拾取位置自动流程



		m_MNPSParam.m_strCmd = COMM_CMD_STRING_FMPS;// 6、MNPS:平台现在位置的取得，取得平台现在位置
		m_MMVAParam.m_strCmd = COMM_CMD_STRING_FMVA;// 7、MMVA:平台~对准置移动量的设定，设定平台~对准置移动量
		m_MMVRParam.m_strCmd = COMM_CMD_STRING_FMVR;// 8、MMVR:平台相对准置移动量的设定，设定平台相对准置移动量

		m_MPSBParam.m_strCmd = COMM_CMD_STRING_FMPB;
		m_FSPEParam.m_strCmd = COMM_CMD_STRING_FSPE;
		m_FWELParam.m_strCmd = COMM_CMD_STRING_FWEL;
		m_FPCBParam.m_strCmd = COMM_CMD_STRING_FPCB;
		m_FPISParam.m_strCmd = COMM_CMD_STRING_FPIS;
		m_FCPIParam.m_strCmd = COMM_CMD_STRING_FCPI;
		m_FQRCParam.m_strCmd = COMM_CMD_STRING_FQRC;//读取二维码
		m_FQRIParam.m_strCmd = COMM_CMD_STRING_FQRI;
		m_FMCOParam.m_strCmd = COMM_CMD_STRING_FMCO;
		//lzk
		m_FCCIParam.m_strCmd = COMM_CMD_STRING_FCCI;
		m_FINSParam.m_strCmd = COMM_CMD_STRING_FINS;

		// yamaha机器人
		m_strRobotHead = _T("@");			// 指令头
		m_strRobotTail = char(0x03);		// 指令尾
		m_strRobotSeparator = _T(" ");		// 分隔符
		m_strRobotEqual = _T("=");			// 等号
		m_strRobotQuery = _T("?");			// 问号

	}
	else if (CreateCommProPlc(m_eProtocolType) == TRUE)	// PLC链接通信协议
	{
		m_strHead = char(0x02);	// STX
		m_strTail = char(0x03); // ETX
		m_strSeparator = _T(" "); // 空格
		//lzk 0408
		m_FSPCParam.m_strCmd = COMM_CMD_STRING_FVPC;

		m_FSPCParam.m_strCmd = COMM_CMD_STRING_FSPC;// 1、 FSPC：产品切换的设定，将产品切换至指定的产品No.
		m_FSSVParam.m_strCmd = COMM_CMD_STRING_FSSV;// 2、 FSSV：指定产品No.的保存，将目前使用的产品数据保存在指定的产品No.并保存在CF 记忆卡中
		m_FGSPParam.m_strCmd = COMM_CMD_STRING_FGSP;// 3、 FGSP：产品No.的取得，取得目前正在执行的产品No.
		m_FVASParam.m_strCmd = COMM_CMD_STRING_FVAS;// 3、 FVAS：产品虚拟Mark设定.

		m_FCLBParam.m_strCmd = COMM_CMD_STRING_FCLB;// 1、FCLB:Calibration 的执行 执行Calibration
		m_FCBSParam.m_strCmd = COMM_CMD_STRING_FCBS;// 1、FCBS:Calibration 的执行 执行Calibration
		m_FCBRParam.m_strCmd = COMM_CMD_STRING_FCBR;// 1、FCBR:Calibration 的执行 执行Calibration
		m_FCPRParam.m_strCmd = COMM_CMD_STRING_FCPR;// 1、FCPR:相机轴标定
		m_FCBPParam.m_strCmd = COMM_CMD_STRING_FCBP;// 1、FCBP:自动关联

		m_FTGTParam.m_strCmd = COMM_CMD_STRING_FTGT;// 1、FTGT:目标 Mark 位置的取得，取得目标 Mark（目标）位置
		m_FTGSParam.m_strCmd = COMM_CMD_STRING_FTGS;// 1.1、FTGT:目标 Mark 位置的取得，取得目标 Mark（目标）位置
		m_FTGCParam.m_strCmd = COMM_CMD_STRING_FTGC;// 2、FTGC:目标 Mark 位置的取得（候补搜索），利用候补搜索取得目标 Mark（目标）位置
		m_FTGRParam.m_strCmd = COMM_CMD_STRING_FTGR;// 3、FTGR:目标 Mark 位置的登录，将目前使用的产品数据保存在指定的产品No.中并保存在CF 记忆卡
		m_FTGGParam.m_strCmd = COMM_CMD_STRING_FTGG;// 4、FTGG:目标 Mark 画素的取得，取得执行“ＦＴＧＴ”结果的画素
		m_FTGDParam.m_strCmd = COMM_CMD_STRING_FTGD;// 5、FTGD:目标 Mark 指示线的全画面显示，在指定目标 Mark No.的目标 Mark 位置上显示全画面的指示线及刻度
		m_FOBJParam.m_strCmd = COMM_CMD_STRING_FOBJ;// 1、FOBJ:物体 Mark 位置的取得，取得物体 Mark（对准靶标）位置
		m_FOBCParam.m_strCmd = COMM_CMD_STRING_FOBC;// 2、FOBC:物体 Mark 位置的取得（候补搜索），利用候补搜索取得物体 Mark（对准靶标）位置
		m_FOBGParam.m_strCmd = COMM_CMD_STRING_FOBG;// 3、FOBG:物体 Mark 画素的取得，取得执行“ＦＯＢＪ”结果的画素
		m_FMSCParam.m_strCmd = COMM_CMD_STRING_FMSC;// 4、FMSC:手动搜索位置的取得，在自动对准时，当目标 Mark 或物体 Mark 搜索失败时，可利用手动方法（鼠标）指定Mark 位置
		m_FWLDParam.m_strCmd = COMM_CMD_STRING_FWLD;// 5、FWLD：取得目标（目标靶标）或对象（对象靶标）的平台坐标上的位置
		m_FGOWParam.m_strCmd = COMM_CMD_STRING_FGOW;// 6、FGOW:拍照取得对象（对象靶标）的平台坐标上的位置
		m_FGAPParam.m_strCmd = COMM_CMD_STRING_FGAP;// 4、FGAP:目标 Mark 画素的取得，取得执行结果的画素
		m_FCNTParam.m_strCmd = COMM_CMD_STRING_FCNT;// 4、FGAP:目标 Mark 画素的取得，取得执行结果的画素
		m_FGTCParam.m_strCmd = COMM_CMD_STRING_FGTC;// 5、FGTC:获取目标相对于图像中心的图像坐标偏差

		m_FCNOParam.m_strCmd = COMM_CMD_STRING_FCNO;

		m_FGALParam.m_strCmd = COMM_CMD_STRING_FGAL;// 1、FGAL:对准精度判定设定的取得，取得对准精度的判定设定
		m_FALLParam.m_strCmd = COMM_CMD_STRING_FALL;// 2、FALL:对准精度判定的更新，更新对准时的对准精度的判定
		m_FGACParam.m_strCmd = COMM_CMD_STRING_FGAC;// 3、FGAC:对准最多次数的取得，取得设定对准最多次数
		m_FALCParam.m_strCmd = COMM_CMD_STRING_FALC;// 4、FALC:对准最多次数的更新，执行自动对准时，容许最多对准次数的更新
		m_FAALParam.m_strCmd = COMM_CMD_STRING_FAAL;// 5、FAAL:自动对准的执行，执行自动对准（连续对准）
		m_FXYAParam.m_strCmd = COMM_CMD_STRING_FXYA;// 5、FXYA:自动对准的执行，执行自动对准（连续对准）
		m_FAABParam.m_strCmd = COMM_CMD_STRING_FAAB;// 5、FAAB:自动对准的执行，执行自动对准（连续对准），增加内部图像十字中心基准对位过程
		m_FACBParam.m_strCmd = COMM_CMD_STRING_FACB;// 5、FACB:自动对准的执行，执行自动对准（连续对准），对象候补搜索，增加内部图像十字中心基准对位过程
		m_FAACParam.m_strCmd = COMM_CMD_STRING_FAAC;// 5、FAAC:自动对准的执行，执行自动对准（连续对准），对象候补搜索
		m_FAHLParam.m_strCmd = COMM_CMD_STRING_FAHL;// 5、FAHL:背光叠片机自动对准的执行，执行自动对准（连续对准）
		m_FANSParam.m_strCmd = COMM_CMD_STRING_FANS;// 6、FANS:对准后的偏移量的取得，取得对准后平台坐标系的偏移量
		m_FALGParam.m_strCmd = COMM_CMD_STRING_FALG;// 7、FALG:１次对准移动量的取得，取得１次对准移动量
		m_FALPParam.m_strCmd = COMM_CMD_STRING_FALP;// 7、FALP:１次对准拾取移动量的取得，取得１次对准拾取移动量
		m_FALJParam.m_strCmd = COMM_CMD_STRING_FALJ;// 8、FALJ:1:次对准精度判定与对准移动量的取得，对准移动量是否在对准精度内的判定与对准移动量的取得
		m_FACOParam.m_strCmd = COMM_CMD_STRING_FACO;// 9、FACO:偏移量的取得，取得目标 Mark 及物体 Mark 之间中心的平台坐标系偏移量
		m_FAAOParam.m_strCmd = COMM_CMD_STRING_FAAO;
		m_FOLCParam.m_strCmd = COMM_CMD_STRING_FOLC;// 9、FOLC:偏移量的取得，取得目标 Mark 及物体 Mark 之间中心的平台坐标系偏移量
		m_FABOParam.m_strCmd = COMM_CMD_STRING_FABO;// 9、FABO:偏移量的取得，取得目标 Mark 及物体 Mark 之间中心的平台坐标系偏移量
		m_FAOFParam.m_strCmd = COMM_CMD_STRING_FAOF;// 1、FAOF:自动补偿量值的取得，对准偏移量以补偿量值取得
		m_FGOFParam.m_strCmd = COMM_CMD_STRING_FGOF;// 2、FGOF:补偿量值的取得，取得设定的补偿量值
		m_FOFSParam.m_strCmd = COMM_CMD_STRING_FOFS;// 3、FOFS:补偿量值的设定，设定补偿量值
		m_FSFTParam.m_strCmd = COMM_CMD_STRING_FSFT;// 4、FSFT:平台Shift 移动动作，选择内部转移量的设定值，并依照设定值将目前平台的位置做相对移动
		m_FGSFParam.m_strCmd = COMM_CMD_STRING_FGSF;// 5、FGSF:对准Shift 移动量的取得，取得对准转移量
		m_FGPOParam.m_strCmd = COMM_CMD_STRING_FGPO;// 8、FGPO:获取连续对位最终精度
		m_FALMParam.m_strCmd = COMM_CMD_STRING_FALM;// 1、FALM:Alarm资料的取得，取得错误发生的数据代码
		m_FRSTParam.m_strCmd = COMM_CMD_STRING_FRST;// 2、FRST:重新设定（清除错误等），清除各种错误及显示重新设定
		m_FSACParam.m_strCmd = COMM_CMD_STRING_FSAC;// 3、FSAC：保存校正、定位时的数据。所保存的数据为最近500次操作时的数据（不到500次时保存实际次数的数据）
		m_FSCOParam.m_strCmd = COMM_CMD_STRING_FSCO;// 4、FSCO：保存指令收发的历史纪录。所保存的数据为最近500次操作时的数据（不到500次时保存实际次数的数据）
		m_FAOTParam.m_strCmd = COMM_CMD_STRING_FAOT;// 5、FAOT:自动对准的执行，执行自动对准（连续对准），对象候补搜索，目标候补搜索
		m_FALXParam.m_strCmd = COMM_CMD_STRING_FALX;// 5、FALX:自动对准的执行，执行自动对准（连续对准），对象候补搜索
		m_FWDRParam.m_strCmd = COMM_CMD_STRING_FWDR;// 5.1、FWDR:获取Mark的平台坐标系半径（相对于旋转中心的距离）
		m_FCHBParam.m_strCmd = COMM_CMD_STRING_FCHB;
		m_FCHCParam.m_strCmd = COMM_CMD_STRING_FCHC;
		m_FDRPParam.m_strCmd = COMM_CMD_STRING_FDRP;// 7、FDRP:计算基准拾取位置自动流程



		m_MNPSParam.m_strCmd = COMM_CMD_STRING_FMPS;// 6、MNPS:平台现在位置的取得，取得平台现在位置
		m_MMVAParam.m_strCmd = COMM_CMD_STRING_FMVA;// 7、MMVA:平台~对准置移动量的设定，设定平台~对准置移动量
		m_MMVRParam.m_strCmd = COMM_CMD_STRING_FMVR;// 8、MMVR:平台相对准置移动量的设定，设定平台相对准置移动量

		m_FINSParam.m_strCmd = COMM_CMD_STRING_FINS;

		// FAST读写寄存器(暂无)
		m_FHMSParam.m_strCmd = COMM_CMD_STRING_FHMS;// 			2	FHMS
		m_FHOMParam.m_strCmd = COMM_CMD_STRING_FHOM;// 			3	FHOM
		m_FPNTParam.m_strCmd = COMM_CMD_STRING_FPNT;// 			12	FPNT
		m_FMAPParam.m_strCmd = COMM_CMD_STRING_FMAP;// 			22	FMAP
		m_FRCTParam.m_strCmd = COMM_CMD_STRING_FRCT;// 			24	FRCT
		m_FISPParam.m_strCmd = COMM_CMD_STRING_FISP;// 			25	FISP
		m_FOLGParam.m_strCmd = COMM_CMD_STRING_FOLG;// 			26	FOLG
		m_FTLGParam.m_strCmd = COMM_CMD_STRING_FTLG;// 			27	FTLG

		m_MPSBParam.m_strCmd = COMM_CMD_STRING_FMPB;
		m_FSPEParam.m_strCmd = COMM_CMD_STRING_FSPE;
		m_FWELParam.m_strCmd = COMM_CMD_STRING_FWEL;
		m_FPCBParam.m_strCmd = COMM_CMD_STRING_FPCB;
		m_FPISParam.m_strCmd = COMM_CMD_STRING_FPIS;
		m_FCPIParam.m_strCmd = COMM_CMD_STRING_FCPI;
		m_FQRCParam.m_strCmd = COMM_CMD_STRING_FQRC;//读取二维码
		m_FQRIParam.m_strCmd = COMM_CMD_STRING_FQRI;
		m_FMCOParam.m_strCmd = COMM_CMD_STRING_FMCO;
		//lzk
		m_FCCIParam.m_strCmd = COMM_CMD_STRING_FCCI;

		// 		m_VFRSTParam.m_strCmd = COMM_CMD_STRING_FRST;// 		    1	FRST
		// 		m_VFHMSParam.m_strCmd = COMM_CMD_STRING_FHMS;// 			2	FHMS
		// 		m_VFHOMParam.m_strCmd = COMM_CMD_STRING_FHOM;// 			3	FHOM
		// 		m_VFSPCParam.m_strCmd = COMM_CMD_STRING_FSPC;// 			4	FSPC
		// 		m_VFCLBParam.m_strCmd = COMM_CMD_STRING_FCLB;// 			5	FCLB
		// 		m_VFTGTParam.m_strCmd = COMM_CMD_STRING_FTGT;// 			6	FTGT
		// 		m_VFOBJParam.m_strCmd = COMM_CMD_STRING_FOBJ;// 			7	FOBJ
		// 		m_VFAALParam.m_strCmd = COMM_CMD_STRING_FAAL;// 			8	FAAL
		// 		m_VMNPSParam.m_strCmd = COMM_CMD_STRING_FMPS;// 			9	FNPS
		// 		m_VMMVAParam.m_strCmd = COMM_CMD_STRING_FMVA;// 			10	FMVA
		// 		m_VMMVRParam.m_strCmd = COMM_CMD_STRING_FMVR;// 			11	FMVR
		// 		m_VFPNTParam.m_strCmd = COMM_CMD_STRING_FPNT;// 			12	FPNT
		// 		m_VFACOParam.m_strCmd = COMM_CMD_STRING_FACO;// 			13	FACO
		// 		m_VFALGParam.m_strCmd = COMM_CMD_STRING_FALG;// 			14	FALG
		// 		m_VFCNTParam.m_strCmd = COMM_CMD_STRING_FCNT;// 			15	FCNT
		// 		m_VFGAPParam.m_strCmd = COMM_CMD_STRING_FGAP;// 			16	FGAP
		// 		m_VFTGCParam.m_strCmd = COMM_CMD_STRING_FTGC;// 			17	FTGC
		// 		m_VFOBCParam.m_strCmd = COMM_CMD_STRING_FOBC;// 			18	FOBC
		// 		m_VFAACParam.m_strCmd = COMM_CMD_STRING_FAAC;// 			19	FAAC
		// 		m_VFGSPParam.m_strCmd = COMM_CMD_STRING_FGSP;// 			20	FGSP
		// 		m_VFCBSParam.m_strCmd = COMM_CMD_STRING_FCBS;// 			21	FCBS
		// 		m_VFMAPParam.m_strCmd = COMM_CMD_STRING_FMAP;// 			22	FMAP
		// 		m_VFXYAParam.m_strCmd = COMM_CMD_STRING_FXYA;// 			23	FXYA
		// 		m_VFRCTParam.m_strCmd = COMM_CMD_STRING_FRCT;// 			24	FRCT
		// 		m_VFISPParam.m_strCmd = COMM_CMD_STRING_FISP;// 			25	FISP
		// 		m_VFOLGParam.m_strCmd = COMM_CMD_STRING_FOLG;// 			26	FOLG
		// 		m_VFTLGParam.m_strCmd = COMM_CMD_STRING_FTLG;// 			27	FTLG


		// yamaha机器人
		m_strRobotHead = _T("@");			// 指令头
		m_strRobotTail = char(0x03);		// 指令尾
		m_strRobotSeparator = _T(" ");		// 分隔符
		m_strRobotEqual = _T("=");			// 等号
		m_strRobotQuery = _T("?");			// 问号
	}
	else	// 默认通用无协议
	{
		m_strHead = char(0x02);	// STX
		m_strTail = char(0x03); // ETX
		m_strSeparator = _T(" "); // 空格
		//lzk 0408
		m_FSPCParam.m_strCmd = COMM_CMD_STRING_FVPC;

		m_FSPCParam.m_strCmd = COMM_CMD_STRING_FSPC;// 1、 FSPC：产品切换的设定，将产品切换至指定的产品No.
		m_FSSVParam.m_strCmd = COMM_CMD_STRING_FSSV;// 2、 FSSV：指定产品No.的保存，将目前使用的产品数据保存在指定的产品No.并保存在CF 记忆卡中
		m_FGSPParam.m_strCmd = COMM_CMD_STRING_FGSP;// 3、 FGSP：产品No.的取得，取得目前正在执行的产品No.
		m_FVASParam.m_strCmd = COMM_CMD_STRING_FVAS;// 3、 FVAS：产品虚拟Mark设定.

		m_FCLBParam.m_strCmd = COMM_CMD_STRING_FCLB;// 1、FCLB:Calibration 的执行 执行Calibration
		m_FCBSParam.m_strCmd = COMM_CMD_STRING_FCBS;// 1、FCBS:Calibration 的执行 执行Calibration
		m_FCBRParam.m_strCmd = COMM_CMD_STRING_FCBR;// 1、FCBR:Calibration 的执行 执行Calibration
		m_FCPRParam.m_strCmd = COMM_CMD_STRING_FCPR;// 1、FCPR:相机轴标定
		m_FCBPParam.m_strCmd = COMM_CMD_STRING_FCBP;// 1、FCBP:自动关联

		m_FTGTParam.m_strCmd = COMM_CMD_STRING_FTGT;// 1、FTGT:目标 Mark 位置的取得，取得目标 Mark（目标）位置
		m_FTGSParam.m_strCmd = COMM_CMD_STRING_FTGS;// 1.1、FTGT:目标 Mark 位置的取得，取得目标 Mark（目标）位置
		m_FTGCParam.m_strCmd = COMM_CMD_STRING_FTGC;// 2、FTGC:目标 Mark 位置的取得（候补搜索），利用候补搜索取得目标 Mark（目标）位置
		m_FTGRParam.m_strCmd = COMM_CMD_STRING_FTGR;// 3、FTGR:目标 Mark 位置的登录，将目前使用的产品数据保存在指定的产品No.中并保存在CF 记忆卡
		m_FTGGParam.m_strCmd = COMM_CMD_STRING_FTGG;// 4、FTGG:目标 Mark 画素的取得，取得执行“ＦＴＧＴ”结果的画素
		m_FTGDParam.m_strCmd = COMM_CMD_STRING_FTGD;// 5、FTGD:目标 Mark 指示线的全画面显示，在指定目标 Mark No.的目标 Mark 位置上显示全画面的指示线及刻度
		m_FOBJParam.m_strCmd = COMM_CMD_STRING_FOBJ;// 1、FOBJ:物体 Mark 位置的取得，取得物体 Mark（对准靶标）位置
		m_FOBCParam.m_strCmd = COMM_CMD_STRING_FOBC;// 2、FOBC:物体 Mark 位置的取得（候补搜索），利用候补搜索取得物体 Mark（对准靶标）位置
		m_FOBGParam.m_strCmd = COMM_CMD_STRING_FOBG;// 3、FOBG:物体 Mark 画素的取得，取得执行“ＦＯＢＪ”结果的画素
		m_FMSCParam.m_strCmd = COMM_CMD_STRING_FMSC;// 4、FMSC:手动搜索位置的取得，在自动对准时，当目标 Mark 或物体 Mark 搜索失败时，可利用手动方法（鼠标）指定Mark 位置
		m_FWLDParam.m_strCmd = COMM_CMD_STRING_FWLD;// 5、FWLD：取得目标（目标靶标）或对象（对象靶标）的平台坐标上的位置
		m_FGOWParam.m_strCmd = COMM_CMD_STRING_FGOW;// 6、FGOW:拍照取得对象（对象靶标）的平台坐标上的位置

		m_FGAPParam.m_strCmd = COMM_CMD_STRING_FGAP;
		m_FGTCParam.m_strCmd = COMM_CMD_STRING_FGTC;

		m_FCNTParam.m_strCmd = COMM_CMD_STRING_FCNT;
		m_FCNOParam.m_strCmd = COMM_CMD_STRING_FCNO;

		m_FGALParam.m_strCmd = COMM_CMD_STRING_FGAL;// 1、FGAL:对准精度判定设定的取得，取得对准精度的判定设定
		m_FALLParam.m_strCmd = COMM_CMD_STRING_FALL;// 2、FALL:对准精度判定的更新，更新对准时的对准精度的判定
		m_FGACParam.m_strCmd = COMM_CMD_STRING_FGAC;// 3、FGAC:对准最多次数的取得，取得设定对准最多次数
		m_FALCParam.m_strCmd = COMM_CMD_STRING_FALC;// 4、FALC:对准最多次数的更新，执行自动对准时，容许最多对准次数的更新
		m_FAALParam.m_strCmd = COMM_CMD_STRING_FAAL;// 5、FAAL:自动对准的执行，执行自动对准（连续对准）
		m_FXYAParam.m_strCmd = COMM_CMD_STRING_FXYA;// 5、FXYA:自动对准的执行，执行自动对准（连续对准）
		m_FAABParam.m_strCmd = COMM_CMD_STRING_FAAB;// 5、FAAB:自动对准的执行，执行自动对准（连续对准），增加内部图像十字中心基准对位过程
		m_FACBParam.m_strCmd = COMM_CMD_STRING_FACB;// 5、FACB:自动对准的执行，执行自动对准（连续对准），对象候补搜索，增加内部图像十字中心基准对位过程
		m_FAACParam.m_strCmd = COMM_CMD_STRING_FAAC;// 5、FAAC:自动对准的执行，执行自动对准（连续对准），对象候补搜索
		m_FAHLParam.m_strCmd = COMM_CMD_STRING_FAHL;// 5、FAHL:背光叠片机自动对准的执行，执行自动对准（连续对准）
		m_FANSParam.m_strCmd = COMM_CMD_STRING_FANS;// 6、FANS:对准后的偏移量的取得，取得对准后平台坐标系的偏移量
		m_FALGParam.m_strCmd = COMM_CMD_STRING_FALG;// 7、FALG:１次对准移动量的取得，取得１次对准移动量
		m_FALPParam.m_strCmd = COMM_CMD_STRING_FALP;// 7、FALP:１次对准拾取移动量的取得，取得１次对准拾取移动量
		m_FALJParam.m_strCmd = COMM_CMD_STRING_FALJ;// 8、FALJ:1:次对准精度判定与对准移动量的取得，对准移动量是否在对准精度内的判定与对准移动量的取得
		m_FACOParam.m_strCmd = COMM_CMD_STRING_FACO;// 9、FACO:偏移量的取得，取得目标 Mark 及物体 Mark 之间中心的平台坐标系偏移量
		m_FAAOParam.m_strCmd = COMM_CMD_STRING_FAAO;
		m_FOLCParam.m_strCmd = COMM_CMD_STRING_FOLC;// 9、FOLC:偏移量的取得，取得目标 Mark 及物体 Mark 之间中心的平台坐标系偏移量
		m_FABOParam.m_strCmd = COMM_CMD_STRING_FABO;// 9、FABO:偏移量的取得，取得目标 Mark 及物体 Mark 之间中心的平台坐标系偏移量
		m_FAOFParam.m_strCmd = COMM_CMD_STRING_FAOF;// 1、FAOF:自动补偿量值的取得，对准偏移量以补偿量值取得
		m_FGOFParam.m_strCmd = COMM_CMD_STRING_FGOF;// 2、FGOF:补偿量值的取得，取得设定的补偿量值
		m_FOFSParam.m_strCmd = COMM_CMD_STRING_FOFS;// 3、FOFS:补偿量值的设定，设定补偿量值
		m_FSFTParam.m_strCmd = COMM_CMD_STRING_FSFT;// 4、FSFT:平台Shift 移动动作，选择内部转移量的设定值，并依照设定值将目前平台的位置做相对移动
		m_FGSFParam.m_strCmd = COMM_CMD_STRING_FGSF;// 5、FGSF:对准Shift 移动量的取得，取得对准转移量
		m_FGPOParam.m_strCmd = COMM_CMD_STRING_FGPO;// 8、FGPO:获取连续对位最终精度
		m_FALMParam.m_strCmd = COMM_CMD_STRING_FALM;// 1、FALM:Alarm资料的取得，取得错误发生的数据代码
		m_FRSTParam.m_strCmd = COMM_CMD_STRING_FRST;// 2、FRST:重新设定（清除错误等），清除各种错误及显示重新设定
		m_FSACParam.m_strCmd = COMM_CMD_STRING_FSAC;// 3、FSAC：保存校正、定位时的数据。所保存的数据为最近500次操作时的数据（不到500次时保存实际次数的数据）
		m_FSCOParam.m_strCmd = COMM_CMD_STRING_FSCO;// 4、FSCO：保存指令收发的历史纪录。所保存的数据为最近500次操作时的数据（不到500次时保存实际次数的数据）
		m_FAOTParam.m_strCmd = COMM_CMD_STRING_FAOT;// 5、FAOT:自动对准的执行，执行自动对准（连续对准），对象候补搜索,目标候补搜索
		m_FALXParam.m_strCmd = COMM_CMD_STRING_FALX;// 5、FALX:自动对准的执行，执行自动对准（连续对准），对象候补搜索
		m_FWDRParam.m_strCmd = COMM_CMD_STRING_FWDR;// 5.1、FWDR:获取Mark的平台坐标系半径（相对于旋转中心的距离）
		m_FCHBParam.m_strCmd = COMM_CMD_STRING_FCHB;
		m_FCHCParam.m_strCmd = COMM_CMD_STRING_FCHC;
		m_FDRPParam.m_strCmd = COMM_CMD_STRING_FDRP;// 7、FDRP:计算基准拾取位置自动流程


		m_MNPSParam.m_strCmd = COMM_CMD_STRING_FMPS;// 6、MNPS:平台现在位置的取得，取得平台现在位置
		m_MMVAParam.m_strCmd = COMM_CMD_STRING_FMVA;// 7、MMVA:平台~对准置移动量的设定，设定平台~对准置移动量
		m_MMVRParam.m_strCmd = COMM_CMD_STRING_FMVR;// 8、MMVR:平台相对准置移动量的设定，设定平台相对准置移动量

		m_MPSBParam.m_strCmd = COMM_CMD_STRING_FMPB;
		m_FSPEParam.m_strCmd = COMM_CMD_STRING_FSPE;
		m_FWELParam.m_strCmd = COMM_CMD_STRING_FWEL;
		m_FPCBParam.m_strCmd = COMM_CMD_STRING_FPCB;
		m_FPISParam.m_strCmd = COMM_CMD_STRING_FPIS;
		m_FCPIParam.m_strCmd = COMM_CMD_STRING_FCPI;
		m_FQRCParam.m_strCmd = COMM_CMD_STRING_FQRC;//读取二维码
		m_FQRIParam.m_strCmd = COMM_CMD_STRING_FQRI;
		m_FMCOParam.m_strCmd = COMM_CMD_STRING_FMCO;

		m_FINSParam.m_strCmd = COMM_CMD_STRING_FINS;
		//lzk
		m_FCCIParam.m_strCmd = COMM_CMD_STRING_FCCI;
		// yamaha机器人
		m_strRobotHead = _T("@");			// 指令头
		m_strRobotTail = char(0x03);		// 指令尾
		m_strRobotSeparator = _T(" ");		// 分隔符
		m_strRobotEqual = _T("=");			// 等号
		m_strRobotQuery = _T("?");			// 问号

	}
}

// 判断当前的协议类型是否为PLC链接协议，直接读取存储PLC寄存器的
BOOL CCommProtocolXYDFast::IsPlcProtocolType()
{
	if (m_eProtocolType > eProRegBase)
	{
		return TRUE;
	}

	return FALSE;
}


// 命令格式（[STX]FXXX R1 R2 R3 R4[ETX]）
BOOL CCommProtocolXYDFast::AnalyzeCommand(CString strCmd, CString& strName)
{
	strName = _T("");

	int nLength = strCmd.GetLength();
	if (nLength < 6) return FALSE;

	CString strSTX = m_strHead;
	CString strETX = m_strTail;
	CString strSpace = m_strSeparator;

	CString strHead, strTail;
	strHead = strCmd.Mid(0,1);
	strTail = strCmd.Mid(nLength-1,1);
	strName = strCmd.Mid(1,4);

	if (strHead != strSTX)
	{
		return FALSE;
	}

	if (strTail != strETX)
	{
		return FALSE;
	}

	return TRUE;
}

// 命令格式（[STX]FXXX R1 R2 R3 R4[ETX]）
BOOL CCommProtocolXYDFast::AnalyzeCommandParam(CString strCmd, CString& strName, std::vector<CString>& vstrParam)
{
	strName = _T("");
	vstrParam.clear();

	int nLength = strCmd.GetLength();
	if (nLength < 5) return FALSE;

	CString strSTX = m_strHead;
	CString strETX = m_strTail;
	CString strSpace = m_strSeparator;

	for (int i=nLength-1;i>=0;i--)
	{
		if (strCmd.GetAt(i)==strSpace)
		{
			continue;
		}
		else
		{
			strCmd = strCmd.Left(i+1);
			nLength = strCmd.GetLength();
			if (nLength < 5) return FALSE;
			break;
		}
	}

	CString strHead, strTail;
	strHead = strCmd.Mid(0,1);
	strTail = strCmd.Mid(nLength-1,1);
	strName = strCmd.Mid(1,4);

	if (strHead != strSTX)
	{
		return FALSE;
	}
	// 
	// 	if (strTail != strETX)
	// 	{
	// 		return FALSE;
	// 	}
	//
	// 对指令进行整理，将指令中不应该出现的ASCII字符替换为空格
	CString strTempCmd = _T("");
	int j = 0;
	TCHAR ch = 0;

	for (j = 0; j < nLength; j++)
	{
		ch = strCmd.GetAt(j);
		if (j < 5/* || j == nLength - 1*/)
		{
			strTempCmd = strTempCmd + CString(ch);
		}
		else
		{
			if (((ch > '9') || (ch < '0')) && (ch != '-') && (ch != '+') && (CString(ch) != strSpace) 
				&& (ch != '.') && (ch != 'e') && (ch != 'E') && (CString(ch) != strTail))	
			{
				// (ch != '.') && (ch != 'e') && (ch != 'E')
				// 对科学计数法进行支持，使用时要注意避免以下情况:
				// 1）避免指令中间出现非科学计数法的'.'、'e'或'E'；
				// 2）如果支持科学计数法，命令结束符最好不使用'.'、'e'或'E';

				strTempCmd = strTempCmd + strSpace;
			}
			else
			{
				strTempCmd = strTempCmd + CString(ch);
			}
		}
	}

	// 
	std::vector<int> vnStartIndex;
	std::vector<int> vnEndIndex;

	CString strFront;
	CString strTemp;
	CString strBack;
	int i = 0;

	if (strTail == strETX)
	{
		for (i = 5; i < /*nLength*/nLength-1; i++)
		{
			strFront = strTempCmd.GetAt(i-1);
			strTemp = strTempCmd.GetAt(i);
			strBack = strTempCmd.GetAt(i+1);

			//if (i < nLength - 1)
			//{
			//	strBack = strTempCmd.GetAt(i+1);
			//}
			//else
			//{
			//	strBack = strSpace;
			//}

			if (strFront == strSpace && strTemp != strSpace)
			{
				vnStartIndex.push_back(i);
			}

			if ((strBack == strSpace || (i == nLength-2 && strBack == strETX)) && strTemp != strSpace)
			{
				vnEndIndex.push_back(i);
			}
		}
	}
	else
	{
		for (i = 5; i < nLength; i++)
		{
			strFront = strTempCmd.GetAt(i-1);
			strTemp = strTempCmd.GetAt(i);
			if (i < nLength - 1)
			{
				strBack = strTempCmd.GetAt(i+1);
			}
			else
			{
				strBack = strSpace;
			}

			if (strFront == strSpace && strTemp != strSpace)
			{
				vnStartIndex.push_back(i);
			}

			if ((strBack == strSpace) && strTemp != strSpace)
			{
				vnEndIndex.push_back(i);
			}
		}
	}

	if (vnStartIndex.size() != vnEndIndex.size())
	{
		return FALSE;
	}

	for (i = 0; i < vnStartIndex.size(); i++)
	{
		vstrParam.push_back(strTempCmd.Mid(vnStartIndex.at(i), vnEndIndex.at(i) - vnStartIndex.at(i) + 1));
	}

	return TRUE;
}

// 命令格式（[STX]FXXX R1 R2 R3 R4[ETX]）
// BOOL CCommProtocolXYDFast::AnalyzeCommandParam(CString strCmd, CString& strName, std::vector<CString>& vstrParam)
// {
// 	strName = _T("");
// 	vstrParam.clear();
// 
// 	int nLength = strCmd.GetLength();
// 	if (nLength < 6) return FALSE;
// 
// 	CString strSTX = m_strHead;
// 	CString strETX = m_strTail;
// 	CString strSpace = m_strSeparator;
// 
// 	CString strHead, strTail;
// 	strHead = strCmd.Mid(0,1);
// 	strTail = strCmd.Mid(nLength-1,1);
// 	strName = strCmd.Mid(1,4);
// 
// 	if (strHead != strSTX)
// 	{
// 		return FALSE;
// 	}
// 
// 	if (strTail != strETX)
// 	{
// 		return FALSE;
// 	}
// 
// 	// 对指令进行整理，将指令中不应该出现的ASCII字符替换为空格
// 	CString strTempCmd = _T("");
// 	int j = 0;
// 	TCHAR ch = 0;
// 
// 	for (j = 0; j < nLength; j++)
// 	{
// 		ch = strCmd.GetAt(j);
// 		if (j < 5 || j == nLength - 1)
// 		{
// 			strTempCmd = strTempCmd + CString(ch);
// 		}
// 		else
// 		{
// 			if (((ch > '9') || (ch < '0')) && (ch != '-') && (ch != '+') && (CString(ch) != strSpace))
// 			{
// 				strTempCmd = strTempCmd + strSpace;
// 			}
// 			else
// 			{
// 				strTempCmd = strTempCmd + CString(ch);
// 			}
// 		}
// 	}
// 
// 	// 
// 	std::vector<int> vnStartIndex;
// 	std::vector<int> vnEndIndex;
// 
// 	CString strFront;
// 	CString strTemp;
// 	CString strBack;
// 	int i = 0;
// 	for (i = 5; i < nLength-1; i++)
// 	{
// 		strFront = strTempCmd.GetAt(i-1);
// 		strTemp = strTempCmd.GetAt(i);
// 		strBack = strTempCmd.GetAt(i+1);
// 		if (strFront == strSpace && strTemp != strSpace)
// 		{
// 			vnStartIndex.push_back(i);
// 		}
// 
// 		if ((strBack == strSpace || strBack == strETX) && strTemp != strSpace)
// 		{
// 			vnEndIndex.push_back(i);
// 		}
// 	}
// 
// 
// 	if (vnStartIndex.size() != vnEndIndex.size())
// 	{
// 		return FALSE;
// 	}
// 
// 	for (i = 0; i < vnStartIndex.size(); i++)
// 	{
// 		vstrParam.push_back(strTempCmd.Mid(vnStartIndex.at(i), vnEndIndex.at(i) - vnStartIndex.at(i) + 1));
// 	}
// 
// 	return TRUE;
// }


// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FACO R1 P2 P3 P4[ETX]）
BOOL CCommProtocolXYDFast::PackReAlignResultInfoFACO( CString& strInfo, CCoordPos platOffset,BOOL bResult, CPlatformAxisPos* vpPlatAxisPos)
{

	CString strHead = m_strHead;
	CString strName= m_FACOParam.m_strCmd;
	CString strParam[4];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	if (/*bResult == FALSE|| */pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
		}
		else
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
		}

	}
	else
	{
		switch(m_eMidPlatformType)
		{
		case ePlatformXYD:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = platOffset.m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffset.m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffset.m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				}
				else
				{
					double dParam = 0;
					dParam = platOffset.m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffset.m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffset.m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				}
			}
			break;

			// 		case ePlatformXYPD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformX:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXDPY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXDPY1:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformYD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;

		case ePlatformXY1Y2:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dToStartX1 = 0.0;
					double dToStartY1 = 0.0;
					double dToStartY2 = 0.0;

					double dToEndX1 = 0.0;
					double dToEndY1 = 0.0;
					double dToEndY2 = 0.0;

					double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
					double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
					double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

					double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
					double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
					double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

					CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
						dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
						dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


					double dParam = 0;
					dParam = dToEndX1 - dToStartX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dToEndY1 - dToStartY1;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = dToEndY2 - dToStartY2;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;

		case ePlatformX1X2Y:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dToStartX1 = 0.0;
					double dToStartX2 = 0.0;
					double dToStartY1 = 0.0;

					double dToEndX1 = 0.0;
					double dToEndX2 = 0.0;
					double dToEndY1 = 0.0;

					double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
					double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
					double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

					double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
					double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
					double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

					CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
						dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
						dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

					//dX1 = dX1 + 5.5;
					//dX2 = dX2 + 5.5;
					//dY1 = dY1 + 5.5;

					double dParam = 0;
					dParam = dToEndX1 - dToStartX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dToEndX2 - dToStartX2;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dToEndY1 - dToStartY1;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;

		default:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = platOffset.m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffset.m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffset.m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				}
				else
				{
					double dParam = 0;
					dParam = platOffset.m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffset.m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffset.m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				}
			}
		}
	}

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;

	return TRUE;
}


BOOL CCommProtocolXYDFast::PackReAlignResultInfoFAAO(CString& strInfo, CCoordPos platOffset,BOOL bResult, CPlatformAxisPos* vpPlatAxisPos)
{
	CString strHead = m_strHead;
	CString strName= m_FAAOParam.m_strCmd;
	CString strParam[4];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	if (/*bResult == FALSE|| */pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
		}
		else
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
		}

	}
	else
	{
		switch(m_eMidPlatformType)
		{
		case ePlatformXYD:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = platOffset.m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffset.m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffset.m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				}
				else
				{
					double dParam = 0;
					dParam = platOffset.m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffset.m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffset.m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				}
			}
			break;

			// 		case ePlatformXYPD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformX:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXDPY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXDPY1:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformYD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;

		case ePlatformXY1Y2:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dToStartX1 = 0.0;
					double dToStartY1 = 0.0;
					double dToStartY2 = 0.0;

					double dToEndX1 = 0.0;
					double dToEndY1 = 0.0;
					double dToEndY2 = 0.0;

					double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
					double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
					double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

					double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
					double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
					double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

					CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
						dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
						dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


					double dParam = 0;
					dParam = dToEndX1 - dToStartX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dToEndY1 - dToStartY1;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = dToEndY2 - dToStartY2;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;

		case ePlatformX1X2Y:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dToStartX1 = 0.0;
					double dToStartX2 = 0.0;
					double dToStartY1 = 0.0;

					double dToEndX1 = 0.0;
					double dToEndX2 = 0.0;
					double dToEndY1 = 0.0;

					double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
					double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
					double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

					double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
					double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
					double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

					CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
						dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
						dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

					double dParam = 0;
					dParam = dToEndX1 - dToStartX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dToEndX2 - dToStartX2;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dToEndY1 - dToStartY1;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;

		default:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = platOffset.m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffset.m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffset.m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				}
				else
				{
					double dParam = 0;
					dParam = platOffset.m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffset.m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffset.m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				}
			}
		}
	}

	//构造写命令
	strInfo.Empty(); 

	if(bResult)
		strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;
	else
		strInfo = strHead + strName + strBlank + strParam[0]+ strTail;

	return TRUE;
}


// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FABO R1 P2 P3 P4[ETX]）
BOOL CCommProtocolXYDFast::PackReAlignResultInfoFABO( CString& strInfo, CCoordPos platOffset,BOOL bResult, CPlatformAxisPos* vpPlatAxisPos)
{
	CString strHead = m_strHead;
	CString strName= m_FABOParam.m_strCmd;
	CString strParam[4];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	if (bResult == FALSE || pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL)
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}
		else
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}

	}
	else
	{
		switch(m_eMidPlatformType)
		{
		case ePlatformXYD:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = platOffset.m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffset.m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffset.m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					double dParam = 0;
					dParam = platOffset.m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffset.m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffset.m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
			}
			break;

			// 		case ePlatformXYPD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformX:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXDPY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXDPY1:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformYD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

		case ePlatformXY1Y2:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dToStartX1 = 0.0;
					double dToStartY1 = 0.0;
					double dToStartY2 = 0.0;

					double dToEndX1 = 0.0;
					double dToEndY1 = 0.0;
					double dToEndY2 = 0.0;

					double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
					double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
					double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

					double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
					double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
					double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

					CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
						dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
						dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


					double dParam = 0;
					dParam = dToEndX1 - dToStartX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dToEndY1 - dToStartY1;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = dToEndY2 - dToStartY2;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;

		case ePlatformX1X2Y:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dToStartX1 = 0.0;
					double dToStartX2 = 0.0;
					double dToStartY1 = 0.0;

					double dToEndX1 = 0.0;
					double dToEndX2 = 0.0;
					double dToEndY1 = 0.0;

					double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
					double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
					double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

					double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
					double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
					double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

					CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
						dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
						dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

					//dX1 = dX1 + 5.5;
					//dX2 = dX2 + 5.5;
					//dY1 = dY1 + 5.5;

					double dParam = 0;
					dParam = dToEndX1 - dToStartX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dToEndX2 - dToStartX2;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dToEndY1 - dToStartY1;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;

		default:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = platOffset.m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffset.m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffset.m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					double dParam = 0;
					dParam = platOffset.m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffset.m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffset.m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
			}
		}
	}

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;

	return TRUE;

}


// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FAAL R1[ETX]）
BOOL CCommProtocolXYDFast::PackReAlignResultInfoFAAL( CString& strInfo, BOOL bResult, BOOL bAlignBench, CCoordPos platOffset, BOOL bSendTargetOffset, CPlatformAxisPos* pTargetOffsetPlatformAxisPos)
{

	CString strHead = m_strHead;
	CString strName= m_FAALParam.m_strCmd;
	CString strParam[6];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(pTargetOffsetPlatformAxisPos);

	BOOL bIsSendValid = bSendTargetOffset && (NULL !=pPlatformXYDAixisPos);

	if (bAlignBench && !bIsSendValid) // 如果连续迭代对位过程中，需要进行对象的基准对位，指令回复中包括平台轴的相对移动量
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
		}
		else
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
		}

		//构造写命令
		strInfo.Empty();
		strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;

	}
	else if (bAlignBench && bIsSendValid)
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[6], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
		}
		else
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosX;

			PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[6], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
		}

		//构造写命令
		strInfo.Empty();
		strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strBlank + strParam[4] + strBlank + strParam[5] + strTail;

	}
	else if (!bAlignBench && bIsSendValid)
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
		}
		else
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
		}

		//构造写命令
		strInfo.Empty();
		strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;
	}
	else
	{
		//构造写命令
		strInfo.Empty();
		strInfo = strHead + strName + strBlank + strParam[0] + strTail;
	}



	return TRUE;
	// 
	// 	CString strHead = m_strHead;
	// 	CString strCmd = "FAAL";
	// 	CString strTail = m_strTail;
	// 	CString strCR   = char(0x0D);
	// 	CString strBlank= m_strSeparator;
	// 	CString strRes;
	// 	if (bResult)
	// 	{
	// 		strRes="+0";
	// 	}
	// 	else
	// 	{
	// 		strRes="-1";
	// 	}
	// 
	// 
	// 	strData = strHead + strCmd+ strBlank + strRes + strTail;//+ strCR;
	// 
	// 	return TRUE;
}


// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FAAB R1 R2 R3 R4[ETX]）
BOOL CCommProtocolXYDFast::PackReAlignResultInfoFAAB( CString& strInfo, BOOL bResult, BOOL bAlignBench, CCoordPos platOffset, CPlatformAxisPos* vpPlatAxisPos)
{

	CString strHead = m_strHead;
	CString strName= m_FAABParam.m_strCmd;
	CString strParam[4];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);


	if (bAlignBench) // 如果连续迭代对位过程中，需要进行对象的基准对位，指令回复中包括平台轴的相对移动量
	{
		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bResult == FALSE || pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL)
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

					}
				}
			}
		}

		//构造写命令
		strInfo.Empty();
		strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;

	}
	else
	{
		//构造写命令
		strInfo.Empty();
		strInfo = strHead + strName + strBlank + strParam[0] + strTail;
	}

	return TRUE;

}

// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FACB R1 R2 R3 R4[ETX]）
BOOL CCommProtocolXYDFast::PackReAlignResultInfoFACB( CString& strInfo, BOOL bResult, BOOL bAlignBench, CCoordPos platOffset, CPlatformAxisPos* vpPlatAxisPos)
{

	CString strHead = m_strHead;
	CString strName= m_FACBParam.m_strCmd;
	CString strParam[4];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);


	if (bAlignBench) // 如果连续迭代对位过程中，需要进行对象的基准对位，指令回复中包括平台轴的相对移动量
	{
		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bResult == FALSE || pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL)
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

					}
				}
			}
		}

		//构造写命令
		strInfo.Empty();
		strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;

	}
	else
	{
		//构造写命令
		strInfo.Empty();
		strInfo = strHead + strName + strBlank + strParam[0] + strTail;
	}

	return TRUE;

}


// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FAAC R1[ETX]）
BOOL CCommProtocolXYDFast::PackReAlignResultInfoFAAC( CString& strInfo, BOOL bResult, BOOL bAlignBench, CCoordPos platOffset, BOOL bSendTargetOffset, CPlatformAxisPos* pTargetOffsetPlatformAxisPos)
{

	CString strHead = m_strHead;
	CString strName= m_FAACParam.m_strCmd;
	CString strParam[6];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 1;//by CR
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(pTargetOffsetPlatformAxisPos);

	BOOL bIsSendValid = bSendTargetOffset && (NULL !=pPlatformXYDAixisPos);

	if (bAlignBench && !bIsSendValid) // 如果连续迭代对位过程中，需要进行对象的基准对位，指令回复中包括平台轴的相对移动量
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}
		else
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}

		//构造写命令
		strInfo.Empty();
		strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;

	}
	else if (bAlignBench && bIsSendValid)
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[6], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
		}
		else
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosX;

			PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[6], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
		}

		//构造写命令
		strInfo.Empty();
		strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strBlank + strParam[4] + strBlank + strParam[5] + strTail;

	}
	else if (!bAlignBench && bIsSendValid)
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
		}
		else
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
		}

		//构造写命令
		strInfo.Empty();
		strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;
	}
	else
	{
		//构造写命令
		strInfo.Empty();
		strInfo = strHead + strName + strBlank + strParam[0] + strTail;
	}


	return TRUE;
	// 
	// 	CString strHead = m_strHead;
	// 	CString strCmd = "FAAL";
	// 	CString strTail = m_strTail;
	// 	CString strCR   = char(0x0D);
	// 	CString strBlank= m_strSeparator;
	// 	CString strRes;
	// 	if (bResult)
	// 	{
	// 		strRes="+0";
	// 	}
	// 	else
	// 	{
	// 		strRes="-1";
	// 	}
	// 
	// 
	// 	strData = strHead + strCmd+ strBlank + strRes + strTail;//+ strCR;
	// 
	// 	return TRUE;
}

BOOL CCommProtocolXYDFast::PackReAlignResultInfoFQRC( CString& strInfo, BOOL bResult)
{

	CString strHead = m_strHead;
	CString strName= m_FQRCParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;//by CR
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);


	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;

}


// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FAOT R1 R2 R3 R4[ETX]）
BOOL CCommProtocolXYDFast::PackReAlignResultInfoFAOT( CString& strInfo, BOOL bResult, BOOL bAlignBench, CCoordPos platOffset)
{

	CString strHead = m_strHead;
	CString strName= m_FAOTParam.m_strCmd;
	CString strParam[4];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 1;//by CR
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);


	if (bAlignBench) // 如果连续迭代对位过程中，需要进行对象的基准对位，指令回复中包括平台轴的相对移动量
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}
		else
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}

		//构造写命令
		strInfo.Empty();
		strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;

	}
	else
	{
		//构造写命令
		strInfo.Empty();
		strInfo = strHead + strName + strBlank + strParam[0] + strTail;
	}


	return TRUE;

}



// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FALX R1 R2 R3 R4[ETX]）
BOOL CCommProtocolXYDFast::PackReAlignResultInfoFALX( CString& strInfo, BOOL bResult, BOOL bAlignBench, CCoordPos platOffset)
{

	CString strHead = m_strHead;
	CString strName= m_FALXParam.m_strCmd;
	CString strParam[4];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 1;//by CR
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);


	if (bAlignBench) // 如果连续迭代对位过程中，需要进行对象的基准对位，指令回复中包括平台轴的相对移动量
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}
		else
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}

		//构造写命令
		strInfo.Empty();
		strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;

	}
	else
	{
		//构造写命令
		strInfo.Empty();
		strInfo = strHead + strName + strBlank + strParam[0] + strTail;
	}


	return TRUE;

}

// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FAHL R1[ETX]）
BOOL CCommProtocolXYDFast::PackReAlignResultInfoFAHL( CString& strInfo, BOOL bResult, BOOL bAlignBench, CCoordPos platOffset)
{

	CString strHead = m_strHead;
	CString strName= m_FAHLParam.m_strCmd;
	CString strParam[4];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);


	if (bAlignBench) // 如果连续迭代对位过程中，需要进行对象的基准对位，指令回复中包括平台轴的相对移动量
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
		}
		else
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
		}

		//构造写命令
		strInfo.Empty();
		strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;

	}
	else
	{
		//构造写命令
		strInfo.Empty();
		strInfo = strHead + strName + strBlank + strParam[0] + strTail;
	}



	return TRUE;
	// 
	// 	CString strHead = m_strHead;
	// 	CString strCmd = "FAAL";
	// 	CString strTail = m_strTail;
	// 	CString strCR   = char(0x0D);
	// 	CString strBlank= m_strSeparator;
	// 	CString strRes;
	// 	if (bResult)
	// 	{
	// 		strRes="+0";
	// 	}
	// 	else
	// 	{
	// 		strRes="-1";
	// 	}
	// 
	// 
	// 	strData = strHead + strCmd+ strBlank + strRes + strTail;//+ strCR;
	// 
	// 	return TRUE;
}



// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FRST[ETX]）
BOOL CCommProtocolXYDFast::PackReResetFRST( CString& strData, BOOL bResult)
{
	CString strHead = m_strHead;
	CString strName= m_FRSTParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	//构造写命令
	strData.Empty();
	strData = strHead + strName + strTail;

	return TRUE;
	// 
	// 	CString strHead = m_strHead;
	// 	CString strCmd = "FRST";
	// 	CString strTail = m_strTail;
	// 	CString strCR   = char(0x0D);
	// 	CString strBlank= m_strSeparator;
	// 	CString strRes;
	// 	if (bResult)
	// 	{
	// 		strRes="+0";
	// 	}
	// 	else
	// 	{
	// 		strRes="-1";
	// 	}
	// 
	// 
	// 	strData = strHead + strCmd+  strTail;//+ strCR;
	// 
	// 	return TRUE;
}
// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FCHK CY[ETX]）
BOOL CCommProtocolXYDFast::PackReCommFCHK( CString& strData, BOOL bResult)
{
	CString strHead = m_strHead;
	CString strName= m_FCHKParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);
	CString strP1 = "CY";

	m_strCmdName = strName;

	//构造写命令
	strData.Empty();
	strData = strHead + strName + strBlank + strP1 + strTail;

	return TRUE;

}

// 打包对象搜索结果
BOOL CCommProtocolXYDFast::PackReACFInspectFCHB(CString& strInfo,BOOL bResult, int nSuccessPatIndex /* = 0 */)
{
	CString strHead = m_strHead;
	CString strName= m_FCHBParam.m_strCmd;
	CString strParam[14];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam0 = 0;
	int nParam1 = 0;
	if (bResult)
	{	
		nParam0 = 0;
		nParam1 = nSuccessPatIndex;
	}
	else
	{
		nParam0 = -1;
		nParam1 = -1;
	}
	PackParam(strParam[0], nParam0, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
	PackParam(strParam[1], nParam1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	if (m_bEnablePackInspectDistance)
	{

		int nAdressIndex=-1;
		double dParam = 0;
		int nParam=0;
		for (int i =0;i<m_vstL2LDistanceResult.size();i++)
		{
			if (m_vstL2LDistanceResult.at(i).m_bPosSearchFinished)
			{
				nAdressIndex+=1;
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[0];
				PackParam(strParam[2+nAdressIndex*3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[1];
				PackParam(strParam[2+nAdressIndex*3+1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);

				BOOL bOK = TRUE;
				for(int j=0;j<2;j++)
				{
					if (m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_nResult[j]!=1)
					{
						bOK=bOK&&FALSE;
					}
				}
				nParam = bOK? 0 : -1;
				PackParam(strParam[2+nAdressIndex*3+2], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
			}

		}
		strInfo = strHead + strName + strBlank + strParam[0]+ strBlank + strParam[1];
		for (int i=0;i<=nAdressIndex;i++)
		{
			strInfo=strInfo+strBlank+strParam[2+3*i]+strBlank+strParam[2+3*i+1]+strBlank+strParam[2+3*i+2];
		}
		strInfo=strInfo+strTail;
		return TRUE;
	}
	strInfo = strHead + strName + strBlank + strParam[0] +strBlank + strParam[1]+ strTail;

	return TRUE;



}


// 打包对象搜索结果
BOOL CCommProtocolXYDFast::PackReACFInspectFCHBD(CString& strInfo,BOOL bResult, int nSuccessPatIndex, std::vector<double> vdDistance)
{
	CString strHead = m_strHead;
	CString strName= m_FCHBParam.m_strCmd;
	CString strParam[2];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam0 = 0;
	int nParam1 = 0;
	if (bResult)
	{	
		nParam0 = 0;
		nParam1 = nSuccessPatIndex;
	}
	else
	{
		nParam0 = -1;
		nParam1 = -1;
	}
	PackParam(strParam[0], nParam0, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
	PackParam(strParam[1], nParam1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] +strBlank + strParam[1]+ strTail;


	if (vdDistance.size()>0)
	{
		CString strTemp;
		CString stOut;
		for (int i=0; i<vdDistance.size(); i++)
		{
			stOut += strBlank;
			PackParam(strTemp, vdDistance.at(i), m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			stOut += strTemp;
		}

		strInfo = strHead + strName + strBlank + strParam[0] +strBlank + strParam[1]+ stOut + strTail;
	}

	return TRUE;
}

// 打包候补检测结果
BOOL CCommProtocolXYDFast::PackReACFInspectFCHC(CString& strInfo,BOOL bResult, int nSuccessPatIndex /* = 0 */)
{
	CString strHead = m_strHead;
	CString strName= m_FCHCParam.m_strCmd;
	CString strParam[2];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam0 = 0;
	int nParam1 = 0;
	if (bResult)
	{	
		nParam0 = 0;
		nParam1 = nSuccessPatIndex;
	}
	else
	{
		nParam0 = -1;
		nParam1 = -1;
	}
	PackParam(strParam[0], nParam0, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
	PackParam(strParam[1], nParam1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] +strBlank + strParam[1]+ strTail;

	return TRUE;



}


// 打包计算基准拾取位置结果
BOOL CCommProtocolXYDFast::PackReFDRP(CString& strInfo,BOOL bResult)
{
	CString strHead = m_strHead;
	CString strName= m_FDRPParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam0 = 0;
	if (bResult)
	{	
		nParam0 = 0;
	}
	else
	{
		nParam0 = -1;
	}
	PackParam(strParam[0], nParam0, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;

}

BOOL CCommProtocolXYDFast::PackReClearProductFPEP(CString& strInfo,BOOL bResult)
{
	CString strHead = m_strHead;
	CString strName= m_FPEPParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam0 = 0;
	if (bResult)
	{	
		nParam0 = 0;
	}
	else
	{
		nParam0 = -1;
	}
	PackParam(strParam[0], nParam0, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackReProductCopyFPCP(CString& strInfo,BOOL bResult)
{
	CString strHead = m_strHead;
	CString strName= m_FPCPParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam0 = 0;
	if (bResult)
	{	
		nParam0 = 0;
	}
	else
	{
		nParam0 = -1;
	}
	PackParam(strParam[0], nParam0, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackReProductRenameFPRN(CString& strInfo,BOOL bResult)
{
	CString strHead = m_strHead;
	CString strName= m_FPRNParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam0 = 0;
	if (bResult)
	{	
		nParam0 = 0;
	}
	else
	{
		nParam0 = -1;
	}
	PackParam(strParam[0], nParam0, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;
}


// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FALG R1 P2 P3 P4[ETX]）
BOOL CCommProtocolXYDFast::PackReAlignResultInfoFALG( CString& strInfo,CPlatformAxisPos* vpPlatAxisPos,BOOL bResult)
{
	if (NULL == vpPlatAxisPos)
	{
		return FALSE;
	}

	if (vpPlatAxisPos->GetPlatformType()!=ePlatformXYD)
	{
		return FALSE;
	}

	CString strHead = m_strHead;
	CString strName= m_FALGParam.m_strCmd;
	CString strParam[4];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	if (m_pMidPlatformInfo == NULL)
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}
		else
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}

	}
	else
	{
		switch(m_eMidPlatformType)
		{
		case ePlatformXYD:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
			}
			break;

			// 		case ePlatformXYPD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformX:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXDPY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXDPY1:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformYD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

		case ePlatformXY1Y2:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dY1 = 0.0;
					double dY2 = 0.0;

					double dX0 = pPlatformXYDAixisPos->m_dPosX;
					double dY0 = pPlatformXYDAixisPos->m_dPosY;
					double dD0 = pPlatformXYDAixisPos->m_dAngle;
					CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(dX0, dY0, dD0, dY1, dY2, dX1);


					double dParam = 0;
					dParam = dX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dY1;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = dY2;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;

		case ePlatformX1X2Y:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dX2 = 0.0;
					double dY1 = 0.0;

					double dX0 = pPlatformXYDAixisPos->m_dPosX;
					double dY0 = pPlatformXYDAixisPos->m_dPosY;
					double dD0 = pPlatformXYDAixisPos->m_dAngle;
					CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(dX0, dY0, dD0, dX1, dX2, dY1);

					//dX1 = dX1 + 5.5;
					//dX2 = dX2 + 5.5;
					//dY1 = dY1 + 5.5;

					double dParam = 0;
					dParam = dX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dX2;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dY1;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;

		default:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
			}
		}
	}

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;

	return TRUE;

}


// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FALP R1 P2 P3 P4[ETX]）
// BOOL CCommProtocolXYDFast::PackReMulAlignPosInfoFALP(CString& strInfo,std::vector<CPlatformXYDAxisPos> vPlatformXYDAxisPos,BOOL bResult)
// {
// 	if (0 == vPlatformXYDAxisPos.size())
// 	{
// 		return FALSE;
// 	}
// 
// 	std::vector<int> vnWriteData;
// 
// 	CString strHead = m_strHead;
// 	CString strName= m_FALPParam.m_strCmd;
// 	CString strParam[4];
// 	CString strBlank = m_strSeparator;
// 	CString strTail = m_strTail;	
// 	CString strCR = char(0x0D);
// 
// 	m_strCmdName = strName;
// 
// 	int nParam = 0;
// 	if (bResult)
// 	{	
// 		nParam = 0;
// 	}
// 	else
// 	{
// 		nParam = -1;
// 	}
// 	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
// 
// 	int nTempNum = vPlatformXYDAxisPos.size();
// 	std::vector<CString> vsWriteData[3];
// 	vsWriteData[0].resize(nTempNum);
// 	vsWriteData[1].resize(nTempNum);
// 	vsWriteData[2].resize(nTempNum);
// 
// 	CPlatformXYDAxisPos pPlatformXYDAixisPos; 		
// 
// 	for (int i = 0; i < nTempNum; i++)
// 	{
// 		pPlatformXYDAixisPos = (CPlatformXYDAxisPos)(vPlatformXYDAxisPos.at(i));	
// 
// 
// 		if (m_pMidPlatformInfo == NULL)
// 		{
// 			if (eCPOrderYXD == m_eCmdParamOrderType)
// 			{
// 				double dParam = 0;
// 				dParam = pPlatformXYDAixisPos.m_dPosX;
// 				PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
// 				dParam = pPlatformXYDAixisPos.m_dPosY;
// 				PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
// 				dParam = pPlatformXYDAixisPos.m_dAngle;
// 				PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 				vsWriteData[1].at(i) = strParam[2];
// 				vsWriteData[0].at(i) = strParam[1];
// 				vsWriteData[2].at(i) = strParam[3];
// 
// 			}
// 			else
// 			{
// 				double dParam = 0;
// 				dParam = pPlatformXYDAixisPos.m_dPosX;
// 				PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
// 				dParam = pPlatformXYDAixisPos.m_dPosY;
// 				PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
// 				dParam = pPlatformXYDAixisPos.m_dAngle;
// 				PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 				vsWriteData[0].at(i) = strParam[1];
// 				vsWriteData[1].at(i) = strParam[2];
// 				vsWriteData[2].at(i) = strParam[3];
// 
// 			}
// 
// 		}
// 		else
// 		{
// 			switch(m_eMidPlatformType)
// 			{
// 			case ePlatformXYD:
// 				{
// 					if (eCPOrderYXD == m_eCmdParamOrderType)
// 					{
// 						double dParam = 0;
// 						dParam = pPlatformXYDAixisPos.m_dPosX;
// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
// 						dParam = pPlatformXYDAixisPos.m_dPosY;
// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
// 						dParam = pPlatformXYDAixisPos.m_dAngle;
// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						vsWriteData[1].at(i) = strParam[2];
// 						vsWriteData[0].at(i) = strParam[1];
// 						vsWriteData[2].at(i) = strParam[3];
// 
// 					}
// 					else
// 					{
// 						double dParam = 0;
// 						dParam = pPlatformXYDAixisPos.m_dPosX;
// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
// 						dParam = pPlatformXYDAixisPos.m_dPosY;
// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
// 						dParam = pPlatformXYDAixisPos.m_dAngle;
// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						vsWriteData[0].at(i) = strParam[1];
// 						vsWriteData[1].at(i) = strParam[2];
// 						vsWriteData[2].at(i) = strParam[3];
// 
// 					}
// 				}
// 				break;
// 
// 			case ePlatformXD:
// 				{
// 					if (eCPOrderYXD == m_eCmdParamOrderType)
// 					{
// 						double dParam = 0;
// 						dParam = pPlatformXYDAixisPos.m_dPosX;
// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
// 						dParam = pPlatformXYDAixisPos.m_dPosY;
// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
// 						dParam = pPlatformXYDAixisPos.m_dAngle;
// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						vsWriteData[1].at(i) = strParam[2];
// 						vsWriteData[0].at(i) = strParam[1];
// 						vsWriteData[2].at(i) = strParam[3];
// 
// 					}
// 					else
// 					{
// 						double dParam = 0;
// 						dParam = pPlatformXYDAixisPos.m_dPosX;
// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
// 						dParam = pPlatformXYDAixisPos.m_dPosY;
// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
// 						dParam = pPlatformXYDAixisPos.m_dAngle;
// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						vsWriteData[0].at(i) = strParam[1];
// 						vsWriteData[1].at(i) = strParam[2];
// 						vsWriteData[2].at(i) = strParam[3];
// 
// 					}
// 				}
// 				break;
// 
// 			case ePlatformYD:
// 				{
// 					if (eCPOrderYXD == m_eCmdParamOrderType)
// 					{
// 						double dParam = 0;
// 						dParam = pPlatformXYDAixisPos.m_dPosX;
// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
// 						dParam = pPlatformXYDAixisPos.m_dPosY;
// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
// 						dParam = pPlatformXYDAixisPos.m_dAngle;
// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						vsWriteData[1].at(i) = strParam[2];
// 						vsWriteData[0].at(i) = strParam[1];
// 						vsWriteData[2].at(i) = strParam[3];
// 
// 					}
// 					else
// 					{
// 						double dParam = 0;
// 						dParam = pPlatformXYDAixisPos.m_dPosX;
// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
// 						dParam = pPlatformXYDAixisPos.m_dPosY;
// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
// 						dParam = pPlatformXYDAixisPos.m_dAngle;
// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						vsWriteData[0].at(i) = strParam[1];
// 						vsWriteData[1].at(i) = strParam[2];
// 						vsWriteData[2].at(i) = strParam[3];
// 
// 					}
// 				}
// 				break;
// 
// 
// 			case ePlatformXY:
// 				{
// 					if (eCPOrderYXD == m_eCmdParamOrderType)
// 					{
// 						double dParam = 0;
// 						dParam = pPlatformXYDAixisPos.m_dPosX;
// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
// 						dParam = pPlatformXYDAixisPos.m_dPosY;
// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
// 						dParam = pPlatformXYDAixisPos.m_dAngle;
// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						vsWriteData[1].at(i) = strParam[2];
// 						vsWriteData[0].at(i) = strParam[1];
// 						vsWriteData[2].at(i) = strParam[3];
// 
// 					}
// 					else
// 					{
// 						double dParam = 0;
// 						dParam = pPlatformXYDAixisPos.m_dPosX;
// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
// 						dParam = pPlatformXYDAixisPos.m_dPosY;
// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
// 						dParam = pPlatformXYDAixisPos.m_dAngle;
// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						vsWriteData[0].at(i) = strParam[1];
// 						vsWriteData[1].at(i) = strParam[2];
// 						vsWriteData[2].at(i) = strParam[3];
// 
// 					}
// 				}
// 				break;
// 
// 			default:
// 				{
// 					if (eCPOrderYXD == m_eCmdParamOrderType)
// 					{
// 						double dParam = 0;
// 						dParam = pPlatformXYDAixisPos.m_dPosX;
// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
// 						dParam = pPlatformXYDAixisPos.m_dPosY;
// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
// 						dParam = pPlatformXYDAixisPos.m_dAngle;
// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						vsWriteData[1].at(i) = strParam[2];
// 						vsWriteData[0].at(i) = strParam[1];
// 						vsWriteData[2].at(i) = strParam[3];
// 
// 					}
// 					else
// 					{
// 						double dParam = 0;
// 						dParam = pPlatformXYDAixisPos.m_dPosX;
// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
// 						dParam = pPlatformXYDAixisPos.m_dPosY;
// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
// 						dParam = pPlatformXYDAixisPos.m_dAngle;
// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						vsWriteData[0].at(i) = strParam[1];
// 						vsWriteData[1].at(i) = strParam[2];
// 						vsWriteData[2].at(i) = strParam[3];
// 
// 					}
// 				}
// 
// 			}
// 		}
// 	}
// 
// 	CString strTempInfo = _T("");
// 	for (int i = 0; i < nTempNum; i++)
// 	{
// 		CString strTemp = strBlank + vsWriteData[0].at(i) + strBlank + vsWriteData[1].at(i) + strBlank + vsWriteData[2].at(i);
// 		strTempInfo = strTempInfo + strTemp;
// 	}
// 
// 
// 	strInfo.Empty();
// 	//	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;
// 	strInfo = strHead + strName + strBlank + strParam[0] + strTempInfo + strTail;
// 
// 	return TRUE;
// 
// }

BOOL CCommProtocolXYDFast::PackReMulAlignPosInfoFALP(CString& strInfo,std::vector<std::vector<CPlatformXYDAxisPos>> vvPlatformXYDAxisPos,BOOL bResult,int nPickMutiExMode/* = 0*/)
{
	// 	if (0 == vPlatformXYDAxisPos.size())
	// 	{
	// 		return FALSE;
	// 	}
	int nExNum = vvPlatformXYDAxisPos.size();
	int nTempNum = 0;
	int nRealTempNum;
	if(nExNum > 0)
	{
		nTempNum = vvPlatformXYDAxisPos[0].size();
		nRealTempNum = nTempNum;
	}

	CString strHead = m_strHead;
	CString strName= m_FALPParam.m_strCmd;
	CString strParam[6];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	// strParam[0] : 成功、失败
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	// strParam[1] : 总数
	nParam = nTempNum;
	PackParam(strParam[1], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	std::vector<std::vector<CString>> vvsWriteData[4];
	vvsWriteData[0].resize(nExNum);	// 索引
	vvsWriteData[1].resize(nExNum);	// X数据
	vvsWriteData[2].resize(nExNum);	// Y数据
	vvsWriteData[3].resize(nExNum);	// D数据

	CPlatformXYDAxisPos pPlatformXYDAixisPos; 		
	for(int nExIndex=0; nExIndex < nExNum; nExIndex++)
	{
		vvsWriteData[0][nExIndex].resize(nTempNum);
		vvsWriteData[1][nExIndex].resize(nTempNum);
		vvsWriteData[2][nExIndex].resize(nTempNum);
		vvsWriteData[3][nExIndex].resize(nTempNum);
		if(nPickMutiExMode > 200 && nPickMutiExMode < 300)
		{
			int nRealTempNum = nPickMutiExMode % 100;
			vvsWriteData[0][nExIndex].resize(nRealTempNum, _T("0"));
			vvsWriteData[1][nExIndex].resize(nRealTempNum, _T("0"));
			vvsWriteData[2][nExIndex].resize(nRealTempNum, _T("0"));
			vvsWriteData[3][nExIndex].resize(nRealTempNum, _T("0"));
		}
		for (int i = 0; i < nTempNum; i++)
		{
			pPlatformXYDAixisPos = (CPlatformXYDAxisPos)(vvPlatformXYDAxisPos.at(nExIndex).at(i));	


			if (m_pMidPlatformInfo == NULL)
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{

					// 				int nParam = 0;
					// 				// 索引
					// 				nParam = i;
					PackParam(strParam[2], i+1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

					double dParam;
					dParam = pPlatformXYDAixisPos.m_dPosX;
					PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos.m_dPosY;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos.m_dAngle;
					PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

					vvsWriteData[0].at(nExIndex).at(i) = strParam[2];
					vvsWriteData[2].at(nExIndex).at(i) = strParam[4];
					vvsWriteData[1].at(nExIndex).at(i) = strParam[3];
					vvsWriteData[3].at(nExIndex).at(i) = strParam[5];

				}
				else
				{
					// 				int nParam = 0;
					// 				// 索引
					// 				nParam = i;
					PackParam(strParam[2], i+1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

					double dParam = 0;
					dParam = pPlatformXYDAixisPos.m_dPosX;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos.m_dPosY;
					PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos.m_dAngle;
					PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

					vvsWriteData[0].at(nExIndex).at(i) = strParam[2];
					vvsWriteData[1].at(nExIndex).at(i) = strParam[3];
					vvsWriteData[2].at(nExIndex).at(i) = strParam[4];
					vvsWriteData[3].at(nExIndex).at(i) = strParam[5];

				}

			}
			else
			{
				switch(m_eMidPlatformType)
				{
				case ePlatformXYD:
					{
						if (eCPOrderYXD == m_eCmdParamOrderType)
						{
							// 						int nParam = 0;
							// 						// 索引
							// 						nParam = i;
							PackParam(strParam[2], i+1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisPos.m_dPosX;
							PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisPos.m_dPosY;
							PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisPos.m_dAngle;
							PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

							vvsWriteData[0][nExIndex].at(i) = strParam[2];
							vvsWriteData[2][nExIndex].at(i) = strParam[4];
							vvsWriteData[1][nExIndex].at(i) = strParam[3];
							vvsWriteData[3][nExIndex].at(i) = strParam[5];

						}
						else
						{
							// 						int nParam = 0;
							// 						// 索引
							// 						nParam = i;
							PackParam(strParam[2], i+1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisPos.m_dPosX;
							PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisPos.m_dPosY;
							PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisPos.m_dAngle;
							PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

							vvsWriteData[0].at(nExIndex).at(i) = strParam[2];
							vvsWriteData[1].at(nExIndex).at(i) = strParam[3];
							vvsWriteData[2].at(nExIndex).at(i) = strParam[4];
							vvsWriteData[3].at(nExIndex).at(i) = strParam[5];

						}
					}
					break;

				case ePlatformXD:
					{
						if (eCPOrderYXD == m_eCmdParamOrderType)
						{
							// 						int nParam = 0;
							// 						// 索引
							// 						nParam = i;
							PackParam(strParam[2], i+1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisPos.m_dPosX;
							PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisPos.m_dPosY;
							PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisPos.m_dAngle;
							PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

							vvsWriteData[0].at(nExIndex).at(i) = strParam[2];
							vvsWriteData[2].at(nExIndex).at(i) = strParam[4];
							vvsWriteData[1].at(nExIndex).at(i) = strParam[3];
							vvsWriteData[3].at(nExIndex).at(i) = strParam[5];

						}
						else
						{
							// 						int nParam = 0;
							// 						// 索引
							// 						nParam = i;
							PackParam(strParam[2], i+1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisPos.m_dPosX;
							PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisPos.m_dPosY;
							PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisPos.m_dAngle;
							PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

							vvsWriteData[0].at(nExIndex).at(i) = strParam[1];
							vvsWriteData[1].at(nExIndex).at(i) = strParam[2];
							vvsWriteData[2].at(nExIndex).at(i) = strParam[3];
							vvsWriteData[3].at(nExIndex).at(i) = strParam[4];

						}
					}
					break;

				case ePlatformYD:
					{
						if (eCPOrderYXD == m_eCmdParamOrderType)
						{
							// 						int nParam = 0;
							// 						// 索引
							// 						nParam = i;
							PackParam(strParam[2], i+1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisPos.m_dPosX;
							PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisPos.m_dPosY;
							PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisPos.m_dAngle;
							PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

							vvsWriteData[0].at(nExIndex).at(i) = strParam[2];
							vvsWriteData[2].at(nExIndex).at(i) = strParam[4];
							vvsWriteData[1].at(nExIndex).at(i) = strParam[3];
							vvsWriteData[3].at(nExIndex).at(i) = strParam[5];

						}
						else
						{
							// 						int nParam = 0;
							// 						// 索引
							// 						nParam = i;
							PackParam(strParam[2], i+1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisPos.m_dPosX;
							PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisPos.m_dPosY;
							PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisPos.m_dAngle;
							PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

							vvsWriteData[0].at(nExIndex).at(i) = strParam[2];
							vvsWriteData[1].at(nExIndex).at(i) = strParam[3];
							vvsWriteData[2].at(nExIndex).at(i) = strParam[4];
							vvsWriteData[3].at(nExIndex).at(i) = strParam[5];

						}
					}
					break;


				case ePlatformXY:
					{
						if (eCPOrderYXD == m_eCmdParamOrderType)
						{
							// 						int nParam = 0;
							// 						// 索引
							// 						nParam = i;
							PackParam(strParam[2], i+1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisPos.m_dPosX;
							PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisPos.m_dPosY;
							PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisPos.m_dAngle;
							PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

							vvsWriteData[0].at(nExIndex).at(i) = strParam[2];
							vvsWriteData[2].at(nExIndex).at(i) = strParam[4];
							vvsWriteData[1].at(nExIndex).at(i) = strParam[3];
							vvsWriteData[3].at(nExIndex).at(i) = strParam[5];

						}
						else
						{
							// 						int nParam = 0;
							// 						// 索引
							// 						nParam = i;
							PackParam(strParam[2], i+1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisPos.m_dPosX;
							PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisPos.m_dPosY;
							PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisPos.m_dAngle;
							PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

							vvsWriteData[0].at(nExIndex).at(i) = strParam[2];
							vvsWriteData[1].at(nExIndex).at(i) = strParam[3];
							vvsWriteData[2].at(nExIndex).at(i) = strParam[4];
							vvsWriteData[3].at(nExIndex).at(i) = strParam[5];

						}
					}
					break;

				default:
					{
						if (eCPOrderYXD == m_eCmdParamOrderType)
						{
							// 						int nParam = 0;
							// 						// 索引
							// 						nParam = i;
							PackParam(strParam[2], i+1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisPos.m_dPosX;
							PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisPos.m_dPosY;
							PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisPos.m_dAngle;
							PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

							vvsWriteData[0].at(nExIndex).at(i) = strParam[2];
							vvsWriteData[2].at(nExIndex).at(i) = strParam[4];
							vvsWriteData[1].at(nExIndex).at(i) = strParam[3];
							vvsWriteData[3].at(nExIndex).at(i) = strParam[5];

						}
						else
						{
							// 						int nParam = 0;
							// 						// 索引
							// 						nParam = i;
							PackParam(strParam[2], i+1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisPos.m_dPosX;
							PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisPos.m_dPosY;
							PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisPos.m_dAngle;
							PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

							vvsWriteData[0].at(nExIndex).at(i) = strParam[2];
							vvsWriteData[1].at(nExIndex).at(i) = strParam[3];
							vvsWriteData[2].at(nExIndex).at(i) = strParam[4];
							vvsWriteData[3].at(nExIndex).at(i) = strParam[5];

						}
					}

				}
			}
		}

	}

	CString strTempInfo = _T("");
	for(int nExIndex=0; nExIndex < nExNum; nExIndex++)
	{
		strTempInfo = strTempInfo + strBlank + strParam[1];
		for (int i = 0; i < vvsWriteData[0][nExIndex].size(); i++)
		{
			CString strTemp = strBlank + vvsWriteData[0][nExIndex].at(i) + strBlank + vvsWriteData[1][nExIndex].at(i) + strBlank + vvsWriteData[2][nExIndex].at(i) + strBlank + vvsWriteData[3][nExIndex].at(i);
			strTempInfo = strTempInfo + strTemp;
		}
	}



	strInfo.Empty();
	//	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;
	strInfo = strHead + strName + strBlank + strParam[0] + /*strBlank + strParam[1] + */strTempInfo + strTail;

	return TRUE;

}

BOOL CCommProtocolXYDFast::PackReMulAlignPosInfoFMCO(CString& strInfo,std::vector<pair<CCoordPos, int>> vpPlatformXYDOffset,BOOL bResult)
{
	int nTempNum = vpPlatformXYDOffset.size();

	CString strHead = m_strHead;
	CString strName= m_FMCOParam.m_strCmd;
	CString strParam[6];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (FALSE == bResult)
	{	
		nParam = -1;
	}

	// strParam[0] : 成功、失败
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	// strParam[1] : 总数
	nParam = nTempNum;
	PackParam(strParam[1], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	std::vector<CString> vsWriteData[4];
	vsWriteData[0].resize(nTempNum);	// 索引
	vsWriteData[1].resize(nTempNum);	// X数据
	vsWriteData[2].resize(nTempNum);	// Y数据
	vsWriteData[3].resize(nTempNum);	// D数据

	CCoordPos pPlatformXYDAixisOffset; 		

	for (int i = 0; i < nTempNum; i++)
	{
		pPlatformXYDAixisOffset = vpPlatformXYDOffset.at(i).first;
		int nPos = vpPlatformXYDOffset.at(i).second;

		if (m_pMidPlatformInfo == NULL)
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{

				// 				int nParam = 0;
				// 				// 索引
				// 				nParam = i;
				PackParam(strParam[2], nPos+1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

				double dParam;
				dParam = pPlatformXYDAixisOffset.m_dPosX;
				PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisOffset.m_dPosY;
				PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisOffset.m_dAngle;
				PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				vsWriteData[0].at(i) = strParam[2];
				vsWriteData[2].at(i) = strParam[4];
				vsWriteData[1].at(i) = strParam[3];
				vsWriteData[3].at(i) = strParam[5];

			}
			else
			{
				// 				int nParam = 0;
				// 				// 索引
				// 				nParam = i;
				PackParam(strParam[2], nPos+1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

				double dParam = 0;
				dParam = pPlatformXYDAixisOffset.m_dPosX;
				PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisOffset.m_dPosY;
				PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisOffset.m_dAngle;
				PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				vsWriteData[0].at(i) = strParam[2];
				vsWriteData[1].at(i) = strParam[3];
				vsWriteData[2].at(i) = strParam[4];
				vsWriteData[3].at(i) = strParam[5];

			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						// 						int nParam = 0;
						// 						// 索引
						// 						nParam = i;
						PackParam(strParam[2], nPos+1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

						double dParam = 0;
						dParam = pPlatformXYDAixisOffset.m_dPosX;
						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisOffset.m_dPosY;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisOffset.m_dAngle;
						PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

						vsWriteData[0].at(i) = strParam[2];
						vsWriteData[2].at(i) = strParam[4];
						vsWriteData[1].at(i) = strParam[3];
						vsWriteData[3].at(i) = strParam[5];

					}
					else
					{
						// 						int nParam = 0;
						// 						// 索引
						// 						nParam = i;
						PackParam(strParam[2], nPos+1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

						double dParam = 0;
						dParam = pPlatformXYDAixisOffset.m_dPosX;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisOffset.m_dPosY;
						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisOffset.m_dAngle;
						PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

						vsWriteData[0].at(i) = strParam[2];
						vsWriteData[1].at(i) = strParam[3];
						vsWriteData[2].at(i) = strParam[4];
						vsWriteData[3].at(i) = strParam[5];

					}
				}
				break;

			case ePlatformXD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						// 						int nParam = 0;
						// 						// 索引
						// 						nParam = i;
						PackParam(strParam[2], nPos+1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

						double dParam = 0;
						dParam = pPlatformXYDAixisOffset.m_dPosX;
						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisOffset.m_dPosY;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisOffset.m_dAngle;
						PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

						vsWriteData[0].at(i) = strParam[2];
						vsWriteData[2].at(i) = strParam[4];
						vsWriteData[1].at(i) = strParam[3];
						vsWriteData[3].at(i) = strParam[5];

					}
					else
					{
						// 						int nParam = 0;
						// 						// 索引
						// 						nParam = i;
						PackParam(strParam[2], nPos+1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

						double dParam = 0;
						dParam = pPlatformXYDAixisOffset.m_dPosX;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisOffset.m_dPosY;
						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisOffset.m_dAngle;
						PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

						vsWriteData[0].at(i) = strParam[1];
						vsWriteData[1].at(i) = strParam[2];
						vsWriteData[2].at(i) = strParam[3];
						vsWriteData[3].at(i) = strParam[4];

					}
				}
				break;

			case ePlatformYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						// 						int nParam = 0;
						// 						// 索引
						// 						nParam = i;
						PackParam(strParam[2], nPos+1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

						double dParam = 0;
						dParam = pPlatformXYDAixisOffset.m_dPosX;
						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisOffset.m_dPosY;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisOffset.m_dAngle;
						PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

						vsWriteData[0].at(i) = strParam[2];
						vsWriteData[2].at(i) = strParam[4];
						vsWriteData[1].at(i) = strParam[3];
						vsWriteData[3].at(i) = strParam[5];

					}
					else
					{
						// 						int nParam = 0;
						// 						// 索引
						// 						nParam = i;
						PackParam(strParam[2], nPos+1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

						double dParam = 0;
						dParam = pPlatformXYDAixisOffset.m_dPosX;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisOffset.m_dPosY;
						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisOffset.m_dAngle;
						PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

						vsWriteData[0].at(i) = strParam[2];
						vsWriteData[1].at(i) = strParam[3];
						vsWriteData[2].at(i) = strParam[4];
						vsWriteData[3].at(i) = strParam[5];

					}
				}
				break;


			case ePlatformXY:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						// 						int nParam = 0;
						// 						// 索引
						// 						nParam = i;
						PackParam(strParam[2], nPos+1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

						double dParam = 0;
						dParam = pPlatformXYDAixisOffset.m_dPosX;
						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisOffset.m_dPosY;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisOffset.m_dAngle;
						PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

						vsWriteData[0].at(i) = strParam[2];
						vsWriteData[2].at(i) = strParam[4];
						vsWriteData[1].at(i) = strParam[3];
						vsWriteData[3].at(i) = strParam[5];

					}
					else
					{
						// 						int nParam = 0;
						// 						// 索引
						// 						nParam = i;
						PackParam(strParam[2], nPos+1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

						double dParam = 0;
						dParam = pPlatformXYDAixisOffset.m_dPosX;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisOffset.m_dPosY;
						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisOffset.m_dAngle;
						PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

						vsWriteData[0].at(i) = strParam[2];
						vsWriteData[1].at(i) = strParam[3];
						vsWriteData[2].at(i) = strParam[4];
						vsWriteData[3].at(i) = strParam[5];

					}
				}
				break;

			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						// 						int nParam = 0;
						// 						// 索引
						// 						nParam = i;
						PackParam(strParam[2], nPos+1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

						double dParam = 0;
						dParam = pPlatformXYDAixisOffset.m_dPosX;
						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisOffset.m_dPosY;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisOffset.m_dAngle;
						PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

						vsWriteData[0].at(i) = strParam[2];
						vsWriteData[2].at(i) = strParam[4];
						vsWriteData[1].at(i) = strParam[3];
						vsWriteData[3].at(i) = strParam[5];

					}
					else
					{
						// 						int nParam = 0;
						// 						// 索引
						// 						nParam = i;
						PackParam(strParam[2], nPos+1, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

						double dParam = 0;
						dParam = pPlatformXYDAixisOffset.m_dPosX;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisOffset.m_dPosY;
						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisOffset.m_dAngle;
						PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

						vsWriteData[0].at(i) = strParam[2];
						vsWriteData[1].at(i) = strParam[3];
						vsWriteData[2].at(i) = strParam[4];
						vsWriteData[3].at(i) = strParam[5];

					}
				}

			}
		}
	}

	CString strTempInfo = _T("");
	for (int i = 0; i < nTempNum; i++)
	{
		CString strTemp = strBlank + vsWriteData[0].at(i) + strBlank + vsWriteData[1].at(i) + strBlank + vsWriteData[2].at(i) + strBlank + vsWriteData[3].at(i);
		strTempInfo = strTempInfo + strTemp;
	}


	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strTempInfo + strTail;

	return TRUE;

}

// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FALP R1 P2 P3 P4[ETX]）
BOOL CCommProtocolXYDFast::PackReAlignResultInfoFALP( CString& strInfo,CPlatformAxisPos* vpPlatAxisPos,BOOL bResult)
{
	if (NULL == vpPlatAxisPos)
	{
		return FALSE;
	}

	if (vpPlatAxisPos->GetPlatformType()!=ePlatformXYD)
	{
		return FALSE;
	}

	CString strHead = m_strHead;
	CString strName= m_FALPParam.m_strCmd;
	CString strParam[4];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult == 1)
	{	
		nParam = 0;
	}
	else if(bResult == 2)
	{
		nParam = 2;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	if (m_pMidPlatformInfo == NULL)
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}
		else
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}

	}
	else
	{
		switch(m_eMidPlatformType)
		{
		case ePlatformXYD:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
			}
			break;

			// 		case ePlatformXD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformX:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformYD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

		case ePlatformXY1Y2:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dY1 = 0.0;
					double dY2 = 0.0;

					double dX0 = pPlatformXYDAixisPos->m_dPosX;
					double dY0 = pPlatformXYDAixisPos->m_dPosY;
					double dD0 = pPlatformXYDAixisPos->m_dAngle;
					CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(dX0, dY0, dD0, dY1, dY2, dX1);


					double dParam = 0;
					dParam = dX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dY1;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = dY2;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;

		case ePlatformX1X2Y:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dX2 = 0.0;
					double dY1 = 0.0;

					double dX0 = pPlatformXYDAixisPos->m_dPosX;
					double dY0 = pPlatformXYDAixisPos->m_dPosY;
					double dD0 = pPlatformXYDAixisPos->m_dAngle;
					CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(dX0, dY0, dD0, dX1, dX2, dY1);

					//dX1 = dX1 + 5.5;
					//dX2 = dX2 + 5.5;
					//dY1 = dY1 + 5.5;

					double dParam = 0;
					dParam = dX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dX2;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dY1;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;

		default:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
			}
		}
	}

	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;

	return TRUE;

}

BOOL CCommProtocolXYDFast::PackReAlignResultInfoFALP_int( CString& strInfo,CPlatformAxisPos* vpPlatAxisPos,int nResult)
{
	if (NULL == vpPlatAxisPos)
	{
		return FALSE;
	}

	if (vpPlatAxisPos->GetPlatformType()!=ePlatformXYD)
	{
		return FALSE;
	}

	CString strHead = m_strHead;
	CString strName= m_FALPParam.m_strCmd;
	CString strParam[4];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	nParam = nResult;

	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	if (m_pMidPlatformInfo == NULL)
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}
		else
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}

	}
	else
	{
		switch(m_eMidPlatformType)
		{
		case ePlatformXYD:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
			}
			break;
		case ePlatformXD:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
			}
			break;

			// 		case ePlatformXY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformX:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformYD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

		case ePlatformXY1Y2:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dY1 = 0.0;
					double dY2 = 0.0;

					double dX0 = pPlatformXYDAixisPos->m_dPosX;
					double dY0 = pPlatformXYDAixisPos->m_dPosY;
					double dD0 = pPlatformXYDAixisPos->m_dAngle;
					CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(dX0, dY0, dD0, dY1, dY2, dX1);


					double dParam = 0;
					dParam = dX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dY1;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = dY2;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;

		case ePlatformX1X2Y:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dX2 = 0.0;
					double dY1 = 0.0;

					double dX0 = pPlatformXYDAixisPos->m_dPosX;
					double dY0 = pPlatformXYDAixisPos->m_dPosY;
					double dD0 = pPlatformXYDAixisPos->m_dAngle;
					CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(dX0, dY0, dD0, dX1, dX2, dY1);

					//dX1 = dX1 + 5.5;
					//dX2 = dX2 + 5.5;
					//dY1 = dY1 + 5.5;

					double dParam = 0;
					dParam = dX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dX2;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dY1;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;

		default:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
			}
		}
	}

	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;

	return TRUE;

}

BOOL CCommProtocolXYDFast::PackReAlignResultNumberInfoFALP( CString& strInfo,CPlatformAxisPos* vpPlatAxisPos,int nResultNumber)
{
	if (NULL == vpPlatAxisPos)
	{
		return FALSE;
	}

	if (vpPlatAxisPos->GetPlatformType()!=ePlatformXYD)
	{
		return FALSE;
	}

	CString strHead = m_strHead;
	CString strName= m_FALPParam.m_strCmd;
	CString strParam[4];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;

	if (nResultNumber == 1)
	{	
		nParam = 1;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);


	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	if (m_pMidPlatformInfo == NULL)
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}
		else
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}

	}
	else
	{
		switch(m_eMidPlatformType)
		{
		case ePlatformXYD:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
			}
			break;

			// 		case ePlatformXD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformX:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformYD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

		case ePlatformXY1Y2:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dY1 = 0.0;
					double dY2 = 0.0;

					double dX0 = pPlatformXYDAixisPos->m_dPosX;
					double dY0 = pPlatformXYDAixisPos->m_dPosY;
					double dD0 = pPlatformXYDAixisPos->m_dAngle;
					CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(dX0, dY0, dD0, dY1, dY2, dX1);


					double dParam = 0;
					dParam = dX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dY1;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = dY2;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;

		case ePlatformX1X2Y:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dX2 = 0.0;
					double dY1 = 0.0;

					double dX0 = pPlatformXYDAixisPos->m_dPosX;
					double dY0 = pPlatformXYDAixisPos->m_dPosY;
					double dD0 = pPlatformXYDAixisPos->m_dAngle;
					CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(dX0, dY0, dD0, dX1, dX2, dY1);

					//dX1 = dX1 + 5.5;
					//dX2 = dX2 + 5.5;
					//dY1 = dY1 + 5.5;

					double dParam = 0;
					dParam = dX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dX2;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dY1;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;

		default:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
			}
		}
	}

	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;

	return TRUE;
}


// PB 2013.05.27
// 打包写寄存器指令
// strRegAddr 写的寄存器地址
// dWriteNum  写的个数（以双字为单位）
// vWriteData 写的数据(8位数，包括三位小数，一位符号位)
BOOL CCommProtocolXYDFast::PackWriteRegInfo( CString& strInfo, CString strRegAddr, int dWriteNum, std::vector<double> vWriteData )
{
	if (dWriteNum != vWriteData.size())
	{
		return FALSE;
	}

	CString strENQ = char(0x05);

	CString strHead0 = strENQ; // enq
	CString strHead1 = "F80000FF03FF0000";
	CString strCmdWrite = "14010000";
	CString strWriteAdr = strRegAddr;
	CString strWriteNum;
	CString strWriteData;

	strWriteNum.Format(_T("%.4d"), dWriteNum*2);

	for (int i=0; i<dWriteNum; i++)
	{
		int nTemp = vWriteData.at(i) * 1000;

		if (abs(nTemp) > 0xFFFFFFF)
		{
			return FALSE;
		}

		CString strTemp;
		strTemp.Format("%08X", nTemp);

		strWriteData = strWriteData + strTemp.Mid(4, 4) + strTemp.Mid(0, 4);		
	}

	// 	for (int i=dWriteNum; i>0; i--)
	// 	{
	// 		int nTemp = fabs(vWriteData.at(i-1) * 1000 / 1);
	// 		
	// 		if (nTemp >= 10000000)
	// 		{
	// 			return FALSE;
	// 		}
	// 		
	// 		int nTemp1;
	// 		for (int j=0; j<4; j++)
	// 		{
	// 			nTemp1 = nTemp%100;
	// 			
	// 			CString strTemp;
	// 			if (j==3 && vWriteData.at(i-1)<0) // 考虑符号位
	// 			{
	// 				strTemp = unsigned char(((nTemp1/10)<<4) | 0x10 + (nTemp1%10) & 0x0F);
	// 			} 
	// 			else
	// 			{
	// 				strTemp = unsigned char(((nTemp1/10)<<4) + (nTemp1%10) & 0x0F);
	// 			}
	// 			
	// 			StrWriteData = strTemp + StrWriteData;
	// 			nTemp = nTemp/100;
	// 		}
	// 	}

	//构造写命令
	strInfo.Empty();
	strInfo = strHead0 + strHead1 + strCmdWrite + strWriteAdr + strWriteNum + strWriteData;

	return TRUE;
	// 	if (dWriteNum != vWriteData.size())
	// 	{
	// 		return FALSE;
	// 	}
	// 
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(dWriteNum);
	// 	for (int i=0; i<vWriteData.size(); i++)
	// 	{
	// 		if (fabs(vWriteData.at(i)) >= 10000)
	// 		{
	// 			return FALSE;
	// 		}
	// 		vnWriteData.at(i) = (vWriteData.at(i) * 1000) / 1;
	// 	}
	// 
	// 	if (PackWriteRegInfo(strInfo, strRegAddr, dWriteNum, vnWriteData))
	// 	{
	// 		return TRUE;
	// 	}
	// 
	// 	return FALSE;
}


// FM 2014.02.20
// 打包写寄存器指令
// strRegAddr 写的寄存器地址
// dWriteNum  写的个数（以双字为单位）
// vWriteData 写的数据(8位数，一位符号位)
BOOL CCommProtocolXYDFast::PackWriteRegInfo( CString& strInfo, CString strRegAddr, int dWriteNum, std::vector<int> vWriteData )
{
	if (dWriteNum != vWriteData.size())
	{
		return FALSE;
	}

	CString strENQ = char(0x05);

	CString strHead0 = strENQ; // enq
	CString strHead1 = "F80000FF03FF0000";
	CString strCmdWrite = "14010000";
	CString strWriteAdr = strRegAddr;
	CString strWriteNum;
	CString strWriteData;

	strWriteNum.Format(_T("%.4d"), dWriteNum*2);

	for (int i=0; i<dWriteNum; i++)
	{
		int nTemp = vWriteData.at(i);

		if (abs(nTemp) > 0xFFFFFFF)
		{
			return FALSE;
		}

		CString strTemp;
		strTemp.Format("%08X", nTemp);

		strWriteData = strWriteData + strTemp.Mid(4, 4) + strTemp.Mid(0, 4);		
	}

	// 	for (int i=dWriteNum; i>0; i--)
	// 	{
	// 		int nTemp = fabs(vWriteData.at(i-1) * 1000 / 1);
	// 		
	// 		if (nTemp >= 10000000)
	// 		{
	// 			return FALSE;
	// 		}
	// 		
	// 		int nTemp1;
	// 		for (int j=0; j<4; j++)
	// 		{
	// 			nTemp1 = nTemp%100;
	// 			
	// 			CString strTemp;
	// 			if (j==3 && vWriteData.at(i-1)<0) // 考虑符号位
	// 			{
	// 				strTemp = unsigned char(((nTemp1/10)<<4) | 0x10 + (nTemp1%10) & 0x0F);
	// 			} 
	// 			else
	// 			{
	// 				strTemp = unsigned char(((nTemp1/10)<<4) + (nTemp1%10) & 0x0F);
	// 			}
	// 			
	// 			StrWriteData = strTemp + StrWriteData;
	// 			nTemp = nTemp/100;
	// 		}
	// 	}

	//构造写命令
	strInfo.Empty();
	strInfo = strHead0 + strHead1 + strCmdWrite + strWriteAdr + strWriteNum + strWriteData;

	return TRUE;
	// 	if (dWriteNum != vWriteData.size())
	// 	{
	// 		return FALSE;
	// 	}
	// 
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(dWriteNum);
	// 	for (int i=0; i<vWriteData.size(); i++)
	// 	{
	// 		if (fabs(vWriteData.at(i)) >= 10000)
	// 		{
	// 			return FALSE;
	// 		}
	// 		vnWriteData.at(i) = (vWriteData.at(i) * 1000) / 1;
	// 	}
	// 
	// 	if (PackWriteRegInfo(strInfo, strRegAddr, dWriteNum, vnWriteData))
	// 	{
	// 		return TRUE;
	// 	}
	// 
	// 	return FALSE;
}
// 
// 
// // PB 2013.05.27
// // 打包写寄存器指令
// // strRegAddr 写的寄存器地址
// // dWriteNum  写的个数（以双字为单位）
// // vWriteData 写的数据(均为4位整型数，1位符号位，3位数据位)
// BOOL CCommProtocolXYD::PackWriteRegInfo( CString& strInfo, CString strRegAddr, int dWriteNum, std::vector<int> vWriteData )
// {
// 	if (dWriteNum != vWriteData.size())
// 	{
// 		return FALSE;
// 	}
// 	
// 	CString strENQ = char(0x05);
// 	
// 	CString strHead0 = strENQ; // enq
// 	CString strHead1 = "F80000FF03FF0000";
// 	CString strCmdWrite = "14010000";
// 	CString strWriteAdr = strRegAddr;
// 	CString strWriteNum;
// 	CString StrWriteData;
// 	
// 	strWriteNum.Format(_T("%.4d"), dWriteNum);
// 
// 	for (int i=0; i<dWriteNum; i++)
// 	{
// 		int nTemp = vWriteData.at(i);
// 
// 		if (nTemp < 0 || nTemp >= 0xFFFF)
// 		{
// 			return FALSE;
// 		}
// 
// 		CString strTemp;
// 		strTemp.Format("%04X", nTemp);
// 
// 		StrWriteData = StrWriteData + strTemp;
// 
// // 		int nTemp1;
// // 		for (int j=0; j<2; j++)
// // 		{
// // 			nTemp1 = nTemp%100;
// // 
// // 			CString strTemp;
// // 			if (j==1 && vWriteData.at(i-1)<0) // 考虑符号位
// // 			{
// // 				strTemp = unsigned char(((nTemp1/10)<<4) | 0x10 + (nTemp1%10) & 0x0F);
// // 			} 
// // 			else
// // 			{
// // 				strTemp = unsigned char(((nTemp1/10)<<4) + (nTemp1%10) & 0x0F);
// // 			}
// // 			
// // 			StrWriteData = strTemp + StrWriteData;
// // 			nTemp = nTemp/100;
// // 		}
// 	}
// 	
// 	//构造写命令
// 	strInfo.Empty();
// 	strInfo = strHead0 + strHead1 + strCmdWrite + strWriteAdr + strWriteNum + StrWriteData;
// 	
// 	return TRUE;
// }

// PB 2013.05.27
// 打包读寄存器指令
// strRegAddr 读的寄存器地址
// dWriteNum  读的个数（以双字为单位）
BOOL CCommProtocolXYDFast::PackReadRegInfo( CString& strInfo, CString strRegAddr, int nReadNum )
{
	strInfo.Empty();

	CString strENQ = char(0x05);

	CString strHead0 = strENQ; // enq
	CString strHead1 = "F80000FF03FF0000";

	CString strCmdRead = "04010000";
	CString strCmdWrite = "14010000";

	CString strReadNum;			// 读取数量
	strReadNum.Format(_T("%.4d"), nReadNum);

	strInfo = strHead0 + strHead1 + strCmdRead + strRegAddr + strReadNum;

	return TRUE;
}


// PB 2013.05.27
// 解析收到的写寄存器响应（&TAGX1Y1D100\）
BOOL CCommProtocolXYDFast::AnalyzeAswWriteReg( CString strAsw )
{
	CString strSTX = m_strHead;
	CString strETX = m_strTail;

	CString strENQ = char(0x05);

	CString strACK = char(0x06);
	CString strNAK = char(0x15);

	CString strCR = char(0x0D);
	CString strLF = char(0x0A);	

	CString strHead1 = "F80000FF03FF0000";

	// 解析收到的响应
	// 正常回复：strACK + strHead1 + strCR + strLF；
	// 异常回复：strNAK + strHead1 + 出错代码 + strCR + strLF；
	if (strAsw.GetAt(0) == strACK)
	{
		return TRUE;
	} 
	else
	{
		return FALSE;
	}
}


// PB 2013.05.27
// 解析收到的读寄存器响应
BOOL CCommProtocolXYDFast::AnalyzeAswReadReg( CString strAsw, int nReadNum, std::vector<double> &vReceiveData )
{
	CString strSTX = m_strHead;
	CString strETX = m_strTail;

	CString strENQ = char(0x05);

	CString strACK = char(0x06);
	CString strNAK = char(0x15);

	CString strCR = char(0x0D);
	CString strLF = char(0x0A);	


	CString strHead0 = strENQ; // enq
	CString strHead1 = "F80000FF03FF0000";

	// 解析收到的响应
	// 正常回复：strSTX + strHead1 + 数据 + strETX + 和数校验 + strCR + strLF；
	// 异常回复：strNAK + strHead1 + 出错代码 + strCR + strLF；
	if (strAsw == _T(""))
	{
		return FALSE;
	}
	if (strAsw.GetAt(0) != strSTX)
	{
		return FALSE;
	}
	if (strAsw.GetLength() < 17 + nReadNum*8 +1)
	{
		return FALSE;
	}

	if (strAsw.Mid(17 + nReadNum*8, 1) != strETX)
	{
		return FALSE;
	} 
	else
	{
		vReceiveData.clear();
		vReceiveData.resize(nReadNum);
		for (int i=0; i<nReadNum; i++)
		{
			CString strTemp = strAsw.Mid(17 + i*8, 8);

			CString str1 = strTemp.Mid(4,4) + strTemp.Mid(0,4);
			int d = strtoul(str1, NULL, 16);

			vReceiveData.at(i) = d;
		}		
	}

	for (int i=0; i<nReadNum; i++)
	{
		vReceiveData.at(i) = vReceiveData.at(i)/1000.0;
	}
	return true;
	// 	std::vector<int> vnReceiveData;
	// 	if (AnalyzeAswReadReg(strAsw, nReadNum, vnReceiveData))
	// 	{
	// 		vReceiveData.resize(vnReceiveData.size());
	// 		for (int i=0; i<vReceiveData.size(); i++)
	// 		{
	// 			vReceiveData.at(i) = vnReceiveData.at(i) / 1000.0;
	// 		}
	// 		return TRUE;
	// 	} 
	// 	else
	// 	{
	// 		return FALSE;
	// 	}
}


// FM 2014.02.20
// 解析收到的读寄存器响应
BOOL CCommProtocolXYDFast::AnalyzeAswReadReg( CString strAsw, int nReadNum, std::vector<int> &vReceiveData )
{
	CString strSTX = m_strHead;
	CString strETX = m_strTail;

	CString strENQ = char(0x05);

	CString strACK = char(0x06);
	CString strNAK = char(0x15);

	CString strCR = char(0x0D);
	CString strLF = char(0x0A);	


	CString strHead0 = strENQ; // enq
	CString strHead1 = "F80000FF03FF0000";

	// 解析收到的响应
	// 正常回复：strSTX + strHead1 + 数据 + strETX + 和数校验 + strCR + strLF；
	// 异常回复：strNAK + strHead1 + 出错代码 + strCR + strLF；
	if (strAsw == _T(""))
	{
		return FALSE;
	}
	if (strAsw.GetAt(0) != strSTX)
	{
		return FALSE;
	}
	if (strAsw.GetLength() < 17 + nReadNum*8 +1)
	{
		return FALSE;
	}

	if (strAsw.Mid(17 + nReadNum*8, 1) != strETX)
	{
		return FALSE;
	} 
	else
	{
		vReceiveData.clear();
		vReceiveData.resize(nReadNum);
		for (int i=0; i<nReadNum; i++)
		{
			CString strTemp = strAsw.Mid(17 + i*8, 8);

			CString str1 = strTemp.Mid(4,4) + strTemp.Mid(0,4);
			int d = strtoul(str1, NULL, 16);

			vReceiveData.at(i) = d;
		}		
	}

	for (int i=0; i<nReadNum; i++)
	{
		vReceiveData.at(i) = vReceiveData.at(i);
	}
	return true;
	// 	std::vector<int> vnReceiveData;
	// 	if (AnalyzeAswReadReg(strAsw, nReadNum, vnReceiveData))
	// 	{
	// 		vReceiveData.resize(vnReceiveData.size());
	// 		for (int i=0; i<vReceiveData.size(); i++)
	// 		{
	// 			vReceiveData.at(i) = vnReceiveData.at(i) / 1000.0;
	// 		}
	// 		return TRUE;
	// 	} 
	// 	else
	// 	{
	// 		return FALSE;
	// 	}
}



// 
// // PB 2013.05.27
// // 解析收到的读寄存器响应
// BOOL CCommProtocolXYD::AnalyzeAswReadReg( CString strAsw, int nReadNum, std::vector<int> &vReceiveData )
// {
// 	CString strSTX = m_strHead;
// 	CString strETX = m_strTail;
// 	
// 	CString strENQ = char(0x05);
// 	
// 	CString strACK = char(0x06);
// 	CString strNAK = char(0x15);
// 	
// 	CString strCR = char(0x0D);
// 	CString strLF = char(0x0A);	
// 	
// 	
// 	CString strHead0 = strENQ; // enq
// 	CString strHead1 = "F80000FF03FF0000";
// 	
// 	// 解析收到的响应
// 	// 正常回复：strSTX + strHead1 + 数据 + strETX + 和数校验 + strCR + strLF；
// 	// 异常回复：strNAK + strHead1 + 出错代码 + strCR + strLF；
// 	if (strAsw == _T(""))
// 	{
// 		return FALSE;
// 	}
// 	if (strAsw.GetAt(0) != strSTX)
// 	{
// 		return FALSE;
// 	}
// 	if (strAsw.GetLength() < 17 + nReadNum*4 +1)
// 	{
// 		return FALSE;
// 	}
// 
// 	if (strAsw.Mid(17 + nReadNum*4, 1) != strETX)
// 	{
// 		return FALSE;
// 	} 
// 	else
// 	{
// 		vReceiveData.clear();
// 		vReceiveData.resize(nReadNum);
// 		for (int i=0; i<nReadNum; i++)
// 		{
// 			CString strTemp = strAsw.Mid(17 + i*4, 4);
// 
// 			vReceiveData.at(i) = strtoul(strTemp, NULL, 16);
// 		}		
// 	}
// 	return true;
// }



// PB 2013.05.28
SysWorkCmdType CCommProtocolXYDFast::AnalyzeSysWorkCmdReceived(std::vector<int> vnReceivedData)
{
	if (vnReceivedData.size() != 3)
	{
		return eCmdUnknow;
	}

	SysWorkCmdType eCmdType = eCmdUnknow;
	switch (vnReceivedData.at(0))
	{
	case MC4_PLC_CMD_TARGET_SEARCH:
		eCmdType = eCmdTargetSearch; 
		break;	
	case MC4_PLC_CMD_OBJECT_SEARCH:
		eCmdType = eCmdObjectSearch; 
		break;
	case MC4_PLC_CMD_CALIB:
		eCmdType = eCmdCalibrate; 
		break;
	case MC4_PLC_CMD_ALIGN:
		eCmdType = eCmdOnlineAlign; 
		break;
	case MC4_PLC_CMD_CALIB_MOVE_SUCCEED:
	case MC4_PLC_CMD_CALIB_MOVE_FAILED:
	case MC4_PLC_CMD_ALIGN_MOVE_SUCCEED:
	case MC4_PLC_CMD_ALIGN_MOVE_FAILED:
	default:
		eCmdType = eCmdUnknow;
		break;
	}
	return eCmdType;
}

BOOL CCommProtocolXYDFast::GetCmdName(CString& strName)
{
	strName = m_strCmdName;
	return TRUE;
}

SysWorkCmdType CCommProtocolXYDFast::AnalyzeSysWorkCmdReceived(CString strCmd)
{
	// return CCommProtocol::AnalyzeSysWorkCmdReceived(strCmd);
	CString strName;
	std::vector<CString> vstrParam;	
	if (!AnalyzeCommandParam(strCmd, strName, vstrParam))
	{
		return eCmdUnknow;
	}

	m_strCmdName = strName;
	double dBase = 10;

	if (strName == m_FSPCParam.m_strCmd)
	{
		if (vstrParam.size() != m_FSPCParam.m_nPNum)
		{
			return eCmdUnknow;
		}
		m_FSPCParam.P1 = atoi(vstrParam[0]);
		m_FSPCParam.P2 = atoi(vstrParam[1]);

		return eCmdSetProductIndexFSPC;
	}
	else if (strName == m_FCCIParam.m_strCmd)
	{//lzk
		if (vstrParam.size() != m_FCCIParam.m_nPNum)
		{
			return eCmdUnknow;
		}
		m_FCCIParam.P1 = atoi(vstrParam[0]);
		m_FCCIParam.P2 = atoi(vstrParam[1]);

		return eCmdCopyCalibrateInfoFCCI;
	}
	else if (strName == m_FSSVParam.m_strCmd)
	{
		if (vstrParam.size() != m_FSSVParam.m_nPNum)
		{
			return eCmdUnknow;
		}
		m_FSSVParam.P1 = atoi(vstrParam[0]);
		m_FSSVParam.P2 = atoi(vstrParam[1]);

		return eCmdSaveProductIndexFSSV;
	}

	//lzk 0408 
	else if (strName == m_FVPCParam.m_strCmd)
	{
		if (vstrParam.size() != m_FVPCParam.m_nPNum)
		{
			return eCmdUnknow;
		}
		m_FVPCParam.P1 = atoi(vstrParam[0]);
		m_FVPCParam.P2 = atoi(vstrParam[1]);

		return eCmdFVPC;
	}
	else if (strName == m_FGSPParam.m_strCmd)
	{
		if (vstrParam.size() != m_FGSPParam.m_nPNum)
		{
			return eCmdUnknow;
		}

		return eCmdGetProductIndexFGSP;
	}
	else if (strName == m_FVASParam.m_strCmd)
	{
		if (vstrParam.size() != m_FVASParam.m_nPNum)
		{
			return eCmdUnknow;
		}
		m_FVASParam.P1 = atoi(vstrParam[0]);

		return eCmdSetProductVirtualAlnFVAS;
	}
	// 标定
	else if (strName == m_FCLBParam.m_strCmd)
	{
		// 		if (vstrParam.size() != m_FCLBParam.m_nPNum)
		// 		{
		// 			return eCmdUnknow;
		// 		}
		// 		m_FCLBParam.P1 = atoi(vstrParam[0]);
		// 		m_FCLBParam.P2 = atoi(vstrParam[1]);

		if (vstrParam.size() == m_FCLBParam.m_nPNum)	// 如果有5个参数时
		{
			m_FCLBParam.m_nPType = vstrParam.size();
			m_FCLBParam.P1 = atoi(vstrParam[0]);
			m_FCLBParam.P2 = atoi(vstrParam[1]);

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FCLBParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FCLBParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FCLBParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}		
		}
		else if (vstrParam.size() == m_FCLBParam.m_nPNum - 3)	// 如果只有2个参数时
		{
			m_FCLBParam.m_nPType = vstrParam.size();
			m_FCLBParam.P1 = atoi(vstrParam[0]);
			m_FCLBParam.P2 = atoi(vstrParam[1]);
			m_FCLBParam.P3 = 0;
			m_FCLBParam.P4 = 0;
			m_FCLBParam.P5 = 0;
		}
		else
		{
			return eCmdUnknow;
		}


		return eCmdCalibrateFCLB;
	}
	else if (strName == m_FCBSParam.m_strCmd)
	{
		// 		if (vstrParam.size() != m_FCLBParam.m_nPNum)
		// 		{
		// 			return eCmdUnknow;
		// 		}
		// 		m_FCLBParam.P1 = atoi(vstrParam[0]);
		// 		m_FCLBParam.P2 = atoi(vstrParam[1]);

		if (vstrParam.size() == m_FCBSParam.m_nPNum)	// 如果有5个参数时
		{
			m_FCBSParam.m_nPType = vstrParam.size();
			m_FCBSParam.P1 = atoi(vstrParam[0]);
			m_FCBSParam.P2 = atoi(vstrParam[1]);		

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FCBSParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FCBSParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FCBSParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}		
		}
		else if (vstrParam.size() == m_FCBSParam.m_nPNum - 3)	// 如果只有2个参数时
		{
			m_FCBSParam.m_nPType = vstrParam.size();
			m_FCBSParam.P1 = atoi(vstrParam[0]);
			m_FCBSParam.P2 = atoi(vstrParam[1]);
			m_FCBSParam.P3 = 0;
			m_FCBSParam.P4 = 0;
			m_FCBSParam.P5 = 0;

		}
		else
		{
			return eCmdUnknow;
		}


		return eCmdCalibrateFCBS;
	}
	else if (strName == m_FCBRParam.m_strCmd)
	{
		if (vstrParam.size() == m_FCBRParam.m_nPNum)	// 如果有4个参数时
		{
			m_FCBRParam.m_nPType = vstrParam.size();
			m_FCBRParam.P1 = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			m_FCBRParam.P2 = atoi(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			m_FCBRParam.P3 = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			m_FCBRParam.P4 = atoi(vstrParam[3])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);		
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdCalibrateFCBR;
	}
	else if (strName == m_FCPRParam.m_strCmd)
	{

		if (vstrParam.size() == m_FCPRParam.m_nPNum)	// 如果有2个参数时
		{
			m_FCPRParam.m_nPType = vstrParam.size();
			m_FCPRParam.P1 = atoi(vstrParam[0]);
			m_FCPRParam.P2 = atoi(vstrParam[1]);
			m_FCPRParam.P3 = 0;
			m_FCPRParam.P4 = 0;

		}
		else
		{
			return eCmdUnknow;
		}


		return eCmdCalibrateFCPR;
	}
	else if (strName == m_FCBPParam.m_strCmd)
	{

		//if (vstrParam.size() == m_FCBPParam.m_nPNum+3)	// 如果有6个参数时
		//{
		//	m_FCBPParam.m_nPType = vstrParam.size();
		//	m_FCBPParam.P1 = atoi(vstrParam[0]);
		//	m_FCBPParam.P2 = atoi(vstrParam[1]);
		//	m_FCBPParam.P3 = atoi(vstrParam[2])
		//	std::vector<CString> vstrAxisPos;
		//	vstrAxisPos.push_back(vstrParam[3]);
		//	vstrAxisPos.push_back(vstrParam[4]);
		//	vstrAxisPos.push_back(vstrParam[5]);
		//	if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
		//	{
		//		m_FCBPParam.P4 = m_CurPlatformXYDAxisPos.m_dPosX;
		//		m_FCBPParam.P5 = m_CurPlatformXYDAxisPos.m_dPosY;
		//		m_FCBPParam.P6 = m_CurPlatformXYDAxisPos.m_dAngle;
		//	}
		//	else
		//	{
		//		return eCmdUnknow;
		//	}		
		//}	
		if (vstrParam.size() == m_FCBPParam.m_nPNum)// 如果只有3个参数时
		{
			m_FCBPParam.m_nPType = vstrParam.size();
			m_FCBPParam.P1 = atoi(vstrParam[0]);
			m_FCBPParam.P2 = atoi(vstrParam[1]);
			m_FCBPParam.P3 = atoi(vstrParam[2]);
			m_FCBPParam.nP4 = 0;
			m_FCBPParam.P4 = 0;
			m_FCBPParam.P5 = 0;
			m_FCBPParam.P6 = 0;
		}
		else if (vstrParam.size() == m_FCBPParam.m_nPNum+1)// 如果只有4个参数时
		{
			m_FCBPParam.m_nPType = vstrParam.size();
			m_FCBPParam.P1 = atoi(vstrParam[0]);
			m_FCBPParam.P2 = atoi(vstrParam[1]);
			m_FCBPParam.P3 = atoi(vstrParam[2]);
			m_FCBPParam.nP4 = atoi(vstrParam[3]);
			m_FCBPParam.P4 = 0;
			m_FCBPParam.P5 = 0;
			m_FCBPParam.P6 = 0;
		}
		else if (vstrParam.size() == m_FCBPParam.m_nPNum+3)// 如果只有6个参数时
		{
			m_FCBPParam.m_nPType = vstrParam.size();
			m_FCBPParam.P1 = atoi(vstrParam[0]);
			m_FCBPParam.P2 = atoi(vstrParam[1]);
			m_FCBPParam.P3 = atoi(vstrParam[2]);
			m_FCBPParam.nP4 = 0;
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			vstrAxisPos.push_back(vstrParam[5]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FCBPParam.P4 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FCBPParam.P5 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FCBPParam.P6 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}
		}
		else if (vstrParam.size() == m_FCBPParam.m_nPNum+4)// 如果只有7个参数时
		{
			m_FCBPParam.m_nPType = vstrParam.size();
			m_FCBPParam.P1 = atoi(vstrParam[0]);
			m_FCBPParam.P2 = atoi(vstrParam[1]);
			m_FCBPParam.P3 = atoi(vstrParam[2]);
			m_FCBPParam.nP4 = atoi(vstrParam[3]);
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[4]);
			vstrAxisPos.push_back(vstrParam[5]);
			vstrAxisPos.push_back(vstrParam[6]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FCBPParam.P4 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FCBPParam.P5 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FCBPParam.P6 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}
		}
		else
		{
			return eCmdUnknow;
		}
		return eCmdCalibrateFCBP;
	}
	else if (strName == m_FTGTParam.m_strCmd)
	{
		// 		if (vstrParam.size() != m_FTGTParam.m_nPNum)
		// 		{
		// 			return eCmdUnknow;
		// 		}
		// 		m_FTGTParam.P1 = atoi(vstrParam[0]);
		if (vstrParam.size() == m_FTGTParam.m_nPNum - 3)	// 如果只有1个参数时
		{
			m_FTGTParam.m_nPType = vstrParam.size();
			m_FTGTParam.P1 = atoi(vstrParam[0]);
			m_FTGTParam.P2 = 0;
			m_FTGTParam.P3 = 0;
			m_FTGTParam.P4 = 0;
			m_FTGTParam.nP2 = 0;
			m_FTGTParam.nP3 = 0;
			m_FTGTParam.nP4 = 0;
		}
		else if (vstrParam.size() == m_FTGTParam.m_nPNum)	// 如果有4个参数时
		{
			m_FTGTParam.m_nPType = vstrParam.size();
			m_FTGTParam.P1 = atoi(vstrParam[0]);
			m_FTGTParam.P2 = 0;
			m_FTGTParam.P3 = 0;
			m_FTGTParam.P4 = 0;
			m_FTGTParam.nP2 = 0;
			m_FTGTParam.nP3 = 0;
			m_FTGTParam.nP4 = 0;

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[1]);
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FTGTParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FTGTParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FTGTParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}		
		}
		else if (vstrParam.size() == m_FTGTParam.m_nPNum +1)	// 如果只有5个参数时
		{
			m_FTGTParam.m_nPType = vstrParam.size();
			m_FTGTParam.P1 = atoi(vstrParam[0]);
			m_FTGTParam.nP2 = atoi(vstrParam[1]);
			m_FTGTParam.nP3 = 0;
			m_FTGTParam.nP4 = 0;
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FTGTParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FTGTParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FTGTParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}
		}
		else if (vstrParam.size() == m_FTGTParam.m_nPNum+2)
		{
			m_FTGTParam.m_nPType = vstrParam.size();
			m_FTGTParam.P1 = atoi(vstrParam[0]);
			m_FTGTParam.nP2 = atoi(vstrParam[1]);
			m_FTGTParam.nP3 = atoi(vstrParam[2]);
			m_FTGTParam.nP4 = 0;
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			vstrAxisPos.push_back(vstrParam[5]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FTGTParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FTGTParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FTGTParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}
		}
		else if (vstrParam.size() == m_FTGTParam.m_nPNum+3)
		{
			m_FTGTParam.m_nPType = vstrParam.size();
			m_FTGTParam.P1 = atoi(vstrParam[0]);
			m_FTGTParam.nP2 = atoi(vstrParam[1]);
			m_FTGTParam.nP3 = atoi(vstrParam[2]);
			m_FTGTParam.nP4 = atoi(vstrParam[3]);
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[4]);
			vstrAxisPos.push_back(vstrParam[5]);
			vstrAxisPos.push_back(vstrParam[6]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FTGTParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FTGTParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FTGTParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}

		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdTargetSearchFTGT;
	}
	else if (strName == m_FTGMParam.m_strCmd)
	{
		if (vstrParam.size() == m_FTGMParam.m_nPNum)	// 如果有4个参数时
		{
			m_FTGMParam.m_nPType = vstrParam.size();
			m_FTGMParam.P1 = atoi(vstrParam[0]);

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[1]);
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FTGMParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FTGMParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FTGMParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}		
		}
		else if (vstrParam.size() == m_FTGMParam.m_nPNum - 3)	// 如果只有1个参数时
		{
			m_FTGMParam.m_nPType = vstrParam.size();
			m_FTGMParam.P1 = atoi(vstrParam[0]);
			m_FTGMParam.P2 = 0;
			m_FTGMParam.P3 = 0;
			m_FTGMParam.P4 = 0;
		}
		else if (vstrParam.size() == m_FTGMParam.m_nPNum - 2)	// 如果只有2个参数时
		{
			m_FTGMParam.m_nPType = vstrParam.size();
			m_FTGMParam.P1 = atoi(vstrParam[0]);
			m_FTGMParam.P2 = atoi(vstrParam[1]);
			m_FTGMParam.P3 = 0;
			m_FTGMParam.P4 = 0;
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdTargetSearchFTGM;
	}
	else if (strName == m_FTGSParam.m_strCmd)
	{
		// 		if (vstrParam.size() != m_FTGSParam.m_nPNum)
		// 		{
		// 			return eCmdUnknow;
		// 		}
		// 		m_FTGSParam.P1 = atoi(vstrParam[0]);

		if (vstrParam.size() == m_FTGSParam.m_nPNum)	// 如果有4个参数时
		{
			m_FTGSParam.m_nPType = vstrParam.size();
			m_FTGSParam.P1 = atoi(vstrParam[0]);

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[1]);
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FTGSParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FTGSParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FTGSParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}		
		}
		else if (vstrParam.size() == m_FTGSParam.m_nPNum - 3)	// 如果只有1个参数时
		{
			m_FTGSParam.m_nPType = vstrParam.size();
			m_FTGSParam.P1 = atoi(vstrParam[0]);
			m_FTGSParam.P2 = 0;
			m_FTGSParam.P3 = 0;
			m_FTGSParam.P4 = 0;
		}
		else if (vstrParam.size() == m_FTGSParam.m_nPNum - 2)	// 如果只有2个参数时
		{
			m_FTGSParam.m_nPType = vstrParam.size();
			m_FTGSParam.P1 = atoi(vstrParam[0]);
			m_FTGSParam.P2 = atoi(vstrParam[1]);
			m_FTGSParam.P3 = 0;
			m_FTGSParam.P4 = 0;
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdTargetSearchFTGS;
	}
	else if (strName == m_FTGCParam.m_strCmd)
	{
		// 		if (vstrParam.size() != m_FTGCParam.m_nPNum)
		// 		{
		// 			return eCmdUnknow;
		// 		}
		// 		m_FTGCParam.P1 = atoi(vstrParam[0]);
		// 		m_FTGCParam.P2 = atoi(vstrParam[1]);
		if (vstrParam.size() == m_FTGCParam.m_nPNum - 3)	// 如果只有2个参数时
		{
			m_FTGCParam.m_nPType = vstrParam.size();
			m_FTGCParam.P1 = atoi(vstrParam[0]);
			m_FTGCParam.P2 = atoi(vstrParam[1]);
			m_FTGCParam.P3 = 0;
			m_FTGCParam.P4 = 0;
			m_FTGCParam.P5 = 0;
			m_FTGCParam.nP3 = 0;
			m_FTGCParam.nP4 = 0;
			m_FTGCParam.nP5 = 0;

		}
		else if (vstrParam.size() == m_FTGCParam.m_nPNum)	// 如果有5个参数时
		{
			m_FTGCParam.m_nPType = vstrParam.size();
			m_FTGCParam.P1 = atoi(vstrParam[0]);
			m_FTGCParam.P2 = atoi(vstrParam[1]);
			m_FTGCParam.nP3 = 0;
			m_FTGCParam.nP4 = 0;
			m_FTGCParam.nP5 = 0;
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FTGCParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FTGCParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FTGCParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}		
		}// 如果只有5个参数时

		else if (vstrParam.size() == m_FTGCParam.m_nPNum +1)	// 如果只有6个参数时
		{
			m_FTGCParam.m_nPType = vstrParam.size();
			m_FTGCParam.P1 = atoi(vstrParam[0]);
			m_FTGCParam.P2 = atoi(vstrParam[1]);
			m_FTGCParam.nP3 = atoi(vstrParam[2]);
			m_FTGCParam.nP4 = 0;
			m_FTGCParam.nP5 = 0;
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			vstrAxisPos.push_back(vstrParam[5]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FTGCParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FTGCParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FTGCParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}
		}
		else if (vstrParam.size() == m_FTGCParam.m_nPNum +2) // nP4为产品序号
		{
			m_FTGCParam.m_nPType = vstrParam.size();
			m_FTGCParam.P1 = atoi(vstrParam[0]);
			m_FTGCParam.P2 = atoi(vstrParam[1]);
			m_FTGCParam.nP3 = atoi(vstrParam[2]);
			m_FTGCParam.nP4 = atoi(vstrParam[3]);
			m_FTGCParam.nP5 = 0;
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[4]);
			vstrAxisPos.push_back(vstrParam[5]);
			vstrAxisPos.push_back(vstrParam[6]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FTGCParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FTGCParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FTGCParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}
		}
		else if (vstrParam.size() == m_FTGCParam.m_nPNum +3) // nP4为产品序号
		{
			m_FTGCParam.m_nPType = vstrParam.size();
			m_FTGCParam.P1 = atoi(vstrParam[0]);
			m_FTGCParam.P2 = atoi(vstrParam[1]);
			m_FTGCParam.nP3 = atoi(vstrParam[2]);
			m_FTGCParam.nP4 = atoi(vstrParam[3]);
			m_FTGCParam.nP5 = atoi(vstrParam[4]);
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[5]);
			vstrAxisPos.push_back(vstrParam[6]);
			vstrAxisPos.push_back(vstrParam[7]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FTGCParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FTGCParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FTGCParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdTargetSearchFTGC;
	}
	else if (strName == m_FTGRParam.m_strCmd)
	{
		if (vstrParam.size() != m_FTGRParam.m_nPNum)
		{
			return eCmdUnknow;
		}
		m_FTGRParam.P1 = atoi(vstrParam[0]);
		m_FTGRParam.P2 = atof(vstrParam[1])/100.0;
		m_FTGRParam.P3 = atof(vstrParam[2])/100.0;

		return eCmdSaveTargetPosFTGR;
	}
	else if (strName == m_FTGGParam.m_strCmd)
	{
		if (vstrParam.size() != m_FTGGParam.m_nPNum)
		{
			return eCmdUnknow;
		}
		m_FTGGParam.P1 = atoi(vstrParam[0]);

		return eCmdGetTargetImagePosFTGG;
	}
	else if (strName == m_FGAPParam.m_strCmd)
	{
		if (vstrParam.size() == m_FGAPParam.m_nPNum)	// 如果有5个参数时
		{
			m_FGAPParam.m_nPType = vstrParam.size();
			m_FGAPParam.P1 = atoi(vstrParam[0]);	
			m_FGAPParam.P2 = atoi(vstrParam[1]);

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FGAPParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FGAPParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FGAPParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}	

		}
		else if (vstrParam.size() == m_FGAPParam.m_nPNum - 3)	// 如果只有2个参数时
		{
			m_FGAPParam.m_nPType = vstrParam.size();
			m_FGAPParam.P1 = atoi(vstrParam[0]);
			m_FGAPParam.P2 = atoi(vstrParam[1]);
			m_FGAPParam.P3 = 0;
			m_FGAPParam.P4 = 0;
			m_FGAPParam.P5 = 0;
		}
		else if (vstrParam.size() == m_FGAPParam.m_nPNum - 4)	// 如果只有1个参数时
		{
			m_FGAPParam.m_nPType = vstrParam.size();
			m_FGAPParam.P1 = atoi(vstrParam[0]);
			m_FGAPParam.P2 = 1;
			m_FGAPParam.P3 = 0;
			m_FGAPParam.P4 = 0;
			m_FGAPParam.P5 = 0;
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdGetImagePosFGAP;
	}
	else if (strName == m_FGTCParam.m_strCmd)
	{
		if (vstrParam.size() == m_FGTCParam.m_nPNum)	// 如果有5个参数时
		{
			m_FGTCParam.m_nPType = vstrParam.size();
			m_FGTCParam.P1 = atoi(vstrParam[0]);	
			m_FGTCParam.P2 = atoi(vstrParam[1]);

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FGTCParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FGTCParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FGTCParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}	

		}
		else if (vstrParam.size() == m_FGTCParam.m_nPNum - 3)	// 如果只有2个参数时
		{
			m_FGTCParam.m_nPType = vstrParam.size();
			m_FGTCParam.P1 = atoi(vstrParam[0]);
			m_FGTCParam.P2 = atoi(vstrParam[1]);
			m_FGTCParam.P3 = 0;
			m_FGTCParam.P4 = 0;
			m_FGTCParam.P5 = 0;
		}
		else if (vstrParam.size() == m_FGTCParam.m_nPNum - 4)	// 如果只有1个参数时
		{
			m_FGTCParam.m_nPType = vstrParam.size();
			m_FGTCParam.P1 = atoi(vstrParam[0]);
			m_FGTCParam.P2 = 1;
			m_FGTCParam.P3 = 0;
			m_FGTCParam.P4 = 0;
			m_FGTCParam.P5 = 0;
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdGetImagePosFGTC;
	}
	else if (strName == m_FTGDParam.m_strCmd)
	{
		if (vstrParam.size() != m_FTGDParam.m_nPNum)
		{
			return eCmdUnknow;
		}
		m_FTGDParam.P1 = atoi(vstrParam[0]);

		return eCmdDisplayTargetFTGD;
	}
	else if (strName == m_FCNTParam.m_strCmd)
	{
		if (vstrParam.size() == m_FCNTParam.m_nPNum)	// 如果有4个参数时
		{
			m_FCNTParam.m_nPType = vstrParam.size();
			m_FCNTParam.P1 = atoi(vstrParam[0]);

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[1]);
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FCNTParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FCNTParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FCNTParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}		
		}
		else if (vstrParam.size() == m_FCNTParam.m_nPNum - 3)	// 如果只有1个参数时
		{
			m_FCNTParam.m_nPType = vstrParam.size();
			m_FCNTParam.P1 = atoi(vstrParam[0]);
			m_FCNTParam.P2 = 0;
			m_FCNTParam.P3 = 0;
			m_FCNTParam.P4 = 0;
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdObjectSearchFCNT;
	}

	else if (strName == m_FCNOParam.m_strCmd)
	{
		if (vstrParam.size() == m_FCNOParam.m_nPNum)	// 如果有4个参数时
		{
			m_FCNOParam.m_nPType = vstrParam.size();
			m_FCNOParam.P1 = atoi(vstrParam[0]);

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[1]);
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FCNOParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FCNOParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FCNOParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}		
		}
		else if (vstrParam.size() == m_FCNOParam.m_nPNum - 3)	// 如果只有1个参数时
		{
			m_FCNOParam.m_nPType = vstrParam.size();
			m_FCNOParam.P1 = atoi(vstrParam[0]);
			m_FCNOParam.P2 = 0;
			m_FCNOParam.P3 = 0;
			m_FCNOParam.P4 = 0;
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdTargetSearchFCNO;
	}

	else if (strName == m_FOBJParam.m_strCmd)
	{
		// 		if (vstrParam.size() != m_FOBJParam.m_nPNum)
		// 		{
		// 			return eCmdUnknow;
		// 		}
		// 		m_FOBJParam.P1 = atoi(vstrParam[0]);
		if (vstrParam.size() == m_FOBJParam.m_nPNum - 3) // 1个参数
		{
			m_FOBJParam.m_nPType = vstrParam.size();
			m_FOBJParam.P1 = atoi(vstrParam[0]);
			m_FOBJParam.P2 = 0;
			m_FOBJParam.P3 = 0;
			m_FOBJParam.P4 = 0;

			m_FOBJParam.nP2 = 0;
			m_FOBJParam.nP3 = 0;
			m_FOBJParam.nP4 = 0;

		}
		else if (vstrParam.size() == m_FOBJParam.m_nPNum)	// 如果有4个参数时
		{
			m_FOBJParam.m_nPType = vstrParam.size();
			m_FOBJParam.P1 = atoi(vstrParam[0]);
			m_FOBJParam.nP2 = 0;
			m_FOBJParam.nP3 = 0;
			m_FOBJParam.nP4 = 0;

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[1]);
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FOBJParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FOBJParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FOBJParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}		
		}

		else if (vstrParam.size() == m_FOBJParam.m_nPNum +1)	// 如果只有5个参数时
		{
			m_FOBJParam.m_nPType = vstrParam.size();
			m_FOBJParam.P1 = atoi(vstrParam[0]);
			m_FOBJParam.nP2 = atoi(vstrParam[1]);
			m_FOBJParam.nP3 = 0;
			m_FOBJParam.nP4 = 0;
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FOBJParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FOBJParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FOBJParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}
		}
		else if (vstrParam.size() == m_FOBJParam.m_nPNum +2)	// 如果只有6个参数时
		{
			m_FOBJParam.m_nPType = vstrParam.size();
			m_FOBJParam.P1 = atoi(vstrParam[0]);
			m_FOBJParam.nP2 = atoi(vstrParam[1]);
			m_FOBJParam.nP3 = atoi(vstrParam[2]);
			m_FOBJParam.nP4 = 0;
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			vstrAxisPos.push_back(vstrParam[5]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FOBJParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FOBJParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FOBJParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}
		}
		else if (vstrParam.size() == m_FOBJParam.m_nPNum +3)	// 如果只有7个参数时
		{
			m_FOBJParam.m_nPType = vstrParam.size();
			m_FOBJParam.P1 = atoi(vstrParam[0]);
			m_FOBJParam.nP2 = atoi(vstrParam[1]);
			m_FOBJParam.nP3 = atoi(vstrParam[2]);
			m_FOBJParam.nP4 = atoi(vstrParam[3]);
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[4]);
			vstrAxisPos.push_back(vstrParam[5]);
			vstrAxisPos.push_back(vstrParam[6]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FOBJParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FOBJParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FOBJParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdObjectSearchFOBJ;
	}
	else if (strName == m_FOBMParam.m_strCmd)
	{
		if (vstrParam.size() == m_FOBMParam.m_nPNum)	// 如果有4个参数时
		{
			m_FOBMParam.m_nPType = vstrParam.size();
			m_FOBMParam.P1 = atoi(vstrParam[0]);

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[1]);
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FOBMParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FOBMParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FOBMParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}		
		}
		else if (vstrParam.size() == m_FOBMParam.m_nPNum - 3)	// 如果只有1个参数时
		{
			m_FOBMParam.m_nPType = vstrParam.size();
			m_FOBMParam.P1 = atoi(vstrParam[0]);
			m_FOBMParam.P2 = 0;
			m_FOBMParam.P3 = 0;
			m_FOBMParam.P4 = 0;
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdObjectSearchFOBM;
	}
	else if (strName == m_FOBCParam.m_strCmd)
	{
		// 		if (vstrParam.size() != m_FOBCParam.m_nPNum)
		// 		{
		// 			return eCmdUnknow;
		// 		}
		// 		m_FOBCParam.P1 = atoi(vstrParam[0]);
		// 		m_FOBCParam.P2 = atoi(vstrParam[1]);
		if (vstrParam.size() == m_FOBCParam.m_nPNum - 4)	// 如果只有2个参数时
		{
			m_FOBCParam.m_nPType = vstrParam.size();
			m_FOBCParam.P1 = atoi(vstrParam[0]);
			m_FOBCParam.P2 = atoi(vstrParam[1]);
			m_FOBCParam.nP3 = 0;
			m_FOBCParam.nP4 = 0;
			m_FOBCParam.nP5 = 0;
			m_FOBCParam.P3 = 0;
			m_FOBCParam.P4 = 0;
			m_FOBCParam.P5 = 0;
		}
		else if (vstrParam.size() == m_FOBCParam.m_nPNum-1)	// 如果有5个参数时
		{
			m_FOBCParam.m_nPType = vstrParam.size();
			m_FOBCParam.P1 = atoi(vstrParam[0]);
			m_FOBCParam.P2 = atoi(vstrParam[1]);
			m_FOBCParam.nP3 = 0;
			m_FOBCParam.nP4 = 0;
			m_FOBCParam.nP5 = 0;

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FOBCParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FOBCParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FOBCParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}		
		}
		else if (vstrParam.size() == m_FOBCParam.m_nPNum)	// 如果有6个参数时
		{
			m_FOBCParam.m_nPType = vstrParam.size();
			m_FOBCParam.P1 = atoi(vstrParam[0]);
			m_FOBCParam.P2 = atoi(vstrParam[1]);
			m_FOBCParam.nP3 = atoi(vstrParam[2]);
			m_FOBCParam.nP4 = 0;
			m_FOBCParam.nP5 = 0;
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			vstrAxisPos.push_back(vstrParam[5]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FOBCParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FOBCParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FOBCParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}		
		}
		else if (vstrParam.size() == m_FOBCParam.m_nPNum+1)	// 如果有7个参数时
		{
			m_FOBCParam.m_nPType = vstrParam.size();
			m_FOBCParam.P1 = atoi(vstrParam[0]);
			m_FOBCParam.P2 = atoi(vstrParam[1]);
			m_FOBCParam.nP3 = atoi(vstrParam[2]);
			m_FOBCParam.nP4 = atoi(vstrParam[3]);
			m_FOBCParam.nP5 = 0;
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[4]);
			vstrAxisPos.push_back(vstrParam[5]);
			vstrAxisPos.push_back(vstrParam[6]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FOBCParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FOBCParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FOBCParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}		
		}
		else if (vstrParam.size() == m_FOBCParam.m_nPNum+2)	// 如果有8个参数时
		{
			m_FOBCParam.m_nPType = vstrParam.size();
			m_FOBCParam.P1 = atoi(vstrParam[0]);
			m_FOBCParam.P2 = atoi(vstrParam[1]);
			m_FOBCParam.nP3 = atoi(vstrParam[2]);
			m_FOBCParam.nP4 = atoi(vstrParam[3]);
			m_FOBCParam.nP5 = atoi(vstrParam[4]);
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[5]);
			vstrAxisPos.push_back(vstrParam[6]);
			vstrAxisPos.push_back(vstrParam[7]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FOBCParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FOBCParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FOBCParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}		
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdObjectSearchFOBC;
	}
	else if (strName == m_FPMIParam.m_strCmd)
	{
		if (vstrParam.size() == m_FPMIParam.m_nPNum) // 如果只有1个参数时
		{
			m_FPMIParam.m_nPType = vstrParam.size();
			m_FPMIParam.P1 = atoi(vstrParam[0]);

		}
		else if (vstrParam.size() == m_FPMIParam.m_nPNum - 1)//如果没有参数时
		{
			m_FPMIParam.m_nPType = vstrParam.size();
			m_FPMIParam.P1 = 1200;	//默认20分钟
		}
		else
		{
			return eCmdUnknow;
		}
		return eCmdObjectSearchFPMI;
	}
	else if (strName == m_FBISParam.m_strCmd)
	{
		if (vstrParam.size() == m_FBISParam.m_nPNum) // 如果只有4个参数时
		{
			m_FBISParam.m_nPType = vstrParam.size();
			m_FBISParam.P1 = atoi(vstrParam[0]);
			m_FBISParam.P2 = atoi(vstrParam[1]);
			m_FBISParam.P3 = atoi(vstrParam[2]);
			m_FBISParam.P4 = atoi(vstrParam[3]);


		}
		else if (vstrParam.size() == m_FBISParam.m_nPNum - 1)//如果只有3个参数时
		{
			m_FBISParam.m_nPType = vstrParam.size();
			m_FBISParam.P1 = atoi(vstrParam[0]);
			m_FBISParam.P2 = atoi(vstrParam[1]);
			m_FBISParam.P3 = atoi(vstrParam[2]);
			
		}
		else if (vstrParam.size() == m_FBISParam.m_nPNum - 2)//如果只有2个参数时
		{
			m_FBISParam.m_nPType = vstrParam.size();
			m_FBISParam.P1 = atoi(vstrParam[0]);
			m_FBISParam.P2 = atoi(vstrParam[1]);
		}
		else
		{
			return eCmdUnknow;
		}
		return eCmdACFInspectFBIS;
	}
	else if (strName == m_FOBGParam.m_strCmd)
	{
		if (vstrParam.size() != m_FOBGParam.m_nPNum)
		{
			return eCmdUnknow;
		}
		m_FOBGParam.P1 = atoi(vstrParam[0]);

		return eCmdGetObjectImagePosFOBG;
	}
	else if (strName == m_FMSCParam.m_strCmd)
	{
		if (vstrParam.size() != m_FMSCParam.m_nPNum)
		{
			return eCmdUnknow;
		}
		m_FMSCParam.P1 = atoi(vstrParam[0]);

		return eCmdManualSearchFMSC;
	}
	else if (strName == m_FWLDParam.m_strCmd)
	{
		if (vstrParam.size() != m_FWLDParam.m_nPNum)
		{
			return eCmdUnknow;
		}
		m_FWLDParam.P1 = atoi(vstrParam[0]);
		m_FWLDParam.P2 = atoi(vstrParam[1]);

		return eCmdGetSearchWorldPosFWLD;
	}
	else if (strName == m_FWDRParam.m_strCmd)
	{
		if (vstrParam.size() != m_FWDRParam.m_nPNum)
		{
			return eCmdUnknow;
		}
		m_FWDRParam.P1 = atoi(vstrParam[0]);
		m_FWDRParam.P2 = atoi(vstrParam[1]);

		return eCmdFWDR;
	}
	else if (strName == m_FGOWParam.m_strCmd)
	{
		// 		if (vstrParam.size() != m_FGOWParam.m_nPNum)
		// 		{
		// 			return eCmdUnknow;
		// 		}
		// 		m_FGOWParam.P1 = atoi(vstrParam[0]);
		// 		m_FGOWParam.P2 = atoi(vstrParam[1]);

		if (vstrParam.size() == m_FGOWParam.m_nPNum)	// 如果有5个参数时
		{
			m_FGOWParam.m_nPType = vstrParam.size();
			m_FGOWParam.P1 = atoi(vstrParam[0]);
			m_FGOWParam.P2 = atoi(vstrParam[1]);

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FGOWParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FGOWParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FGOWParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}		
		}
		else if (vstrParam.size() == m_FGOWParam.m_nPNum - 3)	// 如果只有2个参数时
		{
			m_FGOWParam.m_nPType = vstrParam.size();
			m_FGOWParam.P1 = atoi(vstrParam[0]);
			m_FGOWParam.P2 = atoi(vstrParam[1]);
			m_FGOWParam.P3 = 0;
			m_FGOWParam.P4 = 0;
			m_FGOWParam.P5 = 0;
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdGetObjectWorldPosFGOW;
	}
	else if (strName == m_FGALParam.m_strCmd)
	{
		if (vstrParam.size() != m_FGALParam.m_nPNum)
		{
			return eCmdUnknow;
		}
		m_FGALParam.P1 = atoi(vstrParam[0]);

		return eCmdGetAlignPrecisionFGAL;
	}
	else if (strName == m_FALLParam.m_strCmd)
	{
		if (vstrParam.size() == m_FALLParam.m_nPNum)	// 如果有4个参数时
		{
			m_FALLParam.m_nPType = vstrParam.size();
			m_FALLParam.P1 = atoi(vstrParam[0]);

			/*std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[1]);
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);*/

			m_CurPlatformXYDAxisPosBackup.m_dPosX  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			m_CurPlatformXYDAxisPosBackup.m_dPosY  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			m_CurPlatformXYDAxisPosBackup.m_dAngle  = atof(vstrParam[3])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);

			//if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPosBackup))
			//{
			m_FALLParam.P2 = m_CurPlatformXYDAxisPosBackup.m_dPosX;
			m_FALLParam.P3 = m_CurPlatformXYDAxisPosBackup.m_dPosY;
			m_FALLParam.P4 = m_CurPlatformXYDAxisPosBackup.m_dAngle;
			// }
			// else
			// {
			// return eCmdUnknow;
			// }	
		}
		else if (vstrParam.size() == m_FALLParam.m_nPNum - 3)	// 如果只有1个参数时
		{
			m_FALLParam.m_nPType = vstrParam.size();
			m_FALLParam.P1 = atoi(vstrParam[0]);
			m_FALLParam.P2 = 0;
			m_FALLParam.P3 = 0;
			m_FALLParam.P4 = 0;
		}
		else
		{
			return eCmdUnknow;
		}
		return eCmdSetAlignPrecisionFALL;
	}
	else if (strName == m_FGACParam.m_strCmd)
	{
		if (vstrParam.size() != m_FGACParam.m_nPNum)
		{
			return eCmdUnknow;
		}

		return eCmdGetAlignTimeFGAC;
	}
	else if (strName == m_FALCParam.m_strCmd)
	{
		if (vstrParam.size() != m_FALCParam.m_nPNum)
		{
			return eCmdUnknow;
		}
		m_FALCParam.P1 = atoi(vstrParam[0]);

		return eCmdSetAlignTimeFALC;
	}
	// 对位
	else if (strName == m_FAALParam.m_strCmd)
	{
		if (vstrParam.size() == m_FAALParam.m_nPNum - 3)	// 如果只有1个参数时
		{
			m_FAALParam.m_nPType = vstrParam.size();
			m_FAALParam.P1 = atoi(vstrParam[0]);
			m_FAALParam.P2 = 0;
			m_FAALParam.P3 = 0;
			m_FAALParam.P4 = 0;

			m_FAALParam.nP2 = 10;
			m_FAALParam.nP3 = 0;
			m_FAALParam.nP4 = 1;
		}
		else if (vstrParam.size() == m_FAALParam.m_nPNum)// 如果有4个参数时
		{
			// 带轴位置的
			m_FAALParam.m_nPType = vstrParam.size();
			m_FAALParam.P1 = atoi(vstrParam[0]);

			m_FAALParam.nP2 = 10;
			m_FAALParam.nP3 = 0;
			m_FAALParam.nP4 = 1;

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[1]);
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FAALParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FAALParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FAALParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}							

		}
		else if (vstrParam.size() == m_FAALParam.m_nPNum+1)// 如果有5个参数时
		{
			// 带轴位置的
			m_FAALParam.m_nPType = vstrParam.size();
			m_FAALParam.P1 = atoi(vstrParam[0]);

			m_FAALParam.nP2 = atoi(vstrParam[1]);
			m_FAALParam.nP3 = 0;
			m_FAALParam.nP4 = 1;

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FAALParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FAALParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FAALParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}							

		}
		else if (vstrParam.size() == m_FAALParam.m_nPNum+3)	// 如果有7个参数时
		{
			// 带轴位置的
			m_FAALParam.m_nPType = vstrParam.size();
			m_FAALParam.P1 = atoi(vstrParam[0]);
			m_FAALParam.nP2 = atoi(vstrParam[1]);
			m_FAALParam.nP3 = atoi(vstrParam[2]);
			m_FAALParam.nP4 = atoi(vstrParam[3]);

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[4]);
			vstrAxisPos.push_back(vstrParam[5]);
			vstrAxisPos.push_back(vstrParam[6]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FAALParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FAALParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FAALParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}		
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdAutoAlignFAAL;
	}
	else if (strName == m_FXYAParam.m_strCmd)
	{
		if (vstrParam.size() == m_FXYAParam.m_nPNum)	// 如果有5个参数时
		{
			m_FXYAParam.m_nPType = vstrParam.size();
			m_FXYAParam.P1 = atoi(vstrParam[0]);
			m_FXYAParam.P2 = atoi(vstrParam[1]);

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FXYAParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FXYAParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FXYAParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}		
		}
		else if (vstrParam.size() == m_FXYAParam.m_nPNum - 3)	// 如果只有2个参数时
		{
			m_FXYAParam.m_nPType = vstrParam.size();
			m_FXYAParam.P1 = atoi(vstrParam[0]);
			m_FXYAParam.P2 = atoi(vstrParam[1]);
			m_FXYAParam.P3 = 0;
			m_FXYAParam.P4 = 0;
			m_FXYAParam.P5 = 0;
		}
		else if (vstrParam.size() == m_FXYAParam.m_nPNum - 2)	// 如果只有3个参数时
		{
			m_FXYAParam.m_nPType = vstrParam.size();
			m_FXYAParam.P1 = atoi(vstrParam[0]);
			m_FXYAParam.P2 = atoi(vstrParam[1]);
			m_FXYAParam.P3 = atoi(vstrParam[2]);
			m_FXYAParam.P4 = 0;
			m_FXYAParam.P5 = 0;
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdAutoAlignFXYA;
	}
	else if (strName == m_FAABParam.m_strCmd)
	{
		if (vstrParam.size() == m_FAABParam.m_nPNum)	// 如果有4个参数时
		{
			m_FAABParam.m_nPType = vstrParam.size();
			m_FAABParam.P1 = atoi(vstrParam[0]);

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[1]);
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FAABParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FAABParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FAABParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}		
		}
		else if (vstrParam.size() == m_FAABParam.m_nPNum - 3)	// 如果只有1个参数时
		{
			m_FAABParam.m_nPType = vstrParam.size();
			m_FAABParam.P1 = atoi(vstrParam[0]);
			m_FAABParam.P2 = 0;
			m_FAABParam.P3 = 0;
			m_FAABParam.P4 = 0;
		}
		else if (vstrParam.size() == m_FAABParam.m_nPNum - 2)	// 如果只有2个参数时
		{
			m_FAABParam.m_nPType = vstrParam.size();
			m_FAABParam.P1 = atoi(vstrParam[0]);
			m_FAABParam.P2 = atoi(vstrParam[1]);
			m_FAABParam.P3 = 0;
			m_FAABParam.P4 = 0;
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdAutoAlignFAAB;
	}
	else if (strName == m_FACBParam.m_strCmd)
	{
		if (vstrParam.size() == m_FACBParam.m_nPNum)	// 如果有4个参数时
		{
			m_FACBParam.m_nPType = vstrParam.size();
			m_FACBParam.P1 = atoi(vstrParam[0]);
			m_FACBParam.P2 = atoi(vstrParam[1]);
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FACBParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FACBParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FACBParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}		
		}
		else if (vstrParam.size() == m_FACBParam.m_nPNum - 3)	// 如果只有1个参数时
		{
			m_FACBParam.m_nPType = vstrParam.size();
			m_FACBParam.P1 = atoi(vstrParam[0]);
			m_FACBParam.P2 = atoi(vstrParam[1]);
			m_FACBParam.P3 = 0;
			m_FACBParam.P4 = 0;
			m_FACBParam.P5 = 0;
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdAutoAlignFACB;
	}
	else if (strName == m_FAACParam.m_strCmd)
	{
		if (vstrParam.size() == m_FAACParam.m_nPNum - 5)	// 如果只有2个参数时
		{
			m_FAACParam.m_nPType = vstrParam.size();
			m_FAACParam.P1 = atoi(vstrParam[0]);
			m_FAACParam.P2 = atoi(vstrParam[1]);

			m_FAACParam.nP3 = -1;
			m_FAACParam.nP4 = 0;

			m_FAACParam.P3 = 0;
			m_FAACParam.P4 = 0;
			m_FAACParam.P5 = 0;
		}
		else if (vstrParam.size() == m_FAACParam.m_nPNum-2)	// 如果只有5个参数时
		{
			// 带有轴位置参数
			m_FAACParam.m_nPType = vstrParam.size();
			m_FAACParam.P1 = atoi(vstrParam[0]);
			m_FAACParam.P2 = atoi(vstrParam[1]);

			m_FAACParam.nP3 = 0;
			m_FAACParam.nP4 = 0;

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FAACParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FAACParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FAACParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}

		}
		else if (vstrParam.size() == m_FAACParam.m_nPNum-1)	// 如果只有7个参数时
		{
			// 带有轴位置参数
			m_FAACParam.m_nPType = vstrParam.size();
			m_FAACParam.P1 = atoi(vstrParam[0]);
			m_FAACParam.P2 = atoi(vstrParam[1]);

			m_FAACParam.nP3 = atoi(vstrParam[2]);
			m_FAACParam.nP4 = 0;

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			vstrAxisPos.push_back(vstrParam[5]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FAACParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FAACParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FAACParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}

		}
		else if (vstrParam.size() == m_FAACParam.m_nPNum)	// 如果只有7个参数时
		{
			// 带有轴位置参数
			m_FAACParam.m_nPType = vstrParam.size();
			m_FAACParam.P1 = atoi(vstrParam[0]);
			m_FAACParam.P2 = atoi(vstrParam[1]);

			m_FAACParam.nP3 = atoi(vstrParam[2]);
			m_FAACParam.nP4 = atoi(vstrParam[3]);

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[4]);
			vstrAxisPos.push_back(vstrParam[5]);
			vstrAxisPos.push_back(vstrParam[6]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FAACParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FAACParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FAACParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}

		}
		else
		{
			return eCmdUnknow;
		}	

		// 		if (vstrParam.size() == m_FAACParam.m_nPNum)	// 如果有5个参数时
		// 		{
		// 			m_FAACParam.m_nPType = vstrParam.size();
		// 			m_FAACParam.P1 = atoi(vstrParam[0]);
		// 			m_FAACParam.P2 = atoi(vstrParam[1]);
		// 
		// 			std::vector<CString> vstrAxisPos;
		// 			vstrAxisPos.push_back(vstrParam[2]);
		// 			vstrAxisPos.push_back(vstrParam[3]);
		// 			vstrAxisPos.push_back(vstrParam[4]);
		// 			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
		// 			{
		// 				m_FAACParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
		// 				m_FAACParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
		// 				m_FAACParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
		// 			}
		// 			else
		// 			{
		// 				return eCmdUnknow;
		// 			}		
		// 		}
		// 		else if (vstrParam.size() == m_FAACParam.m_nPNum - 3)	// 如果只有2个参数时
		// 		{
		// 			m_FAACParam.m_nPType = vstrParam.size();
		// 			m_FAACParam.P1 = atoi(vstrParam[0]);
		// 			m_FAACParam.P2 = atoi(vstrParam[1]);
		// 			m_FAACParam.P3 = 0;
		// 			m_FAACParam.P4 = 0;
		// 			m_FAACParam.P5 = 0;
		// 		}
		// 		else if (vstrParam.size() == m_FAACParam.m_nPNum - 2)	// 如果只有3个参数时
		// 		{
		// 			m_FAACParam.m_nPType = vstrParam.size();
		// 			m_FAACParam.P1 = atoi(vstrParam[0]);
		// 			m_FAACParam.P2 = atoi(vstrParam[1]);
		// 			m_FAACParam.P3 = atoi(vstrParam[2]);
		// 			m_FAACParam.P4 = 0;
		// 			m_FAACParam.P5 = 0;
		// 		}
		// 		else
		// 		{
		// 			return eCmdUnknow;
		// 		}
		// // 
		// // 		if (vstrParam.size() != m_FAACParam.m_nPNum)
		// // 		{
		// // 			return eCmdUnknow;
		// // 		}
		// // 		m_FAACParam.P1 = atoi(vstrParam[0]);
		// // 		m_FAACParam.P2 = atoi(vstrParam[1]);

		return eCmdAutoAlignFAAC;
	}
	else if (strName == m_FAOTParam.m_strCmd)
	{
		if (vstrParam.size() == m_FAOTParam.m_nPNum)	// 如果有5个参数时
		{
			m_FAOTParam.m_nPType = vstrParam.size();
			m_FAOTParam.P1 = atoi(vstrParam[0]);
			m_FAOTParam.P2 = atoi(vstrParam[1]);

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FAOTParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FAOTParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FAOTParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}		
		}
		else if (vstrParam.size() == m_FAOTParam.m_nPNum - 3)	// 如果只有2个参数时
		{
			m_FAOTParam.m_nPType = vstrParam.size();
			m_FAOTParam.P1 = atoi(vstrParam[0]);
			m_FAOTParam.P2 = atoi(vstrParam[1]);
			m_FAOTParam.P3 = 0;
			m_FAOTParam.P4 = 0;
			m_FAOTParam.P5 = 0;
		}
		else
		{
			return eCmdUnknow;
		}


		return eCmdAutoAlignFAOT;
	}
	else if (strName == m_FALXParam.m_strCmd)
	{
		if (vstrParam.size() == m_FALXParam.m_nPNum)	// 如果有5个参数时
		{
			m_FALXParam.m_nPType = vstrParam.size();
			m_FALXParam.P1 = atoi(vstrParam[0]);
			m_FALXParam.P2 = atoi(vstrParam[1]);

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FALXParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FALXParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FALXParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}		
		}
		else if (vstrParam.size() == m_FALXParam.m_nPNum - 3)	// 如果只有2个参数时
		{
			m_FALXParam.m_nPType = vstrParam.size();
			m_FALXParam.P1 = atoi(vstrParam[0]);
			m_FALXParam.P2 = atoi(vstrParam[1]);
			m_FALXParam.P3 = 0;
			m_FALXParam.P4 = 0;
			m_FALXParam.P5 = 0;
		}
		else
		{
			return eCmdUnknow;
		}


		return eCmdAutoAlignFALX;
	}
	else if (strName == m_FAHLParam.m_strCmd)
	{
		if (vstrParam.size() == m_FAHLParam.m_nPNum)	// 如果有4个参数时
		{
			m_FAHLParam.m_nPType = vstrParam.size();
			m_FAHLParam.P1 = atoi(vstrParam[0]);

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[1]);
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FAHLParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FAHLParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FAHLParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}		
		}
		else if (vstrParam.size() == m_FAHLParam.m_nPNum - 3)	// 如果只有1个参数时
		{
			m_FAHLParam.m_nPType = vstrParam.size();
			m_FAHLParam.P1 = atoi(vstrParam[0]);
			m_FAHLParam.P2 = 0;
			m_FAHLParam.P3 = 0;
			m_FAHLParam.P4 = 0;
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdAutoAlignFAHL;
	}
	else if (strName == m_FANSParam.m_strCmd)
	{
		if (vstrParam.size() != m_FANSParam.m_nPNum)
		{
			return eCmdUnknow;
		}

		return eCmdGetAutoAlignOffsetFANS;
	}
	else if (strName == m_FALGParam.m_strCmd)
	{
		if (vstrParam.size() == m_FALGParam.m_nPNum)
		{
			m_FALGParam.P1 = atoi(vstrParam[0]);
			m_FALGParam.nP2 = 10;
			m_FALGParam.nP3 = 0;
			m_FALGParam.nP4 = 1;
		}
		else if (vstrParam.size() == m_FALGParam.m_nPNum + 1)
		{
			m_FALGParam.P1 = atoi(vstrParam[0]);
			m_FALGParam.nP2 = atoi(vstrParam[1]);
			m_FALGParam.nP3 = 0;
			m_FALGParam.nP4 = 0;
		}
		else if (vstrParam.size() == m_FALGParam.m_nPNum + 3)
		{
			m_FALGParam.P1 = atoi(vstrParam[0]);
			m_FALGParam.nP2 = atoi(vstrParam[1]);
			m_FALGParam.nP3 = atoi(vstrParam[2]);
			m_FALGParam.nP4 = atoi(vstrParam[3]);
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdOnceAlignMoveFALG;
	}
	else if (strName == m_FALPParam.m_strCmd)
	{
		if (vstrParam.size() == m_FALPParam.m_nPNum)	
		{
			m_FALPParam.m_nPType = vstrParam.size();
			m_FALPParam.P1 = atoi(vstrParam[0]);

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[1]);
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FALPParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FALPParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FALPParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}		
		}
		else if (vstrParam.size() == m_FALPParam.m_nPNum + 1)	
		{
			m_FALPParam.m_nPType = vstrParam.size();
			m_FALPParam.P1 = atoi(vstrParam[0]);
			m_FALPParam.nP2 = atoi(vstrParam[1]);

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FALPParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FALPParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FALPParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}
		}
		else if (vstrParam.size() == m_FALPParam.m_nPNum - 2)	
		{
			m_FALPParam.m_nPType = vstrParam.size();
			m_FALPParam.P1 = atoi(vstrParam[0]);
			m_FALPParam.nP2 = atoi(vstrParam[1]);
			m_FALPParam.P2 = 0;
			m_FALPParam.P3 = 0;
			m_FALPParam.P4 = 0;
		}
		else if (vstrParam.size() == m_FALPParam.m_nPNum - 3)	
		{
			m_FALPParam.m_nPType = vstrParam.size();
			m_FALPParam.P1 = atoi(vstrParam[0]);
			m_FALPParam.P2 = 0;
			m_FALPParam.P3 = 0;
			m_FALPParam.P4 = 0;
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdOnceAlignMovePickFALP;
	}
	else if (strName == m_FALJParam.m_strCmd)
	{
		if (vstrParam.size() != m_FALJParam.m_nPNum)
		{
			return eCmdUnknow;
		}
		m_FALJParam.P1 = atoi(vstrParam[0]);
		m_FALJParam.P2 = atoi(vstrParam[1]);

		return eCmdOnceAlignFALJ;
	}
	else if (strName == m_FACOParam.m_strCmd)
	{
		if (vstrParam.size() == m_FACOParam.m_nPNum)
		{
			m_FACOParam.P1 = atoi(vstrParam[0]);
			m_FACOParam.nP2 = 0;
			m_FACOParam.nP3 = 0;
		}
		else if (vstrParam.size() == m_FACOParam.m_nPNum + 1)
		{
			m_FACOParam.P1 = atoi(vstrParam[0]);
			m_FACOParam.nP2 = atoi(vstrParam[1]);
			m_FACOParam.nP3 = 0;
		}
		else if (vstrParam.size() == m_FACOParam.m_nPNum + 2)
		{
			m_FACOParam.P1 = atoi(vstrParam[0]);
			m_FACOParam.nP2 = atoi(vstrParam[1]);
			m_FACOParam.nP3 = atoi(vstrParam[2]);
		}
		else
		{
			return eCmdUnknow;
		}
		return eCmdGetTargetObjectOffsetFACO;
	}
	else if (strName == m_FAAOParam.m_strCmd)
	{
		if(vstrParam.size() == m_FAAOParam.m_nPNum)
		{
			m_FAAOParam.m_nPType = vstrParam.size();
			m_FAAOParam.P1       = atoi(vstrParam[0]);
			std::vector<CString>vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[1]);
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);

			if(TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos,&m_CurPlatformXYDAxisPos))
			{
				m_FAAOParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FAAOParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FAAOParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}
		}
		else if(vstrParam.size() == m_FAAOParam.m_nPNum - 3)
		{
			m_FAAOParam.m_nPType = vstrParam.size();
			m_FAAOParam.P1       = atoi(vstrParam[0]);
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdGetObjectTargetOffsetFAAO;
	}
	else if (strName == m_FOLCParam.m_strCmd)
	{
		if (vstrParam.size() == m_FOLCParam.m_nPNum)
		{
			m_FOLCParam.m_nPType = vstrParam.size();
			m_FOLCParam.P1 = atoi(vstrParam[0]);
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[1]);
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FOLCParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FOLCParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FOLCParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else if (vstrParam.size() == m_FOLCParam.m_nPNum - 3)	// 如果只有1个参数时
			{
				m_FOLCParam.m_nPType = vstrParam.size();
				m_FOLCParam.P1 = atoi(vstrParam[0]);
				m_FOLCParam.P2 = 0;
				m_FOLCParam.P3 = 0;
				m_FOLCParam.P4 = 0;
			}
			else
			{
				return eCmdUnknow;
			}		
		}
		else
		{
			m_FOLCParam.P1 = 0;
		}


		return eCmdGetTargetObjectOffsetFOLC;
	}
	else if (strName == m_FABOParam.m_strCmd)
	{
		if (vstrParam.size() == m_FABOParam.m_nPNum)
		{
			m_FABOParam.P1 = atoi(vstrParam[0]);
		}
		else
		{
			m_FABOParam.P1 = 0;
		}


		return eCmdGetTargetObjectOffsetFABO;
	}
	else if (strName == m_FAOFParam.m_strCmd)
	{
		if (vstrParam.size() != m_FAOFParam.m_nPNum)
		{
			return eCmdUnknow;
		}
		m_FAOFParam.P1 = atoi(vstrParam[0]);

		return eCmdCalcuAlignOffsetFAOF;
	}
	else if (strName == m_FGOFParam.m_strCmd)
	{
		if (vstrParam.size() != m_FGOFParam.m_nPNum)
		{
			return eCmdUnknow;
		}
		m_FGOFParam.P1 = atoi(vstrParam[0]);

		return eCmdGetAlignOffsetFGOF;
	}
	else if (strName == m_FOFSParam.m_strCmd)
	{
		if (vstrParam.size() == m_FOFSParam.m_nPNum)	// 如果有4个参数时
		{
			m_FOFSParam.m_nPType = m_FOFSParam.m_nPNum;
			m_FOFSParam.P1 = atoi(vstrParam[0]);
			/*std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[1]);
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);*/

			m_CurPlatformXYDAxisPosBackup.m_dPosX  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			m_CurPlatformXYDAxisPosBackup.m_dPosY  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			m_CurPlatformXYDAxisPosBackup.m_dAngle  = atof(vstrParam[3])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);

			//if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPosBackup))
			//{
			m_FOFSParam.P2 = m_CurPlatformXYDAxisPosBackup.m_dPosX;
			m_FOFSParam.P3 = m_CurPlatformXYDAxisPosBackup.m_dPosY;
			m_FOFSParam.P4 = m_CurPlatformXYDAxisPosBackup.m_dAngle;
			//}
			//else
			//{
			//	return eCmdUnknow;
			//}
		}
		else if (vstrParam.size() == m_FOFSParam.m_nPNum - 3)
		{
			m_FOFSParam.m_nPType = vstrParam.size();
			m_FOFSParam.P1 = atoi(vstrParam[0]);
			m_FOFSParam.P2 = 0;
			m_FOFSParam.P3 = 0;
			m_FOFSParam.P4 = 0;
		}
		else
		{
			return eCmdUnknow;
		}
		// 		m_FOFSParam.P1 = atoi(vstrParam[0]);
		// 		m_FOFSParam.P2 = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
		// 		m_FOFSParam.P3 = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
		// 		m_FOFSParam.P4 = atof(vstrParam[3])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);

		return eCmdSetAlignOffsetFOFS;
	}
	else if (strName == m_FSFTParam.m_strCmd)
	{
		if (vstrParam.size() != m_FSFTParam.m_nPNum)
		{
			return eCmdUnknow;
		}
		m_FSFTParam.P1 = atoi(vstrParam[0]);


		return eCmdFSFT;
	}
	else if (strName == m_FGSFParam.m_strCmd)
	{
		if (vstrParam.size() != m_FGSFParam.m_nPNum)
		{
			return eCmdUnknow;
		}
		m_FGSFParam.P1 = atoi(vstrParam[0]);

		return eCmdFGSF;
	}
	else if (strName == m_FGPOParam.m_strCmd)
	{
		if (vstrParam.size() != m_FGPOParam.m_nPNum)
		{
			return eCmdUnknow;
		}

		return eCmdFGPO;
	}
	else if (strName == m_FALMParam.m_strCmd)
	{
		if (vstrParam.size() != m_FALMParam.m_nPNum)
		{
			return eCmdUnknow;
		}

		return eCmdGetAlarmFALM;
	}
	else if (strName == m_FRSTParam.m_strCmd)
	{
		if (vstrParam.size() != m_FRSTParam.m_nPNum)
		{
			return eCmdUnknow;
		}

		return eCmdResetFRST;
	}
	else if (strName == m_FCHKParam.m_strCmd)
	{
		if (vstrParam.size() != m_FCHKParam.m_nPNum)
		{
			return eCmdUnknow;
		}
		m_FCHKParam.P1 = atoi(vstrParam[0]);
		return eCmdSpecialCommFCHK;
	}
	else if (strName == m_FSACParam.m_strCmd)
	{
		if (vstrParam.size() != m_FSACParam.m_nPNum)
		{
			return eCmdUnknow;
		}

		return eCmdSaveProcessDataFSAC;
	}
	else if (strName == m_FSCOParam.m_strCmd)
	{
		if (vstrParam.size() != m_FSCOParam.m_nPNum)
		{
			return eCmdUnknow;
		}

		return eCmdSaveCommDataFSCO;
	}
	else if (strName == m_FCHBParam.m_strCmd)
	{

		if (vstrParam.size() == m_FCHBParam.m_nPNum)	// 如果有2个参数时
		{
			m_FCHBParam.m_nPType = vstrParam.size();
			m_FCHBParam.P1 = atoi(vstrParam[0]);
			m_FCHBParam.P2 = atoi(vstrParam[1]);


		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdACFInspectFCHB;
	}
	else if (strName == m_FCHCParam.m_strCmd)
	{

		if (vstrParam.size() == m_FCHCParam.m_nPNum)	// 如果有3个参数时
		{
			m_FCHCParam.m_nPType = vstrParam.size();
			m_FCHCParam.P1 = atoi(vstrParam[0]);
			m_FCHCParam.P2 = atoi(vstrParam[1]);
			m_FCHCParam.P3 = atoi(vstrParam[2]);

		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdACFInspectFCHC;
	}
	else if (strName == m_FDRPParam.m_strCmd)
	{

		if (vstrParam.size() == m_FDRPParam.m_nPNum)	// 如果有1个参数时
		{
			m_FDRPParam.m_nPType = vstrParam.size();
			m_FDRPParam.P1 = atoi(vstrParam[0]);
			m_FDRPParam.P2 = 1;
		}
		else if (vstrParam.size() == m_FDRPParam.m_nPNum+1)	// 如果有1个参数时
		{
			m_FDRPParam.m_nPType = vstrParam.size();
			m_FDRPParam.P1 = atoi(vstrParam[0]);
			m_FDRPParam.P2 = atoi(vstrParam[1]);
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdFDRP;
	}
	else if (strName == m_MPSBParam.m_strCmd)
	{
		if (vstrParam.size() != m_MPSBParam.m_nPNum)
		{
			return eCmdUnknow;
		}
		return eCmdGetPosBackupMPSB;
	}
	// 设置相机曝光
	else if (strName == m_FSPEParam.m_strCmd)
	{		
		if (vstrParam.size() == m_FSPEParam.m_nPNum)
		{
			m_FSPEParam.m_nPType = vstrParam.size();
			m_FSPEParam.P1 = atoi(vstrParam[0]);
			m_FSPEParam.P2 = atoi(vstrParam[1]);
			m_FSPEParam.P3 = atoi(vstrParam[2]);

		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdSetProductExposureFSPE;
	}
	// 专用焊接指令
	else if (strName == m_FWELParam.m_strCmd)
	{
		if (vstrParam.size() == m_FWELParam.m_nPNum)	// 如果有5个参数时
		{
			m_FWELParam.m_nPType = vstrParam.size();
			m_FWELParam.P1 = atoi(vstrParam[0]);
			m_FWELParam.P2 = atoi(vstrParam[1]);

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FWELParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FWELParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FWELParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}		
		}
		else if (vstrParam.size() == m_FWELParam.m_nPNum - 3)	// 如果只有2个参数时
		{
			m_FWELParam.m_nPType = vstrParam.size();
			m_FWELParam.P1 = atoi(vstrParam[0]);
			m_FWELParam.P2 = atoi(vstrParam[1]);
			m_FWELParam.P3 = 0;
			m_FWELParam.P4 = 0;
			m_FWELParam.P5 = 0;
		}
		else
		{
			return eCmdUnknow;
		}


		return eCmdAutoAlignFWEL;
	}
	else if (strName == m_FSOLParam.m_strCmd)
	{
		if (vstrParam.size() == m_FSOLParam.m_nPNum)	// 如果有5个参数时
		{
			m_FSOLParam.m_nPType = vstrParam.size();
			m_FSOLParam.P1 = atoi(vstrParam[0]);
			m_FSOLParam.P2 = atoi(vstrParam[1]);

			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FSOLParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FSOLParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FSOLParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}		
		}
		else if (vstrParam.size() == m_FSOLParam.m_nPNum - 3)	// 如果只有2个参数时
		{
			m_FSOLParam.m_nPType = vstrParam.size();
			m_FSOLParam.P1 = atoi(vstrParam[0]);
			m_FSOLParam.P2 = atoi(vstrParam[1]);
			m_FSOLParam.P3 = 0;
			m_FSOLParam.P4 = 0;
			m_FSOLParam.P5 = 0;
		}
		else
		{
			return eCmdUnknow;
		}


		return eCmdAutoAlignFSOL;
	}
	else if (strName == m_FPCBParam.m_strCmd)
	{		

		if (vstrParam.size() == m_FPCBParam.m_nPNum)
		{
			m_FPCBParam.m_nPType = vstrParam.size();
			m_FPCBParam.P1 = atoi(vstrParam[0]);
			//			m_FPCBParam.P2 = atoi(vstrParam[1]);

		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdObjTarSearchFPCB;
	}
	else if (strName == m_FPISParam.m_strCmd)
	{
		if (vstrParam.size() == m_FPISParam.m_nPNum)
		{
			m_FPISParam.m_nPType = vstrParam.size();
			m_FPISParam.P1 = atoi(vstrParam[0]);
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdPCBPrecisionFPIS;
	}
	else if (strName == m_FCPIParam.m_strCmd)
	{
		if (vstrParam.size() == m_FCPIParam.m_nPNum)
		{
			m_FCPIParam.m_nPType = vstrParam.size();
			m_FCPIParam.P1 = atoi(vstrParam[0]);
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdChangePlatformIndex;
	}
	else if(strName == m_FQRCParam.m_strCmd)
	{
		return eCmdSaveQRCode;
	}
	else if(strName == m_FQRIParam.m_strCmd)
	{
		if (vstrParam.size() == m_FQRIParam.m_nPNum)
		{
			m_FQRIParam.m_nPType = vstrParam.size();
			m_FQRIParam.P1 = atoi(vstrParam[0]);
			m_FQRIParam.P2 = atoi(vstrParam[1]);
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdInspectQRCode;
	}
	else if (strName == m_FINSParam.m_strCmd)// 检测产品有、无
	{		
		if (vstrParam.size() == m_FINSParam.m_nPNum)
		{
			m_FINSParam.m_nPType = vstrParam.size();
			m_FINSParam.P1 = atoi(vstrParam[0]);
			m_FINSParam.P2 = atoi(vstrParam[1]);
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdInspectFINS;
	}
	else if (strName == m_FGTWParam.m_strCmd)
	{		
		if (vstrParam.size() == m_FGTWParam.m_nPNum)
		{
			m_FGTWParam.m_nPType = vstrParam.size();
			m_FGTWParam.P1 = atoi(vstrParam[0]);
			m_FGTWParam.P2 = atoi(vstrParam[1]);
			m_FGTWParam.P3 = 0;
			m_FGTWParam.P4 = 0;
			m_FGTWParam.P5 = 0;
			m_FGTWParam.nP3 = 0;
			m_FGTWParam.nP4 = 0;
			m_FGTWParam.nP5 = 0;
		}
		else if (vstrParam.size() == m_FGTWParam.m_nPNum + 3)
		{
			m_FGTWParam.m_nPType = vstrParam.size();
			m_FGTWParam.P1 = atoi(vstrParam[0]);
			m_FGTWParam.P2 = atoi(vstrParam[1]);
			m_FGTWParam.nP3 = 0;
			m_FGTWParam.nP4 = 0;
			m_FGTWParam.nP5 = 0;
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FGTWParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FGTWParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FGTWParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}
		}
		else if (vstrParam.size() == m_FGTWParam.m_nPNum +4)	// 如果只有6个参数时
		{
			m_FGTWParam.m_nPType = vstrParam.size();
			m_FGTWParam.P1 = atoi(vstrParam[0]);
			m_FGTWParam.P2 = atoi(vstrParam[1]);
			m_FGTWParam.nP3 = atoi(vstrParam[2]);
			m_FGTWParam.nP4 = 0;
			m_FGTWParam.nP5 = 0;
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			vstrAxisPos.push_back(vstrParam[5]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FGTWParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FGTWParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FGTWParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}
		}
		else if (vstrParam.size() == m_FGTWParam.m_nPNum +5) // nP4为产品序号
		{
			m_FGTWParam.m_nPType = vstrParam.size();
			m_FGTWParam.P1 = atoi(vstrParam[0]);
			m_FGTWParam.P2 = atoi(vstrParam[1]);
			m_FGTWParam.nP3 = atoi(vstrParam[2]);
			m_FGTWParam.nP4 = atoi(vstrParam[3]);
			m_FGTWParam.nP5 = 0;
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[4]);
			vstrAxisPos.push_back(vstrParam[5]);
			vstrAxisPos.push_back(vstrParam[6]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FGTWParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FGTWParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FGTWParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}
		}
		else if (vstrParam.size() == m_FGTWParam.m_nPNum +6) // nP4为产品序号
		{
			m_FGTWParam.m_nPType = vstrParam.size();
			m_FGTWParam.P1 = atoi(vstrParam[0]);
			m_FGTWParam.P2 = atoi(vstrParam[1]);
			m_FGTWParam.nP3 = atoi(vstrParam[2]);
			m_FGTWParam.nP4 = atoi(vstrParam[3]);
			m_FGTWParam.nP5 = atoi(vstrParam[4]);
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[5]);
			vstrAxisPos.push_back(vstrParam[6]);
			vstrAxisPos.push_back(vstrParam[7]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FGTWParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FGTWParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FGTWParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdGetTargetPlatformPosFGTW;
	}
	else if (strName == m_FGTPParam.m_strCmd)
	{		
		if (vstrParam.size() == m_FGTPParam.m_nPNum)
		{
			m_FGTPParam.m_nPType = vstrParam.size();
			m_FGTPParam.P1 = atoi(vstrParam[0]);
			m_FGTPParam.P2 = atoi(vstrParam[1]);
			m_FGTPParam.P3 = 0;
			m_FGTPParam.P4 = 0;
			m_FGTPParam.P5 = 0;
			m_FGTPParam.nP3 = 0;
			m_FGTPParam.nP4 = 0;
			m_FGTPParam.nP5 = 0;
		}
		else if (vstrParam.size() == m_FGTPParam.m_nPNum + 3)
		{
			m_FGTPParam.m_nPType = vstrParam.size();
			m_FGTPParam.P1 = atoi(vstrParam[0]);
			m_FGTPParam.P2 = atoi(vstrParam[1]);
			m_FGTPParam.nP3 = 0;
			m_FGTPParam.nP4 = 0;
			m_FGTPParam.nP5 = 0;
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[2]);
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FGTPParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FGTPParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FGTPParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}
		}
		else if (vstrParam.size() == m_FGTPParam.m_nPNum +4)	// 如果只有6个参数时
		{
			m_FGTPParam.m_nPType = vstrParam.size();
			m_FGTPParam.P1 = atoi(vstrParam[0]);
			m_FGTPParam.P2 = atoi(vstrParam[1]);
			m_FGTPParam.nP3 = atoi(vstrParam[2]);
			m_FGTPParam.nP4 = 0;
			m_FGTPParam.nP5 = 0;
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			vstrAxisPos.push_back(vstrParam[5]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FGTPParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FGTPParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FGTPParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}
		}
		else if (vstrParam.size() == m_FGTPParam.m_nPNum +5) // nP4为产品序号
		{
			m_FGTPParam.m_nPType = vstrParam.size();
			m_FGTPParam.P1 = atoi(vstrParam[0]);
			m_FGTPParam.P2 = atoi(vstrParam[1]);
			m_FGTPParam.nP3 = atoi(vstrParam[2]);
			m_FGTPParam.nP4 = atoi(vstrParam[3]);
			m_FGTPParam.nP5 = 0;
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[4]);
			vstrAxisPos.push_back(vstrParam[5]);
			vstrAxisPos.push_back(vstrParam[6]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FGTPParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FGTPParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FGTPParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}
		}
		else if (vstrParam.size() == m_FGTPParam.m_nPNum +6) // nP4为产品序号
		{
			m_FGTPParam.m_nPType = vstrParam.size();
			m_FGTPParam.P1 = atoi(vstrParam[0]);
			m_FGTPParam.P2 = atoi(vstrParam[1]);
			m_FGTPParam.nP3 = atoi(vstrParam[2]);
			m_FGTPParam.nP4 = atoi(vstrParam[3]);
			m_FGTPParam.nP5 = atoi(vstrParam[4]);
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[5]);
			vstrAxisPos.push_back(vstrParam[6]);
			vstrAxisPos.push_back(vstrParam[7]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FGTPParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FGTPParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FGTPParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdGetTargetImagePosFGTP;
	}
	else if (strName == m_FAFOParam.m_strCmd)//
	{		
		if (vstrParam.size() == m_FAFOParam.m_nPNum)
		{
			m_FAFOParam.m_nPType = vstrParam.size();
			m_FAFOParam.P1 = atoi(vstrParam[0]);
			m_FAFOParam.P2 = atoi(vstrParam[1]);
			m_FAFOParam.P3 = atoi(vstrParam[2]);
			m_FAFOParam.nP4 = 0;
		}
		else if (vstrParam.size() == m_FAFOParam.m_nPNum+1)
		{
			m_FAFOParam.m_nPType = vstrParam.size();
			m_FAFOParam.P1 = atoi(vstrParam[0]);
			m_FAFOParam.P2 = atoi(vstrParam[1]);
			m_FAFOParam.P3 = atoi(vstrParam[2]);
			m_FAFOParam.nP4 = atoi(vstrParam[3]);
		}
		else if(vstrParam.size() == m_FAFOParam.m_nPNum + 3)
		{
			m_FAFOParam.m_nPType = vstrParam.size();
			m_FAFOParam.P1 = atoi(vstrParam[0]);
			m_FAFOParam.P2 = atoi(vstrParam[1]);
			m_FAFOParam.P3 = atoi(vstrParam[2]);
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[3]);
			vstrAxisPos.push_back(vstrParam[4]);
			vstrAxisPos.push_back(vstrParam[5]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FAFOParam.P4 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FAFOParam.P5 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FAFOParam.P6 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}
		}
		else if(vstrParam.size() == m_FAFOParam.m_nPNum + 4)
		{
			m_FAFOParam.m_nPType = vstrParam.size();
			m_FAFOParam.P1 = atoi(vstrParam[0]);
			m_FAFOParam.P2 = atoi(vstrParam[1]);
			m_FAFOParam.P3 = atoi(vstrParam[2]);
			m_FAFOParam.nP4 = atoi(vstrParam[3]);
			std::vector<CString> vstrAxisPos;
			vstrAxisPos.push_back(vstrParam[4]);
			vstrAxisPos.push_back(vstrParam[5]);
			vstrAxisPos.push_back(vstrParam[6]);
			if (TRUE == ConvertToPlatformXYDAxisPos(vstrAxisPos, &m_CurPlatformXYDAxisPos))
			{
				m_FAFOParam.P4 = m_CurPlatformXYDAxisPos.m_dPosX;
				m_FAFOParam.P5 = m_CurPlatformXYDAxisPos.m_dPosY;
				m_FAFOParam.P6 = m_CurPlatformXYDAxisPos.m_dAngle;
			}
			else
			{
				return eCmdUnknow;
			}
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdFAFO;
	}
	else if (strName == m_FMCOParam.m_strCmd)
	{
		if (vstrParam.size() == m_FMCOParam.m_nPNum)
		{
			m_FMCOParam.m_nPType = vstrParam.size();
			m_FMCOParam.P1 = atoi(vstrParam[0]);
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdGetTargetObjectOffsetFMCO;
	}
	else if (strName == m_FPEPParam.m_strCmd)// 清空产品
	{
		if (vstrParam.size() == m_FPEPParam.m_nPNum)
		{
			m_FPEPParam.P1 = atoi(vstrParam[0]);
			m_FPEPParam.P2 = atoi(vstrParam[1]);
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdProductEmptyPEP;
	}
	else if (strName == m_FPCPParam.m_strCmd)
	{
		if (vstrParam.size() == m_FPCPParam.m_nPNum)
		{
			m_FPCPParam.P1 = atoi(vstrParam[0]);
			m_FPCPParam.P2 = atoi(vstrParam[1]);
			m_FPCPParam.P3 = atoi(vstrParam[2]);
			m_FPCPParam.P4 = atoi(vstrParam[3]);
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdProductCopyFPCP;
	}
	else if (strName == m_FPRNParam.m_strCmd)
	{
		if (vstrParam.size() == m_FPRNParam.m_nPNum)
		{
			m_FPRNParam.P1 = atoi(vstrParam[0]);
			m_FPRNParam.P2 = atoi(vstrParam[1]);
			m_FPRNParam.P3 = atoi(vstrParam[2]);
		}
		else
		{
			return eCmdUnknow;
		}

		return eCmdProductRenameFPRN;
	}
	else
	{
		return eCmdUnknow;
	}

	return eCmdUnknow;
}
BOOL CCommProtocolXYDFast::ClearL2LDistanceResult()
{
	m_vstL2LDistanceResult.clear();
	m_vstL2LDistanceResult.resize(8);
	return TRUE;
}

// 解析是否系统标定指令（[STX]FCLB P1 P2[ETX]）
BOOL CCommProtocolXYDFast::IsSysCalibrateCmd( CString strCmd )
{
	int nLength;
	TCHAR char1, char2;
	CString charP1,charP2;
	long  lchar1,lchar2;
	CString strInfo;

	nLength = strCmd.GetLength();

	if (nLength<=0 || nLength!=10) return FALSE;

	char1 = strCmd.GetAt(0); lchar1= char1;
	char2 = strCmd.GetAt(nLength-1); lchar2=char2;
	strInfo = strCmd.Mid(1, 4);
	charP1  = strCmd.Mid(6,1);
	charP2  = strCmd.Mid(8,1);

	if(lchar1!= 2) return FALSE;
	if(lchar2!= 3) return FALSE;
	if(strInfo!=_T("FCLB")) return FALSE;

	m_CalibParam.P1=atoi(charP1);
	m_CalibParam.P2=atoi(charP2);

	return TRUE;
}
// 解析是否系统标定指令（[STX]FCBS P1 P2 P3[ETX]）
// BOOL CCommProtocolXYDFast::IsSysSepCalibrateCmd( CString strCmd )
// {
// 	int nLength;
// 	TCHAR char1, char2;
// 	CString charP1,charP2,charP3;
// 	long  lchar1,lchar2;
// 	CString strInfo;
// 
// 	nLength = strCmd.GetLength();
// 
// 	if (nLength<=0 || nLength!=12) return FALSE;
// 
// 	char1 = strCmd.GetAt(0); lchar1= char1;
// 	char2 = strCmd.GetAt(nLength-1); lchar2=char2;
// 	strInfo = strCmd.Mid(1, 4);
// 	charP1  = strCmd.Mid(6,1);
// 	charP2  = strCmd.Mid(8,1);
// 	charP3 = strCmd.Mid(10,1);
// 
// 	if(lchar1!= 2) return FALSE;
// 	if(lchar2!= 3) return FALSE;
// 	if(strInfo!=_T("FCBS")) return FALSE;
// 
// 	m_CalibParam.P1=atoi(charP1);
// 	m_CalibParam.P2=atoi(charP2);
// 
// 	return TRUE;
// }

// 解析是否系统标定指令（[STX]FRST[ETX]）
BOOL CCommProtocolXYDFast::IsSysResetCmd( CString strCmd )
{
	int nLength;
	TCHAR char1, char2;
	CString charP1,charP2;
	long  lchar1,lchar2;
	CString strInfo;

	nLength = strCmd.GetLength();

	if (nLength<=0 || nLength!=6) return FALSE;

	char1 = strCmd.GetAt(0); lchar1= char1;
	char2 = strCmd.GetAt(nLength-1); lchar2=char2;
	strInfo = strCmd.Mid(1, 4);


	if(lchar1!= 2) return FALSE;
	if(lchar2!= 3) return FALSE;
	if(strInfo!=_T("FRST")) return FALSE;


	return TRUE;
}


// 解析是否在线对位指令（[STX]FACO P1 [ETX]）
BOOL CCommProtocolXYDFast::IsOnLineAlignCmd( CString strCmd )
{
	int nLength;
	TCHAR char1, char2;
	long  lchar1,lchar2;
	CString strInfo;

	nLength = strCmd.GetLength();

	if (nLength<=0 || nLength!=10) return FALSE;

	char1 = strCmd.GetAt(0); lchar1= char1;
	char2 = strCmd.GetAt(nLength-1); lchar2=char2;
	strInfo = strCmd.Mid(1, 4);

	if(lchar1!= 2) return FALSE;
	if(lchar2!= 3) return FALSE;
	if(strInfo!=_T("FACO")) return FALSE;

	return TRUE;	
}

// 解析是否在线对位指令（[STX]FACO P1 [ETX]）
BOOL CCommProtocolXYDFast::IsOnLineAlignCmdFACO( CString strCmd )
{
	int nLength;
	TCHAR char1, char2;
	long  lchar1,lchar2;
	CString strInfo;

	nLength = strCmd.GetLength();

	if (nLength<=0 || nLength!=10) return FALSE;

	char1 = strCmd.GetAt(0); lchar1= char1;
	char2 = strCmd.GetAt(nLength-1); lchar2=char2;
	strInfo = strCmd.Mid(1, 4);

	if(lchar1!= 2) return FALSE;
	if(lchar2!= 3) return FALSE;
	if(strInfo!=_T("FACO")) return FALSE;

	return TRUE;	
}
// 解析是否在线对位指令（[STX]FAAL P1[ETX]）
BOOL CCommProtocolXYDFast::IsOnLineAlignCmdFAAL( CString strCmd )
{
	int nLength;
	TCHAR char1, char2;
	long  lchar1,lchar2;
	CString strInfo,strP1;

	nLength = strCmd.GetLength();

	if (nLength<=0 || nLength!=10) return FALSE;

	char1 = strCmd.GetAt(0); lchar1= char1;
	char2 = strCmd.GetAt(nLength-1); lchar2=char2;
	strInfo = strCmd.Mid(1, 4);
	strP1=strCmd.GetAt(nLength-2);

	if(lchar1!= 2) return FALSE;
	if(lchar2!= 3) return FALSE;
	if(strInfo!=_T("FAAL")) return FALSE;

	m_FAALParam.P1=atoi(strP1);

	return TRUE;		
}

// 解析是否在线对位指令（[STX]FALG P1[ETX]）
BOOL CCommProtocolXYDFast::IsOnLineAlignCmdFALG( CString strCmd )
{
	int nLength;
	TCHAR char1, char2;
	long  lchar1,lchar2;
	CString strInfo;

	nLength = strCmd.GetLength();

	if (nLength<=0 || nLength!=8) return FALSE;

	char1 = strCmd.GetAt(0); lchar1= char1;
	char2 = strCmd.GetAt(nLength-1); lchar2=char2;
	strInfo = strCmd.Mid(1, 4);

	if(lchar1!= 2) return FALSE;
	if(lchar2!= 3) return FALSE;
	if(strInfo!=_T("FALG")) return FALSE;

	return TRUE;	
}
//解析是否获得对位结果([STX]FANS[ETX])
BOOL CCommProtocolXYDFast::IsGetAlignResult(CString strCmd)
{
	int nLength;
	TCHAR char1, char2;
	long  lchar1,lchar2;
	CString strInfo;

	nLength = strCmd.GetLength();

	if (nLength<=0 || nLength!=6) return FALSE;

	char1 = strCmd.GetAt(0); lchar1= char1;
	char2 = strCmd.GetAt(nLength-1); lchar2=char2;
	strInfo = strCmd.Mid(1, 4);

	if(lchar1!= 2) return FALSE;
	if(lchar2!= 3) return FALSE;
	if(strInfo!=_T("FANS")) return FALSE;

	return TRUE;


}

// 解析是否在线对位指令（[STX]FTGT P1[ETX]）
BOOL CCommProtocolXYDFast::IsSetTargetBench(CString strCmd)
{
	int nLength;
	TCHAR char1, char2;
	long  lchar1,lchar2;
	CString strInfo;

	nLength = strCmd.GetLength();

	if (nLength<=0 || nLength!=8) return FALSE;

	char1 = strCmd.GetAt(0); lchar1= char1;
	char2 = strCmd.GetAt(nLength-1); lchar2=char2;
	strInfo = strCmd.Mid(1, 4);

	if(lchar1!= 2) return FALSE;
	if(lchar2!= 3) return FALSE;
	if(strInfo!=_T("FTGT")) return FALSE;

	return TRUE;



}
// 解析是否标定搜索指令（&CAG\）
BOOL CCommProtocolXYDFast::IsCalibMarkSearchCmd(CString strCmd)
{
	int nLength;
	TCHAR char1, char2;
	CString strInfo;

	nLength = strCmd.GetLength();

	if (nLength<=0 || nLength!=5) return FALSE;

	char1 = strCmd.GetAt(0);
	char2 = strCmd.GetAt(nLength-1);
	strInfo = strCmd.Mid(1, 3);

	if(char1!='&') return FALSE;
	if(char2!='\\') return FALSE;
	if(strInfo!=_T("CAG")) return FALSE;

	return TRUE;
}

// 解析是否实时目标搜索指令（[STX]FTGC P1 P2[ETX]）
BOOL CCommProtocolXYDFast::IsTargetMarkSearchCmd( CString strCmd )
{
	int nLength;
	TCHAR char1, char2;
	CString charP1,charP2;
	long  lchar1,lchar2;
	CString strInfo;

	nLength = strCmd.GetLength();

	if (nLength<=0 || nLength!=10) return FALSE;

	char1 = strCmd.GetAt(0); lchar1=char1;
	char2 = strCmd.GetAt(nLength-1); lchar2=char2;
	strInfo = strCmd.Mid(1, 4);
	charP1  =  strCmd.Mid(6,1);
	charP2  =  strCmd.Mid(8,1);

	if(lchar1!= 2) return FALSE;
	if(lchar2!= 3) return FALSE;
	if(strInfo!=_T("FTGC")) return FALSE;

	m_TargetSearchParam.P1=atoi(charP1);
	m_TargetSearchParam.P2= atoi(charP2);

	return TRUE;
}

// 解析是否实时目标搜索指令（[STX]FTGT P1[ETX]）
BOOL CCommProtocolXYDFast::IsTargetMarkSearchCmdFTGT( CString strCmd )
{
	int nLength;
	TCHAR char1, char2;
	CString charP1,charP2;
	long  lchar1,lchar2;
	CString strInfo;

	nLength = strCmd.GetLength();

	if (nLength<=0 || nLength!=8) return FALSE;

	char1 = strCmd.GetAt(0); lchar1=char1;
	char2 = strCmd.GetAt(nLength-1); lchar2=char2;
	strInfo = strCmd.Mid(1, 4);
	charP1  =  strCmd.Mid(6,1);
	//	charP2  =  strCmd.Mid(8,1);

	if(lchar1!= 2) return FALSE;
	if(lchar2!= 3) return FALSE;
	if(strInfo!=_T("FTGT")) return FALSE;

	m_TargetSearchParam.P1=atoi(charP1);
	//	m_TargetSearchParam.P2= atoi(charP2);

	return TRUE;
}


// 解析是否实时目标搜索指令（[STX]FTGC P1 P2[ETX]）
BOOL CCommProtocolXYDFast::IsTargetMarkSearchCmdFTGC( CString strCmd )
{
	int nLength;
	TCHAR char1, char2;
	CString charP1,charP2;
	long  lchar1,lchar2;
	CString strInfo;

	nLength = strCmd.GetLength();

	if (nLength<=0 || nLength!=10) return FALSE;

	char1 = strCmd.GetAt(0); lchar1=char1;
	char2 = strCmd.GetAt(nLength-1); lchar2=char2;
	strInfo = strCmd.Mid(1, 4);
	charP1  =  strCmd.Mid(6,1);
	charP2  =  strCmd.Mid(8,1);

	if(lchar1!= 2) return FALSE;
	if(lchar2!= 3) return FALSE;
	if(strInfo!=_T("FTGC")) return FALSE;

	m_FTGCParam.P1=atoi(charP1);
	m_FTGCParam.P2=atoi(charP2);
	//	m_TargetSearchParam.P2= atoi(charP2);

	return TRUE;
}


// 解析是否实时对象搜索指令（[STX]FOBJ P1[ETX]）
BOOL CCommProtocolXYDFast::IsObjectMarkSearchCmd( CString strCmd )
{
	int nLength;
	TCHAR char1, char2;
	CString charP1,charP2;
	long  lchar1,lchar2;
	CString strInfo;

	nLength = strCmd.GetLength();

	if (nLength<=0 || nLength!=8) return FALSE;

	char1 = strCmd.GetAt(0); lchar1= char1;
	char2 = strCmd.GetAt(nLength-1); lchar2 = char2;
	strInfo = strCmd.Mid(1, 4);
	charP1  =  strCmd.Mid(6,1);
	//	charP2  =  strCmd.Mid(8,1);

	if(lchar1!= 2) return FALSE;
	if(lchar2!= 3) return FALSE;
	if(strInfo!=_T("FOBJ")) return FALSE;

	m_ObjectSearchParam.P1=atoi(charP1);
	//	m_ObjectSearchParam.P2= atoi(charP2);

	return TRUE;
}

// 解析是否虚拟对象搜索指令（&VBG\）
BOOL CCommProtocolXYDFast::IsVirtualMarkSearchCmd( CString strCmd )
{
	int nLength;
	TCHAR char1, char2;
	CString strInfo;

	nLength = strCmd.GetLength();

	if (nLength<=0 || nLength!=5) return FALSE;

	char1 = strCmd.GetAt(0);
	char2 = strCmd.GetAt(nLength-1);
	strInfo = strCmd.Mid(1, 3);

	if(char1!='&') return FALSE;
	if(char2!='\\') return FALSE;
	if(strInfo!=_T("VBG")) return FALSE;

	return TRUE;
}

// 解析是否确定虚拟对象与实时对象关系指令（&COV\）
BOOL CCommProtocolXYDFast::IsGetVirtualAndObjectMarkRelationShipCmd( CString strCmd )
{
	int nLength;
	TCHAR char1, char2;
	CString strInfo;

	nLength = strCmd.GetLength();

	if (nLength<=0 || nLength!=5) return FALSE;

	char1 = strCmd.GetAt(0);
	char2 = strCmd.GetAt(nLength-1);
	strInfo = strCmd.Mid(1, 3);

	if(char1!='&') return FALSE;
	if(char2!='\\') return FALSE;
	if(strInfo!=_T("COV")) return FALSE;

	return TRUE;

}



BOOL CCommProtocolXYDFast::PackParam( CString& strParam, int nParam, int nDataLenType, int nUnitExp /*= 0*/ )
{
	double nBase = 10;
	long nNewParam = nParam;
	if (nUnitExp > 0)
	{
		nNewParam = (long) nParam * pow(nBase, nUnitExp);
	}

	if (nDataLenType == 1)
	{

		if (nNewParam >= 0)
		{
			strParam.Format(_T("%010d"), nNewParam);
			strParam = _T("+") + strParam;
		}
		else
		{
			strParam.Format(_T("%011d"), nNewParam);
		}		
	}
	else 
	{
		if (nNewParam >= 0)
		{
			strParam.Format(_T("%d"), nNewParam);
			strParam = _T("+") + strParam;
		}
		else
		{
			strParam.Format(_T("%d"), nNewParam);
		}	
	}


	return TRUE;
}

BOOL CCommProtocolXYDFast::PackParam( CString& strParam, double dParam, int nDataLenType, int nUnitExp /*= 0*/ )
{
	double nBase = 10;
	double dNewParam = dParam;
	if (nUnitExp > 0)
	{
		dNewParam = dParam * pow(nBase, nUnitExp);
	}

	if (nDataLenType == 1)
	{
		if (fabs(dNewParam) < DBL_EPSILON)
		{
			dNewParam = +0.0;
		}
		if (dNewParam >= 0)
		{
			strParam.Format(_T("%010.0lf"), fabs(dNewParam));
			strParam = _T("+") + strParam;
		}
		else
		{
			strParam.Format(_T("%011.0lf"), dNewParam);
		}		
	}
	else 
	{
		if (fabs(dNewParam) < DBL_EPSILON)
		{
			dNewParam = +0.0;
		}
		if (dNewParam >= 0)
		{
			strParam.Format(_T("%.0lf"), fabs(dNewParam));
			strParam = _T("+") + strParam;
		}
		else
		{
			strParam.Format(_T("%.0lf"), dNewParam);
		}	
	}

	return TRUE;
}



// 打包“获取平台各轴绝对位置”指令： TAG
BOOL CCommProtocolXYDFast::PackGetPlatformAbsPos(CString& strInfo)
{
	CString strHead = m_strHead;
	CString strName= m_MNPSParam.m_strCmd;
	CString strBlank = m_strSeparator;
	CString strParam[1];
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName +  strTail;


	// 
	// 	CString strHead = m_strHead;
	// 	CString strCalib= "MNPS";
	// 
	// 	CString strCR = char(0x0D);
	// 	CString strTail = m_strTail;	
	// 
	// 
	// 	//构造写命令
	// 	strInfo.Empty();
	// 	strInfo = strHead + strCalib +  strTail;//+ strCR;

	return TRUE;

}

BOOL CCommProtocolXYDFast::PackGetPlatformAbsPosBackup(CString& strInfo)
{
	CString strHead = m_strHead;
	CString strName= m_MPSBParam.m_strCmd;
	CString strBlank = m_strSeparator;
	CString strParam[1];
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName +  strTail;
	return TRUE;
}

// 解析收到的“获取平台各轴绝对位置”响应（[STX]MPSB R1 R2 R3 R4[ETX]）
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswGetGetPlatformAbsPosBackup(CString strAsw, CPlatformAxisPos* vpPlatAxisPos)
{	
	if (NULL == vpPlatAxisPos)
	{
		return eAswUnkown;
	}

	if (vpPlatAxisPos->GetPlatformType()!=ePlatformXYD)
	{
		return eAswUnkown;
	}

	CString strName;
	std::vector<CString> vstrParam;	
	if (!AnalyzeCommandParam(strAsw, strName, vstrParam))
	{
		return eAswCmdErr;
	}

	m_strCmdName = strName;
	double dBase = 10;

	if (strName != m_MPSBParam.m_strCmd)
	{
		return eAswCmdErr;
	}
	if (vstrParam.size() != 4)
	{
		return eAswCmdErr;
	}

	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);

	/*std::vector<CString> vstrAxisPos;
	vstrAxisPos.push_back(vstrParam[1]);
	vstrAxisPos.push_back(vstrParam[2]);
	vstrAxisPos.push_back(vstrParam[3]);*/

	pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
	pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
	pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[3])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);

	/*if (FALSE == ConvertToPlatformXYDAxisPos(vstrAxisPos, pPlatformXYDAixisPos))
	{
	return eAswCmdErr;
	}*/


	return eAswSucceed;
}


// 解析收到的“获取平台各轴绝对位置”响应（[STX]MNPS R1 R2 R3 R4[ETX]）
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswGetGetPlatformAbsPos( CString strAsw, CPlatformAxisPos* vpPlatAxisPos )
{

	if (NULL == vpPlatAxisPos)
	{
		return eAswUnkown;
	}

	if (vpPlatAxisPos->GetPlatformType()!=ePlatformXYD)
	{
		return eAswUnkown;
	}

	CString strName;
	std::vector<CString> vstrParam;	
	if (!AnalyzeCommandParam(strAsw, strName, vstrParam))
	{
		return eAswCmdErr;
	}

	m_strCmdName = strName;
	double dBase = 10;

	if (strName != m_MNPSParam.m_strCmd)
	{
		return eAswCmdErr;
	}
	if (vstrParam.size() != 4)
	{
		return eAswCmdErr;
	}

	if (0 != atoi(vstrParam[0]))
	{
		return eAswCmdErr;
	}

	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);

	std::vector<CString> vstrAxisPos;
	vstrAxisPos.push_back(vstrParam[1]);
	vstrAxisPos.push_back(vstrParam[2]);
	vstrAxisPos.push_back(vstrParam[3]);
	if (FALSE == ConvertToPlatformXYDAxisPos(vstrAxisPos, pPlatformXYDAixisPos))
	{
		return eAswCmdErr;
	}


	return eAswSucceed;

	// 
	// 	if (m_pMidPlatformInfo == NULL)
	// 	{
	// 		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	// 		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	// 		pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 		pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 		pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[3])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
	// 
	// 	}
	// 	else
	// 	{
	// 		switch(m_eMidPlatformType)
	// 		{
	// 		case ePlatformXYD:
	// 			{
	// 				CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	// 				pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	// 				pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[3])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
	// 
	// 
	// 				// 	pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				// 	pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				// 	pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[3])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
	// 
	// 			}
	// 			break;
	// 		case ePlatformXD:
	// 			{
	// 				CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	// 				pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	// 				pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[3])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
	// 
	// 
	// 				// 	pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				// 	pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				// 	pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[3])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
	// 
	// 			}
	// 			break;
	// 		case ePlatformYD:
	// 			{
	// 				CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	// 				pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	// 				pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[3])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
	// 
	// 
	// 				// 	pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				// 	pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				// 	pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[3])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
	// 
	// 			}
	// 			break;
	// 		case ePlatformXY1Y2:
	// 			{
	// 				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
	// 				{
	// 					double dX1 = 0.0;
	// 					double dY1 = 0.0;
	// 					double dY2 = 0.0;
	// 
	// 					double dX0 = 0.0;
	// 					double dY0 = 0.0;
	// 					double dD0 = 0.0;
	// 					CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;
	// 
	// 
	// 					dX1 = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dY1 = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dY2 = atof(vstrParam[3])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp); 
	// 
	// 					pPlatformXY1Y2Info->ConvertXY1Y2PltfmPosToXYDPltfmPos(dY1, dY2, dX1, dX0, dY0, dD0);
	// 
	// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	// 					pPlatformXYDAixisPos->m_dPosX  = dX0;
	// 					pPlatformXYDAixisPos->m_dPosY  = dY0;
	// 					pPlatformXYDAixisPos->m_dAngle  = dD0;
	// 
	// 				}
	// 				else
	// 				{
	// 					return eAswCmdErr;
	// 				}
	// 			}
	// 			break;
	// 		case ePlatformX1X2Y:
	// 			{
	// 				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
	// 				{
	// 					double dX1 = 0.0;
	// 					double dX2 = 0.0;
	// 					double dY1 = 0.0;
	// 
	// 					double dX0 = 0.0;
	// 					double dY0 = 0.0;
	// 					double dD0 = 0.0;
	// 					CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;
	// 
	// 
	// 					dY1 = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dX1= atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dX2 = atof(vstrParam[3])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp); 
	// 
	// 					//dX1 = dX1 - 5.5;
	// 					//dX2 = dX2 - 5.5;
	// 					//dY1 = dY1 - 5.5;
	// 					pPlatformX1X2YInfo->ConvertX1X2YPltfmPosToXYDPltfmPos(dX1, dX2, dY1, dX0, dY0, dD0);
	// 
	// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	// 					pPlatformXYDAixisPos->m_dPosX  = dX0;
	// 					pPlatformXYDAixisPos->m_dPosY  = dY0;
	// 					pPlatformXYDAixisPos->m_dAngle  = dD0;
	// 				}
	// 				else
	// 				{
	// 					return eAswCmdErr;
	// 				}
	// 			}
	// 			break;
	// 		default:
	// 			{
	// 				CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	// 				pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	// 				pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[3])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
	// 
	// 
	// 				// 	pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				// 	pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				// 	pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[3])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
	// 
	// 			}
	// 		}
	// 	}
	// 
	// 	return eAswSucceed;

	// 
	// 	switch(m_SystemOptionCofing.m_eTempPlatformType)
	// 	{
	// 	case ePlatformXYD:
	// 		{
	// 			CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	// 			pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	// 			pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 			pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 			pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[3])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
	// 
	// 
	// 			// 	pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 			// 	pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 			// 	pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[3])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
	// 
	// 		}
	// 		break;
	// 	case ePlatformXY1Y2:
	// 		{
	// 			if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
	// 			{
	// 				double dX1 = 0.0;
	// 				double dY1 = 0.0;
	// 				double dY2 = 0.0;
	// 
	// 				double dX0 = 0.0;
	// 				double dY0 = 0.0;
	// 				double dD0 = 0.0;
	// 				CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_SystemOptionCofing.m_pTempPlatformInfo;
	// 
	// 					
	// 				dX1 = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				dY1 = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				dY2 = atof(vstrParam[3])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp); 
	// 
	// 				pPlatformXY1Y2Info->ConvertXY1Y2PltfmPosToXYDPltfmPos(dY1, dY2, dX1, dX0, dY0, dD0);
	// 
	// 				CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	// 				pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	// 				pPlatformXYDAixisPos->m_dPosX  = dX0;
	// 				pPlatformXYDAixisPos->m_dPosY  = dY0;
	// 				pPlatformXYDAixisPos->m_dAngle  = dD0;
	// 
	// 			}
	// 			else
	// 			{
	// 				return eAswCmdErr;
	// 			}
	// 		}
	// 		break;
	// 	case ePlatformX1X2Y:
	// 		{
	// 			if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
	// 			{
	// 				double dX1 = 0.0;
	// 				double dX2 = 0.0;
	// 				double dY1 = 0.0;
	// 
	// 				double dX0 = 0.0;
	// 				double dY0 = 0.0;
	// 				double dD0 = 0.0;
	// 				CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_SystemOptionCofing.m_pTempPlatformInfo;
	// 
	// 
	// 				dY1 = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				dX1= atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				dX2 = atof(vstrParam[3])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp); 
	// 				
	// 				//dX1 = dX1 - 5.5;
	// 				//dX2 = dX2 - 5.5;
	// 				//dY1 = dY1 - 5.5;
	// 				pPlatformX1X2YInfo->ConvertX1X2YPltfmPosToXYDPltfmPos(dX1, dX2, dY1, dX0, dY0, dD0);
	// 
	// 				CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	// 				pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	// 				pPlatformXYDAixisPos->m_dPosX  = dX0;
	// 				pPlatformXYDAixisPos->m_dPosY  = dY0;
	// 				pPlatformXYDAixisPos->m_dAngle  = dD0;
	// 			}
	// 			else
	// 			{
	// 				return eAswCmdErr;
	// 			}
	// 		}
	// 		break;
	// 	default:
	// 		{
	// 			CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	// 			pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	// 			pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 			pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 			pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[3])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
	// 
	// 
	// 			// 	pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 			// 	pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 			// 	pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[3])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
	// 
	// 		}
	// 	}

	// 	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	// 	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	// 	pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 	pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 	pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[3])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
	// 
	// 
	// // 	pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// // 	pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// // 	pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[3])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
	// 
	// 	vpPlatAxisPos = pPlatformXYDAixisPos;
	// 
	// 	return eAswSucceed;

	// 	if (NULL == vpPlatAxisPos)
	// 	{
	// 		return eAswUnkown;
	// 	}
	// 
	// 	if (vpPlatAxisPos->GetPlatformType()!=ePlatformXYD)
	// 	{
	// 		return eAswUnkown;
	// 	}
	// 
	// 	int nLength;
	// 	TCHAR char1, char2;
	// 	long  lchar1,lchar2;
	// 	CString strInfo1, strInfo2, strInfo3,strPolarity;
	// 	double dValue1, dValue2, dValue3;    
	// 
	// 	nLength = strlen(strAsw);
	// 	if (nLength<0) return eAswCmdErr;
	// 
	// 	char1 = strAsw.GetAt(0); lchar1 = char1;
	// 	char2 = strAsw.GetAt(nLength-1); lchar2 = char2;
	// 	strInfo1 = strAsw.Mid(1,4); //MNPS
	// 	strInfo2 = strAsw.Mid(6,2);//R1位数需确认。
	// 
	// 	if(char1!=2) return eAswCmdErr;
	// 	if(char2!=3) return eAswCmdErr;
	// 	if(strInfo1!=_T("MNPS")) return eAswCmdErr;
	// 	if(strInfo2==_T("-1")) return eAswCmdErr;
	// 
	// 	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	// 	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	// 
	// 	strInfo1 = strAsw.Mid(8, 11); //位数需要确定 .MNPS 0 +0001751110 +0000326780 +0000600000.
	// 	strInfo2 = strAsw.Mid(1*12+8, 11); 
	// 	strInfo3 = strAsw.Mid(2*12+8, 11);
	// 
	// 	strPolarity = strInfo1.Mid(0,1);
	// 	if (strPolarity=="+")
	// 	{
	// 		strInfo1= strInfo1.Mid(1,10);
	// 		dValue1 = atof(strInfo1);
	// 		pPlatformXYDAixisPos->m_dPosX  = dValue1/10000;
	// 	}
	// 	else if (strPolarity=="-")
	// 	{
	// 		strInfo1= strInfo1.Mid(1,10);
	// 		dValue1 = atof(strInfo1);
	// 		pPlatformXYDAixisPos->m_dPosX  = -dValue1/10000;
	// 	}
	// 
	// 	strPolarity = strInfo2.Mid(0,1);
	// 	if (strPolarity=="+")
	// 	{
	// 		strInfo2= strInfo2.Mid(1,10);
	// 		dValue2 = atof(strInfo2);
	// 		pPlatformXYDAixisPos->m_dPosY  = dValue2/10000;
	// 	}
	// 	else if (strPolarity=="-")
	// 	{
	// 		strInfo2= strInfo2.Mid(1,10);
	// 		dValue2 = atof(strInfo2);
	// 		pPlatformXYDAixisPos->m_dPosY  = -dValue2/10000;
	// 	}
	// 
	// 	strPolarity = strInfo3.Mid(0,1);
	// 	if (strPolarity=="+")
	// 	{
	// 		strInfo3= strInfo3.Mid(1,10);
	// 		dValue3 = atof(strInfo3);
	// 		pPlatformXYDAixisPos->m_dAngle  = dValue3/100000;
	// 	}
	// 	else if (strPolarity=="-")
	// 	{
	// 		strInfo3= strInfo3.Mid(1,10);
	// 		dValue3 = atof(strInfo3);
	// 		pPlatformXYDAixisPos->m_dAngle  = -dValue3/100000;
	// 	}
	// 	//	dValue3 = atof(strInfo3);
	// 
	// 	// 	pPlatformXYDAixisPos->m_dPosX  = dValue1/10000;
	// 	// 	pPlatformXYDAixisPos->m_dPosY  = dValue2/10000;
	// 	// 	pPlatformXYDAixisPos->m_dAngle = dValue3/100000;
	// 
	// 	vpPlatAxisPos = pPlatformXYDAixisPos;
	// 
	// 	return eAswSucceed;
}

// 打包“指定平台各轴移动到的绝对位置”指令: （[STX]MMVA P1 P2 P3[ETX]）
BOOL CCommProtocolXYDFast::PackDrivePlatformMoveToAbsPos( CString& strData, CPlatformAxisPos* vpPlatAxisPos )
{
	if (NULL == vpPlatAxisPos)
	{
		return FALSE;
	}

	if (vpPlatAxisPos->GetPlatformType()!=ePlatformXYD)
	{
		return FALSE;
	}

	CString strHead = m_strHead;
	CString strName= m_MMVAParam.m_strCmd;
	CString strParam[3];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	if (m_pMidPlatformInfo == NULL)
	{

		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
		}
		else
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}

	}
	else
	{
		switch(m_eMidPlatformType)
		{
		case ePlatformXYD:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				}
				else
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}

			}
			break;

			// 		case ePlatformXYPD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 
			// 			}
			// 			break;

			// 		case ePlatformXD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 
			// 			}
			// 			break;

			// 		case ePlatformXY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 
			// 			}
			// 			break;

			// 		case ePlatformX:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 
			// 			}
			// 			break;

			// 		case ePlatformY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 
			// 			}
			// 			break;

			// 		case ePlatformXDPY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 
			// 			}
			// 			break;

			// 			case ePlatformXDPY1:
			// 				{
			// 					if (eCPOrderYXD == m_eCmdParamOrderType)
			// 					{
			// 						double dParam = 0;
			// 						dParam = pPlatformXYDAixisPos->m_dPosX;
			// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 						dParam = pPlatformXYDAixisPos->m_dPosY;
			// 						PackParam(strParam[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 						dParam = pPlatformXYDAixisPos->m_dAngle;
			// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 					}
			// 					else
			// 					{
			// 						double dParam = 0;
			// 						dParam = pPlatformXYDAixisPos->m_dPosX;
			// 						PackParam(strParam[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 						dParam = pPlatformXYDAixisPos->m_dPosY;
			// 						PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 						dParam = pPlatformXYDAixisPos->m_dAngle;
			// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					}
			// 
			// 				}
			// 				break;

			// 		case ePlatformYD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 
			// 			}
			// 			break;

		case ePlatformXY1Y2:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dY1 = 0.0;
					double dY2 = 0.0;

					double dX0 = pPlatformXYDAixisPos->m_dPosX;
					double dY0 = pPlatformXYDAixisPos->m_dPosY;
					double dD0 = pPlatformXYDAixisPos->m_dAngle;
					CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(dX0, dY0, dD0, dY1, dY2, dX1);


					double dParam = 0;
					dParam = dX1;
					PackParam(strParam[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dY1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = dY2;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;

		case ePlatformX1X2Y:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dX2 = 0.0;
					double dY1 = 0.0;

					double dX0 = pPlatformXYDAixisPos->m_dPosX;
					double dY0 = pPlatformXYDAixisPos->m_dPosY;
					double dD0 = pPlatformXYDAixisPos->m_dAngle;
					CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(dX0, dY0, dD0, dX1, dX2, dY1);

					//dX1 = dX1 + 5.5;
					//dX2 = dX2 + 5.5;
					//dY1 = dY1 + 5.5;

					double dParam = 0;
					dParam = dX1;
					PackParam(strParam[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dX2;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dY1;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;

		default:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				}
				else
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}

			}
		}
	}

	strData.Empty();
	strData = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strTail;

	return TRUE;

}



// 解析收到的“指定平台各轴移动到的绝对位置”响应（[STX]MMVA R1[ETX]）
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswDrivePlatformMoveToAbsPos( CString strAsw )
{
	CString strName;
	std::vector<CString> vstrParam;	
	if (!AnalyzeCommandParam(strAsw, strName, vstrParam))
	{
		return eAswCmdErr;
	}

	m_strCmdName = strName;
	double dBase = 10;

	if (strName != m_MMVAParam.m_strCmd)
	{
		return eAswCmdErr;
	}
	// 2016.11.28 不再判断MMVA返回的参数是否合理，默认都是移动成功
	return eAswSucceed;

	if (vstrParam.size() != 1)
	{
		return eAswCmdErr;
	}


	if (0 == atoi(vstrParam[0]))
	{
		return eAswSucceed;
	}
	else if (-1 == atoi(vstrParam[0]))
	{
		return eAswUnkown;
	}

	return eAswCmdErr;

	// 	int nLength;
	// 	TCHAR char1, char2;
	// 	long  lchar1,lchar2;
	// 	CString strInfo1, strInfo2;
	// 
	// 	nLength = strlen(strAsw);
	// 
	// 	if (nLength<0 || nLength!=8) return eAswCmdErr;
	// 
	// 	char1 = strAsw.GetAt(0); lchar1 = char1;
	// 	char2 = strAsw.GetAt(nLength-1); lchar2 = char2;
	// 	strInfo1 = strAsw.Mid(1,4);
	// 	strInfo2 = strAsw.Mid(6,1);
	// 
	// 	if(lchar1!= 2) return eAswCmdErr; 
	// 	if(lchar2!= 3) return eAswCmdErr;
	// 	if(strInfo1!=_T("MMVA")) return eAswCmdErr;
	// 
	// 	CmdAnsweredStatus cmdAnsweredStatus;
	// 	//if (atoi(strInfo2)!=0)
	// 	if (strInfo2!="O")
	// 	{
	// 		cmdAnsweredStatus = eAswCmdErr;
	// 	}
	// 	else
	// 		cmdAnsweredStatus= (CmdAnsweredStatus)(atoi(strInfo2));
	// 
	// 	return cmdAnsweredStatus;
}
BOOL CCommProtocolXYDFast::PackReCalTargetFixOffsetFAFO(CString& strInfo,BOOL bResult,std::vector<int> vnPosIndex,std::vector<CCoordPos>& vCoordPos,std::vector<CPlatformXYDAxisPos>& vPlatformAxis,std::vector<CCoordPos>& vBoardPos)
{
	int nPosNum = 0;
	if (bResult)
	{
		nPosNum = vnPosIndex.size();
	}

	CString strHead = m_strHead;
	CString strName= m_FAFOParam.m_strCmd;
	CString strParam[6];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	// strParam[0] : 成功、失败
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	// strParam[1] : 总数
	nParam = nPosNum;
	PackParam(strParam[1], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	std::vector<CString> vsWriteData[4];
	vsWriteData[0].resize(nPosNum*2);	// 位置序号
	vsWriteData[1].resize(nPosNum*2);	// X数据
	vsWriteData[2].resize(nPosNum*2);	// Y数据
	vsWriteData[3].resize(nPosNum*2);	// D数据

	for (int i=0;i<nPosNum;i++)
	{
		int nPosIndex = vnPosIndex.at(i);
		PackParam(strParam[2], nPosIndex, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
		double dParam = 0;
		dParam = vCoordPos.at(i).GetPosX();
		PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = vCoordPos.at(i).GetPosY();
		PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
		dParam = vCoordPos.at(i).GetAngle();
		PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		vsWriteData[0].at(i) = strParam[2];
		vsWriteData[1].at(i) = strParam[3];
		vsWriteData[2].at(i) = strParam[4];
		vsWriteData[3].at(i) = strParam[5];
	}
	for (int i=nPosNum;i<nPosNum*2;i++)
	{
		int nPosIndex = vnPosIndex.at(i-nPosNum);
		PackParam(strParam[2], nPosIndex, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
		double dParam = 0;
		dParam = vPlatformAxis.at(i-nPosNum).m_dPosX;
		PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = vPlatformAxis.at(i-nPosNum).m_dPosY;
		PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
		dParam = vPlatformAxis.at(i-nPosNum).m_dAngle;
		PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		vsWriteData[0].at(i) = strParam[2];
		vsWriteData[1].at(i) = strParam[3];
		vsWriteData[2].at(i) = strParam[4];
		vsWriteData[3].at(i) = strParam[5];
	}

	CString strTempInfo = _T("");
	for (int i = 0; i < nPosNum*2; i++)
	{
		CString strTemp = strBlank + vsWriteData[0].at(i) + strBlank + vsWriteData[1].at(i) + strBlank + vsWriteData[2].at(i)+ strBlank + vsWriteData[3].at(i);
		strTempInfo = strTempInfo + strTemp;
	}

	vsWriteData[0].resize(nPosNum);
	vsWriteData[1].resize(nPosNum);
	vsWriteData[2].resize(nPosNum);
	for (int i=0;i<nPosNum;i++)
	{
		int nPosIndex = vnPosIndex.at(i);
		PackParam(strParam[2], nPosIndex, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
		double dParam = 0;
		dParam = vBoardPos.at(i).GetPosX();
		PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = vBoardPos.at(i).GetPosY();
		PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);

		vsWriteData[0].at(i) = strParam[2];
		vsWriteData[1].at(i) = strParam[3];
		vsWriteData[2].at(i) = strParam[4];
	}
	for (int i=0;i<nPosNum;i++)
	{
		CString strTemp = strBlank + vsWriteData[0].at(i) + strBlank + vsWriteData[1].at(i) + strBlank + vsWriteData[2].at(i);
		strTempInfo = strTempInfo + strTemp;
	}
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1]+ strTempInfo + strTail;

	return TRUE;
}
BOOL CCommProtocolXYDFast::PackReCalTargetFixOffsetFAFO(CString& strInfo,BOOL bResult)
{
	CString strHead = m_strHead;
	CString strName= m_FAFOParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;
}

// 打包标定结果
BOOL CCommProtocolXYDFast::PackReCalibrateFCLB(CString& strInfo,BOOL bResult)
{
	CString strHead = m_strHead;
	CString strName= m_FCLBParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;
	// 
	// 	CString strHead = m_strHead;
	// 	CString strCalib= "FCLB";
	// 	CString strRes;
	// 	if (bResult)
	// 	{
	// 		strRes="+0";
	// 	}
	// 	else
	// 	{
	// 		strRes="-1";
	// 	}
	// 	CString strTail = m_strTail;
	// 	CString strCR   = char(0x0D);
	// 	CString strBlank = m_strSeparator;
	// 
	// 
	// 	//构造写命令
	// 	strInfo.Empty();
	// 	strInfo = strHead + strCalib +strBlank+ strRes + strTail ;//+ strCR;

	return TRUE;

}
// 打包标定结果
BOOL CCommProtocolXYDFast::PackReCalibrateFCBP(CString& strInfo,BOOL bResult)
{
	CString strHead = m_strHead;
	CString strName= m_FCBPParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;
	// 
	// 	CString strHead = m_strHead;
	// 	CString strCalib= "FCLB";
	// 	CString strRes;
	// 	if (bResult)
	// 	{
	// 		strRes="+0";
	// 	}
	// 	else
	// 	{
	// 		strRes="-1";
	// 	}
	// 	CString strTail = m_strTail;
	// 	CString strCR   = char(0x0D);
	// 	CString strBlank = m_strSeparator;
	// 
	// 
	// 	//构造写命令
	// 	strInfo.Empty();
	// 	strInfo = strHead + strCalib +strBlank+ strRes + strTail ;//+ strCR;

	return TRUE;

}

// 打包标定结果
BOOL CCommProtocolXYDFast::PackReCalibrateFCBS(CString& strInfo,BOOL bResult)
{
	CString strHead = m_strHead;
	CString strName= m_FCBSParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;


	return TRUE;

}


// 1、FCBR:关联Calibration 的执行 执行Calibration
BOOL CCommProtocolXYDFast::PackReCalibrateFCBR(CString& strInfo,BOOL bResult)
{
	CString strHead = m_strHead;
	CString strName= m_FCBRParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;
}

// 打包目标搜索结果
BOOL CCommProtocolXYDFast::PackReTargetSearchFTGC(CString& strInfo,BOOL bResult, int nSuccessPatIndex/* = 0*/)
{

	CString strHead = m_strHead;
	CString strName= m_FTGCParam.m_strCmd;
	CString strParam[13];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = nSuccessPatIndex;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	if (m_bEnablePackInspectDistance)
	{

		int nAdressIndex=-1;
		double dParam = 0;
		int nParam=0;
		for (int i =0;i<m_vstL2LDistanceResult.size();i++)
		{
			if (m_vstL2LDistanceResult.at(i).m_bPosSearchFinished)
			{
				nAdressIndex+=1;
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[0];
				PackParam(strParam[1+nAdressIndex*3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[1];
				PackParam(strParam[1+nAdressIndex*3+1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);

				BOOL bOK = TRUE;
				for(int j=0;j<2;j++)
				{
					if (m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_nResult[j]!=1)
					{
						bOK=bOK&&FALSE;
					}
				}
				nParam = bOK? 0 : -1;
				PackParam(strParam[1+nAdressIndex*3+2], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
			}

		}
		strInfo = strHead + strName + strBlank + strParam[0];
		for (int i=0;i<=nAdressIndex;i++)
		{
			strInfo=strInfo+strBlank+strParam[1+3*i]+strBlank+strParam[1+3*i+1]+strBlank+strParam[1+3*i+2];
		}
		strInfo=strInfo+strTail;
		return TRUE;
	}
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;

	// 
	// 	CString strHead = m_strHead;
	// 	CString strTarSearch= "FTGC";
	// 	CString strRes;
	// 	if (bResult)
	// 	{
	// 		strRes="+0";
	// 
	// 		strRes.Format(_T("%010d"), nSuccessPatIndex);
	// 		strRes = "+" + strRes;
	// 	}
	// 	else
	// 	{
	// 		strRes="-1";
	// 	}
	// 	CString strTail = m_strTail;
	// 	CString strBlank  = m_strSeparator;
	// 	CString strCR    = char(0x0D);
	// 
	// 	//构造写命令
	// 	strInfo.Empty();
	// 	strInfo = strHead + strTarSearch +strBlank+ strRes + strTail;// + strCR;
	//
	//	return TRUE;

}
// 打包目标搜索结果
BOOL CCommProtocolXYDFast::PackReTargetSearchFTGT(CString& strInfo,BOOL bResult)
{
	CString strHead = m_strHead;
	CString strName= m_FTGTParam.m_strCmd;
	CString strParam[13];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	if (m_bEnablePackInspectDistance)
	{

		int nAdressIndex=-1;
		double dParam = 0;
		int nParam=0;
		for (int i =0;i<m_vstL2LDistanceResult.size();i++)
		{
			if (m_vstL2LDistanceResult.at(i).m_bPosSearchFinished)
			{
				nAdressIndex+=1;
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[0];
				PackParam(strParam[1+nAdressIndex*3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[1];
				PackParam(strParam[1+nAdressIndex*3+1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);

				BOOL bOK = TRUE;
				for(int j=0;j<2;j++)
				{
					if (m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_nResult[j]!=1)
					{
						bOK=bOK&&FALSE;
					}
				}
				nParam = bOK? 0 : -1;
				PackParam(strParam[1+nAdressIndex*3+2], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
			}

		}
		strInfo = strHead + strName + strBlank + strParam[0];
		for (int i=0;i<=nAdressIndex;i++)
		{
			strInfo=strInfo+strBlank+strParam[1+3*i]+strBlank+strParam[1+3*i+1]+strBlank+strParam[1+3*i+2];
		}
		strInfo=strInfo+strTail;
		return TRUE;
	}
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;

	// 
	// 	CString strHead = m_strHead;
	// 	CString strTarSearch= "FTGT";
	// 	CString strRes;
	// 	if (bResult)
	// 	{
	// 		strRes="+0";
	// 	}
	// 	else
	// 	{
	// 		strRes="-1";
	// 	}
	// 	CString strTail = m_strTail;
	// 	CString strBlank  = m_strSeparator;
	// 	CString strCR    = char(0x0D);
	// 
	// 	//构造写命令
	// 	strInfo.Empty();
	// 	strInfo = strHead + strTarSearch +strBlank+ strRes + strTail;// + strCR;
	// 
	// 	return TRUE;

}

BOOL CCommProtocolXYDFast::PackReTargetSearchFTGM(CString& strInfo,BOOL bResult)  
{
	CString strHead = m_strHead;
	CString strName= m_FTGMParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;
}

// 打包对象搜索结果
BOOL CCommProtocolXYDFast::PackReObjectSearchFOBJ(CString& strInfo,BOOL bResult)
{
	CString strHead = m_strHead;
	CString strName= m_FOBJParam.m_strCmd;
	CString strParam[13];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	if (m_bEnablePackInspectDistance)
	{

		int nAdressIndex=-1;
		double dParam = 0;
		int nParam=0;
		for (int i =0;i<m_vstL2LDistanceResult.size();i++)
		{
			if (m_vstL2LDistanceResult.at(i).m_bPosSearchFinished)
			{
				nAdressIndex+=1;
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[0];
				PackParam(strParam[1+nAdressIndex*3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[1];
				PackParam(strParam[1+nAdressIndex*3+1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);

				BOOL bOK = TRUE;
				for(int j=0;j<2;j++)
				{
					if (m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_nResult[j]!=1)
					{
						bOK=bOK&&FALSE;
					}
				}
				nParam = bOK? 0 : -1;
				PackParam(strParam[1+nAdressIndex*3+2], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
			}

		}
		strInfo = strHead + strName + strBlank + strParam[0];
		for (int i=0;i<=nAdressIndex;i++)
		{
			strInfo=strInfo+strBlank+strParam[1+3*i]+strBlank+strParam[1+3*i+1]+strBlank+strParam[1+3*i+2];
		}
		strInfo=strInfo+strTail;
		return TRUE;
	}
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;


	// 	CString strHead = m_strHead;
	// 	CString strTarSearch= "FOBJ";
	// 	CString strRes;
	// 	if (bResult)
	// 	{
	// 		strRes="+0";
	// 	}
	// 	else
	// 	{
	// 		strRes="-1";
	// 	}
	// 	CString strTail = m_strTail;
	// 	CString strBlank  = m_strSeparator;
	// 	CString strCR    = char(0x0D);
	// 
	// 
	// 	//构造写命令
	// 	strInfo.Empty();
	// 	strInfo = strHead + strTarSearch +strBlank+ strRes + strTail;//+strCR;
	// 
	// 	return TRUE;

}

// 打包对象搜索结果
BOOL CCommProtocolXYDFast::PackReObjectSearchFCNT(CString& strInfo,BOOL bResult)
{
	CString strHead = m_strHead;
	CString strName= m_FCNTParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;

}


BOOL CCommProtocolXYDFast::PackReTargetSearchFCNO(CString& strInfo,BOOL bResult)
{
	CString strHead = m_strHead;
	CString strName= m_FCNOParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;

}


BOOL CCommProtocolXYDFast::PackReObjectSearchFOBM(CString& strInfo,BOOL bResult)
{
	CString strHead = m_strHead;
	CString strName= m_FOBMParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;
}

// 打包对象搜索结果
BOOL CCommProtocolXYDFast::PackReObjectSearchFOBC(CString& strInfo,BOOL bResult, int nSuccessPatIndex /* = 0 */)
{
	CString strHead = m_strHead;
	CString strName= m_FOBCParam.m_strCmd;
	CString strParam[13];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = nSuccessPatIndex;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	if (m_bEnablePackInspectDistance)
	{

		int nAdressIndex=-1;
		double dParam = 0;
		int nParam=0;
		for (int i =0;i<m_vstL2LDistanceResult.size();i++)
		{
			if (m_vstL2LDistanceResult.at(i).m_bPosSearchFinished)
			{
				nAdressIndex+=1;
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[0];
				PackParam(strParam[1+nAdressIndex*3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[1];
				PackParam(strParam[1+nAdressIndex*3+1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);

				BOOL bOK = TRUE;
				for(int j=0;j<2;j++)
				{
					if (m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_nResult[j]!=1)
					{
						bOK=bOK&&FALSE;
					}
				}
				nParam = bOK? 0 : -1;
				PackParam(strParam[1+nAdressIndex*3+2], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
			}

		}
		strInfo = strHead + strName + strBlank + strParam[0];
		for (int i=0;i<=nAdressIndex;i++)
		{
			strInfo=strInfo+strBlank+strParam[1+3*i]+strBlank+strParam[1+3*i+1]+strBlank+strParam[1+3*i+2];
		}
		strInfo=strInfo+strTail;
		return TRUE;
	}


	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;

	// 	//构造写命令
	// 	strInfo.Empty();
	// 	strInfo = strHead + strName + strBlank + strParam[0] + strTail;
	// 
	// 
	// 	CString strHead = m_strHead;
	// 	CString strTarSearch= "FOBC";
	// 	CString strRes;
	// 	if (bResult)
	// 	{
	// 		strRes="+0";
	// 
	// 		strRes.Format(_T("%010d"), nSuccessPatIndex);
	// 		strRes = "+" + strRes;
	// 	}
	// 	else
	// 	{
	// 		strRes="-1";
	// 	}
	// 	CString strTail = m_strTail;
	// 	CString strBlank  = m_strSeparator;
	// 	CString strCR    = char(0x0D);
	// 
	// 
	// 	//构造写命令
	// 	strInfo.Empty();
	// 	strInfo = strHead + strTarSearch +strBlank+ strRes + strTail;//+strCR;
	// 
	// 	return TRUE;

}
//lzk 0408
BOOL CCommProtocolXYDFast::PackReSetPositionVirtualFVPC( CString& strInfo,BOOL bResult )
{
	CString strHead = m_strHead;
	CString strName= m_FVPCParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;
	return TRUE;
}
//lzk FCCI：复制标定信息
BOOL CCommProtocolXYDFast::PackReCopyCalibrateInfoFCCI( CString& strInfo,BOOL bResult )
{
	CString strHead = m_strHead;
	CString strName= m_FCCIParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;
	return TRUE;
}


// 1、 FSPC：品种切换的设定，将品种切换至指定的品种No.
// 参　数	
// 		Ｐ1	１～２５０：类型编号
// 		Ｐ2	１：辅助编号：通常设定为“1”。
// 回　复
// 	   Ｒ１	－１：异常停止 ０：正常停止

// 发送：（[STX]FSPC P1 P2[ETX]）
// 回复：（[STX]FSPC R1[ETX]）
BOOL CCommProtocolXYDFast::PackReSetProductIndexFSPC( CString& strInfo,BOOL bResult )
{
	CString strHead = m_strHead;
	CString strName= m_FSPCParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;
	return TRUE;
}
// 2、 FSSV：指定品种No.的保存，将目前使用的品种数据保存在指定的品种No.并保存在CF 记忆卡中
// 参　数	
// 		Ｐ1	０：当前使用中的类型	１～２５０：类型编号
// 		Ｐ2	１：辅助编号：通常设定为“1”。
// 回　复
// 		Ｒ１	－１：异常停止０：正常停止

// 发送：（[STX]FSSV P1 P2[ETX]）
// 回复：（[STX]FSSV R1[ETX]）
BOOL CCommProtocolXYDFast::PackReSaveProductIndexFSSV( CString& strInfo,BOOL bResult )
{
	CString strHead = m_strHead;
	CString strName= m_FSSVParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;
	return TRUE;
}
// 3、 FGSP：品种No.的取得，取得目前正在执行的品种No.
// 参 数
// 回 复	
// 		 Ｒ１	－１：异常停止　０：正常停止
// 		 Ｒ２	１～２５０：类型编号　
// 		 Ｒ３	１：辅助编号(通常返回“1”）

// 发送：（[STX]FGSP[ETX]）
// 回复：（[STX]FGSP R1 R2 R3[ETX]）
BOOL CCommProtocolXYDFast::PackReGetProductIndexFGSP( CString& strInfo,BOOL bResult, int nCurProductIndex, int nAssitIndex /*= 1*/ )
{
	CString strHead = m_strHead;
	CString strName= m_FGSPParam.m_strCmd;
	CString strParam[3];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	nParam = nCurProductIndex;
	PackParam(strParam[1], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
	nParam = nAssitIndex;
	PackParam(strParam[2], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strTail;

	return TRUE;
}

// 发送：（[STX]FVAS P1[ETX]）
// 回复：（[STX]FVAS R1[ETX]）
BOOL CCommProtocolXYDFast::PackReSetProductVirtualAlnFVAS( CString& strInfo,BOOL bResult )
{
	CString strHead = m_strHead;
	CString strName= m_FVASParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;
	return TRUE;
}
// 1、FCLB:Calibration的执行，执行Calibration
// 参　数	
// 		Ｐ1	０：目标 靶标 	１：对象　靶标（通常设定为“1”。不支持“0”）
// 		Ｐ2	１～４：靶标№
// 回 复
// 		Ｒ１	－１：异常停止 ０：正常停止

// 发送：（[STX]FCLB P1 P2[ETX]）
// 回复：（[STX]FCLB R1[ETX]）
// BOOL CCommProtocolXYDFast::PackReCalibrateFCLB( CString& strInfo,BOOL bResult )
// {
// 	CString strHead = m_strHead;
// 	CString strName= m_FCLBParam.m_strCmd;
// 	CString strParam[1];
// 	CString strBlank = m_strSeparator;
// 	CString strTail = m_strTail;	
// 	CString strCR = char(0x0D);
// 
// 	m_strCmdName = strName;
// 
// 	int nParam = 0;
// 	if (bResult)
// 	{	
// 		nParam = 0;
// 	}
// 	else
// 	{
// 		nParam = -1;
// 	}
// 	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
// 
// 	//构造写命令
// 	strInfo.Empty();
// 	strInfo = strHead + strName + strBlank + strParam[0] + strTail;
// 	return TRUE;
// }
// 1、FTGT:目标 Mark 位置的取得，取得目标 Mark（目标）位置
// 参　数	
// 			Ｐ1	    １～４  ：靶标№
// 	　　			    ５  ：靶标连续检出
// 		   　		８  ：提取目标靶标位置
// 					９  ：保存目标靶标位置
// 回 复
// 		    Ｒ１	－１：异常停止  ０：正常停止

// 发送：（[STX]FTGT P1[ETX]）
// 回复：（[STX]FTGT R1[ETX]）
// BOOL CCommProtocolXYDFast::PackReTargetSearchFTGT( CString& strInfo,BOOL bResult )
// {
// 	CString strHead = m_strHead;
// 	CString strName= m_FTGTParam.m_strCmd;
// 	CString strParam[1];
// 	CString strBlank = m_strSeparator;
// 	CString strTail = m_strTail;	
// 	CString strCR = char(0x0D);
// 
// 	m_strCmdName = strName;
// 
// 	int nParam = 0;
// 	if (bResult)
// 	{	
// 		nParam = 0;
// 	}
// 	else
// 	{
// 		nParam = -1;
// 	}
// 	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
// 
// 	//构造写命令
// 	strInfo.Empty();
// 	strInfo = strHead + strName + strBlank + strParam[0] + strTail;
// 
// 	return TRUE;
// }

// 1.1、FTGS:目标 Mark 位置的取得，取得目标 Mark（目标）位置，目标平台轴位置一致
// 参　数	
// 			Ｐ1	    １～４  ：靶标№
// 	　　			    ５  ：靶标连续检出
// 		   　		８  ：提取目标靶标位置
// 					９  ：保存目标靶标位置
// 回 复
// 		    Ｒ１	－１：异常停止  ０：正常停止

// 发送：（[STX]FTGS P1[ETX]）
// 回复：（[STX]FTGS R1[ETX]）
BOOL CCommProtocolXYDFast::PackReTargetSearchFTGS(CString& strInfo,BOOL bResult)
{
	CString strHead = m_strHead;
	CString strName= m_FTGSParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;
}


// 2、FTGC:目标 Mark 位置的取得（候补搜索），利用候补搜索取得目标 Mark（目标）位置
// 参　数	
// 			Ｐ1	１～４：靶标№
// 　				５：连续搜索靶标
// 			Ｐ２	１～５：候补检索开始的编号
// 				１０：从上次成功的候补编号开始
//  回 复
// 			Ｒ１		＊目标成对进行候补检索
// 						1～５：正常停止后的候补检索编号
//  　					－1：异常停止
// 			Ｒ１		＊独立进行目标的候补检索时
//   　					０：正常停止
// 						－１：异常停止

// 发送：（[STX]FTGC P1 P2[ETX]）
// 回复：（[STX]FTGC R1[ETX]）
// BOOL CCommProtocolXYDFast::PackReTargetSearchFTGC( CString& strInfo,BOOL bResult, int nSuccessPatIndex /*= 1*/ )
// {
// 	CString strHead = m_strHead;
// 	CString strName= m_FTGCParam.m_strCmd;
// 	CString strParam[1];
// 	CString strBlank = m_strSeparator;
// 	CString strTail = m_strTail;	
// 	CString strCR = char(0x0D);
// 
// 	m_strCmdName = strName;
// 
// 	int nParam = 0;
// 	if (bResult)
// 	{	
// 		nParam = nSuccessPatIndex;
// 	}
// 	else
// 	{
// 		nParam = -1;
// 	}
// 	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
// 
// 	//构造写命令
// 	strInfo.Empty();
// 	strInfo = strHead + strName + strBlank + strParam[0] + strTail;
// 
// 	return TRUE;
// }
// 3、FTGR:目标 Mark 位置的登录，将目前使用的品种数据保存在指定的品种No.中并保存在CF 记忆卡
// 参数
// 		Ｐ１ １～４：Mark No.
// 		Ｐ２ ０～５１１００：Ｘ的画素（１／１００画素单位）
// 		Ｐ３ ０～４７９００：Ｙ的画素（１／１００画素单位）
// 回复 
// 		Ｒ１  －１：异常结束 ０：正常结束

// 发送：（[STX]FTGR P1 P2 P3[ETX]）
// 回复：（[STX]FTGR R1[ETX]）
BOOL CCommProtocolXYDFast::PackReSaveTargetPosFTGR( CString& strInfo,BOOL bResult )
{
	CString strHead = m_strHead;
	CString strName= m_FTGRParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;
}
// 4、FTGG:目标 Mark 画素的取得，取得执行“ＦＴＧＴ”结果的画素
// 参数 
// 		Ｐ１ １～４：Mark No.
// 回复 
// 		Ｒ１ －１：异常结束 ０：正常结束
// 		Ｒ２ Ｘ的画素（１００倍值）
// 		Ｒ３ Ｙ的画素（１００倍值）

// 发送：（[STX]FTGG P1[ETX]）
// 回复：（[STX]FTGG R1 R2 R3[ETX]）
BOOL CCommProtocolXYDFast::PackReGetTargetImagePosFTGG( CString& strInfo,BOOL bResult, double dImagePosX, double dImagePosY )
{
	CString strHead = m_strHead;
	CString strName= m_FTGGParam.m_strCmd;
	CString strParam[3];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	double dParam = 0;
	dParam = dImagePosX;
	PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
	dParam = dImagePosY;
	PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strTail;

	return TRUE;
}


BOOL CCommProtocolXYDFast::PackReGetImagePosFGTC( CString& strInfo,BOOL bResult, double dImagePosX, double dImagePosY, double dImagePosD )
{
	CString strHead = m_strHead;
	CString strName= m_FGTCParam.m_strCmd;
	CString strParam[4];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	double dParam = 0;
	dParam = dImagePosX;
	PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
	dParam = dImagePosY;
	PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
	dParam = dImagePosD;
	PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);


	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] +  strBlank + strParam[3] + strTail;

	return TRUE;
}


// 发送：（[STX]FGAP P1[ETX]）
// 回复：（[STX]FGAP R1 R2 R3 R4[ETX]）
BOOL CCommProtocolXYDFast::PackReGetImagePosFGAP( CString& strInfo,BOOL bResult, double dImagePosX, double dImagePosY, double dImagePosD )
{
	CString strHead = m_strHead;
	CString strName= m_FGAPParam.m_strCmd;
	CString strParam[4];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	double dParam = 0;
	dParam = dImagePosX;
	PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
	dParam = dImagePosY;
	PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
	dParam = dImagePosD;
	PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);


	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] +  strBlank + strParam[3] + strTail;

	return TRUE;
}

// 5、FTGD:目标 Mark 指示线的全画面显示，在指定目标 Mark No.的目标 Mark 位置上显示全画面的指示线及刻度
// 参数
// 		Ｐ１  ０ ：在品种设定里所设定的显示方法
// 			  １ ～ ４：Mark No.
// 回复 
// 		Ｒ１ －１：异常结束(0)* ０：正常结束 (255)*

// 发送：（[STX]FTGD P1[ETX]）
// 回复：（[STX]FTGD R1[ETX]）
BOOL CCommProtocolXYDFast::PackReDisplayTargetFTGD( CString& strInfo,BOOL bResult )
{
	CString strHead = m_strHead;
	CString strName= m_FTGDParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;
	return TRUE;
}


BOOL CCommProtocolXYDFast::PackReAlignResultInfoFXYA(CString& strInfo,BOOL bResult, BOOL bAlignBench, CCoordPos platOffset)
{
	CString strHead = m_strHead;
	CString strName= m_FXYAParam.m_strCmd;
	CString strParam[4];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);


	if (bAlignBench) // 如果连续迭代对位过程中，需要进行对象的基准对位，指令回复中包括平台轴的相对移动量
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}
		else
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}

		//构造写命令
		strInfo.Empty();
		strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;

	}
	else
	{
		//构造写命令
		strInfo.Empty();
		strInfo = strHead + strName + strBlank + strParam[0] + strTail;
	}

	// 	//构造写命令
	// 	strInfo.Empty();
	// 	strInfo = strHead + strName + strBlank + strParam[0] + strTail;


	return TRUE;
}



// 1、FOBJ:物体 Mark 位置的取得，取得物体 Mark（对准靶标）位置
// 参　数	
// 		Ｐ1	１～４  ：靶标№
// 	　　		５  ：连续搜索靶标
// 			11～14：手动搜索靶标1－靶标4
// 			15  ：连续手动搜索靶标
// 回 复
// 		Ｒ１	－１：异常停止  ０：正常停止	  １：取消停止

// 发送：（[STX]FOBJ P1[ETX]）
// 回复：（[STX]FOBJ R1[ETX]）
// BOOL CCommProtocolXYDFast::PackReObjectSearchFOBJ( CString& strInfo,BOOL bResult )
// {
// 	CString strHead = m_strHead;
// 	CString strName= m_FOBJParam.m_strCmd;
// 	CString strParam[1];
// 	CString strBlank = m_strSeparator;
// 	CString strTail = m_strTail;	
// 	CString strCR = char(0x0D);
// 
// 	m_strCmdName = strName;
// 
// 	int nParam = 0;
// 	if (bResult)
// 	{	
// 		nParam = 0;
// 	}
// 	else
// 	{
// 		nParam = -1;
// 	}
// 	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
// 
// 	//构造写命令
// 	strInfo.Empty();
// 	strInfo = strHead + strName + strBlank + strParam[0] + strTail;
// 
// 	return TRUE;
// }
// 2、FOBC:物体 Mark 位置的取得（候补搜索），利用候补搜索取得物体 Mark（对准靶标）位置
// 参　数	
// 		Ｐ1	１～４：靶标№
// 　		５：连续进行靶标检出
// 		Ｐ２	１～５：候补搜索开始的编号
// 			１０：从上次成功的候补编号开始
//  回 复
// 		Ｒ１	＊成对进行目标靶标候补搜索时
// 				1～５：正常停止的候补搜索号码
//  　			－1：异常停止
// 		Ｒ１	＊单独进行目标　靶标候补搜索时
// 				０：正常停止
// 				－１：异常停止

// 发送：（[STX]FOBC P1 P2[ETX]）
// 回复：（[STX]FOBC R1[ETX]）
// BOOL CCommProtocolXYDFast::PackReObjectSearchFOBC( CString& strInfo,BOOL bResult, int nSuccessPatIndex /*= 1*/ )
// {
// 	CString strHead = m_strHead;
// 	CString strName= m_FOBCParam.m_strCmd;
// 	CString strParam[1];
// 	CString strBlank = m_strSeparator;
// 	CString strTail = m_strTail;	
// 	CString strCR = char(0x0D);
// 
// 	m_strCmdName = strName;
// 
// 	int nParam = 0;
// 	if (bResult)
// 	{	
// 		nParam = nSuccessPatIndex;
// 	}
// 	else
// 	{
// 		nParam = -1;
// 	}
// 	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
// 
// 	//构造写命令
// 	strInfo.Empty();
// 	strInfo = strHead + strName + strBlank + strParam[0] + strTail;
// 
// 	return TRUE;
// }
// 3、FOBG:物体 Mark 画素的取得，取得执行“ＦＯＢＪ”结果的画素
// 参数
// 		Ｐ１１～４：Mark No.
// 			５：Mark 连续搜索
// 回复		
// 		Ｒ１ －１：异常结束 ０：正常结束
// 		Ｒ２ Ｘ的画素（１００倍值）
// 		Ｒ３ Ｙ的画素（１００倍值）

// 发送：（[STX]FOBG P1[ETX]）
// 回复：（[STX]FOBG R1 R2 R3[ETX]）
BOOL CCommProtocolXYDFast::PackReGetObjectImagePosFOBG( CString& strInfo,BOOL bResult, double dImagePosX, double dImagePosY )
{
	CString strHead = m_strHead;
	CString strName= m_FOBGParam.m_strCmd;
	CString strParam[3];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	double dParam = 0;
	dParam = dImagePosX;
	PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
	dParam = dImagePosY;
	PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strTail;

	return TRUE;
}
// 4、FMSC:手动搜索位置的取得，在自动对准时，当目标 Mark 或物体 Mark 搜索失败时，可利用手动方法（鼠标）指定Mark 位置
// 参数
// 		Ｐ１   0：目标 Mark 1：物体 Mark
// 回复 
// 		Ｒ１   －１：异常结束 (0)*   ０：正常结束 (255)*  １：取消结束

// 发送：（[STX]FMSC P1[ETX]）
// 回复：（[STX]FMSC R1[ETX]）
BOOL CCommProtocolXYDFast::PackReManualSearchFMSC( CString& strInfo,BOOL bResult )
{
	CString strHead = m_strHead;
	CString strName= m_FMSCParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;
}
// 5、FWLD：取得目标（目标靶标）或对象（对象靶标）的平台坐标上的位置
// 参　数	
// 		Ｐ１	０：目标 靶标 １：对象 靶标
// 		Ｐ２	１～４：靶标№
// 回 复
// 		Ｒ１	－１：异常停止	　０：正常停止
// 		Ｒ２	-2147483648～2147483647（1/10000mm单位）：Ｘ方向的平台座标位置
// 		 Ｒ３	-2147483648～2147483647（1/10000mm单位）：Ｙ方向的平台座标位置

// 发送：（[STX]FWLD P1 P2[ETX]）
// 回复：（[STX]FWLD R1 R2 R3[ETX]）
BOOL CCommProtocolXYDFast::PackReGetSearchWorldPosFWLD( CString& strInfo,BOOL bResult, double dPlatPosX, double dPlatPosY )
{
	CString strHead = m_strHead;
	CString strName= m_FWLDParam.m_strCmd;
	CString strParam[3];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	double dParam = 0;
	dParam = dPlatPosX;
	PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
	dParam = dPlatPosY;
	PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strTail;

	return TRUE;
}

// 5.1、FWDR:获取目标/对象Mark的平台坐标系半径（相对于旋转中心的距离）
// 参　数	
// 		Ｐ１	０：目标 靶标 １：对象 靶标
// 		Ｐ２	１～４：靶标№，5：根据全部Mark计算出一个位置的R
// 回 复
// 		Ｒ１	－１：异常停止	　０：正常停止
// 		Ｒ２	-2147483648～2147483647（1/10000mm单位）：Ｘ方向的平台座标位置
// 		 Ｒ３	-2147483648～2147483647（1/10000mm单位）：Ｙ方向的平台座标位置

// 发送：（[STX]FWDR P1 P2[ETX]）
// 回复：（[STX]FWDR R1 R2[ETX]）
BOOL CCommProtocolXYDFast::PackReGetSearchWorldRadiusFWDR(CString& strInfo,BOOL bResult, CCoordPos platOffset)
{
	CString strHead = m_strHead;
	CString strName= m_FWDRParam.m_strCmd;
	CString strParam[3];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	double dParam = 0;
	dParam = platOffset.m_dPosX;
	PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strTail;

	return TRUE;
}


// 5.1、FGOW:拍照取得对象（对象靶标）的平台坐标上的位置
// 参　数	
// 		Ｐ１	０：目标 靶标 １：对象 靶标
// 		Ｐ２	１～４：靶标№，5：根据全部Mark计算出一个位置的R
// 回 复
// 		Ｒ１	－１：异常停止	　０：正常停止
// 		Ｒ２	-2147483648～2147483647（1/10000mm单位）：Ｘ方向的平台座标位置
// 		 Ｒ３	-2147483648～2147483647（1/10000mm单位）：Ｙ方向的平台座标位置

// 发送：（[STX]FGOW P1 P2 P3 P4[ETX]）
// 回复：（[STX]FGOW R1 R2 R3[ETX]）
BOOL CCommProtocolXYDFast::PackReGetObjectWorldPosFGOW(CString& strInfo,BOOL bResult, CCoordPos platOffset)
{
	CString strHead = m_strHead;
	CString strName= m_FGOWParam.m_strCmd;
	CString strParam[3];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	double dParam = 0;
	dParam = platOffset.m_dPosX;
	PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);

	dParam = platOffset.m_dPosY;
	PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strTail;

	return TRUE;
}
BOOL CCommProtocolXYDFast::PackReGetTargetImagePosFGTP(CString& strInfo,BOOL bResult, std::vector<int> vnPosIndex,std::vector<CCoordPos>& vImagePos,std::vector<CPlatformXYDAxisPos>& vPlatformAxis)
{
	int nPosNum = 0;
	if (bResult)
	{
		nPosNum = vnPosIndex.size();
	}

	CString strHead = m_strHead;
	CString strName= m_FGTPParam.m_strCmd;
	CString strParam[9];
	CString strDisInspectParam[12];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	// strParam[0] : 成功、失败
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	// strParam[1] : 总数
	nParam = nPosNum;
	PackParam(strParam[1], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	CString strDisInspectInfo = _T("");
	if (m_bEnablePackInspectDistance)
	{
		int nAdressIndex=-1;
		double dParam = 0;
		int nParam=0;
		for (int i =0;i<m_vstL2LDistanceResult.size();i++)
		{
			if (m_vstL2LDistanceResult.at(i).m_bPosSearchFinished)
			{
				nAdressIndex+=1;
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[0];
				PackParam(strDisInspectParam[nAdressIndex*3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[1];
				PackParam(strDisInspectParam[nAdressIndex*3+1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);

				BOOL bOK = TRUE;
				for(int j=0;j<2;j++)
				{
					if (m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_nResult[j]!=1)
					{
						bOK=bOK&&FALSE;
					}
				}
				nParam = bOK? 0 : -1;
				PackParam(strDisInspectParam[nAdressIndex*3+2], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
			}

		}
		for (int i=0;i<=nAdressIndex;i++)
		{
			strDisInspectInfo=strDisInspectInfo+strBlank+strDisInspectParam[3*i]+strBlank+strDisInspectParam[3*i+1]+strBlank+strDisInspectParam[3*i+2];
		}
	}

	std::vector<CString> vsWriteData[7];
	vsWriteData[0].resize(nPosNum);	// 位置序号
	vsWriteData[1].resize(nPosNum);	// X数据
	vsWriteData[2].resize(nPosNum);	// Y数据
	vsWriteData[3].resize(nPosNum);	// X1数据
	vsWriteData[4].resize(nPosNum);	// Y1数据
	vsWriteData[5].resize(nPosNum);	// X1数据
	vsWriteData[6].resize(nPosNum);	// Y1数据

	for (int i=0;i<nPosNum;i++)
	{
		int nPosIndex = vnPosIndex.at(i);
		PackParam(strParam[2], nPosIndex, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
		double dParam = 0;
		dParam = vImagePos.at(i).GetPosX();
		PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = vImagePos.at(i).GetPosY();
		PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);

		dParam = vImagePos.at(i).GetAuxiliaryPosX(0);
		PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = vImagePos.at(i).GetAuxiliaryPosY(0);
		PackParam(strParam[6], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);

		dParam = vImagePos.at(i).GetAuxiliaryPosX(1);
		PackParam(strParam[7], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = vImagePos.at(i).GetAuxiliaryPosY(1);
		PackParam(strParam[8], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);


		vsWriteData[0].at(i) = strParam[2];
		vsWriteData[1].at(i) = strParam[3];
		vsWriteData[2].at(i) = strParam[4];
		vsWriteData[3].at(i) = strParam[5];
		vsWriteData[4].at(i) = strParam[6];
		vsWriteData[5].at(i) = strParam[7];
		vsWriteData[6].at(i) = strParam[8];
	}

	CString strTempInfo = _T("");
	for (int i = 0; i < nPosNum; i++)
	{
		CString strTemp = strBlank + vsWriteData[0].at(i) + strBlank + vsWriteData[1].at(i) + strBlank + vsWriteData[2].at(i)
			+ strBlank + vsWriteData[3].at(i)+ strBlank + vsWriteData[4].at(i)+ strBlank + vsWriteData[5].at(i)+ strBlank + vsWriteData[6].at(i);
		strTempInfo = strTempInfo + strTemp;
	}

	for (int i=0;i<nPosNum;i++)
	{
		int nPosIndex = vnPosIndex.at(i);
		PackParam(strParam[2], nPosIndex, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
		double dParam = 0;
		dParam = vPlatformAxis.at(i).m_dPosX;
		PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = vPlatformAxis.at(i).m_dPosY;
		PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);

		vsWriteData[0].at(i) = strParam[2];
		vsWriteData[1].at(i) = strParam[3];
		vsWriteData[2].at(i) = strParam[4];
	}
	for (int i = 0; i < nPosNum; i++)
	{
		CString strTemp = strBlank + vsWriteData[0].at(i) + strBlank + vsWriteData[1].at(i) + strBlank + vsWriteData[2].at(i);
		strTempInfo = strTempInfo + strTemp;
	}

	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strDisInspectInfo+strBlank + strParam[1]+ strTempInfo + strTail;

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackReGetTargetPlatformPosFGTW(CString& strInfo,BOOL bResult,std::vector<int> vnPosIndex,std::vector<CCoordPos>& vCoordPos,std::vector<CPlatformXYDAxisPos>& vPlatformAxis)
{
	int nPosNum = 0;
	if (bResult)
	{
		nPosNum = vnPosIndex.size();
	}

	CString strHead = m_strHead;
	CString strName= m_FGTWParam.m_strCmd;
	CString strParam[6];
	CString strDisInspectParam[12];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	// strParam[0] : 成功、失败
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	// strParam[1] : 总数
	nParam = nPosNum;
	PackParam(strParam[1], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	CString strDisInspectInfo = _T("");
	if (m_bEnablePackInspectDistance)
	{
		int nAdressIndex=-1;
		double dParam = 0;
		int nParam=0;
		for (int i =0;i<m_vstL2LDistanceResult.size();i++)
		{
			if (m_vstL2LDistanceResult.at(i).m_bPosSearchFinished)
			{
				nAdressIndex+=1;
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[0];
				PackParam(strDisInspectParam[nAdressIndex*3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[1];
				PackParam(strDisInspectParam[nAdressIndex*3+1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);

				BOOL bOK = TRUE;
				for(int j=0;j<2;j++)
				{
					if (m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_nResult[j]!=1)
					{
						bOK=bOK&&FALSE;
					}
				}
				nParam = bOK? 0 : -1;
				PackParam(strDisInspectParam[nAdressIndex*3+2], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
			}

		}
		for (int i=0;i<=nAdressIndex;i++)
		{
			strDisInspectInfo=strDisInspectInfo+strBlank+strDisInspectParam[3*i]+strBlank+strDisInspectParam[3*i+1]+strBlank+strDisInspectParam[3*i+2];
		}
	}


	std::vector<CString> vsWriteData[4];
	vsWriteData[0].resize(nPosNum*2);	// 位置序号
	vsWriteData[1].resize(nPosNum*2);	// X数据
	vsWriteData[2].resize(nPosNum*2);	// Y数据
	vsWriteData[3].resize(nPosNum*2);	// D数据

	for (int i=0;i<nPosNum;i++)
	{
		int nPosIndex = vnPosIndex.at(i);
		PackParam(strParam[2], nPosIndex, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
		double dParam = 0;
		dParam = vCoordPos.at(i).GetPosX();
		PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = vCoordPos.at(i).GetPosY();
		PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
		dParam = vCoordPos.at(i).GetAngle();
		PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		vsWriteData[0].at(i) = strParam[2];
		vsWriteData[1].at(i) = strParam[3];
		vsWriteData[2].at(i) = strParam[4];
		vsWriteData[3].at(i) = strParam[5];
	}
	for (int i=nPosNum;i<nPosNum*2;i++)
	{
		int nPosIndex = vnPosIndex.at(i-nPosNum);
		PackParam(strParam[2], nPosIndex, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
		double dParam = 0;
		dParam = vPlatformAxis.at(i-nPosNum).m_dPosX;
		PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = vPlatformAxis.at(i-nPosNum).m_dPosY;
		PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
		dParam = vPlatformAxis.at(i-nPosNum).m_dAngle;
		PackParam(strParam[5], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		vsWriteData[0].at(i) = strParam[2];
		vsWriteData[1].at(i) = strParam[3];
		vsWriteData[2].at(i) = strParam[4];
		vsWriteData[3].at(i) = strParam[5];
	}

	CString strTempInfo = _T("");
	for (int i = 0; i < nPosNum*2; i++)
	{
		CString strTemp = strBlank + vsWriteData[0].at(i) + strBlank + vsWriteData[1].at(i) + strBlank + vsWriteData[2].at(i)+ strBlank + vsWriteData[3].at(i);
		strTempInfo = strTempInfo + strTemp;
	}
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] +strDisInspectInfo + strBlank + strParam[1]+ strTempInfo + strTail;

	return TRUE;
}


// 1、FGAL:对准精度判定设定的取得，取得对准精度的判定设定
// 参数 
// 		Ｐ１ ０：对准精度判定取得 １：最终精度判定取得
// 回复	
// 		Ｒ１ －１：异常结束 	０：正常结束
// 		Ｒ２ －2147483648～2147483647（ｍｍ单位，１００００倍值） ：Ｘ方向精度值
// 		Ｒ３ －2147483648～2147483647（ｍｍ单位，１００００倍值） ：Ｙ方向精度值 
// 		Ｒ４ －2147483648～2147483647（度单位，１０００００倍值） ：θ方向精度值

// 发送：（[STX]FGAL P1[ETX]）
// 回复：（[STX]FGAL R1 R2 R3 R4[ETX]）
BOOL CCommProtocolXYDFast::PackReGetAlignPrecisionFGAL( CString& strInfo,BOOL bResult, CCoordPos cpAlignPrecision )
{
	CString strHead = m_strHead;
	CString strName= m_FGALParam.m_strCmd;
	CString strParam[4];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	double dParam = 0;
	dParam = cpAlignPrecision.m_dPosX;
	PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
	dParam = cpAlignPrecision.m_dPosY;
	PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
	dParam = cpAlignPrecision.m_dAngle;
	PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;

	return TRUE;
}
// 2、FALL:对准精度判定的更新，更新对准时的对准精度的判定
// 参数
// 		Ｐ１  ０：设定对准精度的判定   １：设定最终对准精度判定
// 		Ｐ２ Ｘ（１／１００００ｍm 单位）
// 		Ｐ３ Ｙ（１／１００００ｍｍ单位）
// 		Ｐ４ θ（１／１０００００度单位）
// 回复
// 		Ｒ１  －１：异常结束 ０：正常结束

// 发送：（[STX]FALL P1 P2 P3 P4[ETX]）
// 回复：（[STX]FALL R1[ETX]）
BOOL CCommProtocolXYDFast::PackReSetAlignPrecisionFALL( CString& strInfo,BOOL bResult )
{
	CString strHead = m_strHead;
	CString strName= m_FALLParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;
}
// 3、FGAC:对准最多次数的取得，取得设定对准最多次数
// 参数
// 回复 
// 		Ｒ１ －１：异常结束 ０：正常结束
// 		Ｒ２ １～１０：对准最多对准次数

// 发送：（[STX]FGAC[ETX]）
// 回复：（[STX]FGAC R1 R2[ETX]）
BOOL CCommProtocolXYDFast::PackReGetAlignTimeFGAC( CString& strInfo,BOOL bResult, int nAlignTime )
{
	CString strHead = m_strHead;
	CString strName= m_FGACParam.m_strCmd;
	CString strParam[2];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	nParam = nAlignTime;
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strTail;

	return TRUE;
}
// 4、FALC:对准最多次数的更新，执行自动对准时，容许最多对准次数的更新
// 参数 
// 		Ｐ１ １～１０：设定最多对准次数
// 回复 
// 		Ｒ１  －１：异常结束  ０：正常结束

// 发送：（[STX]FALC P1[ETX]）
// 回复：（[STX]FALC R1[ETX]）
BOOL CCommProtocolXYDFast::PackReSetAlignTimeFALC( CString& strInfo,BOOL bResult )
{
	CString strHead = m_strHead;
	CString strName= m_FALCParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;
}
// 5、FAAL:自动对准的执行，执行自动对准（连续对准）
// 参数
// 		Ｐ１	０：不参照补偿量值（补偿量值为０）
// 			１：参照内部补偿量值（参照参数设定值）
// 			５：参照外部补偿量值（参照“ＦＯＦＳ”设定值）
// 			６：参照外部补偿量值（参照取得的自动补偿量值）
// 回复 
// 		Ｒ１ －１：异常结束 (0)* ０：正常结束 (255)*

// 注：另外一种解释：
// 参　数	
// 		Ｐ1	０：不参照偏移量值。（偏移量值为0）
// 			１、１０～１４：参照内部偏移量值（参照参数设定值）
// 回 复
// 		Ｒ１	－１：异常停止 ０：正常停止
//（自动迭代对位指令）

// 发送：（[STX]FAAL P1[ETX]）
// 回复：（[STX]FAAL R1[ETX]）
// BOOL CCommProtocolXYDFast::PackReAutoAlignFAAL( CString& strInfo,BOOL bResult )
// {
// 
// 	CString strHead = m_strHead;
// 	CString strName= m_FAALParam.m_strCmd;
// 	CString strParam[1];
// 	CString strBlank = m_strSeparator;
// 	CString strTail = m_strTail;	
// 	CString strCR = char(0x0D);
// 
// 	m_strCmdName = strName;
// 
// 	int nParam = 0;
// 	if (bResult)
// 	{	
// 		nParam = 0;
// 	}
// 	else
// 	{
// 		nParam = -1;
// 	}
// 	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
// 
// 	//构造写命令
// 	strInfo.Empty();
// 	strInfo = strHead + strName + strBlank + strParam[0] + strTail;
// 
// 	return TRUE;
// }
// 6、FANS:对准后的偏移量的取得，取得对准后平台坐标系的偏移量
// 参数 －
// 回复
// 		Ｒ１		－１：异常结束  ０：正常结束
// 		Ｒ２ －2147483648～2147483647 Ｘ方向的偏移量（１／10000mm 单位）
// 		Ｒ３ －2147483648～2147483647 Ｙ方向的偏移量（１／10000mm 单位）
// 		Ｒ４ －2147483648～2147483647 θ方向的偏移量（１／100000 度单位）
// （获取对位完成后的偏差量）

// 发送：（[STX]FANS[ETX]）
// 回复：（[STX]FANS R1 R2 R3 R4[ETX]）
BOOL CCommProtocolXYDFast::PackReGetAutoAlignOffsetFANS( CString& strInfo,BOOL bResult, CCoordPos cpPlatOffset )
{
	CString strHead = m_strHead;
	CString strName= m_FANSParam.m_strCmd;
	CString strParam[4];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	double dParam = 0;
	dParam = cpPlatOffset.m_dPosX;
	PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
	dParam = cpPlatOffset.m_dPosY;
	PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
	dParam = cpPlatOffset.m_dAngle;
	PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;

	return TRUE;
}
// 7、FALG:１次对准移动量的取得，取得１次对准移动量
// 参数
// 		Ｐ１	 ０：不参照补偿量值（补偿量值为０）
// 			 １：参照内部补偿量值（参照参数设定值）
// 			 ５：参照外部补偿量值（参照“ＦＯＦＳ”设定值）
// 			 ６：参照外部补偿量值（参照取得的自动补偿量值）
// 回复
// 		Ｒ１ －１：异常结束 ０：正常结束
// 
// 				ＸＹθ轴平台时
// 		Ｒ２ －2147483648～2147483647（１／１００００ｍｍ单位）：Ｘ轴的~对值移动量
// 		Ｒ３ －2147483648～2147483647（１／１００００ｍｍ单位）：Ｙ轴的~对值移动量
// 		Ｒ４ －2147483648～2147483647（１／１０００００度单位）：θ轴的~对值移动量
// 				ＵＶＷ轴平台时
// 		Ｒ２ －2147483648～2147483647（１／１００００ｍｍ单位）：U 轴的~对值移动量
// 		Ｒ３ －2147483648～2147483647（１／１００００ｍｍ单位）：V 轴的~对值移动量
// 		Ｒ４ －2147483648～2147483647（１／１００００ｍｍ单位）：W 轴的~对值移动量
//（取得一次对位指令后平台移动量，根据已经获得的目标和对象的位置，进行对位计算，获得相应的平台移动量
//（注：目标和对象，已经通过其他指令获得，此过程不用再重新获得了））

// 发送：（[STX]FALG P1[ETX]）
// 回复：（[STX]FALG R1 R2 R3 R4[ETX]）
// BOOL CCommProtocolXYDFast::PackReOnceAlignMoveFALG( CString& strInfo,BOOL bResult, CPlatformAxisPos* vpPlatAxisPos )
// {
// 	if (NULL == vpPlatAxisPos)
// 	{
// 		return FALSE;
// 	}
// 
// 	if (vpPlatAxisPos->GetPlatformType()!=ePlatformXYD)
// 	{
// 		return FALSE;
// 	}
// 
// 
// 	CString strHead = m_strHead;
// 	CString strName= m_FALGParam.m_strCmd;
// 	CString strParam[4];
// 	CString strBlank = m_strSeparator;
// 	CString strTail = m_strTail;	
// 	CString strCR = char(0x0D);
// 
// 	m_strCmdName = strName;
// 
// 	int nParam = 0;
// 	if (bResult)
// 	{	
// 		nParam = 0;
// 	}
// 	else
// 	{
// 		nParam = -1;
// 	}
// 	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
// 
// 	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
// 	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
// 
// 	double dParam = 0;
// 	dParam = pPlatformXYDAixisPos->m_dPosX;
// 	PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
// 	dParam = pPlatformXYDAixisPos->m_dPosY;
// 	PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
// 	dParam = pPlatformXYDAixisPos->m_dAngle;
// 	PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 	//构造写命令
// 	strInfo.Empty();
// 	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;
// 
// 	return TRUE;
// }
// 8、FALJ:1:次对准精度判定与对准移动量的取得，对准移动量是否在对准精度内的判定与对准移动量的取得
// 参数
// 		Ｐ１	０：不参照补偿量值（补偿量值为０）
// 			１：参照内部补偿量值（参照参数设定值）
// 			５：参照外部补偿量值（参照“ＦＯＦＳ”设定值）
// 			６：参照外部补偿量值（参照取得的自动补偿量值）
// 
// 			Ｐ２ ０：参照对准精度判定值
// 			    １：参照最终对准精度判定值（无效时请参照对准精度判定值）
// 回复
// 		Ｒ１ －１：异常结束 ０：正常结束
// 				ＸＹθ轴平台时
// 		Ｒ２ －2147483648～2147483647（１／１００００ｍｍ单位）：Ｘ轴的~对值移动量
// 		Ｒ３ －2147483648～2147483647（１／１００００ｍｍ单位）：Ｙ轴的~对值移动量
// 		Ｒ４ －2147483648～2147483647（１／１０００００度单位）：θ轴的~对值移动量
// 			ＵＶＷ轴平台时
// 		Ｒ２ －2147483648～2147483647（１／１００００ｍｍ单位）：U 轴的~对值移动量
// 		Ｒ３ －2147483648～2147483647（１／１００００ｍｍ单位）：V 轴的~对值移动量
// 		Ｒ４ －2147483648～2147483647（１／１００００ｍｍ单位）：W 轴的~对值移动量
//（取得一次对位指令后平台移动量，根据已经获得的目标，然后拍摄对象的位置进行对位计算，获得相应的平台移动量
//（注：目标已经通过其他指令获得，但对象还未获得；非迭代执行，也就是此过程中不会再二次检查对象位置））

// 发送：（[STX]FALJ P1[ETX]）
// 回复：（[STX]FALJ R1 R2 R3 R4[ETX]）
BOOL CCommProtocolXYDFast::PackReOnceAlignFALJ( CString& strInfo,BOOL bResult, CPlatformAxisPos* vpPlatAxisPos )
{
	if (NULL == vpPlatAxisPos)
	{
		return FALSE;
	}

	if (vpPlatAxisPos->GetPlatformType()!=ePlatformXYD)
	{
		return FALSE;
	}


	CString strHead = m_strHead;
	CString strName= m_FALJParam.m_strCmd;
	CString strParam[4];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	

	double dParam = 0;
	dParam = pPlatformXYDAixisPos->m_dPosX;
	PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
	dParam = pPlatformXYDAixisPos->m_dPosY;
	PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
	dParam = pPlatformXYDAixisPos->m_dAngle;
	PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;

	return TRUE;
}
// 9、FACO:偏移量的取得，取得目标 Mark 及物体 Mark 之间中心的平台坐标系偏移量
// 参数 －
// 回复
// 		Ｒ１ －１：异常结束 ０：正常结束
// 		Ｒ２ －2147483648～2147483647 Ｘ方向的偏移量（１／10000mm 单位）
// 		Ｒ３ －2147483648～2147483647 Ｙ方向的偏移量（１／10000mm 单位）
// 		Ｒ４ －2147483648～2147483647 θ方向的偏移量（１／100000 度单位）
//（根据已经获得的目标和对象的位置，进行对位计算，获得目标和对象之间的偏差，但不考虑各种补偿量
//（注：目标和对象，已经通过其他指令获得，此过程不用再重新获得了））

// 发送：（[STX]FACO[ETX]）
// 回复：（[STX]FACO R1 R2 R3 R4[ETX]）
// BOOL CCommProtocolXYDFast::PackReGetTargetObjectOffsetFACO( CString& strInfo,BOOL bResult, CCoordPos cpPlatOffset )
// {
// 	CString strHead = m_strHead;
// 	CString strName= m_FACOParam.m_strCmd;
// 	CString strParam[4];
// 	CString strBlank = m_strSeparator;
// 	CString strTail = m_strTail;	
// 	CString strCR = char(0x0D);
// 
// 	m_strCmdName = strName;
// 
// 	int nParam = 0;
// 	if (bResult)
// 	{	
// 		nParam = 0;
// 	}
// 	else
// 	{
// 		nParam = -1;
// 	}
// 	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
// 
// 	double dParam = 0;
// 	dParam = cpPlatOffset.m_dPosX;
// 	PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
// 	dParam = cpPlatOffset.m_dPosY;
// 	PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
// 	dParam = cpPlatOffset.m_dAngle;
// 	PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 	//构造写命令
// 	strInfo.Empty();
// 	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;
// 
// 	return TRUE;
// 
// }
// 1、FAOF:自动补偿量值的取得，对准偏移量以补偿量值取得
// 参数
// 		Ｐ１	０：不参照补偿量值（补偿量值为０）
// 			１：参照内部补偿量值（参照参数设定值）
// 			５：参照外部补偿量值（参照“ＦＯＦＳ”设定值）
// 			６：参照外部补偿量值（参照取得的自动补偿量值）
// 回复 
// 		Ｒ１	－１：异常结束 (255)*	０：正常结束 (0)*

// 发送：（[STX]FAOF P1[ETX]）
// 回复：（[STX]FAOF R1[ETX]）
BOOL CCommProtocolXYDFast::PackReCalcuAlignOffsetFAOF( CString& strInfo,BOOL bResult )
{

	CString strHead = m_strHead;
	CString strName= m_FAOFParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;
}
// 2、FGOF:补偿量值的取得，取得设定的补偿量值
// 参数
// 		Ｐ１０：取得最后使用的补偿量值。（最后下达ＦＡＡＬ，ＦＡＬＧ，ＦＡＬＪ，ＦＡＯＦ，ＦＡＣＯ的其中一个指令时所使用的补偿量值。
// 		       但ＦＡＣＯ下达时会自动设定无补偿量，因此在下达ＦＡＣＯ后得到的回复为（Ｒ２，Ｒ３，Ｒ４）＝（０，０，０））。
// 			１：内部补偿量值（取得参数设定值）
// 			５：外部补偿量值（取得在“FOFS”的设定值）
// 			６：外部补偿量值（取得在“FAOF”指令所取得的自动补偿量值）
// 回复
// 		Ｒ１－１：异常结束 ０：正常结束
// 		Ｒ２ －2147483648～2147483647（mm 单位，１００００倍值）：Ｘ方向的补偿量值
// 		Ｒ３ －2147483648～2147483647（ｍｍ单位，１００００倍值）：Ｙ方向的补偿量值
// 		Ｒ４ －2147483648～2147483647（度单位，１０００００倍值）：θ方向的补偿量值

// 发送：（[STX]FGOF P1[ETX]）
// 回复：（[STX]FGOF R1 R2 R3 R4[ETX]）
BOOL CCommProtocolXYDFast::PackReGetAlignOffsetFGOF( CString& strInfo,BOOL bResult, CCoordPos cpAlignOffset )
{
	CString strHead = m_strHead;
	CString strName= m_FGOFParam.m_strCmd;
	CString strParam[4];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	double dParam = 0;
	dParam = cpAlignOffset.m_dPosX;
	PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
	dParam = cpAlignOffset.m_dPosY;
	PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
	dParam = cpAlignOffset.m_dAngle;
	PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;

	return TRUE;
}
// 3、FOFS:补偿量值的设定，设定补偿量值
// 参数
// 		Ｐ１ －2147483648～2147483647（１／１００００ｍｍ单位）：Ｘ方向的补偿量值
// 		Ｐ２ －2147483648～2147483647（１／１００００ｍｍ单位）：Ｙ方向的补偿量值
// 		Ｐ３ －2147483648～2147483647（１／１０００００度单位）：θ方向的补偿量值
// 回复 
// 		Ｒ１－１：异常结束 ０：正常结束

// 发送：（[STX]FOFS P1 P2 P3[ETX]）
// 回复：（[STX]FOFS R1[ETX]）
BOOL CCommProtocolXYDFast::PackReSetAlignOffsetFOFS( CString& strInfo,BOOL bResult )
{
	CString strHead = m_strHead;
	CString strName= m_FOFSParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;
}
// 4、FSFT:平台Shift 移动动作，选择内部转移量的设定值，并依照设定值将目前平台的位置做相对移动
// 参数
// 		Ｐ１ ０ ：不参照移动值（移动值为０）
// 			 １～３：参照内部移动值（参照参数设定值）
// 回复 
// 		Ｒ１ －１：异常结束(255)* ０：正常结束 (0)*

// 发送：（[STX]FSFT P1[ETX]）
// 回复：（[STX]FSFT R1[ETX]）
BOOL CCommProtocolXYDFast::PackReFSFT( CString& strInfo,BOOL bResult )
{
	CString strHead = m_strHead;
	CString strName= m_FSFTParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;
}
// 5、FGSF:对准Shift 移动量的取得，取得对准转移量
// 参数
// 		Ｐ１０ ：不参照移动值（移动值为０）
// 				１～３：参照内部移动值（参照参数设定值）
// 回复
// 		Ｒ１－１：异常结束 ０：正常结束
// 					ＸＹθ轴平台时
// 		Ｒ２ －2147483648～2147483647（１／１００００ｍｍ单位）：Ｘ轴的~对值移动量
// 		Ｒ３ －2147483648～2147483647（１／１００００ｍｍ单位）：Ｙ轴的~对值移动量
// 		Ｒ４ －2147483648～2147483647（１／１０００００度单位）：θ轴的~对值移动量
// 					ＵＶＷ轴平台时
// 		Ｒ２ －2147483648～2147483647（１／１００００ｍｍ单位）：U 轴的~对值移动量
// 		Ｒ３ －2147483648～2147483647（１／１００００ｍｍ单位）：V 轴的~对值移动量
// 		Ｒ４ －2147483648～2147483647（１／１００００ｍｍ单位）：W 轴的~对值移动量

// 发送：（[STX]FGSF P1[ETX]）
// 回复：（[STX]FGSF R1 R2 R3 R4[ETX]）
BOOL CCommProtocolXYDFast::PackReFGSF( CString& strInfo,BOOL bResult, CPlatformAxisPos* vpPlatAxisPos )
{

	CString strHead = m_strHead;
	CString strName= m_FGSFParam.m_strCmd;
	CString strParam[4];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	

	double dParam = 0;
	dParam = pPlatformXYDAixisPos->m_dPosX;
	PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
	dParam = pPlatformXYDAixisPos->m_dPosY;
	PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
	dParam = pPlatformXYDAixisPos->m_dAngle;
	PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackReGetAlignOffsetFGPO(CString& strInfo, BOOL bResult, CCoordPos& coAlignOffset)
{
	CString strHead = m_strHead;
	CString strName= m_FGPOParam.m_strCmd;
	CString strParam[4];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;
	int nParam = bResult ? 0: -1;
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	double dParam = 0;
	dParam = coAlignOffset.GetPosX();
	PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
	dParam = coAlignOffset.GetPosY();
	PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
	dParam = coAlignOffset.GetAngle();
	PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;

	return TRUE;
}

// 1、FALM:Alarm资料的取得，取得错误发生的数据代码
// 参数 －
// 回复 
// 		Ｒ１ ０：没有错误  －５０～－２５０：错误代码
// 		Ｒ２ 仿真数据。（通常设定为“－１”）

// 发送：（[STX]FALM[ETX]）
// 回复：（[STX]FALM R1 R2[ETX]）
BOOL CCommProtocolXYDFast::PackReGetAlarmFALM( CString& strInfo,int nAlarmIndex, int nSimData /*= -1*/ )
{
	CString strHead = m_strHead;
	CString strName= m_FALMParam.m_strCmd;
	CString strParam[2];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;

	nParam = nAlarmIndex;
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	nParam = nSimData;
	PackParam(strParam[1], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strTail;

	return TRUE;
}
// 2、FRST:重新设定（清除错误等），清除各种错误及显示重新设定
// 参数 －
// 回复 －

// 发送：（[STX]FRST[ETX]）
// 回复：（[STX]FRST[ETX]）
// BOOL CCommProtocolXYDFast::PackReResetFRST( CString& strInfo )
// {
// 	CString strHead = m_strHead;
// 	CString strName= m_FRSTParam.m_strCmd;
// 	CString strParam[1];
// 	CString strBlank = m_strSeparator;
// 	CString strTail = m_strTail;	
// 	CString strCR = char(0x0D);
// 
// 	m_strCmdName = strName;
// 
// 	//构造写命令
// 	strInfo.Empty();
// 	strInfo = strHead + strName + strTail;
// 
// 	return TRUE;
// }
// 3、FSAC：保存校正、定位时的数据。所保存的数据为最近500次操作时的数据（不到500次时保存实际次数的数据）
// 参　数	－	
// 回 复
// 		Ｒ１	－１：异常停止 　０：正常停止
// 发送：（[STX]FSAC[ETX]）
// 回复：（[STX]FSAC R1[ETX]）
BOOL CCommProtocolXYDFast::PackReSaveProcessDataFSAC( CString& strInfo,BOOL bResult )
{
	CString strHead = m_strHead;
	CString strName= m_FSACParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;
}

// 4、FSCO：保存指令收发的历史纪录。所保存的数据为最近500次操作时的数据（不到500次时保存实际次数的数据）
// 参　数	－	
// 回 复
// 		Ｒ１	－１：异常停止 　０：正常停止
// 发送：（[STX]FSCO[ETX]）
// 回复：（[STX]FSCO R1[ETX]）
BOOL CCommProtocolXYDFast::PackReSaveCommDataFSCO( CString& strInfo,BOOL bResult )
{
	CString strHead = m_strHead;
	CString strName= m_FSCOParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;
}

// 产品曝光时间设置
BOOL CCommProtocolXYDFast::PackReProductExposureFSPE( CString& strInfo,BOOL bResult )
{
	CString strHead = m_strHead;
	CString strName= m_FSPEParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;
	return TRUE;
}

// 焊接专用指令
BOOL CCommProtocolXYDFast::PackReAlignResultInfoFWEL( CString& strInfo, BOOL bResult, BOOL bAlignBench, CCoordPos platOffset)
{

	CString strHead = m_strHead;
	CString strName= m_FWELParam.m_strCmd;
	CString strParam[4];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 1;//by CR
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);


	if (bAlignBench) // 如果连续迭代对位过程中，需要进行对象的基准对位，指令回复中包括平台轴的相对移动量
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}
		else
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}

		//构造写命令
		strInfo.Empty();
		strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;

	}
	else
	{
		//构造写命令
		strInfo.Empty();
		strInfo = strHead + strName + strBlank + strParam[0] + strTail;
	}


	return TRUE;

}

// 焊接专用指令
BOOL CCommProtocolXYDFast::PackReAlignResultInfoFSOL( CString& strInfo, BOOL bResult, BOOL bAlignBench, CCoordPos platOffset)
{

	CString strHead = m_strHead;
	CString strName= m_FSOLParam.m_strCmd;
	CString strParam[4];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 1;//by CR
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);


	if (bAlignBench) // 如果连续迭代对位过程中，需要进行对象的基准对位，指令回复中包括平台轴的相对移动量
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}
		else
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}

		//构造写命令
		strInfo.Empty();
		strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;

	}
	else
	{
		//构造写命令
		strInfo.Empty();
		strInfo = strHead + strName + strBlank + strParam[0] + strTail;
	}


	return TRUE;

}


BOOL CCommProtocolXYDFast::PackReObjTarSearchFPCB(CString& strInfo,BOOL bResult,std::vector<CCoordPos>markPos)
{
	CString strHead = m_strHead;
	CString strName= m_FPCBParam.m_strCmd;
	CString strParam[1];
	std::vector<CString> vstrParam;
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	vstrParam.clear();
	for (int i=0;i<markPos.size();i++)
	{
		CString strTemp,strTempX,strTempY;
		PackParam(strTempX,markPos.at(i).m_dPosX,m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
		PackParam(strTempY,markPos.at(i).m_dPosY,m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
		strTemp.Empty();
		strTemp = strTempX+strBlank+strTempY;
		vstrParam.push_back(strTemp);

	}

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0];// + strTail;
	for (int i=0;i<vstrParam.size();i++)
	{
		strInfo = strInfo + strBlank + vstrParam.at(i);
	}

	strInfo = strInfo + strTail;

	return TRUE;

}

BOOL CCommProtocolXYDFast::PackReProductInspectFINS( CString& strInfo,BOOL bResult )
{
	CString strHead = m_strHead;
	CString strName= m_FINSParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackRePCBPrecisionFCPI( CString& strInfo,BOOL bResult )
{
	CString strHead = m_strHead;
	CString strName= m_FCPIParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;

}
BOOL CCommProtocolXYDFast::PackRePCBPrecisionFPIS( CString& strInfo,BOOL bResult )
{
	CString strHead = m_strHead;
	CString strName= m_FPISParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;

	return TRUE;

}


BOOL CCommProtocolXYDFast::ConvertToPlatformXYDAxisPos(std::vector<CString> vstrParam, CPlatformAxisPos* vpPlatAxisPos)
{
	if (vpPlatAxisPos == NULL)
	{
		return FALSE;
	}

	if (vpPlatAxisPos->GetPlatformType()!=ePlatformXYD)
	{
		return eAswUnkown;
	}

	double dBase = 10;
	if (m_pMidPlatformInfo == NULL)
	{
		if (vstrParam.size() != 3)
		{
			return FALSE;
		}

		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);

		}
		else
		{
			CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);

		}

	}
	else
	{
		switch(m_eMidPlatformType)
		{
		case ePlatformXYD:
			{
				if (vstrParam.size() != 3)
				{
					return FALSE;
				}

				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
					pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
					pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
					pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
					pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
					pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
					pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);

				}
			}
			break;

			// 		case ePlatformXYPD:
			// 			{
			// 				if (vstrParam.size() != 3)
			// 				{
			// 					return FALSE;
			// 				}
			// 
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXD:
			// 			{
			// 				if (vstrParam.size() != 3)
			// 				{
			// 					return FALSE;
			// 				}
			// 
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXY:
			// 			{
			// 				if (vstrParam.size() != 3)
			// 				{
			// 					return FALSE;
			// 				}
			// 
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformX:
			// 			{
			// 				if (vstrParam.size() != 3)
			// 				{
			// 					return FALSE;
			// 				}
			// 
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformY:
			// 			{
			// 				if (vstrParam.size() != 3)
			// 				{
			// 					return FALSE;
			// 				}
			// 
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXDPY:
			// 			{
			// 				if (vstrParam.size() != 3)
			// 				{
			// 					return FALSE;
			// 				}
			// 
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXDPY1:
			// 			{
			// 				if (vstrParam.size() != 3)
			// 				{
			// 					return FALSE;
			// 				}
			// 
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformYD:
			// 			{
			// 				if (vstrParam.size() != 3)
			// 				{
			// 					return FALSE;
			// 				}
			// 
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

		case ePlatformXY1Y2:
			{
				if (vstrParam.size() != 3)
				{
					return FALSE;
				}

				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dY1 = 0.0;
					double dY2 = 0.0;

					double dX0 = 0.0;
					double dY0 = 0.0;
					double dD0 = 0.0;
					CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;


					dX1 = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
					dY1 = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
					dY2 = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp); 

					pPlatformXY1Y2Info->ConvertXY1Y2PltfmPosToXYDPltfmPos(dY1, dY2, dX1, dX0, dY0, dD0);

					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
					pPlatformXYDAixisPos->m_dPosX  = dX0;
					pPlatformXYDAixisPos->m_dPosY  = dY0;
					pPlatformXYDAixisPos->m_dAngle  = dD0;

				}
				else
				{
					return FALSE;
				}
			}
			break;

		case ePlatformX1X2Y:
			{
				if (vstrParam.size() != 3)
				{
					return FALSE;
				}

				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dX2 = 0.0;
					double dY1 = 0.0;

					double dX0 = 0.0;
					double dY0 = 0.0;
					double dD0 = 0.0;
					CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;


					dX1 = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
					dX2 = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
					dY1 = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);

					//dX1 = dX1 - 5.5;
					//dX2 = dX2 - 5.5;
					//dY1 = dY1 - 5.5;
					pPlatformX1X2YInfo->ConvertX1X2YPltfmPosToXYDPltfmPos(dX1, dX2, dY1, dX0, dY0, dD0);

					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
					pPlatformXYDAixisPos->m_dPosX  = dX0;
					pPlatformXYDAixisPos->m_dPosY  = dY0;
					pPlatformXYDAixisPos->m_dAngle  = dD0;
				}
				else
				{
					return FALSE;
				}
			}
			break;

		default:
			{
				if (vstrParam.size() != 3)
				{
					return FALSE;
				}

				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
					pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
					pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
					pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
					pPlatformXYDAixisPos->m_dPosX  = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
					pPlatformXYDAixisPos->m_dPosY  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
					pPlatformXYDAixisPos->m_dAngle  = atof(vstrParam[2])/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);

				}

			}
		}
	}

	return TRUE;
}

BOOL CCommProtocolXYDFast::ConvertToPlatformXYDAxisPos(std::vector<int> vnParam, CPlatformAxisPos* vpPlatAxisPos)
{
	if (vpPlatAxisPos == NULL)
	{
		return FALSE;
	}

	if (vpPlatAxisPos->GetPlatformType()!=ePlatformXYD)
	{
		return eAswUnkown;
	}

	vector<int> vnTrans;
	vnTrans.resize(3);

	for (int it=0;it<vnTrans.size();it++)
	{
		vnTrans[it] = it;
	}

	switch(m_eCmdParamOrderType)
	{
	case eCPOrderXYD:
		{
			vnTrans[0] = 0;
			vnTrans[1] = 1;
			vnTrans[2] = 2;
		}
		break;
	case eCPOrderYXD:
		{
			vnTrans[0] = 1;
			vnTrans[1] = 0;
			vnTrans[2] = 2;
		}
		break;
	case eCPOrderXDY:
		{
			vnTrans[0] = 0;
			vnTrans[1] = 2;
			vnTrans[2] = 1;
		}
		break;
	case eCPOrderDXY:
		{
			vnTrans[0] = 2;
			vnTrans[1] = 0;
			vnTrans[2] = 1;
		}
		break;
	case eCPOrderYDX:
		{
			vnTrans[0] = 1;
			vnTrans[1] = 2;
			vnTrans[2] = 0;
		}
		break;
	case eCPOrderDYX:
		{
			vnTrans[0] = 2;
			vnTrans[1] = 1;
			vnTrans[2] = 0;
		}
		break;
	default:
		{
			vnTrans[0] = 0;
			vnTrans[1] = 1;
			vnTrans[2] = 2;
		}
		break;
	}

	double dBase = 10;
	if (m_pMidPlatformInfo == NULL)
	{
		if (vnParam.size() != 3)
		{
			return FALSE;
		}

		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		pPlatformXYDAixisPos->m_dPosX  = vnParam[vnTrans[0]]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
		pPlatformXYDAixisPos->m_dPosY  = vnParam[vnTrans[1]]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
		pPlatformXYDAixisPos->m_dAngle  = vnParam[vnTrans[2]]/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);

	}
	else
	{
		switch(m_eMidPlatformType)
		{
		case ePlatformXYD:
			{
				if (vnParam.size() != 3)
				{
					return FALSE;
				}

				CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
				pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
				pPlatformXYDAixisPos->m_dPosX  = vnParam[vnTrans[0]]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
				pPlatformXYDAixisPos->m_dPosY  = vnParam[vnTrans[1]]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
				pPlatformXYDAixisPos->m_dAngle  = vnParam[vnTrans[2]]/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);

			}
			break;

			// 		case ePlatformXYPD:
			// 			{
			// 				if (vnParam.size() != 3)
			// 				{
			// 					return FALSE;
			// 				}
			// 
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = vnParam[1]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = vnParam[0]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = vnParam[2]/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = vnParam[0]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = vnParam[1]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = vnParam[2]/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXD:
			// 			{
			// 				if (vnParam.size() != 3)
			// 				{
			// 					return FALSE;
			// 				}
			// 
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = vnParam[1]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = vnParam[0]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = vnParam[2]/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = vnParam[0]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = vnParam[1]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = vnParam[2]/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXY:
			// 			{
			// 				if (vnParam.size() != 3)
			// 				{
			// 					return FALSE;
			// 				}
			// 
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = vnParam[1]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = vnParam[0]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = vnParam[2]/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = vnParam[0]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = vnParam[1]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = vnParam[2]/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformX:
			// 			{
			// 				if (vnParam.size() != 3)
			// 				{
			// 					return FALSE;
			// 				}
			// 
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = vnParam[1]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = vnParam[0]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = vnParam[2]/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = vnParam[0]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = vnParam[1]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = vnParam[2]/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformY:
			// 			{
			// 				if (vnParam.size() != 3)
			// 				{
			// 					return FALSE;
			// 				}
			// 
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = vnParam[1]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = vnParam[0]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = vnParam[2]/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = vnParam[0]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = vnParam[1]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = vnParam[2]/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXDPY:
			// 			{
			// 				if (vnParam.size() != 3)
			// 				{
			// 					return FALSE;
			// 				}
			// 
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = vnParam[1]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = vnParam[0]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = vnParam[2]/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = vnParam[0]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = vnParam[1]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = vnParam[2]/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

			// 		case ePlatformXDPY1:
			// 				{
			// 					if (vnParam.size() != 3)
			// 					{
			// 						return FALSE;
			// 					}
			// 
			// 					if (eCPOrderYXD == m_eCmdParamOrderType)
			// 					{
			// 						CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 						pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 						pPlatformXYDAixisPos->m_dPosX  = vnParam[1]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 						pPlatformXYDAixisPos->m_dPosY  = vnParam[0]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 						pPlatformXYDAixisPos->m_dAngle  = vnParam[2]/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					}
			// 					else
			// 					{
			// 						CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 						pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 						pPlatformXYDAixisPos->m_dPosX  = vnParam[0]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 						pPlatformXYDAixisPos->m_dPosY  = vnParam[1]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 						pPlatformXYDAixisPos->m_dAngle  = vnParam[2]/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					}
			// 				}
			// 				break;

			// 		case ePlatformYD:
			// 			{
			// 				if (vnParam.size() != 3)
			// 				{
			// 					return FALSE;
			// 				}
			// 
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = vnParam[1]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = vnParam[0]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = vnParam[2]/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			// 					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			// 					pPlatformXYDAixisPos->m_dPosX  = vnParam[0]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			// 					pPlatformXYDAixisPos->m_dPosY  = vnParam[1]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			// 					pPlatformXYDAixisPos->m_dAngle  = vnParam[2]/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

		case ePlatformXY1Y2:
			{
				if (vnParam.size() != 3)
				{
					return FALSE;
				}

				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dY1 = 0.0;
					double dY2 = 0.0;

					double dX0 = 0.0;
					double dY0 = 0.0;
					double dD0 = 0.0;
					CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;


					//dX1 = vnParam[0]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
					//dY1 = vnParam[1]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
					//dY2 = vnParam[2]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp); 

					dX1 = vnParam[vnTrans[0]]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
					dY1 = vnParam[vnTrans[1]]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
					dY2 = vnParam[vnTrans[2]]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp); 

					pPlatformXY1Y2Info->ConvertXY1Y2PltfmPosToXYDPltfmPos(dY1, dY2, dX1, dX0, dY0, dD0);

					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
					pPlatformXYDAixisPos->m_dPosX  = dX0;
					pPlatformXYDAixisPos->m_dPosY  = dY0;
					pPlatformXYDAixisPos->m_dAngle  = dD0;

				}
				else
				{
					return FALSE;
				}
			}
			break;

		case ePlatformX1X2Y:
			{
				if (vnParam.size() != 3)
				{
					return FALSE;
				}

				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dX2 = 0.0;
					double dY1 = 0.0;

					double dX0 = 0.0;
					double dY0 = 0.0;
					double dD0 = 0.0;
					CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

					//dX1 = vnParam[0]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
					//dX2 = vnParam[1]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp); 
					//dY1 = vnParam[2]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);

					dX1 = vnParam[vnTrans[0]]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
					dX2 = vnParam[vnTrans[1]]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp); 
					dY1 = vnParam[vnTrans[2]]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);

					//dX1 = dX1 - 5.5;
					//dX2 = dX2 - 5.5;
					//dY1 = dY1 - 5.5;
					pPlatformX1X2YInfo->ConvertX1X2YPltfmPosToXYDPltfmPos(dX1, dX2, dY1, dX0, dY0, dD0);

					CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
					pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
					pPlatformXYDAixisPos->m_dPosX  = dX0;
					pPlatformXYDAixisPos->m_dPosY  = dY0;
					pPlatformXYDAixisPos->m_dAngle  = dD0;
				}
				else
				{
					return FALSE;
				}
			}
			break;

		default:
			{
				if (vnParam.size() != 3)
				{
					return FALSE;
				}

				CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
				pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
				pPlatformXYDAixisPos->m_dPosX  = vnParam[vnTrans[0]]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
				pPlatformXYDAixisPos->m_dPosY  = vnParam[vnTrans[1]]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
				pPlatformXYDAixisPos->m_dAngle  = vnParam[vnTrans[2]]/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
				
			}
		}
	}

	return TRUE;
}

BOOL CCommProtocolXYDFast::ConvertToCamXYAxisPos(std::vector<CString> vstrParam, CPlatformAxisPos* vpCamAxisPos)
{
	if (vpCamAxisPos == NULL)
	{
		return FALSE;
	}



	double dBase = 10;

	CPlatformXYAxisPos* pCamXYAixisPos; 		
	pCamXYAixisPos = (CPlatformXYAxisPos*)(vpCamAxisPos);	
	pCamXYAixisPos->m_dPosX  = atof(vstrParam[0])/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
	pCamXYAixisPos->m_dPosY  = atof(vstrParam[1])/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);

	return TRUE;
}

BOOL CCommProtocolXYDFast::ReplaceNewCommCmd(const CString strOldCmd, CString& strNewCmd)
{
	int nIndex = 0;
	strNewCmd = strOldCmd;
	CString strOldSub = _T("");
	CString strNewSub = _T("");
	for (nIndex = 0; nIndex < COMMCMDSTRINGNUM; nIndex++)
	{
		strOldSub = g_strCommCmdString[nIndex][0];
		strNewSub = g_strCommCmdString[nIndex][1];

		if (strNewCmd.Replace(strOldSub, strNewSub) > 0)
		{
			break;
		}		
	}

	return TRUE;
}


//////////////////////////////////////////////////////////////////////////
// Yamaha 机器人
// 指令分析
// 命令格式（[Pos] R1 R2 R3 R4 R5 R6）
BOOL CCommProtocolXYDFast::AnalyzeRobotCommandParam(CString strCmd, CString& strName, std::vector<CString>& vstrParam)
{
	strName = _T("");
	vstrParam.clear();

	int nLength = strCmd.GetLength();
	if (nLength <= 0) return FALSE;

	CString strSTX = m_strRobotHead;
	CString strETX = m_strRobotTail;
	CString strSpace = m_strRobotSeparator;
	CString strEqual = m_strRobotEqual;
	// 
	std::vector<int> vnStartIndex;
	std::vector<int> vnEndIndex;

	CString strTemp;
	int i = 0;
	BOOL bNeedStart = TRUE;
	BOOL bNeedEnd = FALSE;
	for (i = 0; i < nLength; i++)
	{
		strTemp = strCmd.GetAt(i);

		if (strTemp == strEqual)
		{
			vnStartIndex.push_back(i);
			vnEndIndex.push_back(i);
			continue;
		}

		if ((bNeedStart == TRUE) && (strTemp != strSpace) && (strTemp != strEqual))
		{
			vnStartIndex.push_back(i);
			bNeedStart = FALSE;
			bNeedEnd = TRUE;
		}

		if ((bNeedEnd == TRUE) && ((strTemp == strSpace) || (strTemp == strEqual)) && (i > 0))
		{
			vnEndIndex.push_back(i-1);
			bNeedStart = TRUE;
			bNeedEnd = FALSE;
		}

		if ((bNeedEnd == TRUE) && (strTemp != strSpace) &&  (strTemp != strEqual)  && (i == nLength-1))
		{
			vnEndIndex.push_back(i);
			bNeedStart = TRUE;
			bNeedEnd = FALSE;
		}



	}


	if (vnStartIndex.size() != vnEndIndex.size())
	{
		return FALSE;
	}

	for (i = 0; i < vnStartIndex.size(); i++)
	{
		vstrParam.push_back(strCmd.Mid(vnStartIndex.at(i), vnEndIndex.at(i) - vnStartIndex.at(i) + 1));
	}

	return TRUE;
}


// 1）机器人工作模式查询、设定（手动模式manual、自动模式auto等）；
//	命令 @ ?MOD [cr/lf]
//	应答 AUTO [cr/lf]
BOOL CCommProtocolXYDFast::PackRobotGetMod(CString& strInfo)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= COMM_ROBOT_CMD_STRING_MOD;
	CString strParam[1];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strQuery + strName;

	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotGetMod(CString strAsw, RobotMod& rmRobotMod)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_AUTO)
	{
		rmRobotMod = eRmAuto;
	}
	else if (strAsw == COMM_ROBOT_CMD_STRING_PROGRAM)
	{
		rmRobotMod = eRmProgram;
	}
	else if (strAsw == COMM_ROBOT_CMD_STRING_MANUAL)
	{
		rmRobotMod = eRmManual;
	}
	else if (strAsw == COMM_ROBOT_CMD_STRING_SYSTEM)
	{
		rmRobotMod = eRmSystem;
	}
	else
	{
		rmRobotMod = eRmUnknown;
	}

	return eAswSucceed;
}

BOOL CCommProtocolXYDFast::PackRobotSetMod(CString& strInfo, RobotMod rmRobotMod)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= _T("");
	CString strParam[1];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);

	if (rmRobotMod == eRmAuto)
	{
		strName = COMM_ROBOT_CMD_STRING_AUTO;
	}
	else if (rmRobotMod == eRmProgram)
	{
		strName = COMM_ROBOT_CMD_STRING_PROGRAM;
	}
	else if (rmRobotMod == eRmManual)
	{
		strName = COMM_ROBOT_CMD_STRING_MANUAL;
	}
	else if (rmRobotMod == eRmSystem)
	{
		strName = COMM_ROBOT_CMD_STRING_SYSTEM;
	}
	else 
	{
		return FALSE;
	}

	m_strCmdName = strName;

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName;

	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotSetMod(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_OK)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}
// 2）机器人自动模式下程序执行操作（自动模式下的运行Run、重置Reset、停止stop等）；	
BOOL CCommProtocolXYDFast::PackRobotAutoControl(CString& strInfo, RobotAutoControl racAutoControl)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= _T("");
	CString strParam[1];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);


	if (racAutoControl == eRacReset)
	{
		strName = COMM_ROBOT_CMD_STRING_RESET;
	}
	else if (racAutoControl == eRacRun)
	{
		strName = COMM_ROBOT_CMD_STRING_RUN;
	}
	else if (racAutoControl == eRacStep)
	{
		strName = COMM_ROBOT_CMD_STRING_STEP;
	}
	else if (racAutoControl == eRacSkip)
	{
		strName = COMM_ROBOT_CMD_STRING_SKIP;
	}
	else if (racAutoControl == eRacNext)
	{
		strName = COMM_ROBOT_CMD_STRING_NEXT;
	}
	else if (racAutoControl == eRacStop)
	{
		strName = COMM_ROBOT_CMD_STRING_STOP;
	}
	else 
	{
		return FALSE;
	}

	m_strCmdName = strName;

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName;

	return TRUE;
}

CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotAutoControl(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_OK)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}

// 3）机器人手动移动速度查询、设定（mspeed；
BOOL CCommProtocolXYDFast::PackRobotGetMSpeed(CString& strInfo)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= COMM_ROBOT_CMD_STRING_MSPEED;
	CString strParam[1];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strQuery + strName;

	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotGetMSpeed(CString strAsw, int& nSpeed)
{
	m_strCmdName = strAsw;

	if (strAsw.IsEmpty())
	{
		return eAswCmdErr;
	}

	if (strAsw.GetLength() > 3)
	{
		return eAswCmdErr;
	}

	if (!IsStringNumerical(strAsw))
	{
		return eAswCmdErr;
	}

	nSpeed = atoi(strAsw);

	return eAswSucceed;
}

BOOL CCommProtocolXYDFast::PackRobotSetMSpeed(CString& strInfo, int nSpeed)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= COMM_ROBOT_CMD_STRING_MSPEED;
	CString strParam[1];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	if (nSpeed <= 0 || nSpeed >= 100)
	{
		return FALSE;
	}

	strParam[0].Format(_T("%d"), nSpeed);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0];

	return TRUE;  

}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotSetMSpeed(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_OK)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}

// 4）机器人移动命令（inch X、Y、Z等)；
BOOL CCommProtocolXYDFast::PackRobotInch(CString& strInfo, RobotInchAxis nAxis, RobotInchType nType)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= COMM_ROBOT_CMD_STRING_INCH;
	CString strParam[2];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);

	if (nAxis == eRiaX)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_X;
	}
	else if (nAxis == eRiaY)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_Y;
	}
	else if (nAxis == eRiaR)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_R;
	}
	else if (nAxis == eRiaZ)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_Z;
	}
	else if (nAxis == eRiaA)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_A;
	}
	else if (nAxis == eRiaB)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_B;
	}
	else
	{
		return FALSE;
	}


	if (nType == eRitAdd)
	{
		strParam[1] = COMM_ROBOT_CMD_STRING_INCH_ADD;
	}
	else if (nType == eRitSub)
	{
		strParam[1] = COMM_ROBOT_CMD_STRING_INCH_SUB;
	}
	else
	{
		return FALSE;
	}

	m_strCmdName = strName;

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strParam[1];

	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotInch(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_OK)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}

// 5）机器人当前位置查询（WHRXY）；
BOOL CCommProtocolXYDFast::PackRobotGetPosWHRXY(CString& strInfo)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= COMM_ROBOT_CMD_STRING_WHRXY;
	CString strParam[2];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strQuery + strName;

	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotGetPosWHRXY(CString strAsw, RobotPos& rpPos)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= _T("");
	CString strParam[7];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);

	std::vector<CString> vstrParam;	
	if (!AnalyzeRobotCommandParam(strAsw, strName, vstrParam))
	{
		return eAswCmdErr;
	}

	if (vstrParam.size() != 7)
	{
		return eAswCmdErr;
	}

	if (vstrParam.at(0) != _T("[POS]"))
	{
		return eAswCmdErr;
	}

	strName = vstrParam.at(0);
	m_strCmdName = strName;

	rpPos.m_dPosX = atof(vstrParam[1]);
	rpPos.m_dPosY = atof(vstrParam[2]);
	rpPos.m_dPosZ = atof(vstrParam[3]);
	rpPos.m_dPosR = atof(vstrParam[4]);
	rpPos.m_dPosA = atof(vstrParam[5]);
	rpPos.m_dPosB = atof(vstrParam[6]);

	return eAswSucceed;
}

// 6）设置机器人示教点位（TEACH 200）；
BOOL CCommProtocolXYDFast::PackRobotTeachPos(CString& strInfo, int nPosIndex)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= COMM_ROBOT_CMD_STRING_TEACH;
	CString strParam[1];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	if (nPosIndex < 0 || nPosIndex >= 10000)
	{
		return FALSE;
	}

	strParam[0].Format(_T("%d"), nPosIndex);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0];

	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotTeachPos(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_OK)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}

// 7）机器人点位查询（Read P200）；
BOOL CCommProtocolXYDFast::PackRobotReadPos(CString& strInfo, int nPosIndex)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= COMM_ROBOT_CMD_STRING_READ;
	CString strParam[1];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	if (nPosIndex < 0 || nPosIndex >= 10000)
	{
		return FALSE;
	}

	strParam[0].Format(_T("P%d"), nPosIndex);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0];

	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotReadPos(CString strAsw, RobotPos& rpPos)
{

	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= _T("");
	CString strParam[7];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);

	std::vector<CString> vstrParam;	
	if (!AnalyzeRobotCommandParam(strAsw, strName, vstrParam))
	{
		return eAswCmdErr;
	}

	if (vstrParam.size() != 9)
	{
		return eAswCmdErr;
	}

	if (vstrParam.at(0).GetLength() < 1 || vstrParam.at(0).Find(_T("P")) != 0)
	{
		return eAswCmdErr;
	}

	strName = vstrParam.at(0);
	m_strCmdName = strName;

	rpPos.m_dPosX = atof(vstrParam[2]);
	rpPos.m_dPosY = atof(vstrParam[3]);
	rpPos.m_dPosZ = atof(vstrParam[4]);
	rpPos.m_dPosR = atof(vstrParam[5]);
	rpPos.m_dPosA = atof(vstrParam[6]);
	rpPos.m_dPosB = atof(vstrParam[7]);
	rpPos.m_nCoordType = atoi(vstrParam[8]);

	return eAswSucceed;
}

// 8）执行机器人语言指令（@“机器人语言”，如@MOVE P, P100, S=20 [cr/lf]）.
BOOL CCommProtocolXYDFast::PackRobotMovePos(CString& strInfo, int nPosIndex, int nSpeed/* = 20*/)
{

	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= COMM_ROBOT_CMD_STRING_MOVE;
	CString strParam[1];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	if (nSpeed < 0 || nSpeed >= 100)
	{
		return FALSE;
	}

	strParam[0].Format(_T("P, P%d, S=%d"), nPosIndex, nSpeed);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0];

	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotMovePos(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_OK)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}


// 9）执行中断处理（ETX(03)）
BOOL CCommProtocolXYDFast::PackRobotETX(CString& strInfo)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= char(03);		// ETX
	CString strParam[1];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	//构造写命令
	strInfo.Empty();
	strInfo = strName;

	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotETX(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_ABORTED)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}
// 10）设置某个点某个轴的位置（@“机器人语言”，如@LOCX(P100) = 20 [cr/lf]）

BOOL CCommProtocolXYDFast::PackRobotSetPosAixs(CString& strInfo, int nPosIndex, RobotInchAxis nAxis, double dVal)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= COMM_ROBOT_CMD_STRING_LOC;
	CString strParam[4];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);

	if (nAxis == eRiaX)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_X;
	}
	else if (nAxis == eRiaY)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_Y;
	}
	else if (nAxis == eRiaR)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_R;
	}
	else if (nAxis == eRiaZ)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_Z;
	}
	else if (nAxis == eRiaA)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_A;
	}
	else if (nAxis == eRiaB)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_B;
	}
	else
	{
		return FALSE;
	}

	strParam[1].Format(_T("(P%d)"), nPosIndex);
	strParam[2] = m_strRobotEqual;
	strParam[3].Format(_T("%.02f"), dVal);

	m_strCmdName = strName;

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strParam[0] + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3];

	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotSetPosAixs(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_OK)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}

// 10）设置某个点的位置（@“机器人语言”，如@WRITE P100 = 100.00 ...... [cr/lf]）
BOOL CCommProtocolXYDFast::PackRobotSetPos(CString& strInfo, int nPosIndex, RobotPos rpPos)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= COMM_ROBOT_CMD_STRING_WRITE;
	CString strParam[9];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strEqual = m_strRobotEqual;
	CString strCR = char(0x0D);

	strParam[0].Format(_T("P%d"), nPosIndex);
	strParam[1] = strEqual;
	strParam[2].Format(_T("%.02f"), rpPos.m_dPosX);
	strParam[3].Format(_T("%.02f"), rpPos.m_dPosY);
	strParam[4].Format(_T("%.02f"), rpPos.m_dPosZ);
	strParam[5].Format(_T("%.02f"), rpPos.m_dPosR);
	strParam[6].Format(_T("%.02f"), rpPos.m_dPosA);
	strParam[7].Format(_T("%.02f"), rpPos.m_dPosB);
	strParam[8].Format(_T("%d"),    rpPos.m_nCoordType);


	m_strCmdName = strName;

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3]
	+ strBlank + strParam[4] + strBlank + strParam[5] + strBlank + strParam[6] + strBlank + strParam[7]  + strBlank + strParam[8] ;

	return TRUE;
}

CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotSetPos(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_OK)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}

// 11）查询某个点某个轴的位置（@“机器人语言”，如@LOCX(P100) [cr/lf]）
// 12) 设置某个变量的值
// 13）设置某个变量的值
// 14）主机器人轴移动至可进行绝对式原点复位的位置(ABSADJ X-)
BOOL CCommProtocolXYDFast::PackRobotABSADJ(CString& strInfo, RobotInchAxis nAxis, RobotInchType nType)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= COMM_ROBOT_CMD_STRING_ABSADJ;
	CString strParam[2];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);
	CString strInterval = _T(",");
	if (nAxis == eRiaX)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_X;
	}
	else if (nAxis == eRiaY)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_Y;
	}
	else if (nAxis == eRiaR)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_R;
	}
	else if (nAxis == eRiaZ)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_Z;
	}
	else if (nAxis == eRiaA)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_A;
	}
	else if (nAxis == eRiaB)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_B;
	}
	else
	{
		return FALSE;
	}


	if (nType == eRitAdd)
	{
		strParam[1] = _T("0");
	}
	else if (nType == eRitSub)
	{
		strParam[1] =  _T("1");;
	}
	else
	{
		return FALSE;
	}

	m_strCmdName = strName;

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strInterval + strBlank + strParam[1];

	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotABSADJ(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_OK)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}

// 15）主机器人轴的绝对式原点复位(ABSRESET k)
BOOL CCommProtocolXYDFast::PackRobotABSRESET(CString& strInfo, RobotInchAxis nAxis)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= COMM_ROBOT_CMD_STRING_ABSRESET;
	CString strParam[2];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);
	CString strInterval = _T(",");
	if (nAxis == eRiaX)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_X;
	}
	else if (nAxis == eRiaY)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_Y;
	}
	else if (nAxis == eRiaR)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_R;
	}
	else if (nAxis == eRiaZ)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_Z;
	}
	else if (nAxis == eRiaA)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_A;
	}
	else if (nAxis == eRiaB)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_B;
	}
	else
	{
		return FALSE;
	}

	m_strCmdName = strName;

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0];

	return TRUE;

	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotABSRESET(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_OK)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}



// 16) 设置整型常量的值（@“机器人语言”，如@SGI0 = 20[cr/lf]）
BOOL CCommProtocolXYDFast::PackRobotWriteSGI(CString& strInfo, int nIndex, int nVal)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName = COMM_ROBOT_CMD_STRING_SGI;
	CString strParam[9];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strEqual = m_strRobotEqual;
	CString strCR = char(0x0D);

	strParam[0].Format(_T("%d"), nIndex);
	strParam[1] = strEqual;
	strParam[2].Format(_T("%d"), nVal);

	m_strCmdName = strName;

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2];

	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotWriteSGI(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_OK)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}

// 17) 查询整型常量的值（@“机器人语言”，如@READ SGI0[cr/lf]）
BOOL CCommProtocolXYDFast::PackRobotReadSGI(CString& strInfo, int nIndex)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strRead = COMM_ROBOT_CMD_STRING_READ;
	CString strName = COMM_ROBOT_CMD_STRING_SGI;
	CString strParam[9];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strEqual = m_strRobotEqual;
	CString strCR = char(0x0D);

	strParam[0].Format(_T("%d"), nIndex);

	m_strCmdName = strName;

	//构造读命令
	strInfo.Empty();
	strInfo = strHead + strRead + strBlank + strName + strParam[0];

	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotReadSGI(CString strAsw, int &nVal)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strRead = COMM_ROBOT_CMD_STRING_READ;
	CString strName = COMM_ROBOT_CMD_STRING_SGI;
	CString strParam[9];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strEqual = m_strRobotEqual;
	CString strCR = char(0x0D);

	std::vector<CString> vstrParam;	
	vstrParam.push_back(strAsw);

	strName = vstrParam.at(0);
	m_strCmdName = strName;

	if (vstrParam[0].IsEmpty())
	{
		return eAswCmdErr;
	}

	if (!IsStringNumerical(vstrParam[0]))
	{
		return eAswCmdErr;
	}

	nVal = atoi(vstrParam[0]);

	return eAswSucceed;
}

// 18) 设置实数常量的值（@“机器人语言”，如@SGR0 = 20.0[cr/lf]）
BOOL CCommProtocolXYDFast::PackRobotWriteSGR(CString& strInfo, int nIndex, double dVal)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName = COMM_ROBOT_CMD_STRING_SGR;
	CString strParam[9];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strEqual = m_strRobotEqual;
	CString strCR = char(0x0D);

	strParam[0].Format(_T("%d"), nIndex);
	strParam[1] = strEqual;
	strParam[2].Format(_T("%f"), dVal);

	m_strCmdName = strName;

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2];

	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotWriteSGR(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_OK)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}

// 18) 查询实数常量的值（@“机器人语言”，如@READ SGR0[cr/lf]）
BOOL CCommProtocolXYDFast::PackRobotReadSGR(CString& strInfo, int nIndex)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strRead = COMM_ROBOT_CMD_STRING_READ;
	CString strName = COMM_ROBOT_CMD_STRING_SGR;
	CString strParam[9];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strEqual = m_strRobotEqual;
	CString strCR = char(0x0D);

	strParam[0].Format(_T("%d"), nIndex);

	m_strCmdName = strName;

	//构造读命令
	strInfo.Empty();
	strInfo = strHead + strRead + strBlank + strName + strParam[0];

	return TRUE;
}

CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotReadSGR(CString strAsw, double &dVal)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strRead = COMM_ROBOT_CMD_STRING_READ;
	CString strName = COMM_ROBOT_CMD_STRING_SGR;
	CString strParam[9];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strEqual = m_strRobotEqual;
	CString strCR = char(0x0D);

	std::vector<CString> vstrParam;	
	vstrParam.push_back(strAsw);

	strName = vstrParam.at(0);
	m_strCmdName = strName;

	if (vstrParam[0].IsEmpty())
	{
		return eAswCmdErr;
	}

	if (!IsStringNumerical(vstrParam[0]))
	{
		return eAswCmdErr;
	}

	dVal = atof(vstrParam[0]);

	return eAswSucceed;
}

//////////////////////////////////////////////////////////////////////////
// 雅马哈340机器人

// 1）机器人工作模式查询、设定（手动模式manual、自动模式auto等）；
//	命令 @ ?MODE [cr/lf]
//	应答 1 [cr/lf]
//	应答 OK [cr/lf]
BOOL CCommProtocolXYDFast::PackRobotGetMod340(CString& strInfo)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= COMM_ROBOT_CMD_STRING_MOD_340;
	CString strParam[1];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strQuery + strName;

	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotGetMod340(CString strAsw, RobotMod& rmRobotMod)
{
	m_strCmdName = strAsw;

	if (!IsStringNumerical(strAsw))
	{
		return eAswCmdErr;
	}

	if (strAsw == COMM_ROBOT_CMD_STRING_AUTO_340)
	{
		rmRobotMod = eRmAuto;
	}
	else if (strAsw == COMM_ROBOT_CMD_STRING_PROGRAM_340)
	{
		rmRobotMod = eRmProgram;
	}
	else if (strAsw == COMM_ROBOT_CMD_STRING_MANUAL_340)
	{
		rmRobotMod = eRmManual;
	}
	else if (strAsw == COMM_ROBOT_CMD_STRING_SYSTEM_340)
	{
		rmRobotMod = eRmSystem;
	}
	else
	{
		rmRobotMod = eRmUnknown;
	}

	return eAswSucceed;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotGetModOK340(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_OK)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}

BOOL CCommProtocolXYDFast::PackRobotSetMod340(CString& strInfo, RobotMod rmRobotMod)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= _T("");
	CString strParam[1];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);

	if (rmRobotMod == eRmAuto)
	{
		strName = COMM_ROBOT_CMD_STRING_AUTO;
	}
	else if (rmRobotMod == eRmProgram)
	{
		strName = COMM_ROBOT_CMD_STRING_PROGRAM;
	}
	else if (rmRobotMod == eRmManual)
	{
		strName = COMM_ROBOT_CMD_STRING_MANUAL;
	}
	else if (rmRobotMod == eRmSystem)
	{
		strName = COMM_ROBOT_CMD_STRING_SYSTEM;
	}
	else 
	{
		return FALSE;
	}

	m_strCmdName = strName;

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName;

	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotSetMod340(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_OK)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}

// 3）机器人手动移动速度查询、设定（mspeed；
BOOL CCommProtocolXYDFast::PackRobotGetMSpeed340(CString& strInfo)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= COMM_ROBOT_CMD_STRING_MSPEED;
	CString strParam[1];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strQuery + strName;

	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotGetMSpeed340(CString strAsw, int& nSpeed)
{
	m_strCmdName = strAsw;

	if (strAsw.IsEmpty())
	{
		return eAswCmdErr;
	}

	if (strAsw.GetLength() > 3)
	{
		return eAswCmdErr;
	}

	if (!IsStringNumerical(strAsw))
	{
		return eAswCmdErr;
	}

	nSpeed = atoi(strAsw);

	return eAswSucceed;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotGetMSpeedOK340(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_OK)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}


BOOL CCommProtocolXYDFast::PackRobotSetMSpeed340(CString& strInfo, int nSpeed)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= COMM_ROBOT_CMD_STRING_MSPEED;
	CString strParam[1];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	if (nSpeed <= 0 || nSpeed >= 100)
	{
		return FALSE;
	}

	strParam[0].Format(_T("%d"), nSpeed);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0];

	return TRUE;  

}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotSetMSpeed340(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_OK)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}


// 4）机器人移动命令（INCHXY X、Y、Z等)；
BOOL CCommProtocolXYDFast::PackRobotInch340(CString& strInfo, RobotInchAxis nAxis, RobotInchType nType)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= COMM_ROBOT_CMD_STRING_INCH_340;
	CString strParam[2];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);

	if (nAxis == eRiaX)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_X_340;
	}
	else if (nAxis == eRiaY)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_Y_340;
	}
	else if (nAxis == eRiaR)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_R_340;
	}
	else if (nAxis == eRiaZ)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_Z_340;
	}
	else if (nAxis == eRiaA)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_A_340;
	}
	else if (nAxis == eRiaB)
	{
		strParam[0] = COMM_ROBOT_CMD_STRING_INCH_B_340;
	}
	else
	{
		return FALSE;
	}


	if (nType == eRitAdd)
	{
		strParam[1] = COMM_ROBOT_CMD_STRING_INCH_ADD_340;
	}
	else if (nType == eRitSub)
	{
		strParam[1] = COMM_ROBOT_CMD_STRING_INCH_SUB_340;
	}
	else
	{
		return FALSE;
	}

	m_strCmdName = strName;

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strParam[1];

	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotInchStart340(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_START_340)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}

CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotInchEnd340(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_END_340)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}

// 5）机器人当前位置查询（WHRXY）；
BOOL CCommProtocolXYDFast::PackRobotGetPosWHRXY340(CString& strInfo)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= COMM_ROBOT_CMD_STRING_WHRXY;
	CString strParam[2];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strQuery + strName;

	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotGetPosWHRXY340(CString strAsw, RobotPos& rpPos)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= _T("");
	CString strParam[7];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);

	std::vector<CString> vstrParam;	
	if (!AnalyzeRobotCommandParam(strAsw, strName, vstrParam))
	{
		return eAswCmdErr;
	}

	if (vstrParam.size() < 6)
	{
		return eAswCmdErr;
	}

	strName = vstrParam.at(0);
	m_strCmdName = strName;

	rpPos.m_dPosX = atof(vstrParam[0]);
	rpPos.m_dPosY = atof(vstrParam[1]);
	rpPos.m_dPosZ = atof(vstrParam[2]);
	rpPos.m_dPosR = atof(vstrParam[3]);
	rpPos.m_dPosA = atof(vstrParam[4]);
	rpPos.m_dPosB = atof(vstrParam[5]);

	return eAswSucceed;
}

CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotGetPosWHRXYOK340(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_OK)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}

// 6）设置机器人示教点位（TEACH 200）；
BOOL CCommProtocolXYDFast::PackRobotTeachPos340(CString& strInfo, int nPosIndex)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= COMM_ROBOT_CMD_STRING_TEACH_340;
	CString strParam[1];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);


	m_strCmdName = strName;

	if (nPosIndex < 0 || nPosIndex >= 29999)
	{
		return FALSE;
	}

	strParam[0].Format(_T("%d"), nPosIndex);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0];

	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotTeachPos340(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_OK)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}


// 7）机器人点位查询（?P200）；
BOOL CCommProtocolXYDFast::PackRobotReadPos340(CString& strInfo, int nPosIndex)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= COMM_ROBOT_CMD_STRING_READ;
	CString strParam[1];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	if (nPosIndex < 0 || nPosIndex >= 10000)
	{
		return FALSE;
	}

	strParam[0].Format(_T("P%d"), nPosIndex);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + m_strRobotQuery + strParam[0];

	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotReadPos340(CString strAsw, RobotPos& rpPos)
{

	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= _T("");
	CString strParam[7];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strCR = char(0x0D);

	std::vector<CString> vstrParam;	
	if (!AnalyzeRobotCommandParam(strAsw, strName, vstrParam))
	{
		return eAswCmdErr;
	}

	if (vstrParam.size() != 9)
	{
		return eAswCmdErr;
	}

	strName = vstrParam.at(0);
	m_strCmdName = strName;

	rpPos.m_dPosX = atof(vstrParam[0]);
	rpPos.m_dPosY = atof(vstrParam[1]);
	rpPos.m_dPosZ = atof(vstrParam[2]);
	rpPos.m_dPosR = atof(vstrParam[3]);
	rpPos.m_dPosA = atof(vstrParam[4]);
	rpPos.m_dPosB = atof(vstrParam[5]);
	rpPos.m_nCoordType = atoi(vstrParam[6]);

	return eAswSucceed;
}

CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotReadPosOK340(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_OK)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}

// 10）设置某个点的位置（@“机器人语言”，如@P100 = 100.00 ...... [cr/lf]）
BOOL CCommProtocolXYDFast::PackRobotSetPos340(CString& strInfo, int nPosIndex, RobotPos rpPos)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName= COMM_ROBOT_CMD_STRING_WRITE;
	CString strParam[9];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strEqual = m_strRobotEqual;
	CString strCR = char(0x0D);

	strParam[0].Format(_T("P%d"), nPosIndex);
	strParam[1] = strEqual;
	strParam[2].Format(_T("%.03f"), rpPos.m_dPosX);
	strParam[3].Format(_T("%.03f"), rpPos.m_dPosY);
	strParam[4].Format(_T("%.03f"), rpPos.m_dPosZ);
	strParam[5].Format(_T("%.03f"), rpPos.m_dPosR);
	strParam[6].Format(_T("%.03f"), rpPos.m_dPosA);
	strParam[7].Format(_T("%.03f"), rpPos.m_dPosB);
	strParam[8].Format(_T("%d"),    rpPos.m_nCoordType);


	m_strCmdName = strName;

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3]
	+ strBlank + strParam[4] + strBlank + strParam[5] + strBlank + strParam[6] + strBlank + strParam[7]  + strBlank + strParam[8] ;

	return TRUE;
}

CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotSetPos340(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_OK)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}



// 16) 设置整型常量的值（@“机器人语言”，如@SGI0 = 20[cr/lf]）
BOOL CCommProtocolXYDFast::PackRobotWriteSGI340(CString& strInfo, int nIndex, int nVal)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName = COMM_ROBOT_CMD_STRING_SGI;
	CString strParam[9];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strEqual = m_strRobotEqual;
	CString strCR = char(0x0D);

	strParam[0].Format(_T("%d"), nIndex);
	strParam[1] = strEqual;
	strParam[2].Format(_T("%d"), nVal);

	m_strCmdName = strName;

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2];

	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotWriteSGI340(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_OK)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}

// 17) 查询整型常量的值（@“机器人语言”，如@?SGI0[cr/lf]）
BOOL CCommProtocolXYDFast::PackRobotReadSGI340(CString& strInfo, int nIndex)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strRead = COMM_ROBOT_CMD_STRING_READ;
	CString strName = COMM_ROBOT_CMD_STRING_SGI;
	CString strParam[9];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strEqual = m_strRobotEqual;
	CString strCR = char(0x0D);

	strParam[0].Format(_T("%d"), nIndex);

	m_strCmdName = strName;

	//构造读命令
	strInfo.Empty();
	strInfo = strHead + m_strRobotQuery + strName + strParam[0];

	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotReadSGI340(CString strAsw, int &nVal)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strRead = COMM_ROBOT_CMD_STRING_READ;
	CString strName = COMM_ROBOT_CMD_STRING_SGI;
	CString strParam[9];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strEqual = m_strRobotEqual;
	CString strCR = char(0x0D);

	std::vector<CString> vstrParam;	
	vstrParam.push_back(strAsw);

	strName = vstrParam.at(0);
	m_strCmdName = strName;

	if (vstrParam[0].IsEmpty())
	{
		return eAswCmdErr;
	}

	if (!IsStringNumerical(vstrParam[0]))
	{
		return eAswCmdErr;
	}

	nVal = atoi(vstrParam[0]);

	return eAswSucceed;
}

CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotReadSGIOK340(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_OK)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}

// 18) 设置实数常量的值（@“机器人语言”，如@SGR0 = 20.0[cr/lf]）
BOOL CCommProtocolXYDFast::PackRobotWriteSGR340(CString& strInfo, int nIndex, double dVal)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strName = COMM_ROBOT_CMD_STRING_SGR;
	CString strParam[9];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strEqual = m_strRobotEqual;
	CString strCR = char(0x0D);

	strParam[0].Format(_T("%d"), nIndex);
	strParam[1] = strEqual;
	strParam[2].Format(_T("%f"), dVal);

	m_strCmdName = strName;

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2];

	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotWriteSGR340(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_OK)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}

// 18) 查询实数常量的值（@“机器人语言”，如@?SGR0[cr/lf]）
BOOL CCommProtocolXYDFast::PackRobotReadSGR340(CString& strInfo, int nIndex)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strRead = COMM_ROBOT_CMD_STRING_READ;
	CString strName = COMM_ROBOT_CMD_STRING_SGR;
	CString strParam[9];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strEqual = m_strRobotEqual;
	CString strCR = char(0x0D);

	strParam[0].Format(_T("%d"), nIndex);

	m_strCmdName = strName;

	//构造读命令
	strInfo.Empty();
	strInfo = strHead + m_strRobotQuery + strName + strParam[0];

	return TRUE;
}

CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotReadSGR340(CString strAsw, double &dVal)
{
	CString strHead = m_strRobotHead;
	CString strQuery = m_strRobotQuery;
	CString strRead = COMM_ROBOT_CMD_STRING_READ;
	CString strName = COMM_ROBOT_CMD_STRING_SGR;
	CString strParam[9];
	CString strBlank = m_strRobotSeparator;
	CString strTail = m_strRobotTail;	
	CString strEqual = m_strRobotEqual;
	CString strCR = char(0x0D);

	std::vector<CString> vstrParam;	
	vstrParam.push_back(strAsw);

	strName = vstrParam.at(0);
	m_strCmdName = strName;

	if (vstrParam[0].IsEmpty())
	{
		return eAswCmdErr;
	}

	if (!IsStringNumerical(vstrParam[0]))
	{
		return eAswCmdErr;
	}

	dVal = atof(vstrParam[0]);

	return eAswSucceed;
}

CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswRobotReadSGROK340(CString strAsw)
{
	m_strCmdName = strAsw;

	if (strAsw == COMM_ROBOT_CMD_STRING_OK)
	{

	}
	else 
	{
		return eAswCmdErr;
	}

	return eAswSucceed;
}


/////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////

BOOL CCommProtocolXYDFast::PackPlcParam(int& nPackParam, int nParam, int nUnitExp/* = 0*/)
{
	double nBase = 10;
	int nNewParam = nParam;
	if (nUnitExp > 0)
	{
		nNewParam = (int)(nParam * pow(nBase, nUnitExp));
	}

	nPackParam = nNewParam;

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackPlcParam(int& nPackParam, double dParam, int nUnitExp/* = 0*/)
{
	double nBase = 10;
	double dNewParam = dParam;
	if (nUnitExp > 0)
	{
		dNewParam = dParam * pow(nBase, nUnitExp);
	}
	if (dNewParam >= 0)
	{
		nPackParam = (int)(dNewParam+0.5);
	}
	else
	{
		nPackParam = (int)(dNewParam-0.5);
	}


	return TRUE;
}





// 根据协议类型，创建PLC通信协议类对象，如果ptProtocolType不是PLC协议则返回False
BOOL CCommProtocolXYDFast::CreateCommProPlc( ProtocolType ptProtocolType )
{
	switch(ptProtocolType)
	{	
	case eProRegModbusSerialAscii:		// Modbus的寄存器串口ASCII协议
		{
			if (m_pCommProRegBase != NULL)
			{
				delete m_pCommProRegBase;
				m_pCommProRegBase = NULL;
			}

			m_pCommProRegBase = new CCommProRegModbusSerialAscii;
		}
		break;
	case eProRegModbusSerialRtu:		// Modbus的寄存器串口RTU协议
		{
			if (m_pCommProRegBase != NULL)
			{
				delete m_pCommProRegBase;
				m_pCommProRegBase = NULL;
			}

			m_pCommProRegBase = new CCommProRegModbusSerialRtu;
		}
		break;
	case eProRegModbusSocketTcp:		// Modbus的寄存器网口TCP协议
		{
			if (m_pCommProRegBase != NULL)
			{
				delete m_pCommProRegBase;
				m_pCommProRegBase = NULL;
			}

			m_pCommProRegBase = new CCommProRegModbusSocketTcp;
		}
		break;
	case eProRegPanasonicSerialMewtocol:	// 松下FP系列PLC的寄存器串口Mewtocol协议(一般使用这种)
	case eProRegPanasonicSocketMewtocol:	// 松下FP系列PLC的寄存器网口Mewtocol协议
		{
			if (m_pCommProRegBase != NULL)
			{
				delete m_pCommProRegBase;
				m_pCommProRegBase = NULL;
			}

			m_pCommProRegBase = new CCommProRegPanaSerialMewtocol;
		}
		break;
	case eProRegMitsubishiQSerialAscii: // 三菱Q系列PLC的寄存器串口MC(格式4)ASCII协议(一般使用这种)
		{
			if (m_pCommProRegBase != NULL)
			{
				delete m_pCommProRegBase;
				m_pCommProRegBase = NULL;
			}

			m_pCommProRegBase = new CCommProRegMitsQSerialAscii;
		}
		break;
	case eProRegMitsubishiQSocketAscii: // 三菱Q系列PLC的寄存器网口MC（E3）ASCII协议(一般使用这种)
	case eProRegMitsubishiQSocketAsciiUDP: // 三菱Q系列PLC的寄存器网口UDP MC（E3）ASCII协议(一般使用这种)
		{
			if (m_pCommProRegBase != NULL)
			{
				delete m_pCommProRegBase;
				m_pCommProRegBase = NULL;
			}

			m_pCommProRegBase = new CCommProRegMitsQSocketAscii;
		}
		break;
	case eProRegMitsubishiQSocketBinary: // 三菱Q系列PLC的寄存器网口MC（E3）二进制协议(一般使用这种)
	case eProRegMitsubishiQSocketBinaryUDP: // 三菱Q系列PLC的寄存器网口UDP MC（E3）二进制协议(一般使用这种)
		{
			if (m_pCommProRegBase != NULL)
			{
				delete m_pCommProRegBase;
				m_pCommProRegBase = NULL;
			}

			m_pCommProRegBase = new CCommProRegMitsQSocketBinary;
		}
		break;
	case eProRegMitsubishiFXSerialAscii: // 三菱FX系列PLC的寄存器串口MC(格式4)ASCII协议(一般使用这种)
		{
			if (m_pCommProRegBase != NULL)
			{
				delete m_pCommProRegBase;
				m_pCommProRegBase = NULL;
			}

			m_pCommProRegBase = new CCommProRegMitsFXSerialAscii;
		}
		break;
	case eProRegMitsubishiFXSocketBinaryMC1E:		// 三菱FX系列PLC的寄存器网口MC（A兼容1E帧）二进制协议(FX-3U-ENET-ADP网口模块使用)
		{
			if (m_pCommProRegBase != NULL)
			{
				delete m_pCommProRegBase;
				m_pCommProRegBase = NULL;
			}

			m_pCommProRegBase = new CCommProRegMitsFXSocketBinaryMC1E;

		}
		break;
	case eProRegYokogawaSocketAscii:  // 横河PLC的寄存器网口ASCII协议（PC-Link(以太网ASCII码)，一般用这种）
		{
			if (m_pCommProRegBase != NULL)
			{
				delete m_pCommProRegBase;
				m_pCommProRegBase = NULL;
			}

			m_pCommProRegBase = new CCommProRegYokoSocketAscii;
		}
		break;
	case eProRegYokogawaSocketBinary:  // 横河PLC的寄存器网口二进制协议（PC-Link(以太网二进制)，一般用这种）
		{
			if (m_pCommProRegBase != NULL)
			{
				delete m_pCommProRegBase;
				m_pCommProRegBase = NULL;
			}

			m_pCommProRegBase = new CCommProRegYokoSocketBinary;
		}
		break;
	case eProRegYaskawa:	// 安川PLC的寄存器协议
		{
			if (m_pCommProRegBase != NULL)
			{
				delete m_pCommProRegBase;
				m_pCommProRegBase = NULL;
			}

			m_pCommProRegBase = new CCommProRegYask;
		}
		break;
	case eProRegKeyenceSerialAscii:		// 基恩士KV系列PLC的寄存器串口ASCII协议
		{
			if (m_pCommProRegBase != NULL)
			{
				delete m_pCommProRegBase;
				m_pCommProRegBase = NULL;
			}

			m_pCommProRegBase = new CCommProRegKeyenceSerialAscii;

		}
		break;
	case eProRegKeyenceSerialPCLink:		// 基恩士KV系列PLC的寄存器串口上位链路协议
		{
			if (m_pCommProRegBase != NULL)
			{
				delete m_pCommProRegBase;
				m_pCommProRegBase = NULL;
			}

			m_pCommProRegBase = new CCommProRegKeyenceSerialPCLink;

		}
		break;
	case eProRegKeyenceSocketAscii:		// 基恩士KV系列使用三菱Q系列PLC的寄存器网口MC（3E）ASCII协议   (QnA兼容3E)
		{
			if (m_pCommProRegBase != NULL)
			{
				delete m_pCommProRegBase;
				m_pCommProRegBase = NULL;
			}

			m_pCommProRegBase = new CCommProRegKeyenceSocketAscii;

		}
		break;
	case eProRegKeyenceSocketBinary:		// 基恩士KV系列使用三菱Q系列PLC的寄存器网口MC（3E）二进制协议  (QnA兼容3E)
		{
			if (m_pCommProRegBase != NULL)
			{
				delete m_pCommProRegBase;
				m_pCommProRegBase = NULL;
			}

			m_pCommProRegBase = new CCommProRegKeyenceSocketBinary;

		}
		break;
	case eProRegKeyenceSocketPCLink:		// 基恩士KV系列PLC的寄存器网口上位链路协议
		{
			if (m_pCommProRegBase != NULL)
			{
				delete m_pCommProRegBase;
				m_pCommProRegBase = NULL;
			}

			m_pCommProRegBase = new CCommProRegKeyenceSocketPCLink;

		}
		break;
	case eProRegFujiSPH:		// 基恩士KV系列PLC的寄存器串口ASCII协议
		{
			if (m_pCommProRegBase != NULL)
			{
				delete m_pCommProRegBase;
				m_pCommProRegBase = NULL;
			}

			m_pCommProRegBase = new CCommProRegFuJiSPHSocket;

		}
		break;
	case eProRegOmronSerialHostLink:		// 欧姆龙PLC的寄存器串口HostLink协议
		{
			if (m_pCommProRegBase != NULL)
			{
				delete m_pCommProRegBase;
				m_pCommProRegBase = NULL;
			}

			m_pCommProRegBase = new CCommProRegOmronSerialHostLink;

		}
		break;
	case eProRegOmronSocketFins:		// 欧姆龙PLC的寄存器网口Fins协议
		{
			if (m_pCommProRegBase != NULL)
			{
				delete m_pCommProRegBase;
				m_pCommProRegBase = NULL;
			}

			m_pCommProRegBase = new CCommProRegOmronSocketFins;

		}
		break;
	case eProRegDeltaModbusSerialAscii:		// Delta(台达)Modbus的寄存器串口ASCII协议
		{
			if (m_pCommProRegBase != NULL)
			{
				delete m_pCommProRegBase;
				m_pCommProRegBase = NULL;
			}

			m_pCommProRegBase = new CCommProRegDeltaModbusSerialAscii;
		}
		break;
	case eProRegDeltaModbusSerialRtu:		// Delta(台达)Modbus的寄存器串口RTU协议
		{
			if (m_pCommProRegBase != NULL)
			{
				delete m_pCommProRegBase;
				m_pCommProRegBase = NULL;
			}

			m_pCommProRegBase = new CCommProRegDeltaModbusSerialRtu;
		}
		break;
	case eProRegDeltaModbusSocketTcp:		// Delta(台达)Modbus的寄存器网口TCP协议
		{
			if (m_pCommProRegBase != NULL)
			{
				delete m_pCommProRegBase;
				m_pCommProRegBase = NULL;
			}

			m_pCommProRegBase = new CCommProRegDeltaModbusSocketTcp;
		}
		break;
	default:
		{
			return FALSE;
		}
	}

	if (m_pCommProRegBase != NULL)
	{
		m_pCommProRegBase->SetCurRegDataTypeIndex(m_nRegDataTypeIndex);
	}

	return TRUE;
}


// 设置翻译的打包指令
BOOL CCommProtocolXYDFast::SetTranslateResultInfo(CString strTranslateResultInfo)
{
	m_dstrTranlateResultInfo.push_back(strTranslateResultInfo);
	return TRUE;
}

// 获取翻译的打包指令
BOOL CCommProtocolXYDFast::GetTranslateResultInfo(CString& strTranslateResultInfo,BOOL bReceive)
{
	if (m_dstrTranlateResultInfo.size()>0)
	{
		if (bReceive)
		{
			strTranslateResultInfo = m_dstrTranlateResultInfo.at(0);
			m_dstrTranlateResultInfo.pop_front();
			return TRUE;
		}
		else
		{
			strTranslateResultInfo = m_dstrTranlateResultInfo.at(0);
			return TRUE;
		}

	}
	else
	{
		return FALSE;
	}

}



// 保存日志，写寄存器指令转义信息
BOOL  CCommProtocolXYDFast::SetWriteRegTranslateResultInfo(long dRegAddr,int nWriteNum,std::vector<int> &vWriteData,BOOL bDWORD /*TRUE*/)
{
	if(vWriteData.size() <= 0)
	{//写入数为0时不记录
		return FALSE;
	}
	CString strWriteRegTranslateInfo;
	CString strTmp;


	if(bDWORD)
	{
		strWriteRegTranslateInfo.Format("写寄存器,地址:%ld-%ld,字类型:双字,个数:%d,数值:",dRegAddr,dRegAddr+2*nWriteNum-1,nWriteNum);
		if(nWriteNum == 1)
		{
			strTmp.Format("%d",vWriteData[nWriteNum-1]);
			strWriteRegTranslateInfo += strTmp;
		}
		else
		{
			for(int nTmp=0;nTmp<nWriteNum-1;nTmp++)
			{
				strTmp.Format("%d,",vWriteData[nTmp]);
				strWriteRegTranslateInfo += strTmp;
			}
			strTmp.Format("%d",vWriteData[nWriteNum-1]);
			strWriteRegTranslateInfo += strTmp;
		}
	}
	else
	{
		strWriteRegTranslateInfo.Format("写寄存器,地址:%ld-%ld,字类型:单字,个数:%d,数值:",dRegAddr,dRegAddr+nWriteNum-1,nWriteNum);
		if(nWriteNum == 1)
		{
			strTmp.Format("%d",vWriteData[nWriteNum-1]);
			strWriteRegTranslateInfo += strTmp;
		}
		else
		{
			for(int nTmp=0;nTmp<nWriteNum-1;nTmp++)
			{
				strTmp.Format("%d,",vWriteData[nTmp]);
				strWriteRegTranslateInfo += strTmp;
			}
			strTmp.Format("%d",vWriteData[nWriteNum-1]);
			strWriteRegTranslateInfo += strTmp;
		}
	}

	m_dstrTranlateResultInfo.push_back(strWriteRegTranslateInfo);
	return TRUE;

}

// 保存日志，写寄存器指令转义信息
BOOL  CCommProtocolXYDFast::SetWriteRegTranslateResultInfo(long dRegAddr,int nWriteNum,std::vector<double> &vWriteData,BOOL bDWORD /*TRUE*/)
{
	CString strWriteRegTranslateInfo;
	CString strTmp;

	if(bDWORD)
	{
		strWriteRegTranslateInfo.Format("写寄存器,地址:%ld-%ld,字类型:双字,个数:%d,数值:",dRegAddr,dRegAddr+2*nWriteNum-1,nWriteNum);
		if(nWriteNum == 1)
		{
			strTmp.Format("%f",vWriteData[nWriteNum-1]);
			strWriteRegTranslateInfo += strTmp;
		}
		else
		{
			for(int nTmp=0;nTmp<nWriteNum-1;nTmp++)
			{
				strTmp.Format("%f,",vWriteData[nTmp]);
				strWriteRegTranslateInfo += strTmp;
			}
			strTmp.Format("%f",vWriteData[nWriteNum-1]);
			strWriteRegTranslateInfo += strTmp;
		}
	}
	else
	{
		strWriteRegTranslateInfo.Format("写寄存器,地址:%ld-%ld,字类型:单字,个数:%d,数值:",dRegAddr,dRegAddr+nWriteNum-1,nWriteNum);
		if(nWriteNum == 1)
		{
			strTmp.Format("%f",vWriteData[nWriteNum-1]);
			strWriteRegTranslateInfo += strTmp;
		}
		else
		{
			for(int nTmp=0;nTmp<nWriteNum-1;nTmp++)
			{
				strTmp.Format("%f,",vWriteData[nTmp]);
				strWriteRegTranslateInfo += strTmp;
			}
			strTmp.Format("%f",vWriteData[nWriteNum-1]);
			strWriteRegTranslateInfo += strTmp;
		}
	}

	m_dstrTranlateResultInfo.push_back(strWriteRegTranslateInfo);
	return TRUE;

}


BOOL CCommProtocolXYDFast::SetReadRegTranslateResultInfo(long dRegAddr, int nReadNum,BOOL bDWORD)
{
	CString strReadRegTranslateInfo;
	if(bDWORD)
	{
		strReadRegTranslateInfo.Format("读寄存器,地址:%ld-%ld,字类型:双字,个数:%d",dRegAddr,dRegAddr+2*nReadNum-1,nReadNum);
	}
	else
	{
		strReadRegTranslateInfo.Format("读寄存器,地址:%ld-%ld,字类型:单字,个数:%d",dRegAddr,dRegAddr+1*nReadNum-1,nReadNum);
	}

	m_dstrTranlateResultInfo.push_back(strReadRegTranslateInfo);

	return TRUE;
}

BOOL CCommProtocolXYDFast::SetAnalyzeAswWriteRegTransInfo()
{
	CString strAnalyzeAswWriteRegInfo;

	strAnalyzeAswWriteRegInfo.Format("写寄存器回复,状态:成功");
	m_dstrTranlateResultInfo.push_back(strAnalyzeAswWriteRegInfo);

	return TRUE;
}

BOOL CCommProtocolXYDFast::SetAnalyzeAswReadRegTransInfo(int nReceiveNum,std::vector<int> &vReceivedData,BOOL bDWORD /*TRUE*/)
{
	CString strReadReceivedInfo;
	CString strTmp;
	if (bDWORD)
	{
		strReadReceivedInfo.Format("读寄存器回复,状态:成功,个数:%d,数据:",nReceiveNum);
		if (nReceiveNum == 1)
		{
			strTmp.Format("%d",vReceivedData[nReceiveNum-1]);
			strReadReceivedInfo += strTmp;
		}
		else
		{
			for (int nTmp=0;nTmp<nReceiveNum-1;nTmp++)
			{
				strTmp.Format("%d,",vReceivedData[nTmp]);
				strReadReceivedInfo += strTmp;
			}
			strTmp.Format("%d",vReceivedData[nReceiveNum-1]);
			strReadReceivedInfo += strTmp;
		}
	}
	else
	{
		strReadReceivedInfo.Format("读寄存器回复,状态:成功,个数:%d,数据:",nReceiveNum);
		if (nReceiveNum == 1)
		{
			strTmp.Format("%d",vReceivedData[nReceiveNum-1]);
			strReadReceivedInfo += strTmp;
		}
		else
		{
			for (int nTmp=0;nTmp<nReceiveNum-1;nTmp++)
			{
				strTmp.Format("%d,",vReceivedData[nTmp]);
				strReadReceivedInfo += strTmp;
			}
			strTmp.Format("%d",vReceivedData[nReceiveNum-1]);
			strReadReceivedInfo += strTmp;
		}
	}

	m_dstrTranlateResultInfo.push_back(strReadReceivedInfo);
	return TRUE;
}

BOOL CCommProtocolXYDFast::SetAnalyzeAswReadRegTransInfo(int nReceiveNum,std::vector<double> &vReceivedData,BOOL bDWORD /*TRUE*/)
{

	CString strReadReceivedInfo;
	CString strTmp;
	if (bDWORD)
	{
		strReadReceivedInfo.Format("读寄存器回复,状态:成功,个数:%d,数据:",nReceiveNum);
		if (nReceiveNum == 1)
		{
			strTmp.Format("%f",vReceivedData[nReceiveNum-1]);
			strReadReceivedInfo += strTmp;
		}
		else
		{
			for (int nTmp=0;nTmp<nReceiveNum-1;nTmp++)
			{
				strTmp.Format("%f,",vReceivedData[nTmp]);
				strReadReceivedInfo += strTmp;
			}
			strTmp.Format("%f",vReceivedData[nReceiveNum-1]);
			strReadReceivedInfo += strTmp;
		}
	}
	else
	{
		strReadReceivedInfo.Format("读寄存器回复,状态:成功,个数:%d,数据:",nReceiveNum);
		if (nReceiveNum == 1)
		{
			strTmp.Format("%f",vReceivedData[nReceiveNum-1]);
			strReadReceivedInfo += strTmp;
		}
		else
		{
			for (int nTmp=0;nTmp<nReceiveNum-1;nTmp++)
			{
				strTmp.Format("%f,",vReceivedData[nTmp]);
				strReadReceivedInfo += strTmp;
			}
			strTmp.Format("%f",vReceivedData[nReceiveNum-1]);
			strReadReceivedInfo += strTmp;
		}
	}

	m_dstrTranlateResultInfo.push_back(strReadReceivedInfo);
	return TRUE;
}


// 打包获取PLC动作指令或响应
BOOL CCommProtocolXYDFast::PackPlcReadSysWorkCmd( CString& strInfo)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}
	CString strPlcRead;
	if (m_bRegType)			// 双字节
	{
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLC_CMD_TRIGGER);		// 寄存器地址
		int  nDataNum = /*7*/GetReadDataNum();												// 数据量
		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nDataNum))
		{
			return FALSE;
		}
		SetReadRegTranslateResultInfo(nRegAdrr,nDataNum,TRUE);	
	}
	else					// 单字节
	{
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLC_CMD_TRIGGER_WORD);		// 寄存器地址
		int  nDataNum = /*6*/GetReadDataNum();												// 数据量
		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nDataNum, FALSE))
		{
			return FALSE;
		}
		SetReadRegTranslateResultInfo(nRegAdrr,nDataNum,FALSE);
	}

	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLC_CMD_TRIGGER);		// 寄存器地址
	// 	int  nDataNum = 5;												// 数据量
	// 	if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nDataNum))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}


// SysWorkCmdType CCommProtocolXYDFast::AnalyzePlcSysWorkCmdReceived( CString strCmd, BOOL &bTriggered)
// {
// 	SysWorkCmdType eCmdType = eCmdUnknow;
// 	if (m_pCommProRegBase == NULL)
// 	{
// 		bTriggered = FALSE;
// 		return eCmdType;
// 	}
// 
// 	if (m_bRegType)			// 双字节
// 	{
// 		// 解析字符串
// 		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLC_CMD_TRIGGER);		// 寄存器地址
// 		int  nDataNum = 10;												// 数据量
// 		std::vector<int> vnReceivedData;
// 		if (!m_pCommProRegBase->AnalyzeAswReadReg(strCmd, nDataNum, vnReceivedData))
// 		{
// 			bTriggered = FALSE;
// 			return eCmdType;
// 		}
// 
// 		if (vnReceivedData.size() != nDataNum)
// 		{
// 			bTriggered = FALSE;
// 			return eCmdType;
// 		}
// 
// 		if (vnReceivedData.at(0) == PLC_CMD_VAL_NOT_TRIGGERED)
// 		{
// 			bTriggered = FALSE;
// 			return eCmdType;
// 		}
// 
// 		double dBase = 10;
// 		bTriggered = TRUE;
// 		int nWorkCmdVal = vnReceivedData.at(1);
// 
// 		if (nWorkCmdVal == m_FSPCParam.m_nCmdVal)
// 		{		
// 			m_FSPCParam.P1 = vnReceivedData[2];
// 			m_FSPCParam.P2 = vnReceivedData[3];
// 
// 			return eCmdSetProductIndexFSPC;
// 		}
// 		else if (nWorkCmdVal == m_FSSVParam.m_nCmdVal)
// 		{		
// 			m_FSSVParam.P1 = vnReceivedData[2];
// 			m_FSSVParam.P2 = vnReceivedData[3];
// 
// 			return eCmdSaveProductIndexFSSV;
// 		}
// 		else if (nWorkCmdVal == m_FGSPParam.m_nCmdVal)
// 		{
// 			return eCmdGetProductIndexFGSP;
// 		}
// 		else if (nWorkCmdVal == m_FCLBParam.m_nCmdVal)
// 		{
// 			m_FCLBParam.m_nPType = m_FCLBParam.m_nPNum;
// 			m_FCLBParam.P1 = vnReceivedData[2];
// 			m_FCLBParam.P2 = vnReceivedData[3];
// 
// 			std::vector<int>	vnAxisPos;
// 			vnAxisPos.push_back(vnReceivedData[7]);
// 			vnAxisPos.push_back(vnReceivedData[8]);
// 			vnAxisPos.push_back(vnReceivedData[9]);
// 			if (TRUE == ConvertToPlatformXYDAxisPos(vnAxisPos, &m_CurPlatformXYDAxisPos))
// 			{
// 				m_FCLBParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
// 				m_FCLBParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
// 				m_FCLBParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
// 			}
// 			else
// 			{
// 				return eCmdUnknow;
// 			}
// 
// 			return eCmdCalibrateFCLB;
// 		}
// 		else if (nWorkCmdVal == m_FCBSParam.m_nCmdVal)
// 		{
// 			m_FCBSParam.m_nPType = m_FCBSParam.m_nPNum;
// 			m_FCBSParam.P1 = vnReceivedData[2];
// 			m_FCBSParam.P2 = vnReceivedData[3];
// 
// 			std::vector<int>	vnAxisPos;
// 			vnAxisPos.push_back(vnReceivedData[7]);
// 			vnAxisPos.push_back(vnReceivedData[8]);
// 			vnAxisPos.push_back(vnReceivedData[9]);
// 			if (TRUE == ConvertToPlatformXYDAxisPos(vnAxisPos, &m_CurPlatformXYDAxisPos))
// 			{
// 				m_FCBSParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
// 				m_FCBSParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
// 				m_FCBSParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
// 			}
// 			else
// 			{
// 				return eCmdUnknow;
// 			}
// 
// 			return eCmdCalibrateFCBS;
// 		}
// 		else if (nWorkCmdVal == m_FTGTParam.m_nCmdVal)
// 		{
// 
// 			m_FTGTParam.m_nPType = m_FTGTParam.m_nPNum;
// 			m_FTGTParam.P1 = vnReceivedData[2];
// 
// 			std::vector<int>	vnAxisPos;
// 			vnAxisPos.push_back(vnReceivedData[7]);
// 			vnAxisPos.push_back(vnReceivedData[8]);
// 			vnAxisPos.push_back(vnReceivedData[9]);
// 			if (TRUE == ConvertToPlatformXYDAxisPos(vnAxisPos, &m_CurPlatformXYDAxisPos))
// 			{
// 				m_FTGTParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
// 				m_FTGTParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
// 				m_FTGTParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
// 			}
// 			else
// 			{
// 				return eCmdUnknow;
// 			}
// 
// 			return eCmdTargetSearchFTGT;
// 		}
// 		else if (nWorkCmdVal == m_FTGMParam.m_nCmdVal)
// 		{
// 
// 			m_FTGMParam.m_nPType = m_FTGMParam.m_nPNum;
// 			m_FTGMParam.P1 = vnReceivedData[2];
// 
// 			std::vector<int>	vnAxisPos;
// 			vnAxisPos.push_back(vnReceivedData[7]);
// 			vnAxisPos.push_back(vnReceivedData[8]);
// 			vnAxisPos.push_back(vnReceivedData[9]);
// 			if (TRUE == ConvertToPlatformXYDAxisPos(vnAxisPos, &m_CurPlatformXYDAxisPos))
// 			{
// 				m_FTGMParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
// 				m_FTGMParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
// 				m_FTGMParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
// 			}
// 			else
// 			{
// 				return eCmdUnknow;
// 			}
// 
// 			return eCmdTargetSearchFTGM;
// 		}
// 		else if (nWorkCmdVal == m_FTGSParam.m_nCmdVal)
// 		{
// 			m_FTGSParam.P1 = vnReceivedData[2];
// 
// 			std::vector<int>	vnAxisPos;
// 			vnAxisPos.push_back(vnReceivedData[7]);
// 			vnAxisPos.push_back(vnReceivedData[8]);
// 			vnAxisPos.push_back(vnReceivedData[9]);
// 			if (TRUE == ConvertToPlatformXYDAxisPos(vnAxisPos, &m_CurPlatformXYDAxisPos))
// 			{
// 				m_FTGSParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
// 				m_FTGSParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
// 				m_FTGSParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
// 			}
// 			else
// 			{
// 				return eCmdUnknow;
// 			}
// 
// 			return eCmdTargetSearchFTGS;
// 		}
// 		else if (nWorkCmdVal == m_FTGCParam.m_nCmdVal)
// 		{
// 			m_FTGCParam.m_nPType = m_FTGCParam.m_nPNum;
// 			m_FTGCParam.P1 = vnReceivedData[2];
// 			m_FTGCParam.P2 = vnReceivedData[3];
// 
// 			std::vector<int>	vnAxisPos;
// 			vnAxisPos.push_back(vnReceivedData[7]);
// 			vnAxisPos.push_back(vnReceivedData[8]);
// 			vnAxisPos.push_back(vnReceivedData[9]);
// 			if (TRUE == ConvertToPlatformXYDAxisPos(vnAxisPos, &m_CurPlatformXYDAxisPos))
// 			{
// 				m_FTGCParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
// 				m_FTGCParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
// 				m_FTGCParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
// 			}
// 			else
// 			{
// 				return eCmdUnknow;
// 			}
// 
// 			return eCmdTargetSearchFTGC;
// 		}
// 		else if (nWorkCmdVal == m_FTGRParam.m_nCmdVal)
// 		{		
// 			m_FTGRParam.P1 = vnReceivedData[2];
// 			m_FTGRParam.P2 = vnReceivedData[3]/100.0;
// 			m_FTGRParam.P3 = vnReceivedData[4]/100.0;
// 
// 			return eCmdSaveTargetPosFTGR;
// 		}
// 		else if (nWorkCmdVal == m_FTGGParam.m_nCmdVal)
// 		{		
// 			m_FTGGParam.P1 = vnReceivedData[2];
// 
// 			return eCmdGetTargetImagePosFTGG;
// 		}
// 		else if (nWorkCmdVal == m_FTGDParam.m_nCmdVal)
// 		{
// 
// 			m_FTGDParam.P1 = vnReceivedData[2];
// 
// 			return eCmdDisplayTargetFTGD;
// 		}
// 		else if (nWorkCmdVal == m_FGAPParam.m_nCmdVal)
// 		{	
// 			m_FGAPParam.m_nPType = m_FGAPParam.m_nPNum;
// 			m_FGAPParam.P1 = vnReceivedData[2];
// 			m_FGAPParam.P2 = vnReceivedData[3];
// 
// 			return eCmdGetImagePosFGAP;
// 		}
// 		else if (nWorkCmdVal == m_FCNTParam.m_nCmdVal)
// 		{		
// 			m_FCNTParam.m_nPType = m_FCNTParam.m_nPNum;
// 			m_FCNTParam.P1 = vnReceivedData[2];
// 
// 			std::vector<int>	vnAxisPos;
// 			vnAxisPos.push_back(vnReceivedData[7]);
// 			vnAxisPos.push_back(vnReceivedData[8]);
// 			vnAxisPos.push_back(vnReceivedData[9]);
// 			if (TRUE == ConvertToPlatformXYDAxisPos(vnAxisPos, &m_CurPlatformXYDAxisPos))
// 			{
// 				m_FCNTParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
// 				m_FCNTParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
// 				m_FCNTParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
// 			}
// 			else
// 			{
// 				return eCmdUnknow;
// 			}
// 
// 			return eCmdObjectSearchFCNT;
// 		}
// 		else if (nWorkCmdVal == m_FOBJParam.m_nCmdVal)
// 		{		
// 			m_FOBJParam.m_nPType = m_FOBJParam.m_nPNum;
// 			m_FOBJParam.P1 = vnReceivedData[2];
// 
// 			std::vector<int>	vnAxisPos;
// 			vnAxisPos.push_back(vnReceivedData[7]);
// 			vnAxisPos.push_back(vnReceivedData[8]);
// 			vnAxisPos.push_back(vnReceivedData[9]);
// 			if (TRUE == ConvertToPlatformXYDAxisPos(vnAxisPos, &m_CurPlatformXYDAxisPos))
// 			{
// 				m_FOBJParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
// 				m_FOBJParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
// 				m_FOBJParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
// 			}
// 			else
// 			{
// 				return eCmdUnknow;
// 			}
// 
// 			return eCmdObjectSearchFOBJ;
// 		}
// 		else if (nWorkCmdVal == m_FOBMParam.m_nCmdVal)
// 		{		
// 			m_FOBMParam.m_nPType = m_FOBMParam.m_nPNum;
// 			m_FOBMParam.P1 = vnReceivedData[2];
// 
// 			std::vector<int>	vnAxisPos;
// 			vnAxisPos.push_back(vnReceivedData[7]);
// 			vnAxisPos.push_back(vnReceivedData[8]);
// 			vnAxisPos.push_back(vnReceivedData[9]);
// 			if (TRUE == ConvertToPlatformXYDAxisPos(vnAxisPos, &m_CurPlatformXYDAxisPos))
// 			{
// 				m_FOBMParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
// 				m_FOBMParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
// 				m_FOBMParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
// 			}
// 			else
// 			{
// 				return eCmdUnknow;
// 			}	
// 
// 			return eCmdObjectSearchFOBM;
// 		}
// 		else if (nWorkCmdVal == m_FOBCParam.m_nCmdVal)
// 		{		
// 			m_FOBCParam.m_nPType = m_FOBCParam.m_nPNum;
// 			m_FOBCParam.P1 = vnReceivedData[2];
// 			m_FOBCParam.P2 = vnReceivedData[3];
// 
// 			std::vector<int>	vnAxisPos;
// 			vnAxisPos.push_back(vnReceivedData[7]);
// 			vnAxisPos.push_back(vnReceivedData[8]);
// 			vnAxisPos.push_back(vnReceivedData[9]);
// 			if (TRUE == ConvertToPlatformXYDAxisPos(vnAxisPos, &m_CurPlatformXYDAxisPos))
// 			{
// 				m_FOBCParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
// 				m_FOBCParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
// 				m_FOBCParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
// 			}
// 			else
// 			{
// 				return eCmdUnknow;
// 			}
// 
// 			return eCmdObjectSearchFOBC;
// 		}
// 		else if (nWorkCmdVal == m_FOBGParam.m_nCmdVal)
// 		{
// 			m_FOBGParam.P1 = vnReceivedData[2];
// 
// 			return eCmdGetObjectImagePosFOBG;
// 		}
// 		else if (nWorkCmdVal == m_FMSCParam.m_nCmdVal)
// 		{
// 
// 			m_FMSCParam.P1 = vnReceivedData[2];
// 
// 			return eCmdManualSearchFMSC;
// 		}
// 		else if (nWorkCmdVal == m_FWLDParam.m_nCmdVal)
// 		{
// 			m_FWLDParam.P1 = vnReceivedData[2];
// 			m_FWLDParam.P2 = vnReceivedData[3];
// 
// 			return eCmdGetSearchWorldPosFWLD;
// 		}
// 		else if (nWorkCmdVal == m_FGALParam.m_nCmdVal)
// 		{
// 			m_FGALParam.P1 = vnReceivedData[2];
// 
// 			return eCmdGetAlignPrecisionFGAL;
// 		}
// 		else if (nWorkCmdVal == m_FALLParam.m_nCmdVal)
// 		{
// 			m_FALLParam.P1 = vnReceivedData[2];
// 			m_FALLParam.P2 = vnReceivedData[3]*1.0/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
// 			m_FALLParam.P3 = vnReceivedData[4]*1.0/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
// 			m_FALLParam.P4 = vnReceivedData[5]*1.0/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 			return eCmdSetAlignPrecisionFALL;
// 		}
// 		else if (nWorkCmdVal == m_FGACParam.m_nCmdVal)
// 		{
// 			return eCmdGetAlignTimeFGAC;
// 		}
// 		else if (nWorkCmdVal == m_FALCParam.m_nCmdVal)
// 		{
// 			m_FALCParam.P1 = vnReceivedData[2];
// 
// 			return eCmdSetAlignTimeFALC;
// 		}
// 		else if (nWorkCmdVal == m_FAALParam.m_nCmdVal)
// 		{		
// 			m_FAALParam.m_nPType = m_FAALParam.m_nPNum;
// 			m_FAALParam.P1 = vnReceivedData[2];
// 
// 			std::vector<int>	vnAxisPos;
// 			vnAxisPos.push_back(vnReceivedData[7]);
// 			vnAxisPos.push_back(vnReceivedData[8]);
// 			vnAxisPos.push_back(vnReceivedData[9]);
// 			if (TRUE == ConvertToPlatformXYDAxisPos(vnAxisPos, &m_CurPlatformXYDAxisPos))
// 			{
// 				m_FAALParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
// 				m_FAALParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
// 				m_FAALParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
// 			}
// 			else
// 			{
// 				return eCmdUnknow;
// 			}
// 
// 			return eCmdAutoAlignFAAL;
// 		}
// 		else if (nWorkCmdVal == m_FXYAParam.m_nCmdVal)
// 		{		
// 			m_FXYAParam.m_nPType = m_FAALParam.m_nPNum;
// 			m_FXYAParam.P1 = vnReceivedData[2];
// 			m_FXYAParam.P2 = vnReceivedData[3];
// 
// 			std::vector<int>	vnAxisPos;
// 			vnAxisPos.push_back(vnReceivedData[7]);
// 			vnAxisPos.push_back(vnReceivedData[8]);
// 			vnAxisPos.push_back(vnReceivedData[9]);
// 			if (TRUE == ConvertToPlatformXYDAxisPos(vnAxisPos, &m_CurPlatformXYDAxisPos))
// 			{
// 				m_FXYAParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
// 				m_FXYAParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
// 				m_FXYAParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
// 			}
// 			else
// 			{
// 				return eCmdUnknow;
// 			}
// 
// 			return eCmdAutoAlignFXYA;
// 		}
// 		else if (nWorkCmdVal == m_FAABParam.m_nCmdVal)
// 		{	
// 			m_FAABParam.m_nPType = m_FAABParam.m_nPNum;
// 			m_FAABParam.P1 = vnReceivedData[2];
// 
// 			std::vector<int>	vnAxisPos;
// 			vnAxisPos.push_back(vnReceivedData[7]);
// 			vnAxisPos.push_back(vnReceivedData[8]);
// 			vnAxisPos.push_back(vnReceivedData[9]);
// 			if (TRUE == ConvertToPlatformXYDAxisPos(vnAxisPos, &m_CurPlatformXYDAxisPos))
// 			{
// 				m_FAABParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
// 				m_FAABParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
// 				m_FAABParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
// 			}
// 			else
// 			{
// 				return eCmdUnknow;
// 			}
// 
// 			return eCmdAutoAlignFAAB;
// 		}
// 		else if (nWorkCmdVal == m_FACBParam.m_nCmdVal)
// 		{	
// 			m_FACBParam.m_nPType = m_FACBParam.m_nPNum;
// 			m_FACBParam.P1 = vnReceivedData[2];
// 
// 			std::vector<int>	vnAxisPos;
// 			vnAxisPos.push_back(vnReceivedData[7]);
// 			vnAxisPos.push_back(vnReceivedData[8]);
// 			vnAxisPos.push_back(vnReceivedData[9]);
// 			if (TRUE == ConvertToPlatformXYDAxisPos(vnAxisPos, &m_CurPlatformXYDAxisPos))
// 			{
// 				m_FACBParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
// 				m_FACBParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
// 				m_FACBParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
// 			}
// 			else
// 			{
// 				return eCmdUnknow;
// 			}
// 
// 			return eCmdAutoAlignFACB;
// 		}
// 		else if (nWorkCmdVal == m_FAACParam.m_nCmdVal)
// 		{		
// 			m_FAACParam.m_nPType = m_FAACParam.m_nPNum;
// 			m_FAACParam.P1 = vnReceivedData[2];
// 			m_FAACParam.P2 = vnReceivedData[3];
// 
// 			std::vector<int>	vnAxisPos;
// 			vnAxisPos.push_back(vnReceivedData[7]);
// 			vnAxisPos.push_back(vnReceivedData[8]);
// 			vnAxisPos.push_back(vnReceivedData[9]);
// 			if (TRUE == ConvertToPlatformXYDAxisPos(vnAxisPos, &m_CurPlatformXYDAxisPos))
// 			{
// 				m_FAACParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
// 				m_FAACParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
// 				m_FAACParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
// 			}
// 			else
// 			{
// 				return eCmdUnknow;
// 			}	
// 
// 			return eCmdAutoAlignFAAC;
// 		}
// 		else if (nWorkCmdVal == m_FAOTParam.m_nCmdVal)
// 		{			
// 			m_FAOTParam.m_nPType = m_FAOTParam.m_nPNum;
// 			m_FAOTParam.P1 = vnReceivedData[2];
// 			m_FAOTParam.P2 = vnReceivedData[3];
// 
// 			std::vector<int>	vnAxisPos;
// 			vnAxisPos.push_back(vnReceivedData[7]);
// 			vnAxisPos.push_back(vnReceivedData[8]);
// 			vnAxisPos.push_back(vnReceivedData[9]);
// 			if (TRUE == ConvertToPlatformXYDAxisPos(vnAxisPos, &m_CurPlatformXYDAxisPos))
// 			{
// 				m_FAOTParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
// 				m_FAOTParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
// 				m_FAOTParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
// 			}
// 			else
// 			{
// 				return eCmdUnknow;
// 			}
// 
// 			return eCmdAutoAlignFAOT;
// 		}
// 		else if (nWorkCmdVal == m_FALXParam.m_nCmdVal)
// 		{			
// 			m_FALXParam.m_nPType = m_FALXParam.m_nPNum;
// 			m_FALXParam.P1 = vnReceivedData[2];
// 			m_FALXParam.P2 = vnReceivedData[3];
// 
// 			std::vector<int>	vnAxisPos;
// 			vnAxisPos.push_back(vnReceivedData[7]);
// 			vnAxisPos.push_back(vnReceivedData[8]);
// 			vnAxisPos.push_back(vnReceivedData[9]);
// 			if (TRUE == ConvertToPlatformXYDAxisPos(vnAxisPos, &m_CurPlatformXYDAxisPos))
// 			{
// 				m_FALXParam.P3 = m_CurPlatformXYDAxisPos.m_dPosX;
// 				m_FALXParam.P4 = m_CurPlatformXYDAxisPos.m_dPosY;
// 				m_FALXParam.P5 = m_CurPlatformXYDAxisPos.m_dAngle;
// 			}
// 			else
// 			{
// 				return eCmdUnknow;
// 			}
// 
// 			return eCmdAutoAlignFALX;
// 		}
// 		else if (nWorkCmdVal == m_FAHLParam.m_nCmdVal)
// 		{		
// 			m_FAHLParam.m_nPType = m_FAHLParam.m_nPNum;
// 			m_FAHLParam.P1 = vnReceivedData[2];
// 
// 			std::vector<int>	vnAxisPos;
// 			vnAxisPos.push_back(vnReceivedData[7]);
// 			vnAxisPos.push_back(vnReceivedData[8]);
// 			vnAxisPos.push_back(vnReceivedData[9]);
// 			if (TRUE == ConvertToPlatformXYDAxisPos(vnAxisPos, &m_CurPlatformXYDAxisPos))
// 			{
// 				m_FALXParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
// 				m_FALXParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
// 				m_FALXParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
// 			}
// 			else
// 			{
// 				return eCmdUnknow;
// 			}
// 
// 			return eCmdAutoAlignFAHL;
// 		}
// 		else if (nWorkCmdVal == m_FANSParam.m_nCmdVal)
// 		{		
// 			return eCmdGetAutoAlignOffsetFANS;
// 		}
// 		else if (nWorkCmdVal == m_FALGParam.m_nCmdVal)
// 		{		
// 			m_FALGParam.P1 = vnReceivedData[2];
// 
// 			return eCmdOnceAlignMoveFALG;
// 		}
// 		else if (nWorkCmdVal == m_FALPParam.m_nCmdVal)
// 		{		
// 			m_FALPParam.m_nPType = m_FALPParam.m_nPNum - 3;
// 			m_FALPParam.P1 = vnReceivedData[2];
// 			m_FALPParam.P2 = 0;
// 			m_FALPParam.P3 = 0;
// 			m_FALPParam.P4 = 0;
// 
// 			return eCmdOnceAlignMovePickFALP;
// 		}
// 		else if (nWorkCmdVal == m_FALJParam.m_nCmdVal)
// 		{
// 			m_FALJParam.P1 = vnReceivedData[2];
// 			m_FALJParam.P2 = vnReceivedData[3];
// 
// 			return eCmdOnceAlignFALJ;
// 		}
// 		else if (nWorkCmdVal == m_FACOParam.m_nCmdVal)
// 		{		
// 			m_FACOParam.P1 = vnReceivedData[2];
// 
// 			return eCmdGetTargetObjectOffsetFACO;
// 		}
// 		else if (nWorkCmdVal == m_FOLCParam.m_nCmdVal)
// 		{		
// 			m_FOLCParam.m_nPType = m_FOLCParam.m_nPNum;
// 			m_FOLCParam.P1 = vnReceivedData[2];
// 
// 			std::vector<int>	vnAxisPos;
// 			vnAxisPos.push_back(vnReceivedData[7]);
// 			vnAxisPos.push_back(vnReceivedData[8]);
// 			vnAxisPos.push_back(vnReceivedData[9]);
// 			if (TRUE == ConvertToPlatformXYDAxisPos(vnAxisPos, &m_CurPlatformXYDAxisPos))
// 			{
// 				m_FOLCParam.P2 = m_CurPlatformXYDAxisPos.m_dPosX;
// 				m_FOLCParam.P3 = m_CurPlatformXYDAxisPos.m_dPosY;
// 				m_FOLCParam.P4 = m_CurPlatformXYDAxisPos.m_dAngle;
// 			}
// 			else
// 			{
// 				return eCmdUnknow;
// 			}
// 
// 			return eCmdGetTargetObjectOffsetFOLC;
// 		}
// 		else if (nWorkCmdVal == m_FABOParam.m_nCmdVal)
// 		{
// 			m_FABOParam.P1 = vnReceivedData[2];
// 
// 			return eCmdGetTargetObjectOffsetFABO;
// 		}
// 		else if (nWorkCmdVal == m_FAOFParam.m_nCmdVal)
// 		{		
// 			m_FAOFParam.P1 = vnReceivedData[2];
// 
// 			return eCmdCalcuAlignOffsetFAOF;
// 		}
// 		else if (nWorkCmdVal == m_FGOFParam.m_nCmdVal)
// 		{		
// 			m_FGOFParam.P1 = vnReceivedData[2];
// 
// 			return eCmdGetAlignOffsetFGOF;
// 		}
// 		else if (nWorkCmdVal == m_FOFSParam.m_nCmdVal)
// 		{		
// 			m_FOFSParam.P1 = vnReceivedData[2]*1.0/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
// 			m_FOFSParam.P2 = vnReceivedData[3]*1.0/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
// 			m_FOFSParam.P3 = vnReceivedData[4]*1.0/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 			return eCmdSetAlignOffsetFOFS;
// 		}
// 		else if (nWorkCmdVal == m_FSFTParam.m_nCmdVal)
// 		{
// 			m_FSFTParam.P1 = vnReceivedData[2];
// 			return eCmdFSFT;
// 		}
// 		else if (nWorkCmdVal == m_FGSFParam.m_nCmdVal)
// 		{
// 			m_FGSFParam.P1 = vnReceivedData[2];
// 
// 			return eCmdFGSF;
// 		}
// 		else if (nWorkCmdVal == m_FALMParam.m_nCmdVal)
// 		{
// 			return eCmdGetAlarmFALM;
// 		}
// 		else if (nWorkCmdVal == m_FRSTParam.m_nCmdVal)
// 		{
// 			return eCmdResetFRST;
// 		}
// 		else if (nWorkCmdVal == m_FCHKParam.m_nCmdVal)
// 		{
// 			m_FCHKParam.P1 = vnReceivedData[2];
// 			return eCmdSpecialCommFCHK;
// 		}
// 		else if (nWorkCmdVal == m_FSACParam.m_nCmdVal)
// 		{
// 			return eCmdSaveProcessDataFSAC;
// 		}
// 		else if (nWorkCmdVal == m_FSCOParam.m_nCmdVal)
// 		{
// 			return eCmdSaveCommDataFSCO;
// 		}
// 		else if (nWorkCmdVal == m_MNPSParam.m_nCmdVal)
// 		{
// 			m_MNPSParam.P1 = vnReceivedData[2];
// 			return eCmdGetPosMNPS;
// 		}
// 		else if (nWorkCmdVal == m_MMVAParam.m_nCmdVal)
// 		{
// 			m_MMVAParam.P1 = vnReceivedData[2];
// 			return eCmdMovePosMMVA;
// 		}
// 		else if (nWorkCmdVal == m_MMVRParam.m_nCmdVal)
// 		{
// 			m_MMVRParam.P1 = vnReceivedData[2];
// 			return eCmdMoveRelPosMMVR;
// 		}
// 
// 		return eCmdUnknow;
// 	}
// 	else		// 单字节
// 	{
// 		// 解析字符串
// 		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLC_CMD_TRIGGER_WORD);		// 寄存器地址
// 		int  nDataNum = 5;												// 数据量
// 		std::vector<int> vnReceivedData;
// 
// 		if (!m_pCommProRegBase->AnalyzeAswReadReg(strCmd, nDataNum, vnReceivedData,FALSE))
// 		{
// 			bTriggered = FALSE;
// 			return eCmdType;
// 		}
// 
// 		if (vnReceivedData.size() != nDataNum)
// 		{
// 			bTriggered = FALSE;
// 			return eCmdType;
// 		}
// 
// 		if (vnReceivedData.at(0) == PLC_CMD_VAL_NOT_TRIGGERED)
// 		{
// 			bTriggered = FALSE;
// 			return eCmdType;
// 		}
// 
// 		double dBase = 10;
// 		bTriggered = TRUE;
// 		int nWorkCmdVal = vnReceivedData.at(1);
// 
// 		// FAST 读写寄存器
// 		if (nWorkCmdVal == m_FRSTParam.m_nVCmdValue)		// 	1	FRST
// 		{
// 			return eCmdResetFRST;
// 		}
// 		else if (nWorkCmdVal == m_FHMSParam.m_nVCmdValue)		// 	2	FHMS
// 		{
// 			return eCmdUnknow;
// 		}
// 		else if (nWorkCmdVal == m_FHOMParam.m_nVCmdValue)		// 	3	FHOM
// 		{
// 			return eCmdUnknow;
// 		}
// 		else if (nWorkCmdVal == m_FSPCParam.m_nVCmdValue)		// 	4	FSPC
// 		{
// 			m_FSPCParam.P1 = vnReceivedData[2];
// 			m_FSPCParam.P2 = vnReceivedData[3];
// 
// 			return eCmdSetProductIndexFSPC;
// 		}
// 		else if (nWorkCmdVal == m_FCLBParam.m_nVCmdValue)		// 	5	FCLB
// 		{
// 			m_FCLBParam.m_nPType = m_FCLBParam.m_nPNum - 3;
// 			m_FCLBParam.P1 = vnReceivedData[2];
// 			m_FCLBParam.P2 = vnReceivedData[3];
// 			m_FCLBParam.P3 = 0;
// 			m_FCLBParam.P4 = 0;
// 			m_FCLBParam.P5 = 0;
// 
// 			return eCmdCalibrateFCLB;
// 		}
// 		else if (nWorkCmdVal == m_FTGTParam.m_nVCmdValue)		// 	6	FTGT
// 		{
// 			m_FTGTParam.m_nPType = m_FTGTParam.m_nPNum - 3;
// 			m_FTGTParam.P1 = vnReceivedData[2];
// 			m_FTGTParam.P2 = 0;
// 			m_FTGTParam.P3 = 0;
// 			m_FTGTParam.P4 = 0;
// 
// 			return eCmdTargetSearchFTGT;
// 		}
// 		else if (nWorkCmdVal == m_FOBJParam.m_nVCmdValue)		// 	7	FOBJ
// 		{
// 			m_FOBJParam.m_nPType = m_FOBJParam.m_nPNum - 3;
// 			m_FOBJParam.P1 = vnReceivedData[2];
// 			m_FOBJParam.P2 = 0;
// 			m_FOBJParam.P3 = 0;
// 			m_FOBJParam.P4 = 0;		
// 
// 			return eCmdObjectSearchFOBJ;
// 		}
// 		else if (nWorkCmdVal == m_FAALParam.m_nVCmdValue)		// 	8	FAAL
// 		{
// 			m_FAALParam.m_nPType = m_FAALParam.m_nPNum - 3;
// 			m_FAALParam.P1 = vnReceivedData[2];
// 			m_FAALParam.P2 = 0;
// 			m_FAALParam.P3 = 0;
// 			m_FAALParam.P4 = 0;
// 
// 			return eCmdAutoAlignFAAL;
// 		}
// 		else if (nWorkCmdVal == m_MNPSParam.m_nVCmdValue)		// 	9	FNPS
// 		{
// 			m_MNPSParam.P1 = vnReceivedData[2];
// 			return eCmdGetPosMNPS;
// 		}
// 		else if (nWorkCmdVal == m_MMVAParam.m_nVCmdValue)		// 	10	FMVA
// 		{
// 			m_MMVAParam.P1 = vnReceivedData[2];
// 			return eCmdMovePosMMVA;
// 		}
// 		else if (nWorkCmdVal == m_MMVRParam.m_nVCmdValue)		// 		11	FMVR
// 		{
// 			m_MMVRParam.P1 = vnReceivedData[2];
// 			return eCmdMoveRelPosMMVR;
// 		}
// 		else if (nWorkCmdVal == m_FPNTParam.m_nVCmdValue)		// 		12	FPNT
// 		{
// 		}
// 		else if (nWorkCmdVal == m_FACOParam.m_nVCmdValue)		// 		13	FACO
// 		{
// 			m_FACOParam.P1 = vnReceivedData[2];
// 
// 			return eCmdGetTargetObjectOffsetFACO;
// 		}
// 		else if (nWorkCmdVal == m_FOLCParam.m_nVCmdValue)		// 		13	FOLC
// 		{
// 			m_FOLCParam.m_nPType = m_FOLCParam.m_nPNum - 3;
// 			m_FOLCParam.P1 = vnReceivedData[2];
// 			m_FOLCParam.P2 = 0;
// 			m_FOLCParam.P3 = 0;
// 			m_FOLCParam.P4 = 0;
// 
// 			return eCmdGetTargetObjectOffsetFOLC;
// 		}
// 		else  if (nWorkCmdVal == m_FALGParam.m_nVCmdValue)		// 		14	FALG
// 		{
// 			m_FALGParam.P1 = vnReceivedData[2];
// 
// 			return eCmdOnceAlignMoveFALG;
// 		}
// 		else if (nWorkCmdVal == m_FCNTParam.m_nVCmdValue)		// 		15	FCNT
// 		{
// 			m_FCNTParam.m_nPType = m_FCNTParam.m_nPNum - 3;
// 			m_FCNTParam.P1 = vnReceivedData[2];
// 			m_FCNTParam.P2 = 0;
// 			m_FCNTParam.P3 = 0;
// 			m_FCNTParam.P4 = 0;		
// 
// 			return eCmdObjectSearchFCNT;
// 		}
// 		else if (nWorkCmdVal == m_FGAPParam.m_nVCmdValue)		// 		16	FGAP
// 		{
// 			m_FGAPParam.m_nPType = m_FGAPParam.m_nPNum;
// 			m_FGAPParam.P1 = vnReceivedData[2];
// 			m_FGAPParam.P2 = vnReceivedData[3];
// 
// 			return eCmdGetImagePosFGAP;
// 		}
// 		else if (nWorkCmdVal == m_FTGCParam.m_nVCmdValue)		// 		17	FTGC
// 		{
// 			m_FTGCParam.m_nPType = m_FTGCParam.m_nPNum - 3;
// 			m_FTGCParam.P1 = vnReceivedData[2];
// 			m_FTGCParam.P2 = vnReceivedData[3];
// 			m_FTGCParam.P3 = 0;
// 			m_FTGCParam.P4 = 0;
// 			m_FTGCParam.P5 = 0;
// 
// 			return eCmdTargetSearchFTGC;
// 		}
// 		else if (nWorkCmdVal == m_FOBCParam.m_nVCmdValue)		// 		18	FOBC
// 		{
// 			m_FOBCParam.m_nPType = m_FOBCParam.m_nPNum - 3;
// 			m_FOBCParam.P1 = vnReceivedData[2];
// 			m_FOBCParam.P2 = vnReceivedData[3];
// 			m_FOBCParam.P3 = 0;
// 			m_FOBCParam.P4 = 0;
// 			m_FOBCParam.P5 = 0;
// 
// 			return eCmdObjectSearchFOBC;
// 		}
// 		else if (nWorkCmdVal == m_FAACParam.m_nVCmdValue)		// 		19	FAAC
// 		{
// 			m_FAACParam.m_nPType = m_FAACParam.m_nPNum - 3;
// 			m_FAACParam.P1 = vnReceivedData[2];
// 			m_FAACParam.P2 = vnReceivedData[3];
// 			m_FAACParam.P3 = 0;
// 			m_FAACParam.P4 = 0;
// 			m_FAACParam.P5 = 0;		
// 
// 			return eCmdAutoAlignFAAC;
// 		}
// 		else if (nWorkCmdVal == m_FAOTParam.m_nVCmdValue)
// 		{			
// 			m_FAOTParam.m_nPType = m_FAACParam.m_nPNum - 3;
// 			m_FAOTParam.P1 = vnReceivedData[2];
// 			m_FAOTParam.P2 = vnReceivedData[3];
// 			m_FAOTParam.P3 = 0;
// 			m_FAOTParam.P4 = 0;
// 			m_FAOTParam.P5 = 0;	
// 
// 			return eCmdAutoAlignFAOT;
// 		}
// 		else if (nWorkCmdVal == m_FALXParam.m_nVCmdValue)
// 		{			
// 			m_FALXParam.m_nPType = m_FALXParam.m_nPNum - 3;
// 			m_FALXParam.P1 = vnReceivedData[2];
// 			m_FALXParam.P2 = vnReceivedData[3];
// 			m_FALXParam.P3 = 0;
// 			m_FALXParam.P4 = 0;
// 			m_FALXParam.P5 = 0;
// 
// 			return eCmdAutoAlignFALX;
// 		}
// 		else if (nWorkCmdVal == m_FGSPParam.m_nVCmdValue)		// 		20	FGSP
// 		{
// 			return eCmdGetProductIndexFGSP;
// 		}
// 		else if (nWorkCmdVal == m_FCBSParam.m_nVCmdValue)		// 		21	FCBS
// 		{
// 			m_FCBSParam.m_nPType = m_FCBSParam.m_nPNum - 3;
// 			m_FCBSParam.P1 = vnReceivedData[2];
// 			m_FCBSParam.P2 = vnReceivedData[3];
// 			m_FCBSParam.P3 = 0;
// 			m_FCBSParam.P4 = 0;
// 			m_FCBSParam.P5 = 0;
// 
// 			return eCmdCalibrateFCBS;
// 		}
// 		else if (nWorkCmdVal == m_FMAPParam.m_nVCmdValue)		// 		22	FMAP
// 		{
// 			return eCmdUnknow;
// 		}
// 		else if (nWorkCmdVal == m_FXYAParam.m_nVCmdValue)		// 		23	FXYA
// 		{
// 			m_FXYAParam.m_nPType = m_FAALParam.m_nPNum - 3;
// 			m_FXYAParam.P1 = vnReceivedData[2];
// 			m_FXYAParam.P2 = vnReceivedData[3];
// 			m_FXYAParam.P3 = 0;
// 			m_FXYAParam.P4 = 0;
// 			m_FXYAParam.P5 = 0;
// 			return eCmdAutoAlignFXYA;
// 		}
// 		else if (nWorkCmdVal == m_FRCTParam.m_nVCmdValue)// 		24	FRCT
// 		{
// 			return eCmdUnknow;
// 		}
// 		else if (nWorkCmdVal == m_FISPParam.m_nVCmdValue)// 		25	FISP
// 		{
// 			return eCmdUnknow;
// 		}
// 		else if (nWorkCmdVal == m_FOLGParam.m_nVCmdValue)// 		26	FOLG
// 		{
// 			return eCmdUnknow;
// 		}
// 		else if (nWorkCmdVal == m_FTLGParam.m_nVCmdValue)// 		27	FTLG
// 		{
// 			return eCmdUnknow;
// 		}
// 		else if (nWorkCmdVal == m_FSSVParam.m_nVCmdValue)
// 		{		
// 			m_FSSVParam.P1 = vnReceivedData[2];
// 			m_FSSVParam.P2 = vnReceivedData[3];
// 
// 			return eCmdSaveProductIndexFSSV;
// 		}
// 		else if (nWorkCmdVal == m_FTGMParam.m_nVCmdValue)
// 		{
// 
// 			m_FTGMParam.m_nPType = m_FTGMParam.m_nPNum - 3;
// 			m_FTGMParam.P1 = vnReceivedData[2];
// 			m_FTGMParam.P2 = 0;
// 			m_FTGMParam.P3 = 0;
// 			m_FTGMParam.P4 = 0;
// 
// 			return eCmdTargetSearchFTGM;
// 		}
// 		else if (nWorkCmdVal == m_FTGSParam.m_nVCmdValue)
// 		{
// 			m_FTGSParam.P1 = vnReceivedData[2];
// 
// 			return eCmdTargetSearchFTGS;
// 		}
// 		else if (nWorkCmdVal == m_FTGRParam.m_nVCmdValue)
// 		{		
// 			m_FTGRParam.P1 = vnReceivedData[2];
// 			m_FTGRParam.P2 = vnReceivedData[3]/100.0;
// 			m_FTGRParam.P3 = vnReceivedData[4]/100.0;
// 
// 			return eCmdSaveTargetPosFTGR;
// 		}
// 		else if (nWorkCmdVal == m_FTGGParam.m_nVCmdValue)
// 		{		
// 			m_FTGGParam.P1 = vnReceivedData[2];
// 
// 			return eCmdGetTargetImagePosFTGG;
// 		}
// 		else if (nWorkCmdVal == m_FTGDParam.m_nVCmdValue)
// 		{
// 
// 			m_FTGDParam.P1 = vnReceivedData[2];
// 
// 			return eCmdDisplayTargetFTGD;
// 		}
// 		else if (nWorkCmdVal == m_FOBMParam.m_nVCmdValue)
// 		{		
// 			m_FOBMParam.m_nPType = m_FOBMParam.m_nPNum - 3;
// 			m_FOBMParam.P1 = vnReceivedData[2];
// 			m_FOBMParam.P2 = 0;
// 			m_FOBMParam.P3 = 0;
// 			m_FOBMParam.P4 = 0;		
// 
// 			return eCmdObjectSearchFOBM;
// 		}
// 		else if (nWorkCmdVal == m_FOBGParam.m_nVCmdValue)
// 		{
// 			m_FOBGParam.P1 = vnReceivedData[2];
// 
// 			return eCmdGetObjectImagePosFOBG;
// 		}
// 		else if (nWorkCmdVal == m_FMSCParam.m_nVCmdValue)
// 		{
// 
// 			m_FMSCParam.P1 = vnReceivedData[2];
// 
// 			return eCmdManualSearchFMSC;
// 		}
// 		else if (nWorkCmdVal == m_FWLDParam.m_nVCmdValue)
// 		{
// 			m_FWLDParam.P1 = vnReceivedData[2];
// 			m_FWLDParam.P2 = vnReceivedData[3];
// 
// 			return eCmdGetSearchWorldPosFWLD;
// 		}
// 		else if (nWorkCmdVal == m_FGALParam.m_nVCmdValue)
// 		{
// 			m_FGALParam.P1 = vnReceivedData[2];
// 
// 			return eCmdGetAlignPrecisionFGAL;
// 		}
// 		else if (nWorkCmdVal == m_FALLParam.m_nVCmdValue)
// 		{
// 			m_FALLParam.P1 = vnReceivedData[2];
// 			m_FALLParam.P2 = vnReceivedData[3]*1.0/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
// 			m_FALLParam.P3 = vnReceivedData[4]*1.0/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
// 			m_FALLParam.P4 = vnReceivedData[5]*1.0/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 			return eCmdSetAlignPrecisionFALL;
// 		}
// 		else if (nWorkCmdVal == m_FGACParam.m_nVCmdValue)
// 		{
// 			return eCmdGetAlignTimeFGAC;
// 		}
// 		else if (nWorkCmdVal == m_FALCParam.m_nVCmdValue)
// 		{
// 			m_FALCParam.P1 = vnReceivedData[2];
// 
// 			return eCmdSetAlignTimeFALC;
// 		}
// 		else if (nWorkCmdVal == m_FAABParam.m_nVCmdValue)
// 		{	
// 			m_FAABParam.m_nPType = m_FAABParam.m_nPNum - 3;
// 			m_FAABParam.P1 = vnReceivedData[2];
// 			m_FAABParam.P2 = 0;
// 			m_FAABParam.P3 = 0;
// 			m_FAABParam.P4 = 0;	
// 
// 			return eCmdAutoAlignFAAB;
// 		}
// 		else if (nWorkCmdVal == m_FACBParam.m_nVCmdValue)
// 		{	
// 			m_FACBParam.m_nPType = m_FACBParam.m_nPNum - 3;
// 			m_FACBParam.P1 = vnReceivedData[2];
// 			m_FACBParam.P2 = 0;
// 			m_FACBParam.P3 = 0;
// 			m_FACBParam.P4 = 0;	
// 
// 			return eCmdAutoAlignFACB;
// 		}
// 		else if (nWorkCmdVal == m_FAHLParam.m_nVCmdValue)
// 		{		
// 			m_FAHLParam.m_nPType = m_FAHLParam.m_nPNum - 3;
// 			m_FAHLParam.P1 = vnReceivedData[2];
// 			m_FAHLParam.P2 = 0;
// 			m_FAHLParam.P3 = 0;
// 			m_FAHLParam.P4 = 0;
// 
// 			return eCmdAutoAlignFAHL;
// 		}
// 		else if (nWorkCmdVal == m_FANSParam.m_nVCmdValue)
// 		{		
// 			return eCmdGetAutoAlignOffsetFANS;
// 		}
// 		else if (nWorkCmdVal == m_FALPParam.m_nVCmdValue)
// 		{		
// 			m_FALPParam.m_nPType = m_FALPParam.m_nPNum - 3;
// 			m_FALPParam.P1 = vnReceivedData[2];
// 			m_FALPParam.P2 = 0;
// 			m_FALPParam.P3 = 0;
// 			m_FALPParam.P4 = 0;
// 
// 			return eCmdOnceAlignMovePickFALP;
// 		}
// 		else if (nWorkCmdVal == m_FALJParam.m_nVCmdValue)
// 		{
// 			m_FALJParam.P1 = vnReceivedData[2];
// 			m_FALJParam.P2 = vnReceivedData[3];
// 
// 			return eCmdOnceAlignFALJ;
// 		}
// 		else if (nWorkCmdVal == m_FABOParam.m_nVCmdValue)
// 		{
// 			m_FABOParam.P1 = vnReceivedData[2];
// 
// 			return eCmdGetTargetObjectOffsetFABO;
// 		}
// 		else if (nWorkCmdVal == m_FAOFParam.m_nVCmdValue)
// 		{		
// 			m_FAOFParam.P1 = vnReceivedData[2];
// 
// 			return eCmdCalcuAlignOffsetFAOF;
// 		}
// 		else if (nWorkCmdVal == m_FGOFParam.m_nVCmdValue)
// 		{		
// 			m_FGOFParam.P1 = vnReceivedData[2];
// 
// 			return eCmdGetAlignOffsetFGOF;
// 		}
// 		else if (nWorkCmdVal == m_FOFSParam.m_nVCmdValue)
// 		{		
// 			m_FOFSParam.P1 = vnReceivedData[2]*1.0/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
// 			m_FOFSParam.P2 = vnReceivedData[3]*1.0/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
// 			m_FOFSParam.P3 = vnReceivedData[4]*1.0/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 			return eCmdSetAlignOffsetFOFS;
// 		}
// 		else if (nWorkCmdVal == m_FSFTParam.m_nVCmdValue)
// 		{
// 			m_FSFTParam.P1 = vnReceivedData[2];
// 			return eCmdFSFT;
// 		}
// 		else if (nWorkCmdVal == m_FGSFParam.m_nVCmdValue)
// 		{
// 			m_FGSFParam.P1 = vnReceivedData[2];
// 
// 			return eCmdFGSF;
// 		}
// 		else if (nWorkCmdVal == m_FALMParam.m_nVCmdValue)
// 		{
// 			return eCmdGetAlarmFALM;
// 		}
// 		else if (nWorkCmdVal == m_FCHKParam.m_nVCmdValue)
// 		{
// 			m_FCHKParam.P1 = vnReceivedData[2];
// 			return eCmdSpecialCommFCHK;
// 		}
// 		else if (nWorkCmdVal == m_FSACParam.m_nVCmdValue)
// 		{
// 			return eCmdSaveProcessDataFSAC;
// 		}
// 		else if (nWorkCmdVal == m_FSCOParam.m_nVCmdValue)
// 		{
// 			return eCmdSaveCommDataFSCO;
// 		}
// 		else
// 		{
// 			return eCmdUnknow;
// 		}
// 
// 		return eCmdUnknow;
// 	}
// 
// 
// 	// 解析字符串
// // 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLC_CMD_TRIGGER);		// 寄存器地址
// // 	int  nDataNum = 5;												// 数据量
// // 	std::vector<int> vnReceivedData;
// // 	if (!m_pCommProRegBase->AnalyzeAswReadReg(strCmd, nDataNum, vnReceivedData))
// // 	{
// // 		bTriggered = FALSE;
// // 		return eCmdType;
// // 	}
// // 
// // 	if (vnReceivedData.size() != nDataNum)
// // 	{
// // 		bTriggered = FALSE;
// // 		return eCmdType;
// // 	}
// // 
// // 	if (vnReceivedData.at(0) == PLC_CMD_VAL_NOT_TRIGGERED)
// // 	{
// // 		bTriggered = FALSE;
// // 		return eCmdType;
// // 	}
// // 
// // 	double dBase = 10;
// // 	bTriggered = TRUE;
// // 	int nWorkCmdVal = vnReceivedData.at(1);
// // 
// // 	if (nWorkCmdVal == m_FSPCParam.m_nCmdVal)
// // 	{		
// // 		m_FSPCParam.P1 = vnReceivedData[2];
// // 		m_FSPCParam.P2 = vnReceivedData[3];
// // 
// // 		return eCmdSetProductIndexFSPC;
// // 	}
// // 	else if (nWorkCmdVal == m_FSSVParam.m_nCmdVal)
// // 	{		
// // 		m_FSSVParam.P1 = vnReceivedData[2];
// // 		m_FSSVParam.P2 = vnReceivedData[3];
// // 
// // 		return eCmdSaveProductIndexFSSV;
// // 	}
// // 	else if (nWorkCmdVal == m_FGSPParam.m_nCmdVal)
// // 	{
// // 		return eCmdGetProductIndexFGSP;
// // 	}
// // 	else if (nWorkCmdVal == m_FCLBParam.m_nCmdVal)
// // 	{
// // 		m_FCLBParam.m_nPType = m_FCLBParam.m_nPNum - 3;
// // 		m_FCLBParam.P1 = vnReceivedData[2];
// // 		m_FCLBParam.P2 = vnReceivedData[3];
// // 		m_FCLBParam.P3 = 0;
// // 		m_FCLBParam.P4 = 0;
// // 		m_FCLBParam.P5 = 0;
// // 
// // 		return eCmdCalibrateFCLB;
// // 	}
// // 	else if (nWorkCmdVal == m_FCBSParam.m_nCmdVal)
// // 	{
// // 		m_FCBSParam.m_nPType = m_FCBSParam.m_nPNum - 3;
// // 		m_FCBSParam.P1 = vnReceivedData[2];
// // 		m_FCBSParam.P2 = vnReceivedData[3];
// // 		m_FCBSParam.P3 = 0;
// // 		m_FCBSParam.P4 = 0;
// // 		m_FCBSParam.P5 = 0;
// // 
// // 		return eCmdCalibrateFCBS;
// // 	}
// // 	else if (nWorkCmdVal == m_FTGTParam.m_nCmdVal)
// // 	{
// // 		
// // 		m_FTGTParam.m_nPType = m_FTGTParam.m_nPNum - 3;
// // 		m_FTGTParam.P1 = vnReceivedData[2];
// // 		m_FTGTParam.P2 = 0;
// // 		m_FTGTParam.P3 = 0;
// // 		m_FTGTParam.P4 = 0;
// // 
// // 		return eCmdTargetSearchFTGT;
// // 	}
// // 	else if (nWorkCmdVal == m_FTGMParam.m_nCmdVal)
// // 	{
// // 
// // 		m_FTGMParam.m_nPType = m_FTGMParam.m_nPNum - 3;
// // 		m_FTGMParam.P1 = vnReceivedData[2];
// // 		m_FTGMParam.P2 = 0;
// // 		m_FTGMParam.P3 = 0;
// // 		m_FTGMParam.P4 = 0;
// // 
// // 		return eCmdTargetSearchFTGM;
// // 	}
// // 	else if (nWorkCmdVal == m_FTGSParam.m_nCmdVal)
// // 	{
// // 		m_FTGSParam.P1 = vnReceivedData[2];
// // 
// // 		return eCmdTargetSearchFTGS;
// // 	}
// // 	else if (nWorkCmdVal == m_FTGCParam.m_nCmdVal)
// // 	{
// // 		m_FTGCParam.m_nPType = m_FTGCParam.m_nPNum - 3;
// // 		m_FTGCParam.P1 = vnReceivedData[2];
// // 		m_FTGCParam.P2 = vnReceivedData[3];
// // 		m_FTGCParam.P3 = 0;
// // 		m_FTGCParam.P4 = 0;
// // 		m_FTGCParam.P5 = 0;
// // 
// // 		return eCmdTargetSearchFTGC;
// // 	}
// // 	else if (nWorkCmdVal == m_FTGRParam.m_nCmdVal)
// // 	{		
// // 		m_FTGRParam.P1 = vnReceivedData[2];
// // 		m_FTGRParam.P2 = vnReceivedData[3]/100.0;
// // 		m_FTGRParam.P3 = vnReceivedData[4]/100.0;
// // 
// // 		return eCmdSaveTargetPosFTGR;
// // 	}
// // 	else if (nWorkCmdVal == m_FTGGParam.m_nCmdVal)
// // 	{		
// // 		m_FTGGParam.P1 = vnReceivedData[2];
// // 
// // 		return eCmdGetTargetImagePosFTGG;
// // 	}
// // 	else if (nWorkCmdVal == m_FTGDParam.m_nCmdVal)
// // 	{
// // 		
// // 		m_FTGDParam.P1 = vnReceivedData[2];
// // 
// // 		return eCmdDisplayTargetFTGD;
// // 	}
// // 	else if (nWorkCmdVal == m_FGAPParam.m_nCmdVal)
// // 	{		
// // 		m_FGAPParam.m_nPType = m_FGAPParam.m_nPNum;
// // 		m_FGAPParam.P1 = vnReceivedData[2];
// // 		m_FGAPParam.P2 = vnReceivedData[3];
// // 
// // 		return eCmdGetImagePosFGAP;
// // 	}
// // 	else if (nWorkCmdVal == m_FCNTParam.m_nCmdVal)
// // 	{		
// // 		m_FCNTParam.m_nPType = m_FCNTParam.m_nPNum - 3;
// // 		m_FCNTParam.P1 = vnReceivedData[2];
// // 		m_FCNTParam.P2 = 0;
// // 		m_FCNTParam.P3 = 0;
// // 		m_FCNTParam.P4 = 0;		
// // 
// // 		return eCmdObjectSearchFCNT;
// // 	}
// // 	else if (nWorkCmdVal == m_FOBJParam.m_nCmdVal)
// // 	{		
// // 		m_FOBJParam.m_nPType = m_FOBJParam.m_nPNum - 3;
// // 		m_FOBJParam.P1 = vnReceivedData[2];
// // 		m_FOBJParam.P2 = 0;
// // 		m_FOBJParam.P3 = 0;
// // 		m_FOBJParam.P4 = 0;		
// // 
// // 		return eCmdObjectSearchFOBJ;
// // 	}
// // 	else if (nWorkCmdVal == m_FOBMParam.m_nCmdVal)
// // 	{		
// // 		m_FOBMParam.m_nPType = m_FOBMParam.m_nPNum - 3;
// // 		m_FOBMParam.P1 = vnReceivedData[2];
// // 		m_FOBMParam.P2 = 0;
// // 		m_FOBMParam.P3 = 0;
// // 		m_FOBMParam.P4 = 0;		
// // 
// // 		return eCmdObjectSearchFOBM;
// // 	}
// // 	else if (nWorkCmdVal == m_FOBCParam.m_nCmdVal)
// // 	{		
// // 		m_FOBCParam.m_nPType = m_FOBCParam.m_nPNum - 3;
// // 		m_FOBCParam.P1 = vnReceivedData[2];
// // 		m_FOBCParam.P2 = vnReceivedData[3];
// // 		m_FOBCParam.P3 = 0;
// // 		m_FOBCParam.P4 = 0;
// // 		m_FOBCParam.P5 = 0;
// // 
// // 		return eCmdObjectSearchFOBC;
// // 	}
// // 	else if (nWorkCmdVal == m_FOBGParam.m_nCmdVal)
// // 	{
// // 		m_FOBGParam.P1 = vnReceivedData[2];
// // 
// // 		return eCmdGetObjectImagePosFOBG;
// // 	}
// // 	else if (nWorkCmdVal == m_FMSCParam.m_nCmdVal)
// // 	{
// // 
// // 		m_FMSCParam.P1 = vnReceivedData[2];
// // 
// // 		return eCmdManualSearchFMSC;
// // 	}
// // 	else if (nWorkCmdVal == m_FWLDParam.m_nCmdVal)
// // 	{
// // 		m_FWLDParam.P1 = vnReceivedData[2];
// // 		m_FWLDParam.P2 = vnReceivedData[3];
// // 
// // 		return eCmdGetSearchWorldPosFWLD;
// // 	}
// // 	else if (nWorkCmdVal == m_FGALParam.m_nCmdVal)
// // 	{
// // 		m_FGALParam.P1 = vnReceivedData[2];
// // 
// // 		return eCmdGetAlignPrecisionFGAL;
// // 	}
// // 	else if (nWorkCmdVal == m_FALLParam.m_nCmdVal)
// // 	{
// // 		m_FALLParam.P1 = vnReceivedData[2];
// // 		m_FALLParam.P2 = vnReceivedData[2]*1.0/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
// // 		m_FALLParam.P3 = vnReceivedData[3]*1.0/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
// // 		m_FALLParam.P4 = vnReceivedData[4]*1.0/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
// // 
// // 		return eCmdSetAlignPrecisionFALL;
// // 	}
// // 	else if (nWorkCmdVal == m_FGACParam.m_nCmdVal)
// // 	{
// // 		return eCmdGetAlignTimeFGAC;
// // 	}
// // 	else if (nWorkCmdVal == m_FALCParam.m_nCmdVal)
// // 	{
// // 		m_FALCParam.P1 = vnReceivedData[2];
// // 
// // 		return eCmdSetAlignTimeFALC;
// // 	}
// // 	else if (nWorkCmdVal == m_FAALParam.m_nCmdVal)
// // 	{		
// // 		m_FAALParam.m_nPType = m_FAALParam.m_nPNum - 3;
// // 		m_FAALParam.P1 = vnReceivedData[2];
// // 		m_FAALParam.P2 = 0;
// // 		m_FAALParam.P3 = 0;
// // 		m_FAALParam.P4 = 0;
// // 
// // 		return eCmdAutoAlignFAAL;
// // 	}
// // 	else if (nWorkCmdVal == m_FXYAParam.m_nCmdVal)
// // 	{		
// // 		m_FXYAParam.m_nPType = m_FAALParam.m_nPNum - 3;
// // 		m_FXYAParam.P1 = vnReceivedData[2];
// // 		m_FXYAParam.P2 = vnReceivedData[3];
// // 		m_FXYAParam.P3 = 0;
// // 		m_FXYAParam.P4 = 0;
// // 		m_FXYAParam.P5 = 0;
// // 		return eCmdAutoAlignFXYA;
// // 	}
// // 	else if (nWorkCmdVal == m_FAABParam.m_nCmdVal)
// // 	{	
// // 		m_FAABParam.m_nPType = m_FAABParam.m_nPNum - 3;
// // 		m_FAABParam.P1 = vnReceivedData[2];
// // 		m_FAABParam.P2 = 0;
// // 		m_FAABParam.P3 = 0;
// // 		m_FAABParam.P4 = 0;	
// // 
// // 		return eCmdAutoAlignFAAB;
// // 	}
// // 	else if (nWorkCmdVal == m_FACBParam.m_nCmdVal)
// // 	{	
// // 		m_FACBParam.m_nPType = m_FACBParam.m_nPNum - 3;
// // 		m_FACBParam.P1 = vnReceivedData[2];
// // 		m_FACBParam.P2 = 0;
// // 		m_FACBParam.P3 = 0;
// // 		m_FACBParam.P4 = 0;	
// // 
// // 		return eCmdAutoAlignFACB;
// // 	}
// // 	else if (nWorkCmdVal == m_FAACParam.m_nCmdVal)
// // 	{		
// // 		m_FAACParam.m_nPType = m_FAACParam.m_nPNum - 3;
// // 		m_FAACParam.P1 = vnReceivedData[2];
// // 		m_FAACParam.P2 = vnReceivedData[3];
// // 		m_FAACParam.P3 = 0;
// // 		m_FAACParam.P4 = 0;
// // 		m_FAACParam.P5 = 0;		
// // 
// // 		return eCmdAutoAlignFAAC;
// // 	}
// // 	else if (nWorkCmdVal == m_FAHLParam.m_nCmdVal)
// // 	{		
// // 		m_FAHLParam.m_nPType = m_FAHLParam.m_nPNum - 3;
// // 		m_FAHLParam.P1 = vnReceivedData[2];
// // 		m_FAHLParam.P2 = 0;
// // 		m_FAHLParam.P3 = 0;
// // 		m_FAHLParam.P4 = 0;
// // 
// // 		return eCmdAutoAlignFAHL;
// // 	}
// // 	else if (nWorkCmdVal == m_FANSParam.m_nCmdVal)
// // 	{		
// // 		return eCmdGetAutoAlignOffsetFANS;
// // 	}
// // 	else if (nWorkCmdVal == m_FALGParam.m_nCmdVal)
// // 	{		
// // 		m_FALGParam.P1 = vnReceivedData[2];
// // 
// // 		return eCmdOnceAlignMoveFALG;
// // 	}
// // 	else if (nWorkCmdVal == m_FALPParam.m_nCmdVal)
// // 	{		
// // 		m_FALPParam.m_nPType = m_FALPParam.m_nPNum - 3;
// // 		m_FALPParam.P1 = vnReceivedData[2];
// // 		m_FALPParam.P2 = 0;
// // 		m_FALPParam.P3 = 0;
// // 		m_FALPParam.P4 = 0;
// // 
// // 		return eCmdOnceAlignMovePickFALP;
// // 	}
// // 	else if (nWorkCmdVal == m_FALJParam.m_nCmdVal)
// // 	{
// // 		m_FALJParam.P1 = vnReceivedData[2];
// // 		m_FALJParam.P2 = vnReceivedData[3];
// // 
// // 		return eCmdOnceAlignFALJ;
// // 	}
// // 	else if (nWorkCmdVal == m_FACOParam.m_nCmdVal)
// // 	{		
// // 		m_FACOParam.P1 = vnReceivedData[2];
// // 
// // 		return eCmdGetTargetObjectOffsetFACO;
// // 	}
// // 	else if (nWorkCmdVal == m_FABOParam.m_nCmdVal)
// // 	{
// // 		m_FABOParam.P1 = vnReceivedData[2];
// // 		
// // 		return eCmdGetTargetObjectOffsetFABO;
// // 	}
// // 	else if (nWorkCmdVal == m_FAOFParam.m_nCmdVal)
// // 	{		
// // 		m_FAOFParam.P1 = vnReceivedData[2];
// // 
// // 		return eCmdCalcuAlignOffsetFAOF;
// // 	}
// // 	else if (nWorkCmdVal == m_FGOFParam.m_nCmdVal)
// // 	{		
// // 		m_FGOFParam.P1 = vnReceivedData[2];
// // 
// // 		return eCmdGetAlignOffsetFGOF;
// // 	}
// // 	else if (nWorkCmdVal == m_FOFSParam.m_nCmdVal)
// // 	{		
// // 		m_FOFSParam.P1 = vnReceivedData[2]*1.0/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
// // 		m_FOFSParam.P2 = vnReceivedData[3]*1.0/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
// // 		m_FOFSParam.P3 = vnReceivedData[4]*1.0/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
// // 
// // 		return eCmdSetAlignOffsetFOFS;
// // 	}
// // 	else if (nWorkCmdVal == m_FSFTParam.m_nCmdVal)
// // 	{
// // 		m_FSFTParam.P1 = vnReceivedData[2];
// // 		return eCmdFSFT;
// // 	}
// // 	else if (nWorkCmdVal == m_FGSFParam.m_nCmdVal)
// // 	{
// // 		m_FGSFParam.P1 = vnReceivedData[2];
// // 
// // 		return eCmdFGSF;
// // 	}
// // 	else if (nWorkCmdVal == m_FALMParam.m_nCmdVal)
// // 	{
// // 		return eCmdGetAlarmFALM;
// // 	}
// // 	else if (nWorkCmdVal == m_FRSTParam.m_nCmdVal)
// // 	{
// // 		return eCmdResetFRST;
// // 	}
// // 	else if (nWorkCmdVal == m_FCHKParam.m_nCmdVal)
// // 	{
// // 		m_FCHKParam.P1 = vnReceivedData[2];
// // 		return eCmdSpecialCommFCHK;
// // 	}
// // 	else if (nWorkCmdVal == m_FSACParam.m_nCmdVal)
// // 	{
// // 		return eCmdSaveProcessDataFSAC;
// // 	}
// // 	else if (nWorkCmdVal == m_FSCOParam.m_nCmdVal)
// // 	{
// // 		return eCmdSaveCommDataFSCO;
// // 	}
// // 	else if (nWorkCmdVal == m_MNPSParam.m_nCmdVal)
// // 	{
// // 		m_MNPSParam.P1 = vnReceivedData[2];
// // 		return eCmdGetPosMNPS;
// // 	}
// // 	else if (nWorkCmdVal == m_MMVAParam.m_nCmdVal)
// // 	{
// // 		m_MMVAParam.P1 = vnReceivedData[2];
// // 		return eCmdMovePosMMVA;
// // 	}
// // 	else if (nWorkCmdVal == m_MMVRParam.m_nCmdVal)
// // 	{
// // 		m_MMVRParam.P1 = vnReceivedData[2];
// // 		return eCmdMoveRelPosMMVR;
// // 	}
// // 
// // 	return eCmdUnknow;
// }

SysWorkCmdType CCommProtocolXYDFast::AnalyzePlcSysWorkCmdReceived( CString strCmd, BOOL &bTriggered)
{
	SysWorkCmdType eCmdType = eCmdUnknow;
	if (m_pCommProRegBase == NULL)
	{
		bTriggered = FALSE;
		return eCmdType;
	}

	if (m_bRegType)			// 双字节
	{
		// 解析字符串
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLC_CMD_TRIGGER);		// 寄存器地址
		int  nDataNum = GetReadDataNum();												// 数据量
		std::vector<int> vnReceivedData;
		if (!m_pCommProRegBase->AnalyzeAswReadReg(strCmd, nDataNum, vnReceivedData))
		{
			bTriggered = FALSE;
			return eCmdType;
		}

		if (vnReceivedData.size() != nDataNum)
		{
			bTriggered = FALSE;
			return eCmdType;
		}

		if (vnReceivedData.at(0) == PLC_CMD_VAL_NOT_TRIGGERED)
		{
			bTriggered = FALSE;
			return eCmdType;
		}
		SetAnalyzeAswReadRegTransInfo(nDataNum,vnReceivedData,TRUE);
		double dBase = 10;
		bTriggered = TRUE;
		int nWorkCmdVal = vnReceivedData.at(1);

		//TT 解析轴位置(如果数据包含)
		AnalyzeAxisInfoInCmdParam(vnReceivedData);


		if (nWorkCmdVal == m_FSPCParam.m_nCmdVal)
		{		
			m_FSPCParam.P1 = vnReceivedData[2];
			m_FSPCParam.P2 = vnReceivedData[3];

			return eCmdSetProductIndexFSPC;
		}
		//lzk 0408
		else if (nWorkCmdVal == m_FVPCParam.m_nCmdVal)
		{		
			m_FVPCParam.P1 = vnReceivedData[2];
			m_FVPCParam.P2 = vnReceivedData[3];

			return eCmdFVPC;
		}
		else if (nWorkCmdVal == m_FCCIParam.m_nCmdVal)
		{		
			m_FCCIParam.P1 = vnReceivedData[2];
			m_FCCIParam.P2 = vnReceivedData[3];

			return eCmdCopyCalibrateInfoFCCI;
		}
		else if (nWorkCmdVal == m_FSSVParam.m_nCmdVal)
		{		
			m_FSSVParam.P1 = vnReceivedData[2];
			m_FSSVParam.P2 = vnReceivedData[3];

			return eCmdSaveProductIndexFSSV;
		}
		else if (nWorkCmdVal == m_FGSPParam.m_nCmdVal)
		{
			return eCmdGetProductIndexFGSP;
		}
		else if (nWorkCmdVal == m_FVASParam.m_nCmdVal)
		{		
			m_FVASParam.P1 = vnReceivedData[2];

			return eCmdSetProductVirtualAlnFVAS;
		}
		else if (nWorkCmdVal == m_FCLBParam.m_nCmdVal)
		{
			m_FCLBParam.m_nPType = m_FCLBParam.m_nPNum - 3;
			m_FCLBParam.P1 = vnReceivedData[2];
			m_FCLBParam.P2 = vnReceivedData[3];
			m_FCLBParam.P3 = 0;
			m_FCLBParam.P4 = 0;
			m_FCLBParam.P5 = 0;

			return eCmdCalibrateFCLB;
		}
		else if (nWorkCmdVal == m_FCPRParam.m_nCmdVal)
		{
			m_FCPRParam.m_nPType = m_FCPRParam.m_nPNum;
			m_FCPRParam.P1 = vnReceivedData[2];
			m_FCPRParam.P2 = vnReceivedData[3];
			m_FCPRParam.P3 = 0;
			m_FCPRParam.P4 = 0;
			return eCmdCalibrateFCPR;
		}
		else if (nWorkCmdVal == m_FCBPParam.m_nCmdVal)
		{
			m_FCBPParam.m_nPType = m_FCBPParam.m_nPNum;
			m_FCBPParam.P1 = vnReceivedData[2];
			m_FCBPParam.P2 = vnReceivedData[3];
			m_FCBPParam.P3 = vnReceivedData[4];
			m_FCBPParam.nP4 = vnReceivedData[5];
			m_FCBPParam.P4 = 0;
			m_FCBPParam.P5 = 0;
			m_FCBPParam.P6 = 0;
			return eCmdCalibrateFCBP;
		}
		else if (nWorkCmdVal == m_FCBSParam.m_nCmdVal)
		{
			m_FCBSParam.m_nPType = m_FCBSParam.m_nPNum - 3;
			m_FCBSParam.P1 = vnReceivedData[2];
			m_FCBSParam.P2 = vnReceivedData[3];
			m_FCBSParam.P3 = 0;
			m_FCBSParam.P4 = 0;
			m_FCBSParam.P5 = 0;

			return eCmdCalibrateFCBS;
		}
		else if (nWorkCmdVal == m_FCBRParam.m_nCmdVal)
		{
			m_FCBRParam.m_nPType = m_FCBRParam.m_nPNum-4;
			m_FCBRParam.P1 = 0;
			m_FCBRParam.P2 = 0;
			m_FCBRParam.P3 = 0;
			m_FCBRParam.P4 = 0;

			return eCmdCalibrateFCBR;
		}
		else if (nWorkCmdVal == m_FTGTParam.m_nCmdVal)
		{

			m_FTGTParam.m_nPType = m_FTGTParam.m_nPNum;
			m_FTGTParam.P1 = vnReceivedData[2];
			m_FTGTParam.nP2 = vnReceivedData[3];
			m_FTGTParam.nP3 = vnReceivedData[4];
			m_FTGTParam.nP4 = vnReceivedData[5];


			return eCmdTargetSearchFTGT;
		}
		else if (nWorkCmdVal == m_FTGMParam.m_nCmdVal)
		{
			if (m_bEnableCommMutiTarget)
			{
				m_FTGMParam.m_nPType = m_FTGMParam.m_nPNum - 2;
				m_FTGMParam.P1 = vnReceivedData[2];
				m_FTGMParam.P2 = vnReceivedData[3];
				m_FTGMParam.P3 = 0;
				m_FTGMParam.P4 = 0;
			}
			else
			{
				m_FTGMParam.m_nPType = m_FTGMParam.m_nPNum - 3;
				m_FTGMParam.P1 = vnReceivedData[2];
				m_FTGMParam.P2 = 0;
				m_FTGMParam.P3 = 0;
				m_FTGMParam.P4 = 0;
			}

			return eCmdTargetSearchFTGM;
		}
		else if (nWorkCmdVal == m_FTGSParam.m_nCmdVal)
		{
			if (m_bEnableCommMutiTarget)
			{
				m_FTGSParam.P1 = vnReceivedData[2];
				m_FTGSParam.P2 = vnReceivedData[3];
			}
			else
			{
				m_FTGSParam.P1 = vnReceivedData[2];
			}


			return eCmdTargetSearchFTGS;
		}
		else if (nWorkCmdVal == m_FTGCParam.m_nCmdVal)
		{

			m_FTGCParam.m_nPType = m_FTGCParam.m_nPNum;
			m_FTGCParam.P1 = vnReceivedData[2];
			m_FTGCParam.P2 = vnReceivedData[3];
			m_FTGCParam.nP3 = vnReceivedData[4];
			m_FTGCParam.nP4 = vnReceivedData[5];
			m_FTGCParam.nP5 = vnReceivedData[6];

			return eCmdTargetSearchFTGC;
		}
		else if (nWorkCmdVal == m_FTGRParam.m_nCmdVal)
		{		
			m_FTGRParam.P1 = vnReceivedData[2];
			m_FTGRParam.P2 = vnReceivedData[3]/100.0;
			m_FTGRParam.P3 = vnReceivedData[4]/100.0;

			return eCmdSaveTargetPosFTGR;
		}
		else if (nWorkCmdVal == m_FTGGParam.m_nCmdVal)
		{		
			m_FTGGParam.P1 = vnReceivedData[2];

			return eCmdGetTargetImagePosFTGG;
		}
		else if (nWorkCmdVal == m_FTGDParam.m_nCmdVal)
		{

			m_FTGDParam.P1 = vnReceivedData[2];

			return eCmdDisplayTargetFTGD;
		}
		else if (nWorkCmdVal == m_FGAPParam.m_nCmdVal)
		{	
			m_FGAPParam.m_nPType = m_FGAPParam.m_nPNum - 3;
			m_FGAPParam.P1 = vnReceivedData[2];
			m_FGAPParam.P2 = vnReceivedData[3];

			return eCmdGetImagePosFGAP;
		}
		else if (nWorkCmdVal == m_FCNTParam.m_nCmdVal)
		{		
			m_FCNTParam.m_nPType = m_FCNTParam.m_nPNum - 3;
			m_FCNTParam.P1 = vnReceivedData[2];
			m_FCNTParam.P2 = 0;
			m_FCNTParam.P3 = 0;
			m_FCNTParam.P4 = 0;		

			return eCmdObjectSearchFCNT;
		}
		else if (nWorkCmdVal == m_FCNOParam.m_nCmdVal)
		{		
			m_FCNOParam.m_nPType = m_FCNOParam.m_nPNum - 3;
			m_FCNOParam.P1 = vnReceivedData[2];
			m_FCNOParam.P2 = 0;
			m_FCNOParam.P3 = 0;
			m_FCNOParam.P4 = 0;		

			return eCmdTargetSearchFCNO;
		}
		else if (nWorkCmdVal == m_FOBJParam.m_nCmdVal)
		{		
			m_FOBJParam.m_nPType = m_FOBJParam.m_nPNum - 1;
			m_FOBJParam.P1 = vnReceivedData[2];
			m_FOBJParam.P2 = 0;
			m_FOBJParam.P3 = 0;
			m_FOBJParam.P4 = 0;	

			m_FOBJParam.nP2 = vnReceivedData[3];
			m_FOBJParam.nP3 = vnReceivedData[4];
			m_FOBJParam.nP4 = vnReceivedData[5];

			return eCmdObjectSearchFOBJ;
		}
		else if (nWorkCmdVal == m_FOBMParam.m_nCmdVal)
		{		
			m_FOBMParam.m_nPType = m_FOBMParam.m_nPNum - 3;
			m_FOBMParam.P1 = vnReceivedData[2];
			m_FOBMParam.P2 = 0;
			m_FOBMParam.P3 = 0;
			m_FOBMParam.P4 = 0;		

			return eCmdObjectSearchFOBM;
		}
		else if (nWorkCmdVal == m_FOBCParam.m_nCmdVal)
		{	

			m_FOBCParam.m_nPType = m_FOBCParam.m_nPNum - 1;
			m_FOBCParam.P1 = vnReceivedData[2];
			m_FOBCParam.P2 = vnReceivedData[3];
			m_FOBCParam.P3 = 0;
			m_FOBCParam.P4 = 0;
			m_FOBCParam.P5 = 0;
			m_FOBCParam.nP3 = vnReceivedData[4];
			m_FOBCParam.nP4 = vnReceivedData[5];
			m_FOBCParam.nP5 = vnReceivedData[6];




			return eCmdObjectSearchFOBC;
		}
		else if (nWorkCmdVal == m_FPMIParam.m_nCmdVal)
		{	
			m_FPMIParam.P1 = vnReceivedData[2];
			return eCmdObjectSearchFPMI;
		}
		else if (nWorkCmdVal == m_FBISParam.m_nCmdVal)
		{	
			m_FBISParam.P1 = vnReceivedData[2];
			m_FBISParam.P2 = vnReceivedData[3];
			m_FBISParam.P3 = 0;
			m_FBISParam.P4 = 0;
			return eCmdACFInspectFBIS;
		}
		else if (nWorkCmdVal == m_FOBGParam.m_nCmdVal)
		{
			m_FOBGParam.P1 = vnReceivedData[2];

			return eCmdGetObjectImagePosFOBG;
		}
		else if (nWorkCmdVal == m_FMSCParam.m_nCmdVal)
		{

			m_FMSCParam.P1 = vnReceivedData[2];

			return eCmdManualSearchFMSC;
		}
		else if (nWorkCmdVal == m_FWLDParam.m_nCmdVal)
		{
			m_FWLDParam.P1 = vnReceivedData[2];
			m_FWLDParam.P2 = vnReceivedData[3];

			return eCmdGetSearchWorldPosFWLD;
		}
		else if (nWorkCmdVal == m_FWDRParam.m_nCmdVal)
		{
			m_FWDRParam.P1 = vnReceivedData[2];
			m_FWDRParam.P2 = vnReceivedData[3];

			return eCmdFWDR;
		}
		else if (nWorkCmdVal == m_FGOWParam.m_nCmdVal)
		{		
			m_FGOWParam.m_nPType = m_FGOWParam.m_nPNum - 3;
			m_FGOWParam.P1 = vnReceivedData[2];
			m_FGOWParam.P2 = vnReceivedData[3];
			m_FGOWParam.P3 = 0;
			m_FGOWParam.P4 = 0;
			m_FGOWParam.P5 = 0;

			return eCmdGetObjectWorldPosFGOW;
		}
		else if (nWorkCmdVal == m_FGALParam.m_nCmdVal)
		{
			m_FGALParam.P1 = vnReceivedData[2];

			return eCmdGetAlignPrecisionFGAL;
		}
		else if (nWorkCmdVal == m_FALLParam.m_nCmdVal)
		{
			m_FALLParam.m_nPType = m_FALLParam.m_nPNum - 3;
			m_FALLParam.P1 = vnReceivedData[2];
			m_FALLParam.P2 = 0;
			m_FALLParam.P3 = 0;
			m_FALLParam.P4 = 0;

			return eCmdSetAlignPrecisionFALL;
		}
		else if (nWorkCmdVal == m_FGACParam.m_nCmdVal)
		{
			return eCmdGetAlignTimeFGAC;
		}
		else if (nWorkCmdVal == m_FALCParam.m_nCmdVal)
		{
			m_FALCParam.P1 = vnReceivedData[2];

			return eCmdSetAlignTimeFALC;
		}
		else if (nWorkCmdVal == m_FAALParam.m_nCmdVal)
		{	

			m_FAALParam.m_nPType = m_FAALParam.m_nPNum;
			m_FAALParam.P1 = vnReceivedData[2];
			m_FAALParam.P2 = 0;
			m_FAALParam.P3 = 0;
			m_FAALParam.P4 = 0;
			m_FAALParam.nP2 = vnReceivedData[3];
			m_FAALParam.nP3 = vnReceivedData[4];
			m_FAALParam.nP4 = vnReceivedData[5];


			return eCmdAutoAlignFAAL;
		}
		else if (nWorkCmdVal == m_FXYAParam.m_nCmdVal)
		{
			if (m_bEnableCommMutiTarget)
			{
				m_FXYAParam.m_nPType = m_FAALParam.m_nPNum - 2;
				m_FXYAParam.P1 = vnReceivedData[2];
				m_FXYAParam.P2 = vnReceivedData[3];
				m_FXYAParam.P3 = vnReceivedData[4];
				m_FXYAParam.P4 = 0;
				m_FXYAParam.P5 = 0;
			}
			else
			{
				m_FXYAParam.m_nPType = m_FAALParam.m_nPNum - 3;
				m_FXYAParam.P1 = vnReceivedData[2];
				m_FXYAParam.P2 = vnReceivedData[3];
				m_FXYAParam.P3 = 0;
				m_FXYAParam.P4 = 0;
				m_FXYAParam.P5 = 0;
			}

			return eCmdAutoAlignFXYA;
		}
		else if (nWorkCmdVal == m_FAABParam.m_nCmdVal)
		{	
			if (m_bEnableCommMutiTarget)
			{
				m_FAABParam.m_nPType = m_FAABParam.m_nPNum - 2;
				m_FAABParam.P1 = vnReceivedData[2];
				m_FAABParam.P2 = vnReceivedData[3];
				m_FAABParam.P3 = 0;
				m_FAABParam.P4 = 0;	
			}
			else
			{
				m_FAABParam.m_nPType = m_FAABParam.m_nPNum - 3;
				m_FAABParam.P1 = vnReceivedData[2];
				m_FAABParam.P2 = 0;
				m_FAABParam.P3 = 0;
				m_FAABParam.P4 = 0;	
			}


			return eCmdAutoAlignFAAB;
		}
		else if(nWorkCmdVal == m_FAAOParam.m_nCmdVal)
		{
			m_FAAOParam.m_nPType = m_FAAOParam.m_nPNum - 3;
			m_FAAOParam.P1 = vnReceivedData[2];
			m_FAAOParam.P2 = 0;
			m_FAAOParam.P3 = 0;
			m_FAAOParam.P4 = 0;

			return eCmdGetObjectTargetOffsetFAAO;
		}
		else if (nWorkCmdVal == m_FACBParam.m_nCmdVal)
		{	
			m_FACBParam.m_nPType = m_FACBParam.m_nPNum - 3;
			m_FACBParam.P1 = vnReceivedData[2];
			m_FACBParam.P2 = 0;
			m_FACBParam.P3 = 0;
			m_FACBParam.P4 = 0;	

			return eCmdAutoAlignFACB;
		}
		else if (nWorkCmdVal == m_FAACParam.m_nCmdVal)
		{	

			// 没有轴位置参数
			m_FAACParam.m_nPType = m_FAACParam.m_nPNum - 3;
			m_FAACParam.P1 = vnReceivedData[2];
			m_FAACParam.P2 = vnReceivedData[3];

			m_FAACParam.nP3 = vnReceivedData[4];
			m_FAACParam.nP4 = vnReceivedData[5];

			m_FAACParam.P3 = 0;
			m_FAACParam.P4 = 0;
			m_FAACParam.P5 = 0;



			return eCmdAutoAlignFAAC;
		}
		else if (nWorkCmdVal == m_FAOTParam.m_nCmdVal)
		{			
			m_FAOTParam.m_nPType = m_FAOTParam.m_nPNum - 3;
			m_FAOTParam.P1 = vnReceivedData[2];
			m_FAOTParam.P2 = vnReceivedData[3];
			m_FAOTParam.P3 = 0;
			m_FAOTParam.P4 = 0;
			m_FAOTParam.P5 = 0;	

			return eCmdAutoAlignFAOT;
		}
		else if (nWorkCmdVal == m_FALXParam.m_nCmdVal)
		{			
			m_FALXParam.m_nPType = m_FALXParam.m_nPNum - 3;
			m_FALXParam.P1 = vnReceivedData[2];
			m_FALXParam.P2 = vnReceivedData[3];
			m_FALXParam.P3 = 0;
			m_FALXParam.P4 = 0;
			m_FALXParam.P5 = 0;

			return eCmdAutoAlignFALX;
		}
		else if (nWorkCmdVal == m_FAHLParam.m_nCmdVal)
		{		
			m_FAHLParam.m_nPType = m_FAHLParam.m_nPNum - 3;
			m_FAHLParam.P1 = vnReceivedData[2];
			m_FAHLParam.P2 = 0;
			m_FAHLParam.P3 = 0;
			m_FAHLParam.P4 = 0;

			return eCmdAutoAlignFAHL;
		}
		else if (nWorkCmdVal == m_FANSParam.m_nCmdVal)
		{		
			return eCmdGetAutoAlignOffsetFANS;
		}
		else if (nWorkCmdVal == m_FALGParam.m_nCmdVal)
		{		
			//m_FALGParam.P1 = vnReceivedData[2];

			m_FALGParam.P1 = vnReceivedData[2];
			m_FALGParam.nP2 = vnReceivedData[3];
			m_FALGParam.nP3 = vnReceivedData[4];
			m_FALGParam.nP4 = vnReceivedData[5];

			return eCmdOnceAlignMoveFALG;
		}
		else if (nWorkCmdVal == m_FALPParam.m_nCmdVal)
		{		
			m_FALPParam.m_nPType = m_FALPParam.m_nPNum - 2;
			m_FALPParam.P1 = vnReceivedData[2];
			m_FALPParam.nP2 = vnReceivedData[3];
			m_FALPParam.P2 = 0;
			m_FALPParam.P3 = 0;
			m_FALPParam.P4 = 0;

			return eCmdOnceAlignMovePickFALP;
		}
		else if (nWorkCmdVal == m_FALJParam.m_nCmdVal)
		{
			m_FALJParam.P1 = vnReceivedData[2];
			m_FALJParam.P2 = vnReceivedData[3];

			return eCmdOnceAlignFALJ;
		}
		else if (nWorkCmdVal == m_FACOParam.m_nCmdVal)
		{		
			//m_FACOParam.P1 = vnReceivedData[2];


			m_FACOParam.P1 = vnReceivedData[2];
			m_FACOParam.nP2 = vnReceivedData[3];
			m_FACOParam.nP3 = vnReceivedData[4];


			return eCmdGetTargetObjectOffsetFACO;
		}
		else if (nWorkCmdVal == m_FOLCParam.m_nCmdVal)
		{		
			m_FOLCParam.m_nPType = m_FOLCParam.m_nPNum - 3;
			m_FOLCParam.P1 = vnReceivedData[2];
			m_FOLCParam.P2 = 0;
			m_FOLCParam.P3 = 0;
			m_FOLCParam.P4 = 0;

			return eCmdGetTargetObjectOffsetFOLC;
		}
		else if (nWorkCmdVal == m_FABOParam.m_nCmdVal)
		{
			m_FABOParam.P1 = vnReceivedData[2];

			return eCmdGetTargetObjectOffsetFABO;
		}
		else if (nWorkCmdVal == m_FAOFParam.m_nCmdVal)
		{		
			m_FAOFParam.P1 = vnReceivedData[2];

			return eCmdCalcuAlignOffsetFAOF;
		}
		else if (nWorkCmdVal == m_FGOFParam.m_nCmdVal)
		{		
			m_FGOFParam.P1 = vnReceivedData[2];

			return eCmdGetAlignOffsetFGOF;
		}
		else if (nWorkCmdVal == m_FOFSParam.m_nCmdVal)
		{	
			m_FOFSParam.m_nPType = m_FOFSParam.m_nPNum - 3;
			m_FOFSParam.P1 = vnReceivedData[2];
			m_FOFSParam.P2 = 0;
			m_FOFSParam.P3 = 0;
			m_FOFSParam.P4 = 0;

			return eCmdSetAlignOffsetFOFS;
		}
		else if (nWorkCmdVal == m_FSFTParam.m_nCmdVal)
		{
			m_FSFTParam.P1 = vnReceivedData[2];
			return eCmdFSFT;
		}
		else if (nWorkCmdVal == m_FGSFParam.m_nCmdVal)
		{
			m_FGSFParam.P1 = vnReceivedData[2];

			return eCmdFGSF;
		}
		else if (nWorkCmdVal == m_FGPOParam.m_nCmdVal)
		{
			return eCmdFGPO;
		}
		else if (nWorkCmdVal == m_FALMParam.m_nCmdVal)
		{
			return eCmdGetAlarmFALM;
		}
		else if (nWorkCmdVal == m_FRSTParam.m_nCmdVal)
		{
			return eCmdResetFRST;
		}
		else if (nWorkCmdVal == m_FCHKParam.m_nCmdVal)
		{
			m_FCHKParam.P1 = vnReceivedData[2];
			return eCmdSpecialCommFCHK;
		}
		else if (nWorkCmdVal == m_FSACParam.m_nCmdVal)
		{
			return eCmdSaveProcessDataFSAC;
		}
		else if (nWorkCmdVal == m_FSCOParam.m_nCmdVal)
		{
			return eCmdSaveCommDataFSCO;
		}
		else if (nWorkCmdVal == m_MNPSParam.m_nCmdVal)
		{
			m_MNPSParam.P1 = vnReceivedData[2];
			return eCmdGetPosMNPS;
		}
		else if (nWorkCmdVal == m_MMVAParam.m_nCmdVal)
		{
			m_MMVAParam.P1 = vnReceivedData[2];
			return eCmdMovePosMMVA;
		}
		else if (nWorkCmdVal == m_MMVRParam.m_nCmdVal)
		{
			m_MMVRParam.P1 = vnReceivedData[2];
			return eCmdMoveRelPosMMVR;
		}
		else if (nWorkCmdVal == m_FCHBParam.m_nCmdVal)
		{		
			m_FCHBParam.m_nPType = m_FCHBParam.m_nPNum;
			m_FCHBParam.P1 = vnReceivedData[2];
			m_FCHBParam.P2 = vnReceivedData[3];

			return eCmdACFInspectFCHB;
		}
		else if (nWorkCmdVal == m_FCHCParam.m_nCmdVal)
		{		
			m_FCHCParam.m_nPType = m_FCHCParam.m_nPNum;
			m_FCHCParam.P1 = vnReceivedData[2];
			m_FCHCParam.P2 = vnReceivedData[3];
			m_FCHCParam.P3 = vnReceivedData[4];
			return eCmdACFInspectFCHC;
		}
		else if (nWorkCmdVal == m_FDRPParam.m_nCmdVal)
		{		
			m_FDRPParam.m_nPType = m_FDRPParam.m_nPNum;
			m_FDRPParam.P1 = vnReceivedData[2];
			m_FDRPParam.P2 = vnReceivedData[3];

			return eCmdFDRP;
		}
		else if (nWorkCmdVal == m_FSPEParam.m_nCmdVal)
		{
			m_FSPEParam.m_nPType = m_FSPEParam.m_nPNum;
			m_FSPEParam.P1 = vnReceivedData[2];
			m_FSPEParam.P2 = vnReceivedData[3];
			m_FSPEParam.P3 = vnReceivedData[4];

			return eCmdSetProductExposureFSPE;
		}
		else if (nWorkCmdVal == m_FWELParam.m_nCmdVal)
		{		
			m_FWELParam.m_nPType = m_FWELParam.m_nPNum - 3;
			m_FWELParam.P1 = vnReceivedData[2];
			m_FWELParam.P2 = vnReceivedData[3];
			m_FWELParam.P3 = 0;
			m_FWELParam.P4 = 0;
			m_FWELParam.P5 = 0;		

			return eCmdAutoAlignFWEL;
		}
		else if (nWorkCmdVal == m_FPCBParam.m_nCmdVal)
		{
			m_FPCBParam.m_nPType = m_FPCBParam.m_nPNum;
			m_FPCBParam.P1 = vnReceivedData[2];
			//			m_FPCBParam.P2 = vnReceivedData[3];

			return eCmdObjTarSearchFPCB;
		}
		else if (nWorkCmdVal == m_FPISParam.m_nCmdVal)
		{
			m_FPISParam.m_nPType = m_FPISParam.m_nPNum;
			m_FPISParam.P1 = vnReceivedData[2];

			return eCmdPCBPrecisionFPIS;
		}
		else if (nWorkCmdVal == m_FCPIParam.m_nCmdVal)
		{
			m_FCPIParam.m_nPType = m_FCPIParam.m_nPNum;
			m_FCPIParam.P1 = vnReceivedData[2];

			return eCmdChangePlatformIndex;
		}
		else if(nWorkCmdVal == m_FQRCParam.m_nCmdVal)
		{
			return eCmdSaveQRCode;
		}
		else if (nWorkCmdVal == m_FQRIParam.m_nCmdVal)// 检测二维码
		{
			m_FQRIParam.m_nPType = m_FQRIParam.m_nPNum;
			m_FQRIParam.P1 = vnReceivedData[2];
			m_FQRIParam.P2 = vnReceivedData[3];

			return eCmdInspectQRCode;
		}
		else if (nWorkCmdVal == m_FINSParam.m_nCmdVal)// 检测产品有、无
		{
			m_FINSParam.m_nPType = m_FINSParam.m_nPNum;
			m_FINSParam.P1 = vnReceivedData[2];
			m_FINSParam.P2 = vnReceivedData[3];

			return eCmdInspectFINS;
		}
		else if (nWorkCmdVal == m_FGTWParam.m_nCmdVal)
		{
			m_FGTWParam.m_nPType = m_FGTWParam.m_nPNum+3;
			m_FGTWParam.P1 = vnReceivedData[2];
			m_FGTWParam.P2 = vnReceivedData[3];
			m_FGTWParam.nP3 = vnReceivedData[4];
			m_FGTWParam.nP4 = vnReceivedData[5];
			m_FGTWParam.nP5 = vnReceivedData[6];

			return eCmdGetTargetPlatformPosFGTW;
		}
		else if (nWorkCmdVal == m_FGTPParam.m_nCmdVal)
		{
			m_FGTPParam.m_nPType = m_FGTPParam.m_nPNum+3;
			m_FGTPParam.P1 = vnReceivedData[2];
			m_FGTPParam.P2 = vnReceivedData[3];
			m_FGTPParam.nP3 = vnReceivedData[4];
			m_FGTPParam.nP4 = vnReceivedData[5];
			m_FGTPParam.nP5 = vnReceivedData[6];

			return eCmdGetTargetImagePosFGTP;
		}
		else if (nWorkCmdVal == m_FAFOParam.m_nCmdVal)
		{
			m_FAFOParam.m_nPType = m_FAFOParam.m_nPNum;
			m_FAFOParam.P1 = vnReceivedData[2];
			m_FAFOParam.P2 = vnReceivedData[3];
			m_FAFOParam.P3 = vnReceivedData[4];
			m_FAFOParam.nP4 = vnReceivedData[5];

			return eCmdFAFO;
		}
		else if (nWorkCmdVal == m_FMCOParam.m_nCmdVal)
		{
			m_FMCOParam.m_nPType = m_FMCOParam.m_nPNum;
			m_FMCOParam.P1 = vnReceivedData[2];

			return eCmdGetTargetObjectOffsetFMCO;
		}
		else if (nWorkCmdVal == m_FPEPParam.m_nCmdVal)
		{
			m_FPEPParam.m_nPType = m_FPEPParam.m_nPNum;
			m_FPEPParam.P1 = vnReceivedData[2];
			m_FPEPParam.P2 = vnReceivedData[3];

			return eCmdProductEmptyPEP;
		}
		else if (nWorkCmdVal == m_FPCPParam.m_nCmdVal)
		{
			m_FPCPParam.m_nPType = m_FPCPParam.m_nPNum;
			m_FPCPParam.P1 = vnReceivedData[2];
			m_FPCPParam.P2 = vnReceivedData[3];
			m_FPCPParam.P3 = vnReceivedData[4];
			m_FPCPParam.P4 = vnReceivedData[5];

			return eCmdProductCopyFPCP;
		}
		else if (nWorkCmdVal == m_FPRNParam.m_nCmdVal)
		{
			m_FPRNParam.m_nPType = m_FPRNParam.m_nPNum;
			m_FPRNParam.P1 = vnReceivedData[2];
			m_FPRNParam.P2 = vnReceivedData[3];
			m_FPRNParam.P3 = vnReceivedData[4];

			return eCmdProductRenameFPRN;
		}
		else
		{
			return eCmdUnknow;
		}
		return eCmdUnknow;
	}
	else		// 单字节
	{
		// 解析字符串
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLC_CMD_TRIGGER_WORD);		// 寄存器地址
		int  nDataNum = GetReadDataNum();												// 数据量
		std::vector<int> vnReceivedData;

		if (!m_pCommProRegBase->AnalyzeAswReadReg(strCmd, nDataNum, vnReceivedData,FALSE))
		{
			bTriggered = FALSE;
			return eCmdType;
		}

		if (vnReceivedData.size() != nDataNum)
		{
			bTriggered = FALSE;
			return eCmdType;
		}

		if (vnReceivedData.at(0) == PLC_CMD_VAL_NOT_TRIGGERED)
		{
			bTriggered = FALSE;
			return eCmdType;
		}
		SetAnalyzeAswReadRegTransInfo(nDataNum,vnReceivedData,FALSE);
		double dBase = 10;
		bTriggered = TRUE;
		int nWorkCmdVal = vnReceivedData.at(1);


		//TT 解析轴位置(如果数据包含)
		AnalyzeAxisInfoInCmdParam(vnReceivedData);



		// FAST 读写寄存器
		if (nWorkCmdVal == m_FRSTParam.m_nVCmdValue)		// 	1	FRST
		{
			return eCmdResetFRST;
		}
		else if (nWorkCmdVal == m_FCCIParam.m_nVCmdValue)		// 	FCCI
		{
			m_FCCIParam.P1 = vnReceivedData[2];
			m_FCCIParam.P2 = vnReceivedData[3];

			return eCmdCopyCalibrateInfoFCCI;
		}
		else if (nWorkCmdVal == m_FHMSParam.m_nVCmdValue)		// 	2	FHMS
		{
			return eCmdUnknow;
		}
		else if (nWorkCmdVal == m_FHOMParam.m_nVCmdValue)		// 	3	FHOM
		{
			return eCmdUnknow;
		}
		else if (nWorkCmdVal == m_FSPCParam.m_nVCmdValue)		// 	4	FSPC
		{
			m_FSPCParam.P1 = vnReceivedData[2];
			m_FSPCParam.P2 = vnReceivedData[3];

			return eCmdSetProductIndexFSPC;
		}
		//lzk 0408
		else if (nWorkCmdVal == m_FVPCParam.m_nVCmdValue)		// 	4	FSPC
		{
			m_FVPCParam.P1 = vnReceivedData[2];
			m_FVPCParam.P2 = vnReceivedData[3];

			return eCmdFVPC	;
		}

		else if (nWorkCmdVal == m_FVASParam.m_nVCmdValue)
		{		
			m_FVASParam.P1 = vnReceivedData[2];

			return eCmdSetProductVirtualAlnFVAS;
		}
		else if (nWorkCmdVal == m_FCLBParam.m_nVCmdValue)		// 	5	FCLB
		{
			m_FCLBParam.m_nPType = m_FCLBParam.m_nPNum - 3;
			m_FCLBParam.P1 = vnReceivedData[2];
			m_FCLBParam.P2 = vnReceivedData[3];
			m_FCLBParam.P3 = 0;
			m_FCLBParam.P4 = 0;
			m_FCLBParam.P5 = 0;

			return eCmdCalibrateFCLB;
		}
		else if (nWorkCmdVal == m_FCPRParam.m_nVCmdValue)
		{
			m_FCPRParam.m_nPType = m_FCPRParam.m_nPNum;
			m_FCPRParam.P1 = vnReceivedData[2];
			m_FCPRParam.P2 = vnReceivedData[3];
			m_FCPRParam.P3 = 0;
			m_FCPRParam.P4 = 0;

			return eCmdCalibrateFCPR;
		}
		else if (nWorkCmdVal == m_FCBPParam.m_nVCmdValue)
		{
			m_FCBPParam.m_nPType = m_FCBPParam.m_nPNum;
			m_FCBPParam.P1 = vnReceivedData[2];
			m_FCBPParam.P2 = vnReceivedData[3];
			m_FCBPParam.P3 = vnReceivedData[4];
			m_FCBPParam.P4 = 0;
			m_FCBPParam.P5 = 0;
			m_FCBPParam.P6 = 0;

			return eCmdCalibrateFCBP;
		}
		else if (nWorkCmdVal == m_FTGTParam.m_nVCmdValue)		// 	6	FTGT
		{

			m_FTGTParam.m_nPType = m_FTGTParam.m_nPNum;
			m_FTGTParam.P1 = vnReceivedData[2];
			m_FTGTParam.nP2 = vnReceivedData[3];
			m_FTGTParam.nP3 = vnReceivedData[4];
			m_FTGTParam.nP4 = vnReceivedData[5];




			return eCmdTargetSearchFTGT;
		}
		else if (nWorkCmdVal == m_FOBJParam.m_nVCmdValue)		// 	7	FOBJ
		{
			/*if (TRUE == GetEnableCommMultiCalibExtension())
			{
			m_FOBJParam.m_nPType = m_FOBJParam.m_nPNum - 1;
			m_FOBJParam.P1 = vnReceivedData[2];
			m_FOBJParam.P2 = 0;
			m_FOBJParam.P3 = 0;
			m_FOBJParam.P4 = 0;	

			m_FOBJParam.nP2 = vnReceivedData[3];
			m_FOBJParam.nP3 = vnReceivedData[4];

			}
			else
			{
			m_FOBJParam.m_nPType = m_FOBJParam.m_nPNum - 3;
			m_FOBJParam.P1 = vnReceivedData[2];
			m_FOBJParam.P2 = 0;
			m_FOBJParam.P3 = 0;
			m_FOBJParam.P4 = 0;	
			}*/
			m_FOBJParam.m_nPType = m_FOBJParam.m_nPNum - 1;
			m_FOBJParam.P1 = vnReceivedData[2];
			m_FOBJParam.P2 = 0;
			m_FOBJParam.P3 = 0;
			m_FOBJParam.P4 = 0;	

			m_FOBJParam.nP2 = vnReceivedData[3];
			m_FOBJParam.nP3 = vnReceivedData[4];
			m_FOBJParam.nP4 = vnReceivedData[5];

			return eCmdObjectSearchFOBJ;
		}
		else if (nWorkCmdVal == m_FAALParam.m_nVCmdValue)		// 	8	FAAL
		{

			m_FAALParam.m_nPType = m_FAALParam.m_nPNum;
			m_FAALParam.P1 = vnReceivedData[2];
			m_FAALParam.P2 = 0;
			m_FAALParam.P3 = 0;
			m_FAALParam.P4 = 0;
			m_FAALParam.nP2 = vnReceivedData[3];
			m_FAALParam.nP3 = vnReceivedData[4];
			m_FAALParam.nP4 = vnReceivedData[5];

			return eCmdAutoAlignFAAL;
		}
		else if (nWorkCmdVal == m_MNPSParam.m_nVCmdValue)		// 	9	FNPS
		{
			m_MNPSParam.P1 = vnReceivedData[2];
			return eCmdGetPosMNPS;
		}
		else if (nWorkCmdVal == m_MMVAParam.m_nVCmdValue)		// 	10	FMVA
		{
			m_MMVAParam.P1 = vnReceivedData[2];
			return eCmdMovePosMMVA;
		}
		else if (nWorkCmdVal == m_MMVRParam.m_nVCmdValue)		// 		11	FMVR
		{
			m_MMVRParam.P1 = vnReceivedData[2];
			return eCmdMoveRelPosMMVR;
		}
		else if (nWorkCmdVal == m_FPNTParam.m_nVCmdValue)		// 		12	FPNT
		{
		}
		else if (nWorkCmdVal == m_FACOParam.m_nVCmdValue)		// 		13	FACO
		{
			//m_FACOParam.P1 = vnReceivedData[2];

			m_FACOParam.P1 = vnReceivedData[2];
			m_FACOParam.nP2 = vnReceivedData[3];
			m_FACOParam.nP3 = vnReceivedData[4];

			return eCmdGetTargetObjectOffsetFACO;
		}
		else if (nWorkCmdVal == m_FOLCParam.m_nVCmdValue)		// 		13	FOLC
		{
			m_FOLCParam.m_nPType = m_FOLCParam.m_nPNum - 3;
			m_FOLCParam.P1 = vnReceivedData[2];
			m_FOLCParam.P2 = 0;
			m_FOLCParam.P3 = 0;
			m_FOLCParam.P4 = 0;

			return eCmdGetTargetObjectOffsetFOLC;
		}
		else  if (nWorkCmdVal == m_FALGParam.m_nVCmdValue)		// 		14	FALG
		{
			//m_FALGParam.P1 = vnReceivedData[2];

			m_FALGParam.P1 = vnReceivedData[2];
			m_FALGParam.nP2 = vnReceivedData[3];
			m_FALGParam.nP3 = vnReceivedData[4];
			m_FALGParam.nP4 = vnReceivedData[5];

			return eCmdOnceAlignMoveFALG;
		}
		else if (nWorkCmdVal == m_FCNTParam.m_nVCmdValue)		// 		15	FCNT
		{
			m_FCNTParam.m_nPType = m_FCNTParam.m_nPNum - 3;
			m_FCNTParam.P1 = vnReceivedData[2];
			m_FCNTParam.P2 = 0;
			m_FCNTParam.P3 = 0;
			m_FCNTParam.P4 = 0;		

			return eCmdObjectSearchFCNT;
		}
		else if (nWorkCmdVal == m_FCNOParam.m_nVCmdValue)		// 		15	FCNT
		{
			m_FCNOParam.m_nPType = m_FCNOParam.m_nPNum - 3;
			m_FCNOParam.P1  = vnReceivedData[2];
			m_FCNOParam.P2 = 0;
			m_FCNOParam.P3 = 0;
			m_FCNOParam.P4 = 0;		

			return eCmdTargetSearchFCNO;
		}
		else if (nWorkCmdVal == m_FGAPParam.m_nVCmdValue)		// 		16	FGAP
		{
			m_FGAPParam.m_nPType = m_FGAPParam.m_nPNum - 3;
			m_FGAPParam.P1 = vnReceivedData[2];
			m_FGAPParam.P2 = vnReceivedData[3];

			return eCmdGetImagePosFGAP;
		}
		else if (nWorkCmdVal == m_FTGCParam.m_nVCmdValue)		// 		17	FTGC
		{

			m_FTGCParam.m_nPType = m_FTGCParam.m_nPNum;
			m_FTGCParam.P1 = vnReceivedData[2];
			m_FTGCParam.P2 = vnReceivedData[3];
			m_FTGCParam.nP3 = vnReceivedData[4];
			m_FTGCParam.nP4 = vnReceivedData[5];
			//m_FTGCParam.nP5 = vnReceivedData[6];

			return eCmdTargetSearchFTGC;
		}
		else if (nWorkCmdVal == m_FOBCParam.m_nVCmdValue)		// 		18	FOBC
		{
			m_FOBCParam.m_nPType = m_FOBCParam.m_nPNum - 1;
			m_FOBCParam.P1 = vnReceivedData[2];
			m_FOBCParam.P2 = vnReceivedData[3];
			m_FOBCParam.P3 = 0;
			m_FOBCParam.P4 = 0;
			m_FOBCParam.P5 = 0;
			m_FOBCParam.nP3 = vnReceivedData[4];
			m_FOBCParam.nP4 = vnReceivedData[5];
			//m_FOBCParam.nP5 = vnReceivedData[6];


			return eCmdObjectSearchFOBC;
		}
		else if (nWorkCmdVal == m_FPMIParam.m_nVCmdValue)		// 		18	FOBC
		{
			m_FPMIParam.P1 = vnReceivedData[2];
			return eCmdObjectSearchFPMI;
		}
		else if (nWorkCmdVal == m_FBISParam.m_nVCmdValue)		// 		18	FBIS
		{
			m_FBISParam.P1 = vnReceivedData[2];
			m_FBISParam.P2 = vnReceivedData[3];
			m_FBISParam.P3 = 0;
			m_FBISParam.P4 = 0;
			return eCmdACFInspectFBIS;
		}
		else if (nWorkCmdVal == m_FAACParam.m_nVCmdValue)		// 		19	FAAC
		{

			// 没有轴位置参数
			m_FAACParam.m_nPType = m_FAACParam.m_nPNum - 3;
			m_FAACParam.P1 = vnReceivedData[2];
			m_FAACParam.P2 = vnReceivedData[3];

			m_FAACParam.nP3 = vnReceivedData[4];
			m_FAACParam.nP4 = vnReceivedData[5];

			m_FAACParam.P3 = 0;
			m_FAACParam.P4 = 0;
			m_FAACParam.P5 = 0;



			return eCmdAutoAlignFAAC;
		}
		else if (nWorkCmdVal == m_FAOTParam.m_nVCmdValue)
		{			
			m_FAOTParam.m_nPType = m_FAOTParam.m_nPNum - 3;
			m_FAOTParam.P1 = vnReceivedData[2];
			m_FAOTParam.P2 = vnReceivedData[3];
			m_FAOTParam.P3 = 0;
			m_FAOTParam.P4 = 0;
			m_FAOTParam.P5 = 0;	

			return eCmdAutoAlignFAOT;
		}
		else if (nWorkCmdVal == m_FALXParam.m_nVCmdValue)
		{			
			m_FALXParam.m_nPType = m_FALXParam.m_nPNum - 3;
			m_FALXParam.P1 = vnReceivedData[2];
			m_FALXParam.P2 = vnReceivedData[3];
			m_FALXParam.P3 = 0;
			m_FALXParam.P4 = 0;
			m_FALXParam.P5 = 0;

			return eCmdAutoAlignFALX;
		}
		else if (nWorkCmdVal == m_FGSPParam.m_nVCmdValue)		// 		20	FGSP
		{
			return eCmdGetProductIndexFGSP;
		}
		else if (nWorkCmdVal == m_FCBSParam.m_nVCmdValue)		// 		21	FCBS
		{
			m_FCBSParam.m_nPType = m_FCBSParam.m_nPNum - 3;
			m_FCBSParam.P1 = vnReceivedData[2];
			m_FCBSParam.P2 = vnReceivedData[3];
			m_FCBSParam.P3 = 0;
			m_FCBSParam.P4 = 0;
			m_FCBSParam.P5 = 0;

			return eCmdCalibrateFCBS;
		}
		else if (nWorkCmdVal == m_FCBRParam.m_nCmdVal)
		{
			m_FCBRParam.m_nPType = m_FCBRParam.m_nPNum-4;
			m_FCBRParam.P1 = 0;
			m_FCBRParam.P2 = 0;
			m_FCBRParam.P3 = 0;
			m_FCBRParam.P4 = 0;

			return eCmdCalibrateFCBR;
		}
		else if (nWorkCmdVal == m_FMAPParam.m_nVCmdValue)		// 		22	FMAP
		{
			return eCmdUnknow;
		}
		else if (nWorkCmdVal == m_FXYAParam.m_nVCmdValue)		// 		23	FXYA
		{
			if (m_bEnableCommMutiTarget)
			{
				m_FXYAParam.m_nPType = m_FAALParam.m_nPNum - 2;
				m_FXYAParam.P1 = vnReceivedData[2];
				m_FXYAParam.P2 = vnReceivedData[3];
				m_FXYAParam.P3 = vnReceivedData[4];
				m_FXYAParam.P4 = 0;
				m_FXYAParam.P5 = 0;
			}
			else
			{
				m_FXYAParam.m_nPType = m_FAALParam.m_nPNum - 3;
				m_FXYAParam.P1 = vnReceivedData[2];
				m_FXYAParam.P2 = vnReceivedData[3];
				m_FXYAParam.P3 = 0;
				m_FXYAParam.P4 = 0;
				m_FXYAParam.P5 = 0;
			}

			return eCmdAutoAlignFXYA;
		}
		else if (nWorkCmdVal == m_FRCTParam.m_nVCmdValue)// 		24	FRCT
		{
			return eCmdUnknow;
		}
		else if (nWorkCmdVal == m_FISPParam.m_nVCmdValue)// 		25	FISP
		{
			return eCmdUnknow;
		}
		else if (nWorkCmdVal == m_FOLGParam.m_nVCmdValue)// 		26	FOLG
		{
			return eCmdUnknow;
		}
		else if (nWorkCmdVal == m_FTLGParam.m_nVCmdValue)// 		27	FTLG
		{
			return eCmdUnknow;
		}
		else if (nWorkCmdVal == m_FSSVParam.m_nVCmdValue)
		{		
			m_FSSVParam.P1 = vnReceivedData[2];
			m_FSSVParam.P2 = vnReceivedData[3];

			return eCmdSaveProductIndexFSSV;
		}
		else if (nWorkCmdVal == m_FTGMParam.m_nVCmdValue)
		{
			if (m_bEnableCommMutiTarget)
			{
				m_FTGMParam.m_nPType = m_FTGMParam.m_nPNum - 2;
				m_FTGMParam.P1 = vnReceivedData[2];
				m_FTGMParam.P2 = vnReceivedData[3];
				m_FTGMParam.P3 = 0;
				m_FTGMParam.P4 = 0;
			}
			else
			{
				m_FTGMParam.m_nPType = m_FTGMParam.m_nPNum - 3;
				m_FTGMParam.P1 = vnReceivedData[2];
				m_FTGMParam.P2 = 0;
				m_FTGMParam.P3 = 0;
				m_FTGMParam.P4 = 0;
			}


			return eCmdTargetSearchFTGM;
		}
		else if (nWorkCmdVal == m_FTGSParam.m_nVCmdValue)
		{
			if (m_bEnableCommMutiTarget)
			{
				m_FTGSParam.P1 = vnReceivedData[2];
				m_FTGSParam.P2 = vnReceivedData[3];
			}
			else
			{
				m_FTGSParam.P1 = vnReceivedData[2];
			}


			return eCmdTargetSearchFTGS;
		}
		else if (nWorkCmdVal == m_FTGRParam.m_nVCmdValue)
		{		
			m_FTGRParam.P1 = vnReceivedData[2];
			m_FTGRParam.P2 = vnReceivedData[3]/100.0;
			m_FTGRParam.P3 = vnReceivedData[4]/100.0;

			return eCmdSaveTargetPosFTGR;
		}
		else if (nWorkCmdVal == m_FTGGParam.m_nVCmdValue)
		{		
			m_FTGGParam.P1 = vnReceivedData[2];

			return eCmdGetTargetImagePosFTGG;
		}
		else if (nWorkCmdVal == m_FTGDParam.m_nVCmdValue)
		{

			m_FTGDParam.P1 = vnReceivedData[2];

			return eCmdDisplayTargetFTGD;
		}
		else if (nWorkCmdVal == m_FOBMParam.m_nVCmdValue)
		{		
			m_FOBMParam.m_nPType = m_FOBMParam.m_nPNum - 3;
			m_FOBMParam.P1 = vnReceivedData[2];
			m_FOBMParam.P2 = 0;
			m_FOBMParam.P3 = 0;
			m_FOBMParam.P4 = 0;		

			return eCmdObjectSearchFOBM;
		}
		else if (nWorkCmdVal == m_FOBGParam.m_nVCmdValue)
		{
			m_FOBGParam.P1 = vnReceivedData[2];

			return eCmdGetObjectImagePosFOBG;
		}
		else if (nWorkCmdVal == m_FMSCParam.m_nVCmdValue)
		{

			m_FMSCParam.P1 = vnReceivedData[2];

			return eCmdManualSearchFMSC;
		}
		else if (nWorkCmdVal == m_FWLDParam.m_nVCmdValue)
		{
			m_FWLDParam.P1 = vnReceivedData[2];
			m_FWLDParam.P2 = vnReceivedData[3];

			return eCmdGetSearchWorldPosFWLD;
		}
		else if (nWorkCmdVal == m_FWDRParam.m_nVCmdValue)
		{
			m_FWDRParam.P1 = vnReceivedData[2];
			m_FWDRParam.P2 = vnReceivedData[3];

			return eCmdFWDR;
		}
		else if (nWorkCmdVal == m_FGOWParam.m_nVCmdValue)		// 		18	FGOW
		{
			m_FGOWParam.m_nPType = m_FGOWParam.m_nPNum - 3;
			m_FGOWParam.P1 = vnReceivedData[2];
			m_FGOWParam.P2 = vnReceivedData[3];
			m_FGOWParam.P3 = 0;
			m_FGOWParam.P4 = 0;
			m_FGOWParam.P5 = 0;

			return eCmdGetObjectWorldPosFGOW;
		}
		else if (nWorkCmdVal == m_FGALParam.m_nVCmdValue)
		{
			m_FGALParam.P1 = vnReceivedData[2];

			return eCmdGetAlignPrecisionFGAL;
		}
		else if (nWorkCmdVal == m_FALLParam.m_nVCmdValue)
		{
			m_FALLParam.m_nPType = m_FALLParam.m_nPNum - 3;
			m_FALLParam.P1 = vnReceivedData[2];
			m_FALLParam.P2 = 0;
			m_FALLParam.P3 = 0;
			m_FALLParam.P4 = 0;

			return eCmdSetAlignPrecisionFALL;
		}
		else if (nWorkCmdVal == m_FGACParam.m_nVCmdValue)
		{
			return eCmdGetAlignTimeFGAC;
		}
		else if (nWorkCmdVal == m_FALCParam.m_nVCmdValue)
		{
			m_FALCParam.P1 = vnReceivedData[2];

			return eCmdSetAlignTimeFALC;
		}
		else if (nWorkCmdVal == m_FAABParam.m_nVCmdValue)
		{	
			if (m_bEnableCommMutiTarget)
			{
				m_FAABParam.m_nPType = m_FAABParam.m_nPNum - 2;
				m_FAABParam.P1 = vnReceivedData[2];
				m_FAABParam.P2 = vnReceivedData[3];
				m_FAABParam.P3 = 0;
				m_FAABParam.P4 = 0;	
			}
			else
			{
				m_FAABParam.m_nPType = m_FAABParam.m_nPNum - 3;
				m_FAABParam.P1 = vnReceivedData[2];
				m_FAABParam.P2 = 0;
				m_FAABParam.P3 = 0;
				m_FAABParam.P4 = 0;	
			}


			return eCmdAutoAlignFAAB;
		}
		else if(nWorkCmdVal == m_FAAOParam.m_nVCmdValue)
		{
			m_FAAOParam.m_nPType = m_FAAOParam.m_nPNum - 3;
			m_FAAOParam.P1  = vnReceivedData[2];
			m_FAAOParam.P2  = 0;
			m_FAAOParam.P3  = 0;
			m_FAAOParam.P4  = 0;

			return eCmdGetObjectTargetOffsetFAAO;
		}
		else if (nWorkCmdVal == m_FACBParam.m_nVCmdValue)
		{	
			m_FACBParam.m_nPType = m_FACBParam.m_nPNum - 3;
			m_FACBParam.P1 = vnReceivedData[2];
			m_FACBParam.P2 = 0;
			m_FACBParam.P3 = 0;
			m_FACBParam.P4 = 0;	

			return eCmdAutoAlignFACB;
		}
		else if (nWorkCmdVal == m_FAHLParam.m_nVCmdValue)
		{		
			m_FAHLParam.m_nPType = m_FAHLParam.m_nPNum - 3;
			m_FAHLParam.P1 = vnReceivedData[2];
			m_FAHLParam.P2 = 0;
			m_FAHLParam.P3 = 0;
			m_FAHLParam.P4 = 0;

			return eCmdAutoAlignFAHL;
		}
		else if (nWorkCmdVal == m_FANSParam.m_nVCmdValue)
		{		
			return eCmdGetAutoAlignOffsetFANS;
		}
		else if (nWorkCmdVal == m_FALPParam.m_nVCmdValue)
		{		
			m_FALPParam.m_nPType = m_FALPParam.m_nPNum - 2;
			m_FALPParam.P1 = vnReceivedData[2];
			m_FALPParam.nP2 = vnReceivedData[3];
			m_FALPParam.P2 = 0;
			m_FALPParam.P3 = 0;
			m_FALPParam.P4 = 0;

			return eCmdOnceAlignMovePickFALP;
		}

		else if (nWorkCmdVal == m_FALJParam.m_nVCmdValue)
		{
			m_FALJParam.P1 = vnReceivedData[2];
			m_FALJParam.P2 = vnReceivedData[3];

			return eCmdOnceAlignFALJ;
		}
		else if (nWorkCmdVal == m_FABOParam.m_nVCmdValue)
		{
			m_FABOParam.P1 = vnReceivedData[2];

			return eCmdGetTargetObjectOffsetFABO;
		}
		else if (nWorkCmdVal == m_FAOFParam.m_nVCmdValue)
		{		
			m_FAOFParam.P1 = vnReceivedData[2];

			return eCmdCalcuAlignOffsetFAOF;
		}
		else if (nWorkCmdVal == m_FGOFParam.m_nVCmdValue)
		{		
			m_FGOFParam.P1 = vnReceivedData[2];

			return eCmdGetAlignOffsetFGOF;
		}
		else if (nWorkCmdVal == m_FOFSParam.m_nVCmdValue)
		{	
			m_FOFSParam.m_nPType = m_FOFSParam.m_nPNum - 3;
			m_FOFSParam.P1 = vnReceivedData[2];	
			m_FOFSParam.P2 = 0;
			m_FOFSParam.P3 = 0;
			m_FOFSParam.P4 = 0;

			return eCmdSetAlignOffsetFOFS;
		}
		else if (nWorkCmdVal == m_FSFTParam.m_nVCmdValue)
		{
			m_FSFTParam.P1 = vnReceivedData[2];
			return eCmdFSFT;
		}
		else if (nWorkCmdVal == m_FGSFParam.m_nVCmdValue)
		{
			m_FGSFParam.P1 = vnReceivedData[2];

			return eCmdFGSF;
		}
		else if (nWorkCmdVal == m_FGPOParam.m_nVCmdValue)
		{
			return eCmdFGPO;
		}
		else if (nWorkCmdVal == m_FALMParam.m_nVCmdValue)
		{
			return eCmdGetAlarmFALM;
		}
		else if (nWorkCmdVal == m_FCHKParam.m_nVCmdValue)
		{
			m_FCHKParam.P1 = vnReceivedData[2];
			return eCmdSpecialCommFCHK;
		}
		else if (nWorkCmdVal == m_FSACParam.m_nVCmdValue)
		{
			return eCmdSaveProcessDataFSAC;
		}
		else if (nWorkCmdVal == m_FSCOParam.m_nVCmdValue)
		{
			return eCmdSaveCommDataFSCO;
		}
		else if (nWorkCmdVal == m_FCHBParam.m_nVCmdValue)
		{		
			m_FCHBParam.m_nPType = m_FCHBParam.m_nPNum;
			m_FCHBParam.P1 = vnReceivedData[2];
			m_FCHBParam.P2 = vnReceivedData[3];

			return eCmdACFInspectFCHB;
		}
		else if (nWorkCmdVal == m_FCHCParam.m_nVCmdValue)
		{		
			m_FCHCParam.m_nPType = m_FCHCParam.m_nPNum;
			m_FCHCParam.P1 = vnReceivedData[2];
			m_FCHCParam.P2 = vnReceivedData[3];
			m_FCHCParam.P3 = vnReceivedData[4];

			return eCmdACFInspectFCHC;
		}
		else if (nWorkCmdVal == m_FDRPParam.m_nVCmdValue)
		{		
			m_FDRPParam.m_nPType = m_FDRPParam.m_nPNum;
			m_FDRPParam.P1 = vnReceivedData[2];
			m_FDRPParam.P2 = vnReceivedData[3];

			return eCmdFDRP;
		}
		else if (nWorkCmdVal == m_FSPEParam.m_nVCmdValue)
		{
			m_FSPEParam.m_nPType = m_FSPEParam.m_nPNum;
			m_FSPEParam.P1 = vnReceivedData[2];
			m_FSPEParam.P2 = vnReceivedData[3];
			m_FSPEParam.P3 = vnReceivedData[4];

			return eCmdSetProductExposureFSPE;
		}
		else if (nWorkCmdVal == m_FWELParam.m_nCmdVal)
		{		
			m_FWELParam.m_nPType = m_FWELParam.m_nPNum - 3;
			m_FWELParam.P1 = vnReceivedData[2];
			m_FWELParam.P2 = vnReceivedData[3];
			m_FWELParam.P3 = 0;
			m_FWELParam.P4 = 0;
			m_FWELParam.P5 = 0;		

			return eCmdAutoAlignFWEL;
		}
		else if (nWorkCmdVal == m_FPCBParam.m_nVCmdValue)
		{
			m_FPCBParam.m_nPType = m_FPCBParam.m_nPNum;
			m_FPCBParam.P1 = vnReceivedData[2];
			//			m_FPCBParam.P2 = vnReceivedData[3];

			return eCmdObjTarSearchFPCB;
		}
		else if (nWorkCmdVal == m_FPISParam.m_nVCmdValue)
		{
			m_FPISParam.m_nPType = m_FPISParam.m_nPNum;
			m_FPISParam.P1 = vnReceivedData[2];

			return eCmdPCBPrecisionFPIS;
		}
		else if (nWorkCmdVal == m_FCPIParam.m_nVCmdValue)
		{
			m_FCPIParam.m_nPType = m_FCPIParam.m_nPNum;
			m_FCPIParam.P1 = vnReceivedData[2];

			return eCmdChangePlatformIndex;
		}
		else if(nWorkCmdVal == m_FQRCParam.m_nVCmdValue)
		{
			return eCmdSaveQRCode;
		}
		else if (nWorkCmdVal == m_FQRIParam.m_nVCmdValue)// 检测二维码
		{
			m_FQRIParam.m_nPType = m_FQRIParam.m_nPNum;
			m_FQRIParam.P1 = vnReceivedData[2];
			m_FQRIParam.P2 = vnReceivedData[3];

			return eCmdInspectQRCode;
		}
		else if (nWorkCmdVal == m_FINSParam.m_nVCmdValue)// 检测产品有、无
		{
			m_FINSParam.m_nPType = m_FINSParam.m_nPNum;
			m_FINSParam.P1 = vnReceivedData[2];
			m_FINSParam.P2 = vnReceivedData[3];

			return eCmdInspectFINS;
		}
		else if (nWorkCmdVal == m_FGTWParam.m_nVCmdValue)
		{
			m_FGTWParam.m_nPType = m_FGTWParam.m_nPNum+3;
			m_FGTWParam.P1 = vnReceivedData[2];
			m_FGTWParam.P2 = vnReceivedData[3];
			m_FGTWParam.nP3 = vnReceivedData[4];
			m_FGTWParam.nP4 = vnReceivedData[5];
			//m_FGTWParam.nP5 = vnReceivedData[6];

			return eCmdGetTargetPlatformPosFGTW;
		}
		else if (nWorkCmdVal == m_FGTPParam.m_nVCmdValue)
		{
			m_FGTPParam.m_nPType = m_FGTPParam.m_nPNum+3;
			m_FGTPParam.P1 = vnReceivedData[2];
			m_FGTPParam.P2 = vnReceivedData[3];
			m_FGTPParam.nP3 = vnReceivedData[4];
			m_FGTPParam.nP4 = vnReceivedData[5];
			//m_FGTPParam.nP5 = vnReceivedData[6];

			return eCmdGetTargetImagePosFGTP;
		}
		else if (nWorkCmdVal == m_FAFOParam.m_nVCmdValue)
		{
			m_FAFOParam.m_nPType = m_FAFOParam.m_nPNum;
			m_FAFOParam.P1 = vnReceivedData[2];
			m_FAFOParam.P2 = vnReceivedData[3];
			m_FAFOParam.P3 = vnReceivedData[4];
			m_FAFOParam.nP4 = vnReceivedData[5];

			return eCmdFAFO;
		}
		else if (nWorkCmdVal == m_FMCOParam.m_nVCmdValue)
		{
			m_FMCOParam.m_nPType = m_FMCOParam.m_nPNum;
			m_FMCOParam.P1 = vnReceivedData[2];

			return eCmdGetTargetObjectOffsetFMCO;
		}
		else if (nWorkCmdVal == m_FPEPParam.m_nVCmdValue)
		{
			m_FPEPParam.m_nPType = m_FPEPParam.m_nPNum;
			m_FPEPParam.P1 = vnReceivedData[2];
			m_FPEPParam.P2 = vnReceivedData[3];

			return eCmdProductEmptyPEP;
		}
		else if (nWorkCmdVal == m_FPCPParam.m_nVCmdValue)
		{
			m_FPCPParam.m_nPType = m_FPCPParam.m_nPNum;
			m_FPCPParam.P1 = vnReceivedData[2];
			m_FPCPParam.P2 = vnReceivedData[3];
			m_FPCPParam.P3 = vnReceivedData[4];
			m_FPCPParam.P4 = vnReceivedData[5];

			return eCmdProductCopyFPCP;
		}
		else if (nWorkCmdVal == m_FPRNParam.m_nVCmdValue)
		{
			m_FPRNParam.m_nPType = m_FPRNParam.m_nPNum;
			m_FPRNParam.P1 = vnReceivedData[2];
			m_FPRNParam.P2 = vnReceivedData[3];
			m_FPRNParam.P3 = vnReceivedData[4];

			return eCmdProductRenameFPRN;
		}
		else
		{
			return eCmdUnknow;
		}


		return eCmdUnknow;
	}


	// 解析字符串
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLC_CMD_TRIGGER);		// 寄存器地址
	// 	int  nDataNum = 5;												// 数据量
	// 	std::vector<int> vnReceivedData;
	// 	if (!m_pCommProRegBase->AnalyzeAswReadReg(strCmd, nDataNum, vnReceivedData))
	// 	{
	// 		bTriggered = FALSE;
	// 		return eCmdType;
	// 	}
	// 
	// 	if (vnReceivedData.size() != nDataNum)
	// 	{
	// 		bTriggered = FALSE;
	// 		return eCmdType;
	// 	}
	// 
	// 	if (vnReceivedData.at(0) == PLC_CMD_VAL_NOT_TRIGGERED)
	// 	{
	// 		bTriggered = FALSE;
	// 		return eCmdType;
	// 	}
	// 
	// 	double dBase = 10;
	// 	bTriggered = TRUE;
	// 	int nWorkCmdVal = vnReceivedData.at(1);
	// 
	// 	if (nWorkCmdVal == m_FSPCParam.m_nCmdVal)
	// 	{		
	// 		m_FSPCParam.P1 = vnReceivedData[2];
	// 		m_FSPCParam.P2 = vnReceivedData[3];
	// 
	// 		return eCmdSetProductIndexFSPC;
	// 	}
	// 	else if (nWorkCmdVal == m_FSSVParam.m_nCmdVal)
	// 	{		
	// 		m_FSSVParam.P1 = vnReceivedData[2];
	// 		m_FSSVParam.P2 = vnReceivedData[3];
	// 
	// 		return eCmdSaveProductIndexFSSV;
	// 	}
	// 	else if (nWorkCmdVal == m_FGSPParam.m_nCmdVal)
	// 	{
	// 		return eCmdGetProductIndexFGSP;
	// 	}
	// 	else if (nWorkCmdVal == m_FCLBParam.m_nCmdVal)
	// 	{
	// 		m_FCLBParam.m_nPType = m_FCLBParam.m_nPNum - 3;
	// 		m_FCLBParam.P1 = vnReceivedData[2];
	// 		m_FCLBParam.P2 = vnReceivedData[3];
	// 		m_FCLBParam.P3 = 0;
	// 		m_FCLBParam.P4 = 0;
	// 		m_FCLBParam.P5 = 0;
	// 
	// 		return eCmdCalibrateFCLB;
	// 	}
	// 	else if (nWorkCmdVal == m_FCBSParam.m_nCmdVal)
	// 	{
	// 		m_FCBSParam.m_nPType = m_FCBSParam.m_nPNum - 3;
	// 		m_FCBSParam.P1 = vnReceivedData[2];
	// 		m_FCBSParam.P2 = vnReceivedData[3];
	// 		m_FCBSParam.P3 = 0;
	// 		m_FCBSParam.P4 = 0;
	// 		m_FCBSParam.P5 = 0;
	// 
	// 		return eCmdCalibrateFCBS;
	// 	}
	// 	else if (nWorkCmdVal == m_FTGTParam.m_nCmdVal)
	// 	{
	// 		
	// 		m_FTGTParam.m_nPType = m_FTGTParam.m_nPNum - 3;
	// 		m_FTGTParam.P1 = vnReceivedData[2];
	// 		m_FTGTParam.P2 = 0;
	// 		m_FTGTParam.P3 = 0;
	// 		m_FTGTParam.P4 = 0;
	// 
	// 		return eCmdTargetSearchFTGT;
	// 	}
	// 	else if (nWorkCmdVal == m_FTGMParam.m_nCmdVal)
	// 	{
	// 
	// 		m_FTGMParam.m_nPType = m_FTGMParam.m_nPNum - 3;
	// 		m_FTGMParam.P1 = vnReceivedData[2];
	// 		m_FTGMParam.P2 = 0;
	// 		m_FTGMParam.P3 = 0;
	// 		m_FTGMParam.P4 = 0;
	// 
	// 		return eCmdTargetSearchFTGM;
	// 	}
	// 	else if (nWorkCmdVal == m_FTGSParam.m_nCmdVal)
	// 	{
	// 		m_FTGSParam.P1 = vnReceivedData[2];
	// 
	// 		return eCmdTargetSearchFTGS;
	// 	}
	// 	else if (nWorkCmdVal == m_FTGCParam.m_nCmdVal)
	// 	{
	// 		m_FTGCParam.m_nPType = m_FTGCParam.m_nPNum - 3;
	// 		m_FTGCParam.P1 = vnReceivedData[2];
	// 		m_FTGCParam.P2 = vnReceivedData[3];
	// 		m_FTGCParam.P3 = 0;
	// 		m_FTGCParam.P4 = 0;
	// 		m_FTGCParam.P5 = 0;
	// 
	// 		return eCmdTargetSearchFTGC;
	// 	}
	// 	else if (nWorkCmdVal == m_FTGRParam.m_nCmdVal)
	// 	{		
	// 		m_FTGRParam.P1 = vnReceivedData[2];
	// 		m_FTGRParam.P2 = vnReceivedData[3]/100.0;
	// 		m_FTGRParam.P3 = vnReceivedData[4]/100.0;
	// 
	// 		return eCmdSaveTargetPosFTGR;
	// 	}
	// 	else if (nWorkCmdVal == m_FTGGParam.m_nCmdVal)
	// 	{		
	// 		m_FTGGParam.P1 = vnReceivedData[2];
	// 
	// 		return eCmdGetTargetImagePosFTGG;
	// 	}
	// 	else if (nWorkCmdVal == m_FTGDParam.m_nCmdVal)
	// 	{
	// 		
	// 		m_FTGDParam.P1 = vnReceivedData[2];
	// 
	// 		return eCmdDisplayTargetFTGD;
	// 	}
	// 	else if (nWorkCmdVal == m_FGAPParam.m_nCmdVal)
	// 	{		
	// 		m_FGAPParam.m_nPType = m_FGAPParam.m_nPNum;
	// 		m_FGAPParam.P1 = vnReceivedData[2];
	// 		m_FGAPParam.P2 = vnReceivedData[3];
	// 
	// 		return eCmdGetImagePosFGAP;
	// 	}
	// 	else if (nWorkCmdVal == m_FCNTParam.m_nCmdVal)
	// 	{		
	// 		m_FCNTParam.m_nPType = m_FCNTParam.m_nPNum - 3;
	// 		m_FCNTParam.P1 = vnReceivedData[2];
	// 		m_FCNTParam.P2 = 0;
	// 		m_FCNTParam.P3 = 0;
	// 		m_FCNTParam.P4 = 0;		
	// 
	// 		return eCmdObjectSearchFCNT;
	// 	}
	// 	else if (nWorkCmdVal == m_FOBJParam.m_nCmdVal)
	// 	{		
	// 		m_FOBJParam.m_nPType = m_FOBJParam.m_nPNum - 3;
	// 		m_FOBJParam.P1 = vnReceivedData[2];
	// 		m_FOBJParam.P2 = 0;
	// 		m_FOBJParam.P3 = 0;
	// 		m_FOBJParam.P4 = 0;		
	// 
	// 		return eCmdObjectSearchFOBJ;
	// 	}
	// 	else if (nWorkCmdVal == m_FOBMParam.m_nCmdVal)
	// 	{		
	// 		m_FOBMParam.m_nPType = m_FOBMParam.m_nPNum - 3;
	// 		m_FOBMParam.P1 = vnReceivedData[2];
	// 		m_FOBMParam.P2 = 0;
	// 		m_FOBMParam.P3 = 0;
	// 		m_FOBMParam.P4 = 0;		
	// 
	// 		return eCmdObjectSearchFOBM;
	// 	}
	// 	else if (nWorkCmdVal == m_FOBCParam.m_nCmdVal)
	// 	{		
	// 		m_FOBCParam.m_nPType = m_FOBCParam.m_nPNum - 3;
	// 		m_FOBCParam.P1 = vnReceivedData[2];
	// 		m_FOBCParam.P2 = vnReceivedData[3];
	// 		m_FOBCParam.P3 = 0;
	// 		m_FOBCParam.P4 = 0;
	// 		m_FOBCParam.P5 = 0;
	// 
	// 		return eCmdObjectSearchFOBC;
	// 	}
	// 	else if (nWorkCmdVal == m_FOBGParam.m_nCmdVal)
	// 	{
	// 		m_FOBGParam.P1 = vnReceivedData[2];
	// 
	// 		return eCmdGetObjectImagePosFOBG;
	// 	}
	// 	else if (nWorkCmdVal == m_FMSCParam.m_nCmdVal)
	// 	{
	// 
	// 		m_FMSCParam.P1 = vnReceivedData[2];
	// 
	// 		return eCmdManualSearchFMSC;
	// 	}
	// 	else if (nWorkCmdVal == m_FWLDParam.m_nCmdVal)
	// 	{
	// 		m_FWLDParam.P1 = vnReceivedData[2];
	// 		m_FWLDParam.P2 = vnReceivedData[3];
	// 
	// 		return eCmdGetSearchWorldPosFWLD;
	// 	}
	// 	else if (nWorkCmdVal == m_FGALParam.m_nCmdVal)
	// 	{
	// 		m_FGALParam.P1 = vnReceivedData[2];
	// 
	// 		return eCmdGetAlignPrecisionFGAL;
	// 	}
	// 	else if (nWorkCmdVal == m_FALLParam.m_nCmdVal)
	// 	{
	// 		m_FALLParam.P1 = vnReceivedData[2];
	// 		m_FALLParam.P2 = vnReceivedData[2]*1.0/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 		m_FALLParam.P3 = vnReceivedData[3]*1.0/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 		m_FALLParam.P4 = vnReceivedData[4]*1.0/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
	// 
	// 		return eCmdSetAlignPrecisionFALL;
	// 	}
	// 	else if (nWorkCmdVal == m_FGACParam.m_nCmdVal)
	// 	{
	// 		return eCmdGetAlignTimeFGAC;
	// 	}
	// 	else if (nWorkCmdVal == m_FALCParam.m_nCmdVal)
	// 	{
	// 		m_FALCParam.P1 = vnReceivedData[2];
	// 
	// 		return eCmdSetAlignTimeFALC;
	// 	}
	// 	else if (nWorkCmdVal == m_FAALParam.m_nCmdVal)
	// 	{		
	// 		m_FAALParam.m_nPType = m_FAALParam.m_nPNum - 3;
	// 		m_FAALParam.P1 = vnReceivedData[2];
	// 		m_FAALParam.P2 = 0;
	// 		m_FAALParam.P3 = 0;
	// 		m_FAALParam.P4 = 0;
	// 
	// 		return eCmdAutoAlignFAAL;
	// 	}
	// 	else if (nWorkCmdVal == m_FXYAParam.m_nCmdVal)
	// 	{		
	// 		m_FXYAParam.m_nPType = m_FAALParam.m_nPNum - 3;
	// 		m_FXYAParam.P1 = vnReceivedData[2];
	// 		m_FXYAParam.P2 = vnReceivedData[3];
	// 		m_FXYAParam.P3 = 0;
	// 		m_FXYAParam.P4 = 0;
	// 		m_FXYAParam.P5 = 0;
	// 		return eCmdAutoAlignFXYA;
	// 	}
	// 	else if (nWorkCmdVal == m_FAABParam.m_nCmdVal)
	// 	{	
	// 		m_FAABParam.m_nPType = m_FAABParam.m_nPNum - 3;
	// 		m_FAABParam.P1 = vnReceivedData[2];
	// 		m_FAABParam.P2 = 0;
	// 		m_FAABParam.P3 = 0;
	// 		m_FAABParam.P4 = 0;	
	// 
	// 		return eCmdAutoAlignFAAB;
	// 	}
	// 	else if (nWorkCmdVal == m_FACBParam.m_nCmdVal)
	// 	{	
	// 		m_FACBParam.m_nPType = m_FACBParam.m_nPNum - 3;
	// 		m_FACBParam.P1 = vnReceivedData[2];
	// 		m_FACBParam.P2 = 0;
	// 		m_FACBParam.P3 = 0;
	// 		m_FACBParam.P4 = 0;	
	// 
	// 		return eCmdAutoAlignFACB;
	// 	}
	// 	else if (nWorkCmdVal == m_FAACParam.m_nCmdVal)
	// 	{		
	// 		m_FAACParam.m_nPType = m_FAACParam.m_nPNum - 3;
	// 		m_FAACParam.P1 = vnReceivedData[2];
	// 		m_FAACParam.P2 = vnReceivedData[3];
	// 		m_FAACParam.P3 = 0;
	// 		m_FAACParam.P4 = 0;
	// 		m_FAACParam.P5 = 0;		
	// 
	// 		return eCmdAutoAlignFAAC;
	// 	}
	// 	else if (nWorkCmdVal == m_FAHLParam.m_nCmdVal)
	// 	{		
	// 		m_FAHLParam.m_nPType = m_FAHLParam.m_nPNum - 3;
	// 		m_FAHLParam.P1 = vnReceivedData[2];
	// 		m_FAHLParam.P2 = 0;
	// 		m_FAHLParam.P3 = 0;
	// 		m_FAHLParam.P4 = 0;
	// 
	// 		return eCmdAutoAlignFAHL;
	// 	}
	// 	else if (nWorkCmdVal == m_FANSParam.m_nCmdVal)
	// 	{		
	// 		return eCmdGetAutoAlignOffsetFANS;
	// 	}
	// 	else if (nWorkCmdVal == m_FALGParam.m_nCmdVal)
	// 	{		
	// 		m_FALGParam.P1 = vnReceivedData[2];
	// 
	// 		return eCmdOnceAlignMoveFALG;
	// 	}
	// 	else if (nWorkCmdVal == m_FALPParam.m_nCmdVal)
	// 	{		
	// 		m_FALPParam.m_nPType = m_FALPParam.m_nPNum - 3;
	// 		m_FALPParam.P1 = vnReceivedData[2];
	// 		m_FALPParam.P2 = 0;
	// 		m_FALPParam.P3 = 0;
	// 		m_FALPParam.P4 = 0;
	// 
	// 		return eCmdOnceAlignMovePickFALP;
	// 	}
	// 	else if (nWorkCmdVal == m_FALJParam.m_nCmdVal)
	// 	{
	// 		m_FALJParam.P1 = vnReceivedData[2];
	// 		m_FALJParam.P2 = vnReceivedData[3];
	// 
	// 		return eCmdOnceAlignFALJ;
	// 	}
	// 	else if (nWorkCmdVal == m_FACOParam.m_nCmdVal)
	// 	{		
	// 		m_FACOParam.P1 = vnReceivedData[2];
	// 
	// 		return eCmdGetTargetObjectOffsetFACO;
	// 	}
	// 	else if (nWorkCmdVal == m_FABOParam.m_nCmdVal)
	// 	{
	// 		m_FABOParam.P1 = vnReceivedData[2];
	// 		
	// 		return eCmdGetTargetObjectOffsetFABO;
	// 	}
	// 	else if (nWorkCmdVal == m_FAOFParam.m_nCmdVal)
	// 	{		
	// 		m_FAOFParam.P1 = vnReceivedData[2];
	// 
	// 		return eCmdCalcuAlignOffsetFAOF;
	// 	}
	// 	else if (nWorkCmdVal == m_FGOFParam.m_nCmdVal)
	// 	{		
	// 		m_FGOFParam.P1 = vnReceivedData[2];
	// 
	// 		return eCmdGetAlignOffsetFGOF;
	// 	}
	// 	else if (nWorkCmdVal == m_FOFSParam.m_nCmdVal)
	// 	{		
	// 		m_FOFSParam.P1 = vnReceivedData[2]*1.0/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 		m_FOFSParam.P2 = vnReceivedData[3]*1.0/pow(dBase, m_CommProtocolParam.m_nCommXYUnitExp);
	// 		m_FOFSParam.P3 = vnReceivedData[4]*1.0/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
	// 
	// 		return eCmdSetAlignOffsetFOFS;
	// 	}
	// 	else if (nWorkCmdVal == m_FSFTParam.m_nCmdVal)
	// 	{
	// 		m_FSFTParam.P1 = vnReceivedData[2];
	// 		return eCmdFSFT;
	// 	}
	// 	else if (nWorkCmdVal == m_FGSFParam.m_nCmdVal)
	// 	{
	// 		m_FGSFParam.P1 = vnReceivedData[2];
	// 
	// 		return eCmdFGSF;
	// 	}
	// 	else if (nWorkCmdVal == m_FALMParam.m_nCmdVal)
	// 	{
	// 		return eCmdGetAlarmFALM;
	// 	}
	// 	else if (nWorkCmdVal == m_FRSTParam.m_nCmdVal)
	// 	{
	// 		return eCmdResetFRST;
	// 	}
	// 	else if (nWorkCmdVal == m_FCHKParam.m_nCmdVal)
	// 	{
	// 		m_FCHKParam.P1 = vnReceivedData[2];
	// 		return eCmdSpecialCommFCHK;
	// 	}
	// 	else if (nWorkCmdVal == m_FSACParam.m_nCmdVal)
	// 	{
	// 		return eCmdSaveProcessDataFSAC;
	// 	}
	// 	else if (nWorkCmdVal == m_FSCOParam.m_nCmdVal)
	// 	{
	// 		return eCmdSaveCommDataFSCO;
	// 	}
	// 	else if (nWorkCmdVal == m_MNPSParam.m_nCmdVal)
	// 	{
	// 		m_MNPSParam.P1 = vnReceivedData[2];
	// 		return eCmdGetPosMNPS;
	// 	}
	// 	else if (nWorkCmdVal == m_MMVAParam.m_nCmdVal)
	// 	{
	// 		m_MMVAParam.P1 = vnReceivedData[2];
	// 		return eCmdMovePosMMVA;
	// 	}
	// 	else if (nWorkCmdVal == m_MMVRParam.m_nCmdVal)
	// 	{
	// 		m_MMVRParam.P1 = vnReceivedData[2];
	// 		return eCmdMoveRelPosMMVR;
	// 	}
	// 
	// 	return eCmdUnknow;
}

// 解析写入PLC后，PLC反馈的响应字符串（一般成功都是固定格式），几乎所有写入操作响应的解析都可以用这个函数
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswPlcWriteReg(CString strAsw)
{
	CString strPLCAswWriteInfo;
	if (m_pCommProRegBase == NULL)
	{
		return eAswUnkown;
	}

	if (!m_pCommProRegBase->AnalyzeAswWriteReg(strAsw))
	{
		return eAswUnkown;
	}


	SetAnalyzeAswWriteRegTransInfo();

	return eAswSucceed;
}

BOOL CCommProtocolXYDFast::PackPlcWriteSetPlcCmdTrigger( CString& strInfo, BOOL bTriggered )
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLC_CMD_TRIGGER);		// 寄存器地址
		int  nDataNum = 1;												// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);
		vnWriteData.at(0) = bTriggered ? PLC_CMD_VAL_TRIGGERED : PLC_CMD_VAL_NOT_TRIGGERED;

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}


		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLC_CMD_TRIGGER_WORD);		// 寄存器地址
		int  nDataNum = 1;												// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);
		vnWriteData.at(0) = bTriggered ? PLC_CMD_VAL_TRIGGERED : PLC_CMD_VAL_NOT_TRIGGERED;

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLC_CMD_TRIGGER);		// 寄存器地址
	// 	int  nDataNum = 1;												// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 	vnWriteData.at(0) = bTriggered ? PLC_CMD_VAL_TRIGGERED : PLC_CMD_VAL_NOT_TRIGGERED;
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}

// 1、 PLC Cmd Trigger：设置PLC命令触发器
BOOL CCommProtocolXYDFast::PackPlcWriteSetVisionCmdTrigger(CString& strInfo, BOOL bTriggered)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_TRIGGER);	// 寄存器地址
		int  nDataNum = 1;												// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);
		vnWriteData.at(0) = bTriggered ? PLC_CMD_VAL_TRIGGERED : PLC_CMD_VAL_NOT_TRIGGERED;

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_TRIGGER_WORD);	// 寄存器地址
		int  nDataNum = 1;												// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);
		vnWriteData.at(0) = bTriggered ? PLC_CMD_VAL_TRIGGERED : PLC_CMD_VAL_NOT_TRIGGERED;

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_TRIGGER);	// 寄存器地址
	// 	int  nDataNum = 1;												// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 	vnWriteData.at(0) = bTriggered ? PLC_CMD_VAL_TRIGGERED : PLC_CMD_VAL_NOT_TRIGGERED;
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}

// 设置视觉系统状态（写PLC寄存器）
BOOL CCommProtocolXYDFast::PackPlcWriteSetVisionStatus(CString& strInfo, VisionStatus eVisionStatus)
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		//	CString strName = m_FSPCParam.m_strCmd;
		//	int nCmdVal = m_FSPCParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_STATUS);	// 寄存器地址
		int  nDataNum = 1;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		//	m_strCmdName = strName;	
		//	nParam = nCmdVal;
		//	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = eVisionStatus;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		//	CString strName = m_FSPCParam.m_strCmd;
		//	int nCmdVal = m_FSPCParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_STATUS_WORD);	// 寄存器地址
		int  nDataNum = 1;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		//	m_strCmdName = strName;	
		//	nParam = nCmdVal;
		//	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = eVisionStatus;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	//	CString strName = m_FSPCParam.m_strCmd;
	// 	//	int nCmdVal = m_FSPCParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_STATUS);	// 寄存器地址
	// 	int  nDataNum = 1;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	//	m_strCmdName = strName;	
	// 	//	nParam = nCmdVal;
	// 	//	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = eVisionStatus;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;

}

// 3、 设置视觉弹出手动搜索框：自定义设置、清除PLC命令触发器
BOOL CCommProtocolXYDFast::PackPlcWriteSetManualSearch3(CString& strInfo, BOOL bShow,int nWriteAddr)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	long nRegAdrr = nWriteAddr;		// 寄存器地址
	int  nDataNum = 1;												// 数据量
	std::vector<int> vnWriteData;
	vnWriteData.resize(nDataNum);
	vnWriteData.at(0) = bShow ? PLC_CMD_VAL_TRIGGERED : PLC_CMD_VAL_NOT_TRIGGERED;

	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData,m_bRegType))
	{
		return FALSE;
	}
	SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,m_bRegType);

	return TRUE;
}

// 1、 设置视觉弹出手动搜索框：设置、清除PLC命令触发器
BOOL CCommProtocolXYDFast::PackPlcWriteSetManualSearch(CString& strInfo, BOOL bShow)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_PARAM_P2);		// 寄存器地址
		int  nDataNum = 1;												// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);
		vnWriteData.at(0) = bShow ? PLC_CMD_VAL_TRIGGERED : PLC_CMD_VAL_NOT_TRIGGERED;

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_PARAM_P2_WORD);		// 寄存器地址
		int  nDataNum = 1;												// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);
		vnWriteData.at(0) = bShow ? PLC_CMD_VAL_TRIGGERED : PLC_CMD_VAL_NOT_TRIGGERED;

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	return TRUE;

}


//lzk 0408
BOOL CCommProtocolXYDFast::PackRePlcSetPositionVirtualFVPC( CString& strInfo,BOOL bResult )
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)		// 双字节
	{
		CString strName = m_FVPCParam.m_strCmd;
		int nCmdVal = m_FVPCParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,nDataNum,vnWriteData,TRUE);

	}
	else			// 单字节
	{
		CString strName = m_FVPCParam.m_strCmd;
		int nCmdVal = m_FVPCParam.m_nCmdVal;
		int nVCmdValue = m_FVPCParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;	// 1:OK; 2:NG
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,nDataNum,vnWriteData,FALSE);

	}
	return TRUE;
}


//lzk FCCI复制标定信息
BOOL CCommProtocolXYDFast::PackRePlcCopyCalibrateInfoFCCI( CString& strInfo,BOOL bResult )
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}
	if (m_bRegType)		// 双字节
	{
		CString strName = m_FCCIParam.m_strCmd;
		int nCmdVal = m_FCCIParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,nDataNum,vnWriteData,TRUE);

	}
	else			// 单字节
	{
		CString strName = m_FCCIParam.m_strCmd;
		int nCmdVal = m_FCCIParam.m_nCmdVal;
		int nVCmdValue = m_FCCIParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;	// 1:OK; 2:NG
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,nDataNum,vnWriteData,FALSE);

	}

	return TRUE;


}

// 1、 FSPC：品种切换的设定，将品种切换至指定的品种No.
// 参　数	
// 		Ｐ1	１～２５０：类型编号
// 		Ｐ2	１：辅助编号：通常设定为“1”。
// 回　复
// 	   Ｒ１	－１：异常停止 ０：正常停止

// 发送：（[STX]FSPC P1 P2[ETX]）
// 回复：（[STX]FSPC R1[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcSetProductIndexFSPC( CString& strInfo,BOOL bResult )
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)		// 双字节
	{
		CString strName = m_FSPCParam.m_strCmd;
		int nCmdVal = m_FSPCParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else			// 单字节
	{
		CString strName = m_FSPCParam.m_strCmd;
		int nCmdVal = m_FSPCParam.m_nCmdVal;
		int nVCmdValue = m_FSPCParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;	// 1:OK; 2:NG
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FSPCParam.m_strCmd;
	// 	int nCmdVal = m_FSPCParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;


}
// 2、 FSSV：指定品种No.的保存，将目前使用的品种数据保存在指定的品种No.并保存在CF 记忆卡中
// 参　数	
// 		Ｐ1	０：当前使用中的类型	１～２５０：类型编号
// 		Ｐ2	１：辅助编号：通常设定为“1”。
// 回　复
// 		Ｒ１	－１：异常停止０：正常停止

// 发送：（[STX]FSSV P1 P2[ETX]）
// 回复：（[STX]FSSV R1[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcSaveProductIndexFSSV( CString& strInfo,BOOL bResult )
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)		// 双字节
	{
		CString strName = m_FSSVParam.m_strCmd;
		int nCmdVal = m_FSSVParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);


	}
	else		// 单字节
	{
		CString strName = m_FSSVParam.m_strCmd;
		int nCmdVal = m_FSSVParam.m_nCmdVal;
		int nVCmdValue = m_FSSVParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;	// 1:OK; 2:NG
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);


	}

	// 	CString strName = m_FSSVParam.m_strCmd;
	// 	int nCmdVal = m_FSSVParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}
// 3、 FGSP：品种No.的取得，取得目前正在执行的品种No.
// 参 数
// 回 复	
// 		 Ｒ１	－１：异常停止　０：正常停止
// 		 Ｒ２	１～２５０：类型编号　
// 		 Ｒ３	１：辅助编号(通常返回“1”）

// 发送：（[STX]FGSP[ETX]）
// 回复：（[STX]FGSP R1 R2 R3[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcGetProductIndexFGSP( CString& strInfo,BOOL bResult, int nCurProductIndex, int nAssitIndex /*= 1*/ )
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)		// 双字节
	{
		CString strName = m_FGSPParam.m_strCmd;
		int nCmdVal = m_FGSPParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 4;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = nCurProductIndex;
		PackPlcParam(vnWriteData[2], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = nAssitIndex;
		PackPlcParam(vnWriteData[3], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else		// 单字节
	{
		CString strName = m_FGSPParam.m_strCmd;
		int nCmdVal = m_FGSPParam.m_nCmdVal;
		int nVCmdValue = m_FGSPParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 4;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = nCurProductIndex;
		PackPlcParam(vnWriteData[2], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = nAssitIndex;
		PackPlcParam(vnWriteData[3], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FGSPParam.m_strCmd;
	// 	int nCmdVal = m_FGSPParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 4;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = nCurProductIndex;
	// 	PackPlcParam(vnWriteData[2], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = nAssitIndex;
	// 	PackPlcParam(vnWriteData[3], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackRePlcSetProductVirtualAlnFVAS( CString& strInfo,BOOL bResult )
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)		// 双字节
	{
		CString strName = m_FVASParam.m_strCmd;
		int nCmdVal = m_FVASParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else		// 单字节
	{
		CString strName = m_FVASParam.m_strCmd;
		int nCmdVal = m_FVASParam.m_nCmdVal;
		int nVCmdValue = m_FVASParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);


		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}



	return TRUE;


}


// 1.1、FTGS:目标 Mark 位置的取得，取得目标 Mark（目标）位置，目标平台轴位置一致
// 参　数	
// 			Ｐ1	    １～４  ：靶标№
// 	　　			    ５  ：靶标连续检出
// 		   　		８  ：提取目标靶标位置
// 					９  ：保存目标靶标位置
// 回 复
// 		    Ｒ１	－１：异常停止  ０：正常停止

// 发送：（[STX]FTGS P1[ETX]）
// 回复：（[STX]FTGS R1[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcTargetSearchFTGS(CString& strInfo,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FTGSParam.m_strCmd;
		int nCmdVal = m_FTGSParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FTGSParam.m_strCmd;
		int nCmdVal = m_FTGSParam.m_nCmdVal;
		int nVCmdValue = m_FTGSParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData, FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FTGSParam.m_strCmd;
	// 	int nCmdVal = m_FTGSParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}


// 3、FTGR:目标 Mark 位置的登录，将目前使用的品种数据保存在指定的品种No.中并保存在CF 记忆卡
// 参数
// 		Ｐ１ １～４：Mark No.
// 		Ｐ２ ０～５１１００：Ｘ的画素（１／１００画素单位）
// 		Ｐ３ ０～４７９００：Ｙ的画素（１／１００画素单位）
// 回复 
// 		Ｒ１  －１：异常结束 ０：正常结束

// 发送：（[STX]FTGR P1 P2 P3[ETX]）
// 回复：（[STX]FTGR R1[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcSaveTargetPosFTGR( CString& strInfo,BOOL bResult )
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FTGRParam.m_strCmd;
		int nCmdVal = m_FTGRParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FTGRParam.m_strCmd;
		int nCmdVal = m_FTGRParam.m_nCmdVal;
		int nVCmdValue = m_FTGRParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FTGRParam.m_strCmd;
	// 	int nCmdVal = m_FTGRParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}

// 4、FTGG:目标 Mark 画素的取得，取得执行“ＦＴＧＴ”结果的画素
// 参数 
// 		Ｐ１ １～４：Mark No.
// 回复 
// 		Ｒ１ －１：异常结束 ０：正常结束
// 		Ｒ２ Ｘ的画素（１００倍值）
// 		Ｒ３ Ｙ的画素（１００倍值）

// 发送：（[STX]FTGG P1[ETX]）
// 回复：（[STX]FTGG R1 R2 R3[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcGetTargetImagePosFTGG( CString& strInfo,BOOL bResult, double dImagePosX, double dImagePosY )
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	// 	CString strName = m_FTGGParam.m_strCmd;
	// 	int nCmdVal = m_FTGGParam.m_nCmdVal;
	// 	int nVCmdValue = m_FTGGParam.m_nVCmdValue;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 4;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);

	if (m_bRegType)
	{
		CString strName = m_FTGGParam.m_strCmd;
		int nCmdVal = m_FTGGParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 4;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		double dParam = 0;
		dParam = dImagePosX;
		PackPlcParam(vnWriteData[2], dParam, 2);
		dParam = dImagePosY;
		PackPlcParam(vnWriteData[3], dParam, 2);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FTGGParam.m_strCmd;
		int nCmdVal = m_FTGGParam.m_nCmdVal;
		int nVCmdValue = m_FTGGParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 4;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		double dParam = 0;
		dParam = dImagePosX;
		PackPlcParam(vnWriteData[2], dParam, 2);
		dParam = dImagePosY;
		PackPlcParam(vnWriteData[3], dParam, 2);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FTGGParam.m_strCmd;
	// 	int nCmdVal = m_FTGGParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 4;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	double dParam = 0;
	// 	dParam = dImagePosX;
	// 	PackPlcParam(vnWriteData[2], dParam, 2);
	// 	dParam = dImagePosY;
	// 	PackPlcParam(vnWriteData[3], dParam, 2);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}

// 5、FTGD:目标 Mark 指示线的全画面显示，在指定目标 Mark No.的目标 Mark 位置上显示全画面的指示线及刻度
// 参数
// 		Ｐ１  ０ ：在品种设定里所设定的显示方法
// 			  １ ～ ４：Mark No.
// 回复 
// 		Ｒ１ －１：异常结束(0)* ０：正常结束 (255)*

// 发送：（[STX]FTGD P1[ETX]）
// 回复：（[STX]FTGD R1[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcDisplayTargetFTGD( CString& strInfo,BOOL bResult )
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FTGDParam.m_strCmd;
		int nCmdVal = m_FTGDParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FTGDParam.m_strCmd;
		int nCmdVal = m_FTGDParam.m_nCmdVal;
		int nVCmdValue = m_FTGDParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FTGDParam.m_strCmd;
	// 	int nCmdVal = m_FTGDParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}

// 3、FOBG:物体 Mark 画素的取得，取得执行“ＦＯＢＪ”结果的画素
// 参数
// 		Ｐ１１～４：Mark No.
// 			５：Mark 连续搜索
// 回复		
// 		Ｒ１ －１：异常结束 ０：正常结束
// 		Ｒ２ Ｘ的画素（１００倍值）
// 		Ｒ３ Ｙ的画素（１００倍值）

// 发送：（[STX]FOBG P1[ETX]）
// 回复：（[STX]FOBG R1 R2 R3[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcGetObjectImagePosFOBG( CString& strInfo,BOOL bResult, double dImagePosX, double dImagePosY )
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FOBGParam.m_strCmd;
		int nCmdVal = m_FOBGParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 4;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		double dParam = 0;
		dParam = dImagePosX;
		PackPlcParam(vnWriteData[2], dParam, 2);
		dParam = dImagePosY;
		PackPlcParam(vnWriteData[3], dParam, 2);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FOBGParam.m_strCmd;
		int nCmdVal = m_FOBGParam.m_nCmdVal;
		int nVCmdValue = m_FOBGParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 4;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		double dParam = 0;
		dParam = dImagePosX;
		PackPlcParam(vnWriteData[2], dParam, 2);
		dParam = dImagePosY;
		PackPlcParam(vnWriteData[3], dParam, 2);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FOBGParam.m_strCmd;
	// 	int nCmdVal = m_FOBGParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 4;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	double dParam = 0;
	// 	dParam = dImagePosX;
	// 	PackPlcParam(vnWriteData[2], dParam, 2);
	// 	dParam = dImagePosY;
	// 	PackPlcParam(vnWriteData[3], dParam, 2);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}
// 4、FMSC:手动搜索位置的取得，在自动对准时，当目标 Mark 或物体 Mark 搜索失败时，可利用手动方法（鼠标）指定Mark 位置
// 参数
// 		Ｐ１   0：目标 Mark 1：物体 Mark
// 回复 
// 		Ｒ１   －１：异常结束 (0)*   ０：正常结束 (255)*  １：取消结束

// 发送：（[STX]FMSC P1[ETX]）
// 回复：（[STX]FMSC R1[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcManualSearchFMSC( CString& strInfo,BOOL bResult )
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FMSCParam.m_strCmd;
		int nCmdVal = m_FMSCParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FMSCParam.m_strCmd;
		int nCmdVal = m_FMSCParam.m_nCmdVal;
		int nVCmdValue = m_FMSCParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FMSCParam.m_strCmd;
	// 	int nCmdVal = m_FMSCParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}
// 5、FWLD：取得目标（目标靶标）或对象（对象靶标）的平台坐标上的位置
// 参　数	
// 		Ｐ１	０：目标 靶标 １：对象 靶标
// 		Ｐ２	１～４：靶标№
// 回 复
// 		Ｒ１	－１：异常停止	　０：正常停止
// 		Ｒ２	-2147483648～2147483647（1/10000mm单位）：Ｘ方向的平台座标位置
// 		 Ｒ３	-2147483648～2147483647（1/10000mm单位）：Ｙ方向的平台座标位置

// 发送：（[STX]FWLD P1 P2[ETX]）
// 回复：（[STX]FWLD R1 R2 R3[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcGetSearchWorldPosFWLD( CString& strInfo,BOOL bResult, double dPlatPosX, double dPlatPosY )
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FWLDParam.m_strCmd;
		int nCmdVal = m_FWLDParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 4;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		double dParam = 0;
		dParam = dPlatPosX;
		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = dPlatPosY;
		PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommYUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FWLDParam.m_strCmd;
		int nCmdVal = m_FWLDParam.m_nCmdVal;
		int nVCmdValue = m_FWLDParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 4;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		double dParam = 0;
		dParam = dPlatPosX;
		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = dPlatPosY;
		PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommYUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FWLDParam.m_strCmd;
	// 	int nCmdVal = m_FWLDParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 4;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	double dParam = 0;
	// 	dParam = dPlatPosX;
	// 	PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 	dParam = dPlatPosY;
	// 	PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}



// 打包FWLD轴位置（平台坐标）
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFWLDAxisPos(CString& strInfo,CCoordPos platOffset,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FWLDParam.m_strCmd;
		int nCmdVal = m_FWLDParam.m_nCmdVal;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);		// 寄存器地址
		int  nDataNum = 2;														// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		double dParam = 0;
		dParam = platOffset.m_dPosX;
		PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = platOffset.m_dPosY;
		PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		// 		dParam = platOffset.m_dAngle;
		// 		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FWLDParam.m_strCmd;
		int nCmdVal = m_FWLDParam.m_nCmdVal;
		int nVCmdValue = m_FWLDParam.m_nVCmdValue;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD);	// 寄存器地址
		int  nDataNum = 2;															// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		double dParam = 0;
		dParam = platOffset.m_dPosX;
		PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = platOffset.m_dPosY;
		PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		// 		dParam = platOffset.m_dAngle;
		// 		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}

	return TRUE;
}

// 打包FWLD结果
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFWLD(CString& strInfo, BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FWLDParam.m_strCmd;
		int nCmdVal = m_FWLDParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);		// 寄存器地址
		int  nDataNum = 2;													// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FWLDParam.m_strCmd;
		int nCmdVal = m_FWLDParam.m_nCmdVal;
		int nVCmdValue = m_FWLDParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;														// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackRePlcGetAlignPrecisionFGALAxisPos(CString& strInfo,BOOL bResult, CCoordPos cpAlignPrecision)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FGALParam.m_strCmd;
		int nCmdVal = m_FGALParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_BACKUP);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		double dParam = 0;
		dParam = cpAlignPrecision.m_dPosX;
		PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = cpAlignPrecision.m_dPosY;
		PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		dParam = cpAlignPrecision.m_dAngle;
		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else
	{
		CString strName = m_FGALParam.m_strCmd;
		int nCmdVal = m_FGALParam.m_nCmdVal;
		int nVCmdValue = m_FGALParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_BACKUP_WORD);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		double dParam = 0;
		dParam = cpAlignPrecision.m_dPosX;
		PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = cpAlignPrecision.m_dPosY;
		PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		dParam = cpAlignPrecision.m_dAngle;
		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}

	return TRUE;
}

// 1、FGAL:对准精度判定设定的取得，取得对准精度的判定设定
// 参数 
// 		Ｐ１ ０：对准精度判定取得 １：最终精度判定取得
// 回复	
// 		Ｒ１ －１：异常结束 	０：正常结束
// 		Ｒ２ －2147483648～2147483647（ｍｍ单位，１００００倍值） ：Ｘ方向精度值
// 		Ｒ３ －2147483648～2147483647（ｍｍ单位，１００００倍值） ：Ｙ方向精度值 
// 		Ｒ４ －2147483648～2147483647（度单位，１０００００倍值） ：θ方向精度值

// 发送：（[STX]FGAL P1[ETX]）
// 回复：（[STX]FGAL R1 R2 R3 R4[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcGetAlignPrecisionFGAL(CString& strInfo,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FGALParam.m_strCmd;
		int nCmdVal = m_FGALParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FGALParam.m_strCmd;
		int nCmdVal = m_FGALParam.m_nCmdVal;
		int nVCmdValue = m_FGALParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FGALParam.m_strCmd;
	// 	int nCmdVal = m_FGALParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 5;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	double dParam = 0;
	// 	dParam = cpAlignPrecision.m_dPosX;
	// 	PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 	dParam = cpAlignPrecision.m_dPosY;
	// 	PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 	dParam = cpAlignPrecision.m_dAngle;
	// 	PackPlcParam(vnWriteData[4], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}
// 2、FALL:对准精度判定的更新，更新对准时的对准精度的判定
// 参数
// 		Ｐ１  ０：设定对准精度的判定   １：设定最终对准精度判定
// 		Ｐ２ Ｘ（１／１００００ｍm 单位）
// 		Ｐ３ Ｙ（１／１００００ｍｍ单位）
// 		Ｐ４ θ（１／１０００００度单位）
// 回复
// 		Ｒ１  －１：异常结束 ０：正常结束

// 发送：（[STX]FALL P1 P2 P3 P4[ETX]）
// 回复：（[STX]FALL R1[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcSetAlignPrecisionFALL( CString& strInfo,BOOL bResult )
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FALLParam.m_strCmd;
		int nCmdVal = m_FALLParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FALLParam.m_strCmd;
		int nCmdVal = m_FALLParam.m_nCmdVal;
		int nVCmdValue = m_FALLParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData, FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FALLParam.m_strCmd;
	// 	int nCmdVal = m_FALLParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}
// 3、FGAC:对准最多次数的取得，取得设定对准最多次数
// 参数
// 回复 
// 		Ｒ１ －１：异常结束 ０：正常结束
// 		Ｒ２ １～１０：对准最多对准次数

// 发送：（[STX]FGAC[ETX]）
// 回复：（[STX]FGAC R1 R2[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcGetAlignTimeFGAC( CString& strInfo,BOOL bResult, int nAlignTime )
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FGACParam.m_strCmd;
		int nCmdVal = m_FGACParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = nAlignTime;
		PackPlcParam(vnWriteData[2], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FGACParam.m_strCmd;
		int nCmdVal = m_FGACParam.m_nCmdVal;
		int nVCmdValue = m_FGACParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = nAlignTime;
		PackPlcParam(vnWriteData[2], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FGACParam.m_strCmd;
	// 	int nCmdVal = m_FGACParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 3;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = nAlignTime;
	// 	PackPlcParam(vnWriteData[2], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}
// 4、FALC:对准最多次数的更新，执行自动对准时，容许最多对准次数的更新
// 参数 
// 		Ｐ１ １～１０：设定最多对准次数
// 回复 
// 		Ｒ１  －１：异常结束  ０：正常结束

// 发送：（[STX]FALC P1[ETX]）
// 回复：（[STX]FALC R1[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcSetAlignTimeFALC( CString& strInfo,BOOL bResult )
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FALCParam.m_strCmd;
		int nCmdVal = m_FALCParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FALCParam.m_strCmd;
		int nCmdVal = m_FALCParam.m_nCmdVal;
		int nVCmdValue = m_FALCParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FALCParam.m_strCmd;
	// 	int nCmdVal = m_FALCParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}

// 6、FANS:对准后的偏移量的取得，取得对准后平台坐标系的偏移量
// 参数 －
// 回复
// 		Ｒ１		－１：异常结束  ０：正常结束
// 		Ｒ２ －2147483648～2147483647 Ｘ方向的偏移量（１／10000mm 单位）
// 		Ｒ３ －2147483648～2147483647 Ｙ方向的偏移量（１／10000mm 单位）
// 		Ｒ４ －2147483648～2147483647 θ方向的偏移量（１／100000 度单位）
// （获取对位完成后的偏差量）

// 发送：（[STX]FANS[ETX]）
// 回复：（[STX]FANS R1 R2 R3 R4[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcGetAutoAlignOffsetFANS( CString& strInfo,BOOL bResult, CCoordPos cpPlatOffset )
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FANSParam.m_strCmd;
		int nCmdVal = m_FANSParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 5;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);


		double dParam = 0;
		dParam = cpPlatOffset.m_dPosX;
		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = cpPlatOffset.m_dPosY;
		PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		dParam = cpPlatOffset.m_dAngle;
		PackPlcParam(vnWriteData[4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FANSParam.m_strCmd;
		int nCmdVal = m_FANSParam.m_nCmdVal;
		int nVCmdValue = m_FANSParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 5;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);


		double dParam = 0;
		dParam = cpPlatOffset.m_dPosX;
		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = cpPlatOffset.m_dPosY;
		PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		dParam = cpPlatOffset.m_dAngle;
		PackPlcParam(vnWriteData[4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FANSParam.m_strCmd;
	// 	int nCmdVal = m_FANSParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 5;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 
	// 	double dParam = 0;
	// 	dParam = cpPlatOffset.m_dPosX;
	// 	PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 	dParam = cpPlatOffset.m_dPosY;
	// 	PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 	dParam = cpPlatOffset.m_dAngle;
	// 	PackPlcParam(vnWriteData[4], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}

// 8、FALJ:1:次对准精度判定与对准移动量的取得，对准移动量是否在对准精度内的判定与对准移动量的取得
// 参数
// 		Ｐ１	０：不参照补偿量值（补偿量值为０）
// 			１：参照内部补偿量值（参照参数设定值）
// 			５：参照外部补偿量值（参照“ＦＯＦＳ”设定值）
// 			６：参照外部补偿量值（参照取得的自动补偿量值）
// 
// 			Ｐ２ ０：参照对准精度判定值
// 			    １：参照最终对准精度判定值（无效时请参照对准精度判定值）
// 回复
// 		Ｒ１ －１：异常结束 ０：正常结束
// 				ＸＹθ轴平台时
// 		Ｒ２ －2147483648～2147483647（１／１００００ｍｍ单位）：Ｘ轴的~对值移动量
// 		Ｒ３ －2147483648～2147483647（１／１００００ｍｍ单位）：Ｙ轴的~对值移动量
// 		Ｒ４ －2147483648～2147483647（１／１０００００度单位）：θ轴的~对值移动量
// 			ＵＶＷ轴平台时
// 		Ｒ２ －2147483648～2147483647（１／１００００ｍｍ单位）：U 轴的~对值移动量
// 		Ｒ３ －2147483648～2147483647（１／１００００ｍｍ单位）：V 轴的~对值移动量
// 		Ｒ４ －2147483648～2147483647（１／１００００ｍｍ单位）：W 轴的~对值移动量
//（取得一次对位指令后平台移动量，根据已经获得的目标，然后拍摄对象的位置进行对位计算，获得相应的平台移动量
//（注：目标已经通过其他指令获得，但对象还未获得；非迭代执行，也就是此过程中不会再二次检查对象位置））

// 发送：（[STX]FALJ P1[ETX]）
// 回复：（[STX]FALJ R1 R2 R3 R4[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcOnceAlignFALJ( CString& strInfo,BOOL bResult, CPlatformAxisPos* vpPlatAxisPos )
{

	if (NULL == vpPlatAxisPos)
	{
		return FALSE;
	}

	if (vpPlatAxisPos->GetPlatformType()!=ePlatformXYD)
	{
		return FALSE;
	}

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FALJParam.m_strCmd;
		int nCmdVal = m_FALJParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 5;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	

		double dParam = 0;
		dParam = pPlatformXYDAixisPos->m_dPosX;
		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = pPlatformXYDAixisPos->m_dPosY;
		PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		dParam = pPlatformXYDAixisPos->m_dAngle;
		PackPlcParam(vnWriteData[4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FALJParam.m_strCmd;
		int nCmdVal = m_FALJParam.m_nCmdVal;
		int nVCmdValue = m_FALJParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 5;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	

		double dParam = 0;
		dParam = pPlatformXYDAixisPos->m_dPosX;
		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = pPlatformXYDAixisPos->m_dPosY;
		PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		dParam = pPlatformXYDAixisPos->m_dAngle;
		PackPlcParam(vnWriteData[4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FALJParam.m_strCmd;
	// 	int nCmdVal = m_FALJParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 5;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	// 	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	// 
	// 	double dParam = 0;
	// 	dParam = pPlatformXYDAixisPos->m_dPosX;
	// 	PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 	dParam = pPlatformXYDAixisPos->m_dPosY;
	// 	PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 	dParam = pPlatformXYDAixisPos->m_dAngle;
	// 	PackPlcParam(vnWriteData[4], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}

// 1、FAOF:自动补偿量值的取得，对准偏移量以补偿量值取得
// 参数
// 		Ｐ１	０：不参照补偿量值（补偿量值为０）
// 			１：参照内部补偿量值（参照参数设定值）
// 			５：参照外部补偿量值（参照“ＦＯＦＳ”设定值）
// 			６：参照外部补偿量值（参照取得的自动补偿量值）
// 回复 
// 		Ｒ１	－１：异常结束 (255)*	０：正常结束 (0)*

// 发送：（[STX]FAOF P1[ETX]）
// 回复：（[STX]FAOF R1[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcCalcuAlignOffsetFAOF( CString& strInfo,BOOL bResult )
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FAOFParam.m_strCmd;
		int nCmdVal = m_FAOFParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FAOFParam.m_strCmd;
		int nCmdVal = m_FAOFParam.m_nCmdVal;
		int nVCmdValue = m_FAOFParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FAOFParam.m_strCmd;
	// 	int nCmdVal = m_FAOFParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}
// 2、FGOF:补偿量值的取得，取得设定的补偿量值
// 参数
// 		Ｐ１０：取得最后使用的补偿量值。（最后下达ＦＡＡＬ，ＦＡＬＧ，ＦＡＬＪ，ＦＡＯＦ，ＦＡＣＯ的其中一个指令时所使用的补偿量值。
// 		       但ＦＡＣＯ下达时会自动设定无补偿量，因此在下达ＦＡＣＯ后得到的回复为（Ｒ２，Ｒ３，Ｒ４）＝（０，０，０））。
// 			１：内部补偿量值（取得参数设定值）
// 			５：外部补偿量值（取得在“FOFS”的设定值）
// 			６：外部补偿量值（取得在“FAOF”指令所取得的自动补偿量值）
// 回复
// 		Ｒ１－１：异常结束 ０：正常结束
// 		Ｒ２ －2147483648～2147483647（mm 单位，１００００倍值）：Ｘ方向的补偿量值
// 		Ｒ３ －2147483648～2147483647（ｍｍ单位，１００００倍值）：Ｙ方向的补偿量值
// 		Ｒ４ －2147483648～2147483647（度单位，１０００００倍值）：θ方向的补偿量值

// 发送：（[STX]FGOF P1[ETX]）
// 回复：（[STX]FGOF R1 R2 R3 R4[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcGetAlignOffsetFGOF( CString& strInfo,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FGOFParam.m_strCmd;
		int nCmdVal = m_FGOFParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FGOFParam.m_strCmd;
		int nCmdVal = m_FGOFParam.m_nCmdVal;
		int nVCmdValue = m_FGOFParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);
	}

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackRePlcGetAlignOffsetFGOFAxisPos(CString& strInfo,BOOL bResult, CCoordPos cpAlignOffset)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FGOFParam.m_strCmd;
		int nCmdVal = m_FGOFParam.m_nCmdVal;
		int nVCmdValue = m_FGOFParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_BACKUP);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		double dParam = 0;
		dParam = cpAlignOffset.m_dPosX;
		PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = cpAlignOffset.m_dPosY;
		PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		dParam = cpAlignOffset.m_dAngle;
		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else
	{
		CString strName = m_FGOFParam.m_strCmd;
		int nCmdVal = m_FGOFParam.m_nCmdVal;
		int nVCmdValue = m_FGOFParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_BACKUP_WORD);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		double dParam = 0;
		dParam = cpAlignOffset.m_dPosX;
		PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = cpAlignOffset.m_dPosY;
		PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		dParam = cpAlignOffset.m_dAngle;
		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}

	return TRUE;
}

// 3、FOFS:补偿量值的设定，设定补偿量值
// 参数
// 		Ｐ１ －2147483648～2147483647（１／１００００ｍｍ单位）：Ｘ方向的补偿量值
// 		Ｐ２ －2147483648～2147483647（１／１００００ｍｍ单位）：Ｙ方向的补偿量值
// 		Ｐ３ －2147483648～2147483647（１／１０００００度单位）：θ方向的补偿量值
// 回复 
// 		Ｒ１－１：异常结束 ０：正常结束

// 发送：（[STX]FOFS P1 P2 P3[ETX]）
// 回复：（[STX]FOFS R1[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcSetAlignOffsetFOFS( CString& strInfo,BOOL bResult )
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FOFSParam.m_strCmd;
		int nCmdVal = m_FOFSParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);


		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FOFSParam.m_strCmd;
		int nCmdVal = m_FOFSParam.m_nCmdVal;
		int nVCmdValue = m_FOFSParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);


		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FOFSParam.m_strCmd;
	// 	int nCmdVal = m_FOFSParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}
// 4、FSFT:平台Shift 移动动作，选择内部转移量的设定值，并依照设定值将目前平台的位置做相对移动
// 参数
// 		Ｐ１ ０ ：不参照移动值（移动值为０）
// 			 １～３：参照内部移动值（参照参数设定值）
// 回复 
// 		Ｒ１ －１：异常结束(255)* ０：正常结束 (0)*

// 发送：（[STX]FSFT P1[ETX]）
// 回复：（[STX]FSFT R1[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcFSFT( CString& strInfo,BOOL bResult )
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FSFTParam.m_strCmd;
		int nCmdVal = m_FSFTParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);


		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FSFTParam.m_strCmd;
		int nCmdVal = m_FSFTParam.m_nCmdVal;
		int nVCmdValue = m_FSFTParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);


		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FSFTParam.m_strCmd;
	// 	int nCmdVal = m_FSFTParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}
// 5、FGSF:对准Shift 移动量的取得，取得对准转移量
// 参数
// 		Ｐ１０ ：不参照移动值（移动值为０）
// 				１～３：参照内部移动值（参照参数设定值）
// 回复
// 		Ｒ１－１：异常结束 ０：正常结束
// 					ＸＹθ轴平台时
// 		Ｒ２ －2147483648～2147483647（１／１００００ｍｍ单位）：Ｘ轴的~对值移动量
// 		Ｒ３ －2147483648～2147483647（１／１００００ｍｍ单位）：Ｙ轴的~对值移动量
// 		Ｒ４ －2147483648～2147483647（１／１０００００度单位）：θ轴的~对值移动量
// 					ＵＶＷ轴平台时
// 		Ｒ２ －2147483648～2147483647（１／１００００ｍｍ单位）：U 轴的~对值移动量
// 		Ｒ３ －2147483648～2147483647（１／１００００ｍｍ单位）：V 轴的~对值移动量
// 		Ｒ４ －2147483648～2147483647（１／１００００ｍｍ单位）：W 轴的~对值移动量

// 发送：（[STX]FGSF P1[ETX]）
// 回复：（[STX]FGSF R1 R2 R3 R4[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcFGSF( CString& strInfo,BOOL bResult, CPlatformAxisPos* vpPlatAxisPos )
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FGSFParam.m_strCmd;
		int nCmdVal = m_FGSFParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 5;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	

		double dParam = 0;
		dParam = pPlatformXYDAixisPos->m_dPosX;
		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = pPlatformXYDAixisPos->m_dPosY;
		PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		dParam = pPlatformXYDAixisPos->m_dAngle;
		PackPlcParam(vnWriteData[4], dParam, m_CommProtocolParam.m_nCommDUnitExp);


		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FGSFParam.m_strCmd;
		int nCmdVal = m_FGSFParam.m_nCmdVal;
		int nVCmdValue = m_FGSFParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 5;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	

		double dParam = 0;
		dParam = pPlatformXYDAixisPos->m_dPosX;
		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = pPlatformXYDAixisPos->m_dPosY;
		PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		dParam = pPlatformXYDAixisPos->m_dAngle;
		PackPlcParam(vnWriteData[4], dParam, m_CommProtocolParam.m_nCommDUnitExp);


		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FGSFParam.m_strCmd;
	// 	int nCmdVal = m_FGSFParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 5;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 
	// 	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	// 	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	// 
	// 	double dParam = 0;
	// 	dParam = pPlatformXYDAixisPos->m_dPosX;
	// 	PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 	dParam = pPlatformXYDAixisPos->m_dPosY;
	// 	PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 	dParam = pPlatformXYDAixisPos->m_dAngle;
	// 	PackPlcParam(vnWriteData[4], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}
// 1、FALM:Alarm资料的取得，取得错误发生的数据代码
// 参数 －
// 回复 
// 		Ｒ１ ０：没有错误  －５０～－２５０：错误代码
// 		Ｒ２ 仿真数据。（通常设定为“－１”）

// 发送：（[STX]FALM[ETX]）
// 回复：（[STX]FALM R1 R2[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcGetAlarmFALM( CString& strInfo,int nAlarmIndex, int nSimData /*= -1*/ )
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FALMParam.m_strCmd;
		int nCmdVal = m_FALMParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = nAlarmIndex;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = nSimData;
		PackPlcParam(vnWriteData[2], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FALMParam.m_strCmd;
		int nCmdVal = m_FALMParam.m_nCmdVal;
		int nVCmdValue = m_FALMParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = nAlarmIndex;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = nSimData;
		PackPlcParam(vnWriteData[2], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FALMParam.m_strCmd;
	// 	int nCmdVal = m_FALMParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 3;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = nAlarmIndex;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = nSimData;
	// 	PackPlcParam(vnWriteData[2], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}

// 3、FSAC：保存校正、定位时的数据。所保存的数据为最近500次操作时的数据（不到500次时保存实际次数的数据）
// 参　数	－	
// 回 复
// 		Ｒ１	－１：异常停止 　０：正常停止
// 发送：（[STX]FSAC[ETX]）
// 回复：（[STX]FSAC R1[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcSaveProcessDataFSAC( CString& strInfo,BOOL bResult )
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FSACParam.m_strCmd;
		int nCmdVal = m_FSACParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FSACParam.m_strCmd;
		int nCmdVal = m_FSACParam.m_nCmdVal;
		int nVCmdValue = m_FSACParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}


	// 	CString strName = m_FSACParam.m_strCmd;
	// 	int nCmdVal = m_FSACParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}

// 4、FSCO：保存指令收发的历史纪录。所保存的数据为最近500次操作时的数据（不到500次时保存实际次数的数据）
// 参　数	－	
// 回 复
// 		Ｒ１	－１：异常停止 　０：正常停止
// 发送：（[STX]FSCO[ETX]）
// 回复：（[STX]FSCO R1[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcSaveCommDataFSCO( CString& strInfo,BOOL bResult )
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FSCOParam.m_strCmd;
		int nCmdVal = m_FSCOParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FSCOParam.m_strCmd;
		int nCmdVal = m_FSCOParam.m_nCmdVal;
		int nVCmdValue = m_FSCOParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FSCOParam.m_strCmd;
	// 	int nCmdVal = m_FSCOParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}


// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FRST[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcResetFRST( CString& strInfo, BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FRSTParam.m_strCmd;
		int nCmdVal = m_FRSTParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 1;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FRSTParam.m_strCmd;
		int nCmdVal = m_FRSTParam.m_nCmdVal;
		int nVCmdValue = m_FRSTParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 1;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FRSTParam.m_strCmd;
	// 	int nCmdVal = m_FRSTParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 1;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}
// 打包“特殊通讯握手”指令: （[STX]FCHK[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcCommFCHK( CString& strInfo, BOOL bResult)
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FCHKParam.m_strCmd;
		int nCmdVal = m_FCHKParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 1;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FCHKParam.m_strCmd;
		int nCmdVal = m_FCHKParam.m_nCmdVal;
		int nVCmdValue = m_FCHKParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 1;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FCHKParam.m_strCmd;
	// 	int nCmdVal = m_FCHKParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 1;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}
BOOL CCommProtocolXYDFast::PackPlcGetDmCodeBoardAbsPos(CString& strInfo)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}	

	if (m_bRegType)		// 双字节
	{
		int nParam = 0;
		long nRegAdrr = m_nPLCTempBaseRegAddr;	// 寄存器地址
		int  nDataNum = 85;													// 数据量

		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nDataNum))
		{
			return FALSE;
		}

		SetReadRegTranslateResultInfo(nRegAdrr,nDataNum,TRUE);

	}
	else				// 单字节
	{
		int nParam = 0;
		long nRegAdrr = m_nPLCTempBaseRegAddr;	// 寄存器地址
		int  nDataNum = 85;													// 数据量

		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nDataNum, TRUE))
		{
			return FALSE;
		}
		SetReadRegTranslateResultInfo(nRegAdrr,nDataNum,TRUE);

	}
	return TRUE;
}
BOOL CCommProtocolXYDFast::PackPlcGetBoardPosForTarFixOffset(CString& strInfo)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}	

	if (m_bRegType)		// 双字节
	{
		CString strName = m_FAFOParam.m_strCmd;
		int nCmdVal = m_FAFOParam.m_nCmdVal;
		int nParam = 0;
		long nRegAdrr = m_nPLCTempBaseRegAddr;	// 寄存器地址
		int  nDataNum = 45;													// 数据量

		m_strCmdName = strName;	
		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nDataNum))
		{
			return FALSE;
		}

		SetReadRegTranslateResultInfo(nRegAdrr,nDataNum,TRUE);

	}
	else				// 单字节
	{
		CString strName = m_FAFOParam.m_strCmd;
		int nCmdVal = m_FAFOParam.m_nCmdVal;
		int nVCmdValue = m_FAFOParam.m_nVCmdValue;
		int nParam = 0;
		long nRegAdrr = m_nPLCTempBaseRegAddr;	// 寄存器地址
		int  nDataNum = 45;													// 数据量
		m_strCmdName = strName;	


		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nDataNum, TRUE))
		{
			return FALSE;
		}
		SetReadRegTranslateResultInfo(nRegAdrr,nDataNum,TRUE);

	}
	return TRUE;
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswPlcGetBoardPosForTarFixOffset(CString strAsw,std::vector<int> &vnPosIndex, std::vector<CCoordPos> &vBoardPos)
{
	// 解析字符串
	if (m_bRegType)
	{
		int  nDataNum = 45;														// 数据量
		std::vector<int> vnReceivedData;
		if (!m_pCommProRegBase->AnalyzeAswReadReg(strAsw, nDataNum, vnReceivedData))
		{
			return eAswCmdErr;
		}

		if (vnReceivedData.size() != nDataNum)
		{
			return eAswCmdErr;
		}

		int nPosNum = vnReceivedData[0];
		double dBase = 10;
		CCoordPos pos;
		for (int i=0;i<nPosNum;i++)
		{		
			vnPosIndex.push_back(vnReceivedData[1+nPosNum*8+i*3]);
			pos.m_dPosX = ((double)(vnReceivedData[2+nPosNum*8+i*3]))/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			pos.m_dPosY  = ((double)(vnReceivedData[3+nPosNum*8+i*3]))/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			vBoardPos.push_back(pos);
		}

		SetAnalyzeAswReadRegTransInfo(nDataNum,vnReceivedData,TRUE);

		return eAswSucceed;
	}
	else
	{
		int  nDataNum = 45;														// 数据量
		std::vector<int> vnReceivedData;
		if (!m_pCommProRegBase->AnalyzeAswReadReg(strAsw, nDataNum, vnReceivedData,TRUE))
		{
			return eAswCmdErr;
		}

		if (vnReceivedData.size() != nDataNum)
		{
			return eAswCmdErr;
		}

		int nPosNum = vnReceivedData[0];
		double dBase = 10;
		CCoordPos pos;
		for (int i=0;i<nPosNum;i++)
		{		
			vnPosIndex.push_back(vnReceivedData[1+nPosNum*8+i*3]);
			pos.m_dPosX = ((double)(vnReceivedData[2+nPosNum*8+i*3]))/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			pos.m_dPosY  = ((double)(vnReceivedData[3+nPosNum*8+i*3]))/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			vBoardPos.push_back(pos);
		}

		SetAnalyzeAswReadRegTransInfo(nDataNum,vnReceivedData,TRUE);

		return eAswSucceed;
	}
}

CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswPlcGetDmCodeBoardAbsPos(CString strAsw,std::vector<int> &vnPosIndex,std::vector<CCoordPos> &vImageSize, std::vector<CCoordPos> &vBoardPos)
{
	// 解析字符串
	if (m_bRegType)
	{
		int  nDataNum = 85;														// 数据量
		std::vector<int> vnReceivedData;
		if (!m_pCommProRegBase->AnalyzeAswReadReg(strAsw, nDataNum, vnReceivedData))
		{
			return eAswCmdErr;
		}

		if (vnReceivedData.size() != nDataNum)
		{
			return eAswCmdErr;
		}

		int nPosNum = vnReceivedData[0];
		double dBase = 10;
		CCoordPos pos;
		sc2Vector imageSize;
		for (int i=0;i<nPosNum;i++)
		{		
			vnPosIndex.push_back(vnReceivedData[1+i*(2*GUANLIANBOARDNUM+3)]);
			imageSize.SetX(vnReceivedData[2+i*(2*GUANLIANBOARDNUM+3)]);
			imageSize.SetY(vnReceivedData[3+i*(2*GUANLIANBOARDNUM+3)]);
			pos.SetPos(imageSize);
			vImageSize.push_back(pos);
			for (int j=0;j<GUANLIANBOARDNUM;j++)
			{
				pos.m_dPosX = ((double)(vnReceivedData[4+j*2+i*(2*GUANLIANBOARDNUM+3)]))/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
				pos.m_dPosY  = ((double)(vnReceivedData[5+j*2+i*(2*GUANLIANBOARDNUM+3)]))/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
				vBoardPos.push_back(pos);
			}
		}

		SetAnalyzeAswReadRegTransInfo(nDataNum,vnReceivedData,TRUE);

		return eAswSucceed;
	}
	else
	{
		int  nDataNum = 85;														// 数据量
		std::vector<int> vnReceivedData;
		if (!m_pCommProRegBase->AnalyzeAswReadReg(strAsw, nDataNum, vnReceivedData,TRUE))
		{
			return eAswCmdErr;
		}

		if (vnReceivedData.size() != nDataNum)
		{
			return eAswCmdErr;
		}

		int nPosNum = vnReceivedData[0];
		double dBase = 10;
		CCoordPos pos;
		sc2Vector imageSize;
		for (int i=0;i<nPosNum;i++)
		{		
			vnPosIndex.push_back(vnReceivedData[1+i*(2*GUANLIANBOARDNUM+3)]);
			imageSize.SetX(vnReceivedData[2+i*(2*GUANLIANBOARDNUM+3)]);
			imageSize.SetY(vnReceivedData[3+i*(2*GUANLIANBOARDNUM+3)]);
			pos.SetPos(imageSize);
			vImageSize.push_back(pos);
			for (int j=0;j<GUANLIANBOARDNUM;j++)
			{
				pos.m_dPosX = ((double)(vnReceivedData[4+j*2+i*(2*GUANLIANBOARDNUM+3)]))/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
				pos.m_dPosY  = ((double)(vnReceivedData[5+j*2+i*(2*GUANLIANBOARDNUM+3)]))/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
				vBoardPos.push_back(pos);
			}
		}

		SetAnalyzeAswReadRegTransInfo(nDataNum,vnReceivedData,TRUE);

		return eAswSucceed;
	}
}
BOOL CCommProtocolXYDFast::PackPlcGetTargetImagePos(CString& strInfo)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}	

	if (m_bRegType)		// 双字节
	{
		CString strName = m_FAFOParam.m_strCmd;
		int nCmdVal = m_FAFOParam.m_nCmdVal;
		int nParam = 0;
		long nRegAdrr = m_nPLCTempBaseRegAddr /*+ atoi(RREG_VISION_PLATFORM_TEMP_POS)*/;	// 寄存器地址
		int  nDataNum = 41;													// 数据量

		m_strCmdName = strName;	
		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nDataNum))
		{
			return FALSE;
		}

		SetReadRegTranslateResultInfo(nRegAdrr,nDataNum,TRUE);

	}
	else				// 单字节
	{
		CString strName = m_FAFOParam.m_strCmd;
		int nCmdVal = m_FAFOParam.m_nCmdVal;
		int nVCmdValue = m_FAFOParam.m_nVCmdValue;
		int nParam = 0;
		long nRegAdrr = m_nPLCTempBaseRegAddr /*+ atoi(RREG_VISION_PLATFORM_TEMP_POS)*/;	// 寄存器地址
		int  nDataNum = 41;													// 数据量
		m_strCmdName = strName;	


		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nDataNum, TRUE))
		{
			return FALSE;
		}
		SetReadRegTranslateResultInfo(nRegAdrr,nDataNum,TRUE);

	}
	return TRUE;
}
BOOL CCommProtocolXYDFast::PackPlcGetTargetPlatformPos(CString& strInfo)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}	

	if (m_bRegType)		// 双字节
	{
		CString strName = m_FAFOParam.m_strCmd;
		int nCmdVal = m_FAFOParam.m_nCmdVal;
		int nParam = 0;
		long nRegAdrr = m_nPLCTempBaseRegAddr /*+ atoi(RREG_VISION_PLATFORM_TEMP_POS)*/;	// 寄存器地址
		int  nDataNum = 33;													// 数据量

		m_strCmdName = strName;	
		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nDataNum))
		{
			return FALSE;
		}

		SetReadRegTranslateResultInfo(nRegAdrr,nDataNum,TRUE);

	}
	else				// 单字节
	{
		CString strName = m_FAFOParam.m_strCmd;
		int nCmdVal = m_FAFOParam.m_nCmdVal;
		int nVCmdValue = m_FAFOParam.m_nVCmdValue;
		int nParam = 0;
		long nRegAdrr = m_nPLCTempBaseRegAddr /*+ atoi(RREG_VISION_PLATFORM_TEMP_POS)*/;	// 寄存器地址
		int  nDataNum = 33;													// 数据量
		m_strCmdName = strName;	


		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nDataNum, TRUE))
		{
			return FALSE;
		}
		SetReadRegTranslateResultInfo(nRegAdrr,nDataNum,TRUE);

	}
	return TRUE;
}

CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswPlcGetTargetImagePos(CString strAsw,std::vector<int> &vnPosIndex, std::vector<CCoordPos> &vImagePos,std::vector<CPlatformXYDAxisPos> &vPlatformAxis)
{
	// 解析字符串
	if (m_bRegType)
	{
		int  nDataNum = 41;														// 数据量
		std::vector<int> vnReceivedData;
		if (!m_pCommProRegBase->AnalyzeAswReadReg(strAsw, nDataNum, vnReceivedData))
		{
			return eAswCmdErr;
		}

		if (vnReceivedData.size() != nDataNum)
		{
			return eAswCmdErr;
		}

		int nPosNum = vnReceivedData[0];
		double dBase = 10;
		CCoordPos pos;
		for (int i=0;i<nPosNum;i++)
		{		
			vnPosIndex.push_back(vnReceivedData[1+i*7]);
			pos.m_dPosX = ((double)(vnReceivedData[2+i*7]))/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			pos.m_dPosY  = ((double)(vnReceivedData[3+i*7]))/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			pos.m_vdAuxiliaryPosX.at(0) = ((double)(vnReceivedData[4+i*7]))/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			pos.m_vdAuxiliaryPosY.at(0)  = ((double)(vnReceivedData[5+i*7]))/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			pos.m_vdAuxiliaryPosX.at(1) = ((double)(vnReceivedData[6+i*7]))/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			pos.m_vdAuxiliaryPosY.at(1)  = ((double)(vnReceivedData[7+i*7]))/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			vImagePos.push_back(pos);
		}

		CPlatformXYDAxisPos axisPos;
		for (int i=0;i<nPosNum;i++)
		{
			axisPos.m_dPosX = ((double)(vnReceivedData[2+nPosNum*7+i*3]))/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			axisPos.m_dPosY  = ((double)(vnReceivedData[3+nPosNum*7+i*3]))/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			vPlatformAxis.push_back(axisPos);
		}

		return eAswSucceed;
	}
	else
	{
		int  nDataNum = 41;														// 数据量
		std::vector<int> vnReceivedData;
		if (!m_pCommProRegBase->AnalyzeAswReadReg(strAsw, nDataNum, vnReceivedData,TRUE))
		{
			return eAswCmdErr;
		}

		if (vnReceivedData.size() != nDataNum)
		{
			return eAswCmdErr;
		}

		int nPosNum = vnReceivedData[0];
		double dBase = 10;
		CCoordPos pos;
		for (int i=0;i<nPosNum;i++)
		{		
			vnPosIndex.push_back(vnReceivedData[1+i*7]);
			pos.m_dPosX = ((double)(vnReceivedData[2+i*7]))/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			pos.m_dPosY  = ((double)(vnReceivedData[3+i*7]))/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			pos.m_vdAuxiliaryPosX.at(0) = ((double)(vnReceivedData[4+i*7]))/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			pos.m_vdAuxiliaryPosY.at(0)  = ((double)(vnReceivedData[5+i*7]))/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			pos.m_vdAuxiliaryPosX.at(1) = ((double)(vnReceivedData[6+i*7]))/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			pos.m_vdAuxiliaryPosY.at(1)  = ((double)(vnReceivedData[7+i*7]))/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			vImagePos.push_back(pos);
		}

		CPlatformXYDAxisPos axisPos;
		for (int i=0;i<nPosNum;i++)
		{
			axisPos.m_dPosX = ((double)(vnReceivedData[2+nPosNum*7+i*3]))/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			axisPos.m_dPosY  = ((double)(vnReceivedData[3+nPosNum*7+i*3]))/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			vPlatformAxis.push_back(axisPos);
		}

		return eAswSucceed;
	}
}
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswPlcGetTargetPlatformPos(CString strAsw, std::vector<int> &vnPosIndex,std::vector<CCoordPos> &vCoordPos,std::vector<CPlatformXYDAxisPos> &vPlatformAxis)
{
	// 解析字符串
	if (m_bRegType)
	{
		int  nDataNum = 33;														// 数据量
		std::vector<int> vnReceivedData;
		if (!m_pCommProRegBase->AnalyzeAswReadReg(strAsw, nDataNum, vnReceivedData))
		{
			return eAswCmdErr;
		}

		if (vnReceivedData.size() != nDataNum)
		{
			return eAswCmdErr;
		}

		int nPosNum = vnReceivedData[0];
		double dBase = 10;
		CCoordPos pos;
		for (int i=0;i<nPosNum;i++)
		{		
			vnPosIndex.push_back(vnReceivedData[1+i*4]);
			pos.m_dPosX = ((double)(vnReceivedData[2+i*4]))/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			pos.m_dPosY  = ((double)(vnReceivedData[3+i*4]))/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			pos.m_dAngle  = ((double)(vnReceivedData[4+i*4]))/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			vCoordPos.push_back(pos);
		}

		CPlatformXYDAxisPos axisPos;
		for (int i=nPosNum;i<nPosNum*2;i++)
		{
			axisPos.m_dPosX = ((double)(vnReceivedData[2+i*4]))/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			axisPos.m_dPosY  = ((double)(vnReceivedData[3+i*4]))/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			axisPos.m_dAngle  = ((double)(vnReceivedData[4+i*4]))/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			vPlatformAxis.push_back(axisPos);
		}

		return eAswSucceed;
	}
	else
	{
		int  nDataNum = 33;														// 数据量
		std::vector<int> vnReceivedData;
		if (!m_pCommProRegBase->AnalyzeAswReadReg(strAsw, nDataNum, vnReceivedData,TRUE))
		{
			return eAswCmdErr;
		}

		if (vnReceivedData.size() != nDataNum)
		{
			return eAswCmdErr;
		}

		int nPosNum = vnReceivedData[0];
		double dBase = 10;
		CCoordPos pos;
		for (int i=0;i<nPosNum;i++)
		{		
			vnPosIndex.push_back(vnReceivedData[1+i*4]);
			pos.m_dPosX = ((double)(vnReceivedData[2+i*4]))/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			pos.m_dPosY  = ((double)(vnReceivedData[3+i*4]))/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			pos.m_dAngle  = ((double)(vnReceivedData[4+i*4]))/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			vCoordPos.push_back(pos);
		}

		CPlatformXYDAxisPos axisPos;
		for (int i=nPosNum;i<nPosNum*2;i++)
		{
			axisPos.m_dPosX = ((double)(vnReceivedData[2+i*4]))/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
			axisPos.m_dPosY  = ((double)(vnReceivedData[3+i*4]))/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
			axisPos.m_dAngle  = ((double)(vnReceivedData[4+i*4]))/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);
			vPlatformAxis.push_back(axisPos);
		}

		return eAswSucceed;
	}
}

// 打包“获取平台各轴绝对位置”指令： TAG
BOOL CCommProtocolXYDFast::PackPlcGetPlatformAbsPos(CString& strInfo)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}	

	if (m_bRegType)		// 双字节
	{
		CString strName = m_MNPSParam.m_strCmd;
		int nCmdVal = m_MNPSParam.m_nCmdVal;
		int nParam = 0;
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_CURRENT_POS_X);	// 寄存器地址
		int  nDataNum = 3;													// 数据量

		m_strCmdName = strName;	
		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nDataNum))
		{
			return FALSE;
		}

		SetReadRegTranslateResultInfo(nRegAdrr,nDataNum,TRUE);

	}
	else				// 单字节
	{
		CString strName = m_MNPSParam.m_strCmd;
		int nCmdVal = m_MNPSParam.m_nCmdVal;
		int nVCmdValue = m_MNPSParam.m_nVCmdValue;
		int nParam = 0;
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_CURRENT_POS_X_WORD);	// 寄存器地址
		int  nDataNum = 3;													// 数据量
		m_strCmdName = strName;	


		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nDataNum, TRUE))
		{
			return FALSE;
		}
		SetReadRegTranslateResultInfo(nRegAdrr,nDataNum,TRUE);

	}

	// 	CString strName = m_MNPSParam.m_strCmd;
	// 	int nCmdVal = m_MNPSParam.m_nCmdVal;
	// 	int nParam = 0;
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_CURRENT_POS_X);	// 寄存器地址
	// 	int  nDataNum = 3;													// 数据量
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nDataNum))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;

}

// 解析收到的“获取平台各轴绝对位置”响应（[STX]MNPS R1 R2 R3 R4[ETX]）
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswPlcGetGetPlatformAbsPos( CString strAsw, CPlatformAxisPos* vpPlatAxisPos )
{

	if (NULL == vpPlatAxisPos)
	{
		return eAswUnkown;
	}

	if (vpPlatAxisPos->GetPlatformType()!=ePlatformXYD)
	{
		return eAswUnkown;
	}

	// 解析字符串
	if (m_bRegType)
	{
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_CURRENT_POS_X);		// 寄存器地址
		int  nDataNum = 3;														// 数据量
		std::vector<int> vnReceivedData;
		if (!m_pCommProRegBase->AnalyzeAswReadReg(strAsw, nDataNum, vnReceivedData))
		{
			return eAswCmdErr;
		}

		if (vnReceivedData.size() != nDataNum)
		{
			return eAswCmdErr;
		}

		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);

		std::vector<int> vnAxisPos;
		vnAxisPos.push_back(vnReceivedData[0]);
		vnAxisPos.push_back(vnReceivedData[1]);
		vnAxisPos.push_back(vnReceivedData[2]);
		if (FALSE == ConvertToPlatformXYDAxisPos(vnAxisPos, pPlatformXYDAixisPos))
		{
			return eAswCmdErr;
		}

		std::vector<double> vdPlatformAixisPos;
		vdPlatformAixisPos.push_back(pPlatformXYDAixisPos->m_dPosX);
		vdPlatformAixisPos.push_back(pPlatformXYDAixisPos->m_dPosY);
		vdPlatformAixisPos.push_back(pPlatformXYDAixisPos->m_dAngle);

		SetAnalyzeAswReadRegTransInfo(nDataNum,vdPlatformAixisPos,TRUE);

		return eAswSucceed;
	}
	else
	{
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_CURRENT_POS_X_WORD);		// 寄存器地址
		int  nDataNum = 3;														// 数据量
		std::vector<int> vnReceivedData;
		if (!m_pCommProRegBase->AnalyzeAswReadReg(strAsw, nDataNum, vnReceivedData,TRUE))
		{
			return eAswCmdErr;
		}

		if (vnReceivedData.size() != nDataNum)
		{
			return eAswCmdErr;
		}

		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);

		std::vector<int> vnAxisPos;
		vnAxisPos.push_back(vnReceivedData[0]);
		vnAxisPos.push_back(vnReceivedData[1]);
		vnAxisPos.push_back(vnReceivedData[2]);
		if (FALSE == ConvertToPlatformXYDAxisPos(vnAxisPos, pPlatformXYDAixisPos))
		{
			return eAswCmdErr;
		}


		std::vector<double> vdPlatformAixisPos;
		vdPlatformAixisPos.push_back(pPlatformXYDAixisPos->m_dPosX);
		vdPlatformAixisPos.push_back(pPlatformXYDAixisPos->m_dPosY);
		vdPlatformAixisPos.push_back(pPlatformXYDAixisPos->m_dAngle);
		SetAnalyzeAswReadRegTransInfo(nDataNum,vdPlatformAixisPos,TRUE);

		return eAswSucceed;
	}

	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_CURRENT_POS_X);		// 寄存器地址
	// 	int  nDataNum = 3;														// 数据量
	// 	std::vector<int> vnReceivedData;
	// 	if (!m_pCommProRegBase->AnalyzeAswReadReg(strAsw, nDataNum, vnReceivedData))
	// 	{
	// 		return eAswCmdErr;
	// 	}
	// 
	// 	if (vnReceivedData.size() != nDataNum)
	// 	{
	// 		return eAswCmdErr;
	// 	}
	// 
	// 	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	// 	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);
	// 
	// 	std::vector<int> vnAxisPos;
	// 	vnAxisPos.push_back(vnReceivedData[0]);
	// 	vnAxisPos.push_back(vnReceivedData[1]);
	// 	vnAxisPos.push_back(vnReceivedData[2]);
	// 	if (FALSE == ConvertToPlatformXYDAxisPos(vnAxisPos, pPlatformXYDAixisPos))
	// 	{
	// 		return eAswCmdErr;
	// 	}
	// 	
	// 	return eAswSucceed;
}


// 发送“获取平台坐标”命令	
BOOL CCommProtocolXYDFast::PackPlcGetPlatformPosFCBR(CString& strInfo)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}	

	if (m_bRegType)		// 双字节
	{
		CString strName = m_MNPSParam.m_strCmd;
		int nCmdVal = m_MNPSParam.m_nCmdVal;
		int nParam = 0;
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_CURRENT_POS_X);	// 寄存器地址
		int  nDataNum = 4;													// 数据量

		m_strCmdName = strName;	
		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nDataNum))
		{
			return FALSE;
		}

		SetReadRegTranslateResultInfo(nRegAdrr,nDataNum,TRUE);

	}
	else				// 单字节
	{
		CString strName = m_MNPSParam.m_strCmd;
		int nCmdVal = m_MNPSParam.m_nCmdVal;
		int nVCmdValue = m_MNPSParam.m_nVCmdValue;
		int nParam = 0;
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_CURRENT_POS_X_WORD);	// 寄存器地址
		int  nDataNum = 4;														// 数据量
		m_strCmdName = strName;	


		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nDataNum, TRUE))
		{
			return FALSE;
		}

		SetReadRegTranslateResultInfo(nRegAdrr,nDataNum,TRUE);

	}

	return TRUE;
}

// 解析“获取平台坐标”响应
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswPlcGetPlatformPosFCBR(CString strAsw, double& dPlatformPos1X, double& dPlatformPos1Y, double& dPlatformPos2X, double& dPlatformPos2Y)
{
	// 解析字符串
	if (m_bRegType)
	{
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_CURRENT_POS_X);		// 寄存器地址
		int  nDataNum = 4;														// 数据量
		std::vector<int> vnReceivedData;
		if (!m_pCommProRegBase->AnalyzeAswReadReg(strAsw, nDataNum, vnReceivedData))
		{
			return eAswCmdErr;
		}

		if (vnReceivedData.size() != nDataNum)
		{
			return eAswCmdErr;
		}

		double dBase = 10;
		dPlatformPos1X = vnReceivedData[0]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
		dPlatformPos1Y = vnReceivedData[1]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
		dPlatformPos2X = vnReceivedData[2]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
		dPlatformPos2Y = vnReceivedData[3]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);

		std::vector<double> vdPlstformPos;
		vdPlstformPos.push_back(dPlatformPos1X);
		vdPlstformPos.push_back(dPlatformPos1Y);
		vdPlstformPos.push_back(dPlatformPos2X);
		vdPlstformPos.push_back(dPlatformPos2Y);

		SetAnalyzeAswReadRegTransInfo(nDataNum,vdPlstformPos,TRUE);

		return eAswSucceed;
	}
	else
	{
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_CURRENT_POS_X_WORD);		// 寄存器地址
		int  nDataNum = 4;															// 数据量
		std::vector<int> vnReceivedData;
		if (!m_pCommProRegBase->AnalyzeAswReadReg(strAsw, nDataNum, vnReceivedData,TRUE))
		{
			return eAswCmdErr;
		}

		if (vnReceivedData.size() != nDataNum)
		{
			return eAswCmdErr;
		}

		double dBase = 10;
		dPlatformPos1X = vnReceivedData[0]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
		dPlatformPos1Y = vnReceivedData[1]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
		dPlatformPos2X = vnReceivedData[2]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
		dPlatformPos2Y = vnReceivedData[3]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);

		std::vector<double> vdPlstformPos;
		vdPlstformPos.push_back(dPlatformPos1X);
		vdPlstformPos.push_back(dPlatformPos1Y);
		vdPlstformPos.push_back(dPlatformPos2X);
		vdPlstformPos.push_back(dPlatformPos2Y);

		SetAnalyzeAswReadRegTransInfo(nDataNum,vdPlstformPos,TRUE);

		return eAswSucceed;
	}
}

BOOL CCommProtocolXYDFast::PackPlcGetPlatformAbsPosBackup(CString& strInfo)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}	

	if (m_bRegType) // 双字
	{
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_CURRENT_POS_X_BACKUP);
		int nDataNum = 3;

		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nDataNum))
		{
			return FALSE;
		}
		SetReadRegTranslateResultInfo(nRegAdrr,nDataNum,TRUE);
	}
	else // 单字
	{
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_CURRENT_POS_X_BACKUP_WORD);
		int nDataNum = 3;

		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nDataNum, TRUE))
		{
			return FALSE;
		}
		SetReadRegTranslateResultInfo(nRegAdrr,nDataNum,TRUE);
	}

	return TRUE;


}

CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswPlcGetGetPlatformAbsPosBackup(CString& strInfo, CPlatformAxisPos* vpPlatAxisPos)
{
	if (NULL == vpPlatAxisPos)
	{
		return eAswUnkown;
	}

	if (vpPlatAxisPos->GetPlatformType()!=ePlatformXYD)
	{
		return eAswUnkown;
	}

	// 解析字符串
	if (m_bRegType)
	{
		// long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_CURRENT_POS_X);		// 寄存器地址
		int  nDataNum = 3;														// 数据量
		std::vector<int> vnReceivedData;
		if (!m_pCommProRegBase->AnalyzeAswReadReg(strInfo, nDataNum, vnReceivedData))
		{
			return eAswCmdErr;
		}

		if (vnReceivedData.size() != nDataNum)
		{
			return eAswCmdErr;
		}

		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);

		/*std::vector<int> vnAxisPos;
		vnAxisPos.push_back(vnReceivedData[0]);
		vnAxisPos.push_back(vnReceivedData[1]);
		vnAxisPos.push_back(vnReceivedData[2]);*/
		double dBase = 10;
		pPlatformXYDAixisPos->m_dPosX  = vnReceivedData[0]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
		pPlatformXYDAixisPos->m_dPosY  = vnReceivedData[1]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
		pPlatformXYDAixisPos->m_dAngle  =vnReceivedData[2]/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);

		//if (FALSE == ConvertToPlatformXYDAxisPos(vnAxisPos, pPlatformXYDAixisPos))
		//{
		//	return eAswCmdErr;
		//}
		std::vector<double> vdPlatformAixisPos;
		vdPlatformAixisPos.push_back(pPlatformXYDAixisPos->m_dPosX);
		vdPlatformAixisPos.push_back(pPlatformXYDAixisPos->m_dPosY);
		vdPlatformAixisPos.push_back(pPlatformXYDAixisPos->m_dAngle);

		SetAnalyzeAswReadRegTransInfo(nDataNum,vdPlatformAixisPos,TRUE);

		return eAswSucceed;
	}
	else
	{
		// long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_CURRENT_POS_X_WORD);		// 寄存器地址
		int  nDataNum = 3;														// 数据量
		std::vector<int> vnReceivedData;
		if (!m_pCommProRegBase->AnalyzeAswReadReg(strInfo, nDataNum, vnReceivedData,TRUE))
		{
			return eAswCmdErr;
		}

		if (vnReceivedData.size() != nDataNum)
		{
			return eAswCmdErr;
		}

		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);

		/*std::vector<int> vnAxisPos;
		vnAxisPos.push_back(vnReceivedData[0]);
		vnAxisPos.push_back(vnReceivedData[1]);
		vnAxisPos.push_back(vnReceivedData[2]);*/
		double dBase = 10;
		pPlatformXYDAixisPos->m_dPosX  = vnReceivedData[0]/pow(dBase, m_CommProtocolParam.m_nCommXUnitExp);
		pPlatformXYDAixisPos->m_dPosY  = vnReceivedData[1]/pow(dBase, m_CommProtocolParam.m_nCommYUnitExp);
		pPlatformXYDAixisPos->m_dAngle  =vnReceivedData[2]/pow(dBase, m_CommProtocolParam.m_nCommDUnitExp);

		/*	if (FALSE == ConvertToPlatformXYDAxisPos(vnAxisPos, pPlatformXYDAixisPos))
		{
		return eAswCmdErr;
		}*/
		std::vector<double> vdPlatformAixisPos;
		vdPlatformAixisPos.push_back(pPlatformXYDAixisPos->m_dPosX);
		vdPlatformAixisPos.push_back(pPlatformXYDAixisPos->m_dPosY);
		vdPlatformAixisPos.push_back(pPlatformXYDAixisPos->m_dAngle);

		SetAnalyzeAswReadRegTransInfo(nDataNum,vdPlatformAixisPos,TRUE);
		return eAswSucceed;
	}
}

BOOL CCommProtocolXYDFast::PackRePlcGetPlatformOffsetFGPOAxisPos(CString& strInfo, BOOL bResult, CCoordPos& cpAlignOffset)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FGPOParam.m_strCmd;
		int nCmdVal = m_FGPOParam.m_nCmdVal;
		int nVCmdValue = m_FGPOParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_BACKUP);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		double dParam = 0;
		dParam = cpAlignOffset.m_dPosX;
		PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = cpAlignOffset.m_dPosY;
		PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		dParam = cpAlignOffset.m_dAngle;
		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else
	{
		CString strName = m_FGPOParam.m_strCmd;
		int nCmdVal = m_FGPOParam.m_nCmdVal;
		int nVCmdValue = m_FGPOParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_BACKUP_WORD);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		double dParam = 0;
		dParam = cpAlignOffset.m_dPosX;
		PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = cpAlignOffset.m_dPosY;
		PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		dParam = cpAlignOffset.m_dAngle;
		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}

	return TRUE;


}

BOOL CCommProtocolXYDFast::PackRePlcGetPlatformOffsetFGPO(CString& strInfo, BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FGPOParam.m_strCmd;
		int nCmdVal = m_FGPOParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else
	{
		CString strName = m_FGPOParam.m_strCmd;
		int nCmdVal = m_FGPOParam.m_nCmdVal;
		int nVCmdValue = m_FGPOParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);



		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);
	}
	return TRUE;
}


// 打包“指定平台各轴移动到的绝对位置”指令: 移动位置
BOOL CCommProtocolXYDFast::PackPlcWriteDrivePlatformMoveToAbsPos( CString& strInfo, CPlatformAxisPos* vpPlatAxisPos )
{

	if (NULL == vpPlatAxisPos)
	{
		return eAswUnkown;
	}

	if (vpPlatAxisPos->GetPlatformType()!=ePlatformXYD)
	{
		return eAswUnkown;
	}

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_MMVAParam.m_strCmd;
		int nCmdVal = m_MMVAParam.m_nCmdVal;
		int nParam = 0;

		m_strCmdName = strName;	

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);	// 寄存器地址
		int  nDataNum = 3;												// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (m_pMidPlatformInfo == NULL)
		{

			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}

				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dY1 = 0.0;
						double dY2 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(dX0, dY0, dD0, dY1, dY2, dX1);


						double dParam = 0;
						dParam = dX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dX2 = 0.0;
						double dY1 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(dX0, dY0, dD0, dX1, dX2, dY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}

				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SaveAxisPosDataNeedSend(vnWriteData,strInfo);
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

		return TRUE;
	}
	else
	{
		CString strName = m_MMVAParam.m_strCmd;
		int nCmdVal = m_MMVAParam.m_nCmdVal;
		int nParam = 0;

		m_strCmdName = strName;	

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD);	// 寄存器地址
		int  nDataNum = 3;												// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (m_pMidPlatformInfo == NULL)
		{

			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}

				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dY1 = 0.0;
						double dY2 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(dX0, dY0, dD0, dY1, dY2, dX1);


						double dParam = 0;
						dParam = dX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dX2 = 0.0;
						double dY1 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(dX0, dY0, dD0, dX1, dX2, dY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}

				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData,TRUE))
		{
			return FALSE;
		}

		SaveAxisPosDataNeedSend(vnWriteData,strInfo);
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

		return TRUE;
	}

}

BOOL CCommProtocolXYDFast::PackPlcWriteDriveCamPlatformMoveToAbsPos(CString& strInfo, std::vector<CPlatformXYAxisPos*> vpPlatAxisPos)
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_MMVAParam.m_strCmd;
		int nCmdVal = m_MMVAParam.m_nCmdVal;
		int nParam = 0;

		m_strCmdName = strName;	

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_BACKUP);	// 寄存器地址
		int  nDataNum = 2;												// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		CPlatformXYAxisPos* pPlatformXYAixisPos; 		
		pPlatformXYAixisPos = vpPlatAxisPos.at(0);

		double dParam = 0;
		dParam = pPlatformXYAixisPos->m_dPosX;
		PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
		dParam = pPlatformXYAixisPos->m_dPosY;
		PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);



		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

		return TRUE;
	}
	else
	{
		CString strName = m_MMVAParam.m_strCmd;
		int nCmdVal = m_MMVAParam.m_nVCmdValue;
		int nParam = 0;

		m_strCmdName = strName;	

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_BACKUP_WORD);	// 寄存器地址
		int  nDataNum = 2;												// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		CPlatformXYAxisPos* pPlatformXYAixisPos; 		
		pPlatformXYAixisPos = vpPlatAxisPos.at(0);

		double dParam = 0;
		dParam = pPlatformXYAixisPos->m_dPosX;
		PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
		dParam = pPlatformXYAixisPos->m_dPosY;
		PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);



		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}
}

// 打包写XYD绝对轴位置到备用轴位置寄存器
BOOL CCommProtocolXYDFast::PackPlcWriteDrivePlatformMoveToAbsPosBackup(CString& strInfo, CPlatformAxisPos* pPlatformAxisPos)
{
	if (NULL == pPlatformAxisPos)
	{
		return eAswUnkown;
	}

	if (pPlatformAxisPos->GetPlatformType()!=ePlatformXYD)
	{
		return eAswUnkown;
	}

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_MMVAParam.m_strCmd;
		int nCmdVal = m_MMVAParam.m_nCmdVal;
		int nParam = 0;

		m_strCmdName = strName;	

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_BACKUP);	// 寄存器地址
		int  nDataNum = 3;												// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(pPlatformAxisPos);	
		if (m_pMidPlatformInfo == NULL)
		{

			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}

				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dY1 = 0.0;
						double dY2 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(dX0, dY0, dD0, dY1, dY2, dX1);


						double dParam = 0;
						dParam = dX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dX2 = 0.0;
						double dY1 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(dX0, dY0, dD0, dX1, dX2, dY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}

				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

		return TRUE;
	}
	else
	{
		CString strName = m_MMVAParam.m_strCmd;
		int nCmdVal = m_MMVAParam.m_nCmdVal;
		int nParam = 0;

		m_strCmdName = strName;	

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_BACKUP_WORD);	// 寄存器地址
		int  nDataNum = 3;												// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(pPlatformAxisPos);	
		if (m_pMidPlatformInfo == NULL)
		{

			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}

				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dY1 = 0.0;
						double dY2 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(dX0, dY0, dD0, dY1, dY2, dX1);


						double dParam = 0;
						dParam = dX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dX2 = 0.0;
						double dY1 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(dX0, dY0, dD0, dX1, dX2, dY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[1], dParam,m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[0], dParam,m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}

				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}
}

// 打包“指定平台各轴移动到的绝对位置”指令: 移动指令
BOOL CCommProtocolXYDFast::PackPlcWriteDrivePlatformMove(CString& strInfo)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_MMVAParam.m_strCmd;
		int nCmdVal = m_MMVAParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 1;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		AttachAxisDataToCmd(vnWriteData);
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_MMVAParam.m_strCmd;
		int nCmdVal = m_MMVAParam.m_nCmdVal;
		int nVCmdValue = m_MMVAParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 1;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

		AttachAxisDataToCmd(vnWriteData);
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_MMVAParam.m_strCmd;
	// 	int nCmdVal = m_MMVAParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 1;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}

// 打包“指定平台各轴移动到的绝对位置”响应:打包读取是否移动完成
BOOL CCommProtocolXYDFast::PackPlcReadDrivePlatformMoveCompleted(CString& strInfo)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)		// 双字节
	{
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLC_CMD_TRIGGER);		// 寄存器地址
		int  nDataNum = GetReadDataNum();												// 数据量
		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nDataNum))
		{
			return FALSE;
		}

		SetReadRegTranslateResultInfo(nRegAdrr,nDataNum,TRUE);

	}
	else				// 单字节
	{
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLC_CMD_TRIGGER_WORD);		// 寄存器地址
		int  nDataNum = GetReadDataNum();											// 数据量
		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nDataNum, FALSE))
		{
			return FALSE;
		}

		SetReadRegTranslateResultInfo(nRegAdrr,nDataNum,FALSE);


	}

	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLC_CMD_TRIGGER);		// 寄存器地址
	// 	int  nDataNum = 5;												// 数据量
	// 	if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nDataNum))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}

// 解析收到的“指定平台各轴移动到的绝对位置”响应（[STX]MMVA R1[ETX]）
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswPlcDrivePlatformMoveCompleted( CString strAsw )
{
	BOOL bTriggered = FALSE;
	SysWorkCmdType eCmdType = eCmdUnknow;
	if (m_pCommProRegBase == NULL)
	{
		return eAswCmdErr;
	}

	long nRegAdrr = m_nPLCBaseRegAddr;		// 寄存器地址
	int  nDataNum = GetReadDataNum();												// 数据量
	std::vector<int> vnReceivedData;

	if (m_bRegType)
	{
		nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLC_CMD_TRIGGER);		// 寄存器地址

		if (!m_pCommProRegBase->AnalyzeAswReadReg(strAsw, nDataNum, vnReceivedData))
		{
			return eAswCmdErr;
		}
	}
	else
	{
		nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLC_CMD_TRIGGER_WORD);		// 寄存器地址

		if (!m_pCommProRegBase->AnalyzeAswReadReg(strAsw, nDataNum, vnReceivedData,FALSE))
		{
			return eAswCmdErr;
		}
	}

	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLC_CMD_TRIGGER);		// 寄存器地址
	// 	int  nDataNum = 5;												// 数据量
	// 	std::vector<int> vnReceivedData;
	// 	if (!m_pCommProRegBase->AnalyzeAswReadReg(strAsw, nDataNum, vnReceivedData))
	// 	{
	// 		return eAswCmdErr;
	// 	}

	if (vnReceivedData.size() != nDataNum)
	{
		return eAswCmdErr;
	}

	if (vnReceivedData.at(0) == PLC_CMD_VAL_NOT_TRIGGERED)
	{
		return eAswCmdErr;
	}

	//TT 解析轴位置(如果数据包含)
	AnalyzeAxisInfoInCmdParam(vnReceivedData);

	// SY
	if (m_bRegType)		// 双字节
	{
		if (vnReceivedData.at(1) != m_MMVAParam.m_nCmdVal)
		{
			//return eAswCmdErr;
			return eAswUnkown;
		}

		if (vnReceivedData[2] == 0)
		{

			SetAnalyzeAswReadRegTransInfo(nDataNum,vnReceivedData,TRUE);
			return eAswSucceed;
		}
		else if (vnReceivedData[2] = -1)
		{
			return eAswUnkown;
		}

	}
	else		// 单字节
	{
		if (vnReceivedData.at(1) != m_MMVAParam.m_nVCmdValue)
		{
			//return eAswCmdErr;
			return eAswUnkown;
		}

		// 1:OK;2:NG
		if (vnReceivedData[2] == 1)
		{

			SetAnalyzeAswReadRegTransInfo(nDataNum,vnReceivedData,FALSE);
			return eAswSucceed;
		}
		else if (vnReceivedData[2] = 2)
		{
			return eAswUnkown;
		}
	}

	// 	if (vnReceivedData.at(1) != m_MMVAParam.m_nCmdVal)
	// 	{
	// 		return eAswCmdErr;
	// 	}
	//
	// 	if (vnReceivedData[2] == 0)
	// 	{
	// 		return eAswSucceed;
	// 	}
	// 	else if (vnReceivedData[2] = -1)
	// 	{
	// 		return eAswUnkown;
	// 	}	

	return eAswCmdErr;
}

BOOL CCommProtocolXYDFast::PackRePlcCalTargetFixOffsetFAFOPos(CString& strInfo,BOOL bResult,std::vector<int> vnPosIndex,std::vector<CCoordPos>& vCoordPos,std::vector<CPlatformXYDAxisPos> &vPlatformAxis,std::vector<CCoordPos>& vBoardPos)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}
	if (m_bRegType)
	{
		CString strName = m_FAFOParam.m_strCmd;
		int nCmdVal = m_FAFOParam.m_nCmdVal;
		m_strCmdName = strName;	
		int nParam = 0;

		int nPosNum = 0;
		if (bResult)
		{
			nPosNum = vnPosIndex.size();
		}

		// 寄存器首地址
		long nRegAdrr = m_nPLCTempBaseRegAddr /*+ atoi(RREG_VISION_PLATFORM_TEMP_POS)*/;

		int  nDataNum = ((nPosNum*2) * 4) + 1;	
		nDataNum = nDataNum + (nPosNum*3);
		//int  nDataNum = nPosNum*4+1;
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		nParam = nPosNum;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

		for (int i=0;i<nPosNum;i++)
		{			
			PackPlcParam(vnWriteData[1 + i*4], vnPosIndex.at(i), m_CommProtocolParam.m_nCommUnitExp);
			double dParam = 0;
			dParam = vCoordPos.at(i).GetPosX();
			PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = vCoordPos.at(i).GetPosY();
			PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = vCoordPos.at(i).GetAngle();
			PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);
		}

		for (int i=nPosNum;i<nPosNum*2;i++)
		{			
			PackPlcParam(vnWriteData[1 + i*4], vnPosIndex.at(i-nPosNum), m_CommProtocolParam.m_nCommUnitExp);
			double dParam = 0;
			dParam = vPlatformAxis.at(i-nPosNum).m_dPosX;
			PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = vPlatformAxis.at(i-nPosNum).m_dPosY;
			PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = vPlatformAxis.at(i-nPosNum).m_dAngle;
			PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);
		}

		for (int i=0;i<nPosNum;i++)
		{
			PackPlcParam(vnWriteData[1 + nPosNum*8 + i*3], vnPosIndex.at(i), m_CommProtocolParam.m_nCommUnitExp);
			double dParam = 0;
			dParam = vBoardPos.at(i).m_dPosX;
			PackPlcParam(vnWriteData[2 + nPosNum*8 + i*3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = vBoardPos.at(i).m_dPosY;
			PackPlcParam(vnWriteData[3 + nPosNum*8 + i*3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

		return TRUE;
	}
	else
	{
		CString strName = m_FAFOParam.m_strCmd;
		int nCmdVal = m_FAFOParam.m_nCmdVal;
		m_strCmdName = strName;	
		int nParam = 0;

		int nPosNum = 0;
		if (bResult)
		{
			nPosNum = vnPosIndex.size();
		}

		// 寄存器首地址
		long nRegAdrr = m_nPLCTempBaseRegAddr /*+ atoi(RREG_VISION_PLATFORM_TEMP_POS)*/;

		int  nDataNum = ((nPosNum*2) * 4) + 1;		

		nDataNum = nDataNum + nPosNum*3;

		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		nParam = nPosNum;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

		for (int i=0;i<nPosNum;i++)
		{			
			PackPlcParam(vnWriteData[1 + i*4], vnPosIndex.at(i), m_CommProtocolParam.m_nCommUnitExp);
			double dParam = 0;
			dParam = vCoordPos.at(i).GetPosX();
			PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = vCoordPos.at(i).GetPosY();
			PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = vCoordPos.at(i).GetAngle();
			PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);
		}

		for (int i=nPosNum;i<nPosNum*2;i++)
		{			
			PackPlcParam(vnWriteData[1 + i*4], vnPosIndex.at(i-nPosNum), m_CommProtocolParam.m_nCommUnitExp);
			double dParam = 0;
			dParam = vPlatformAxis.at(i-nPosNum).m_dPosX;
			PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = vPlatformAxis.at(i-nPosNum).m_dPosY;
			PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = vPlatformAxis.at(i-nPosNum).m_dAngle;
			PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);
		}

		for (int i=0;i<nPosNum;i++)
		{
			PackPlcParam(vnWriteData[1 + nPosNum*8 + i*3], vnPosIndex.at(i), m_CommProtocolParam.m_nCommUnitExp);
			double dParam = 0;
			dParam = vBoardPos.at(i).m_dPosX;
			PackPlcParam(vnWriteData[2 + nPosNum*8 + i*3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = vBoardPos.at(i).m_dPosY;
			PackPlcParam(vnWriteData[3 + nPosNum*8 + i*3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData, TRUE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

		return TRUE;
	}

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackPlcSendDmCodeBoardAbsPos(CString& strInfo,std::vector<int> vnPosIndex,std::vector<CCoordPos> &vBoardPos,std::vector<CCoordPos> &vImageSize)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}
	if (m_bRegType)
	{

		int nParam = 0;

		int nPosNum = vnPosIndex.size();

		// 寄存器首地址
		long nRegAdrr = m_nPLCTempBaseRegAddr;
		int  nDataNum = nPosNum*(2*GUANLIANBOARDNUM+3)+1;	

		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		nParam = nPosNum;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

		for (int i=0;i<nPosNum;i++)
		{			
			PackPlcParam(vnWriteData[1 + i*(2*GUANLIANBOARDNUM+3)], vnPosIndex.at(i), m_CommProtocolParam.m_nCommUnitExp);
			PackPlcParam(vnWriteData[2 + i*(2*GUANLIANBOARDNUM+3)], vImageSize.at(i).GetPosX(), m_CommProtocolParam.m_nCommUnitExp);
			PackPlcParam(vnWriteData[3 + i*(2*GUANLIANBOARDNUM+3)], vImageSize.at(i).GetPosY(), m_CommProtocolParam.m_nCommUnitExp);
			double dParam = 0;
			for (int j=0;j<GUANLIANBOARDNUM;j++)
			{
				dParam = vBoardPos.at(i*GUANLIANBOARDNUM+j).GetPosX();
				PackPlcParam(vnWriteData[4+j*2 + i*(2*GUANLIANBOARDNUM+3)], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = vBoardPos.at(i*GUANLIANBOARDNUM+j).GetPosY();
				PackPlcParam(vnWriteData[5+j*2 + i*(2*GUANLIANBOARDNUM+3)], dParam, m_CommProtocolParam.m_nCommYUnitExp);
			}

		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);


		return TRUE;
	}
	else
	{

		int nParam = 0;

		int nPosNum = vnPosIndex.size();


		// 寄存器首地址
		long nRegAdrr = m_nPLCTempBaseRegAddr;

		int  nDataNum = nPosNum*(2*GUANLIANBOARDNUM+3)+ 1;		

		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		nParam = nPosNum;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

		for (int i=0;i<nPosNum;i++)
		{			
			PackPlcParam(vnWriteData[1 + i*(2*GUANLIANBOARDNUM+3)], vnPosIndex.at(i), m_CommProtocolParam.m_nCommUnitExp);
			PackPlcParam(vnWriteData[2 + i*(2*GUANLIANBOARDNUM+3)], vImageSize.at(i).GetPosX(), m_CommProtocolParam.m_nCommUnitExp);
			PackPlcParam(vnWriteData[3 + i*(2*GUANLIANBOARDNUM+3)], vImageSize.at(i).GetPosY(), m_CommProtocolParam.m_nCommUnitExp);
			double dParam = 0;
			for (int j=0;j<GUANLIANBOARDNUM;j++)
			{
				dParam = vBoardPos.at(i*GUANLIANBOARDNUM+j).GetPosX();
				PackPlcParam(vnWriteData[4+j*2 + i*(2*GUANLIANBOARDNUM+3)], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = vBoardPos.at(i*GUANLIANBOARDNUM+j).GetPosY();
				PackPlcParam(vnWriteData[5+j*2 + i*(2*GUANLIANBOARDNUM+3)], dParam, m_CommProtocolParam.m_nCommYUnitExp);
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData, TRUE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

		return TRUE;
	}

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackRePlcCalTargetFixOffsetFAFOBoardPos(CString& strInfo,BOOL bResult,std::vector<int> vnPosIndex,std::vector<CCoordPos> vBoardPos)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}
	if (m_bRegType)
	{
		CString strName = m_FAFOParam.m_strCmd;
		int nCmdVal = m_FAFOParam.m_nCmdVal;
		m_strCmdName = strName;	
		int nParam = 0;

		int nPosNum = 0;
		if (bResult)
		{
			nPosNum = vnPosIndex.size();
		}

		// 寄存器首地址
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_BACKUP);

		int  nDataNum = nPosNum*3+1;	
		//int  nDataNum = nPosNum*4+1;
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		nParam = nPosNum;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

		for (int i=0;i<nPosNum;i++)
		{			
			PackPlcParam(vnWriteData[1 + i*3], vnPosIndex.at(i), m_CommProtocolParam.m_nCommUnitExp);
			double dParam = 0;
			dParam = vBoardPos.at(i).GetPosX();
			PackPlcParam(vnWriteData[2 + i*3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = vBoardPos.at(i).GetPosY();
			PackPlcParam(vnWriteData[3 + i*3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}


		return TRUE;
	}
	else
	{
		CString strName = m_FAFOParam.m_strCmd;
		int nCmdVal = m_FAFOParam.m_nCmdVal;
		m_strCmdName = strName;	
		int nParam = 0;

		int nPosNum = 0;
		if (bResult)
		{
			nPosNum = vnPosIndex.size();
		}

		// 寄存器首地址
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_BACKUP_WORD);

		int  nDataNum = nPosNum*3 + 1;		

		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		nParam = nPosNum;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

		for (int i=0;i<nPosNum;i++)
		{			
			PackPlcParam(vnWriteData[1 + i*3], vnPosIndex.at(i), m_CommProtocolParam.m_nCommUnitExp);
			double dParam = 0;
			dParam = vBoardPos.at(i).GetPosX();
			PackPlcParam(vnWriteData[2 + i*3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = vBoardPos.at(i).GetPosY();
			PackPlcParam(vnWriteData[3 + i*3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData, TRUE))
		{
			return FALSE;
		}

		return TRUE;
	}

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackRePlcCalTargetFixOffsetFAFO(CString& strInfo,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FAFOParam.m_strCmd;
		int nCmdVal = m_FAFOParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FAFOParam.m_strCmd;
		int nCmdVal = m_FAFOParam.m_nCmdVal;
		int nVCmdValue = m_FAFOParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);


	}

	return TRUE;
}

// 打包标定结果
BOOL CCommProtocolXYDFast::PackRePlcCalibrateFCLB(CString& strInfo,BOOL bResult)
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FCLBParam.m_strCmd;
		int nCmdVal = m_FCLBParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FCLBParam.m_strCmd;
		int nCmdVal = m_FCLBParam.m_nCmdVal;
		int nVCmdValue = m_FCLBParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);


	}

	// 	CString strName = m_FCLBParam.m_strCmd;
	// 	int nCmdVal = m_FCLBParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;

}
// 打包标定结果
BOOL CCommProtocolXYDFast::PackRePlcCalibrateFCBP(CString& strInfo,BOOL bResult)
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FCBPParam.m_strCmd;
		int nCmdVal = m_FCBPParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FCBPParam.m_strCmd;
		int nCmdVal = m_FCBPParam.m_nCmdVal;
		int nVCmdValue = m_FCBPParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);


	}

	// 	CString strName = m_FCLBParam.m_strCmd;
	// 	int nCmdVal = m_FCLBParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;

}

BOOL CCommProtocolXYDFast::PackRePlcCalibrateFCBS(CString& strInfo,BOOL bResult)
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FCBSParam.m_strCmd;
		int nCmdVal = m_FCBSParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FCBSParam.m_strCmd;
		int nCmdVal = m_FCBSParam.m_nCmdVal;
		int nVCmdValue = m_FCBSParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FCBSParam.m_strCmd;
	// 	int nCmdVal = m_FCBSParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;

}
//
BOOL CCommProtocolXYDFast::PackReCamCalibrateFCPR(CString& strInfo,BOOL bResult)
{

	CString strHead = m_strHead;
	CString strName= m_FCPRParam.m_strCmd;
	CString strParam[1];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strTail;
	// 


	return TRUE;
}
BOOL CCommProtocolXYDFast::PackRePlcCamCalibrateFCPR(CString& strInfo,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FCPRParam.m_strCmd;
		int nCmdVal = m_FCPRParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else
	{
		CString strName = m_FCPRParam.m_strCmd;
		int nCmdVal = m_FCPRParam.m_nCmdVal;
		int nVCmdValue = m_FCPRParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);
	}



	return TRUE;
}
BOOL CCommProtocolXYDFast::PackPlcGetCamPlatformAbsInfo(CString& strInfo)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}	

	if (m_bRegType)		// 双字节
	{
		int nParam = 0;
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_CURRENT_POS_X_BACKUP);	// 寄存器地址
		int  nDataNum = 6;													// 数据量

		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nDataNum))
		{
			return FALSE;
		}
		SetReadRegTranslateResultInfo(nRegAdrr,nDataNum,TRUE);
	}
	else				// 单字节
	{
		int nParam = 0;
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_CURRENT_POS_X_BACKUP_WORD);	// 寄存器地址
		int  nDataNum = 4;													// 数据量


		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nDataNum, TRUE))
		{
			return FALSE;
		}
		SetReadRegTranslateResultInfo(nRegAdrr,nDataNum,TRUE);
	}


	return TRUE;

}
CmdAnsweredStatus  CCommProtocolXYDFast::AnalyzeAswPlcGetCamPlatformAbsPos(CString strAsw,std::vector<CPlatformXYAxisPos*>& vpCamPlatformXYAxisPos)
{

	// 解析字符串
	if (m_bRegType)
	{
		int  nDataNum = 6;														// 数据量
		std::vector<int> vnReceivedData;
		if (!m_pCommProRegBase->AnalyzeAswReadReg(strAsw, nDataNum, vnReceivedData))
		{
			return eAswCmdErr;
		}

		if (vnReceivedData.size() != nDataNum)
		{
			return eAswCmdErr;
		}
		if(vpCamPlatformXYAxisPos.size() != 2)
		{
			return eAswCmdErr;
		}
		CPlatformXYAxisPos* pCamPlatformXYAixisPos; 
		//for(int i = 0; i < nDataNum ; i++)
		//{
		//pCamPlatformXYAixisPos = vpCamPlatformXYAxisPos.at(0);
		//pCamPlatformXYAixisPos->m_dPosX = vnReceivedData[2*i]/pow(10.0, m_CommProtocolParam.m_nCommXYUnitExp);
		//pCamPlatformXYAixisPos->m_dPosY = vnReceivedData[2*i + 1]/pow(10.0, m_CommProtocolParam.m_nCommXYUnitExp);

		//}

		pCamPlatformXYAixisPos = vpCamPlatformXYAxisPos.at(0);
		pCamPlatformXYAixisPos->m_dPosX = vnReceivedData[0]/pow(10.0, m_CommProtocolParam.m_nCommXUnitExp);
		pCamPlatformXYAixisPos->m_dPosY = vnReceivedData[1]/pow(10.0, m_CommProtocolParam.m_nCommYUnitExp);

		pCamPlatformXYAixisPos = vpCamPlatformXYAxisPos.at(1);
		pCamPlatformXYAixisPos->m_dPosX = vnReceivedData[3]/pow(10.0, m_CommProtocolParam.m_nCommXUnitExp);
		pCamPlatformXYAixisPos->m_dPosY = vnReceivedData[4]/pow(10.0, m_CommProtocolParam.m_nCommYUnitExp);

		return eAswSucceed;
	}
	else
	{
		int  nDataNum = 4;														// 数据量
		std::vector<int> vnReceivedData;
		if (!m_pCommProRegBase->AnalyzeAswReadReg(strAsw, nDataNum, vnReceivedData,TRUE))
		{
			return eAswCmdErr;
		}

		if (vnReceivedData.size() != nDataNum)
		{
			return eAswCmdErr;
		}

		if(vpCamPlatformXYAxisPos.size() < 2)
		{
			return eAswCmdErr;
		}

		CPlatformXYAxisPos* pCamPlatformXYAixisPos; 
		//for(int i = 0; i < nDataNum/2 ; i++)
		//{
		//	pCamPlatformXYAixisPos = vpCamPlatformXYAxisPos.at(i);
		//	pCamPlatformXYAixisPos->m_dPosX = vnReceivedData[2*i]/pow(10.0, m_CommProtocolParam.m_nCommXYUnitExp);
		//	pCamPlatformXYAixisPos->m_dPosY = vnReceivedData[2*i + 1]/pow(10.0, m_CommProtocolParam.m_nCommXYUnitExp);

		//}

		pCamPlatformXYAixisPos = vpCamPlatformXYAxisPos.at(0);
		pCamPlatformXYAixisPos->m_dPosX = vnReceivedData[0]/pow(10.0, m_CommProtocolParam.m_nCommXUnitExp);
		pCamPlatformXYAixisPos->m_dPosY = vnReceivedData[1]/pow(10.0, m_CommProtocolParam.m_nCommYUnitExp);

		pCamPlatformXYAixisPos = vpCamPlatformXYAxisPos.at(1);
		pCamPlatformXYAixisPos->m_dPosX = vnReceivedData[2]/pow(10.0, m_CommProtocolParam.m_nCommXUnitExp);
		pCamPlatformXYAixisPos->m_dPosY = vnReceivedData[3]/pow(10.0, m_CommProtocolParam.m_nCommYUnitExp);

		return eAswSucceed;
	}
	return eAswSucceed;
}

CmdAnsweredStatus  CCommProtocolXYDFast::AnalyzeAswGetCamPlatformAbsPos(CString strAsw,std::vector<CPlatformXYAxisPos*>& vpCamPlatformXYAxisPos)
{
	if (vpCamPlatformXYAxisPos.size() <= 0 || NULL == vpCamPlatformXYAxisPos.at(0))
	{
		return eAswUnkown;
	}

	CString strName;
	std::vector<CString> vstrParam;	
	if (!AnalyzeCommandParam(strAsw, strName, vstrParam))
	{
		return eAswCmdErr;
	}

	m_strCmdName = strName;
	double dBase = 10;

	if (strName != m_MPSBParam.m_strCmd)
	{
		return eAswCmdErr;
	}
	if (vstrParam.size() != 7)
	{
		return eAswCmdErr;
	}

	if (0 != atoi(vstrParam[0]))
	{
		return eAswCmdErr;
	}

	CPlatformXYAxisPos* pPlatformXYAixisPos; 		
	pPlatformXYAixisPos = (CPlatformXYAxisPos*)(vpCamPlatformXYAxisPos.at(0));

	std::vector<CString> vstrAxisPos;
	vstrAxisPos.push_back(vstrParam[1]);
	vstrAxisPos.push_back(vstrParam[2]);
	if (FALSE == ConvertToCamXYAxisPos(vstrAxisPos, pPlatformXYAixisPos))
	{
		return eAswCmdErr;
	}
	pPlatformXYAixisPos = (CPlatformXYAxisPos*)(vpCamPlatformXYAxisPos.at(1));
	vstrAxisPos.clear();
	vstrAxisPos.push_back(vstrParam[4]);
	vstrAxisPos.push_back(vstrParam[5]);
	if (FALSE == ConvertToCamXYAxisPos(vstrAxisPos, pPlatformXYAixisPos))
	{
		return eAswCmdErr;
	}
	return eAswSucceed;
}
// 1、FCBR:关联Calibration 的执行 执行Calibration
BOOL CCommProtocolXYDFast::PackRePlcCalibrateFCBR(CString& strInfo,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FCBRParam.m_strCmd;
		int nCmdVal = m_FCBRParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FCBRParam.m_strCmd;
		int nCmdVal = m_FCBRParam.m_nCmdVal;
		int nVCmdValue = m_FCBRParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	return TRUE;
}


// 打包目标搜索结果
BOOL CCommProtocolXYDFast::PackRePlcTargetSearchFTGC(CString& strInfo,BOOL bResult, int nSuccessPatIndex/* = 0*/)
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FTGCParam.m_strCmd;
		int nCmdVal = m_FTGCParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? nSuccessPatIndex : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		AttachAxisDataToCmd(vnWriteData);
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FTGCParam.m_strCmd;
		int nCmdVal = m_FTGCParam.m_nCmdVal;
		int nVCmdValue = m_FTGCParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		AttachAxisDataToCmd(vnWriteData);
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FTGCParam.m_strCmd;
	// 	int nCmdVal = m_FTGCParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? nSuccessPatIndex : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;

}
// 打包目标搜索结果
BOOL CCommProtocolXYDFast::PackRePlcTargetSearchFTGT(CString& strInfo,BOOL bResult)
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FTGTParam.m_strCmd;
		int nCmdVal = m_FTGTParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		AttachAxisDataToCmd(vnWriteData);
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FTGTParam.m_strCmd;
		int nCmdVal = m_FTGTParam.m_nCmdVal;
		int nVCmdValue = m_FTGTParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		AttachAxisDataToCmd(vnWriteData);
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FTGTParam.m_strCmd;
	// 	int nCmdVal = m_FTGTParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;

}

BOOL CCommProtocolXYDFast::PackRePlcTargetSearchFTGM(CString& strInfo,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FTGMParam.m_strCmd;
		int nCmdVal = m_FTGMParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FTGMParam.m_strCmd;
		int nCmdVal = m_FTGMParam.m_nCmdVal;
		int nVCmdValue = m_FTGMParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FTGMParam.m_strCmd;
	// 	int nCmdVal = m_FTGMParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}


// 打包对象搜索结果
BOOL CCommProtocolXYDFast::PackRePlcObjectSearchFOBJ(CString& strInfo,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}


	if (m_bRegType)
	{
		CString strName = m_FOBJParam.m_strCmd;
		int nCmdVal = m_FOBJParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		AttachAxisDataToCmd(vnWriteData);
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FOBJParam.m_strCmd;
		int nCmdVal = m_FOBJParam.m_nCmdVal;
		int nVCmdValue = m_FOBJParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		AttachAxisDataToCmd(vnWriteData);
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FOBJParam.m_strCmd;
	// 	int nCmdVal = m_FOBJParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;

}

// 打包对象搜索结果
BOOL CCommProtocolXYDFast::PackRePlcObjectSearchFCNT(CString& strInfo,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FCNTParam.m_strCmd;
		int nCmdVal = m_FCNTParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FCNTParam.m_strCmd;
		int nCmdVal = m_FCNTParam.m_nCmdVal;
		int nVCmdValue = m_FCNTParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	return TRUE;

}


BOOL CCommProtocolXYDFast::PackRePlcTargetSearchFCNO(CString& strInfo,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FCNOParam.m_strCmd;
		int nCmdVal = m_FCNOParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FCNOParam.m_strCmd;
		int nCmdVal = m_FCNOParam.m_nCmdVal;
		int nVCmdValue = m_FCNOParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	return TRUE;

}

BOOL CCommProtocolXYDFast::PackRePlcObjectSearchFOBM(CString& strInfo,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FOBMParam.m_strCmd;
		int nCmdVal = m_FOBMParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FOBMParam.m_strCmd;
		int nCmdVal = m_FOBMParam.m_nCmdVal;
		int nVCmdValue = m_FOBMParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FOBMParam.m_strCmd;
	// 	int nCmdVal = m_FOBMParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}

// 打包对象搜索结果
BOOL CCommProtocolXYDFast::PackRePlcObjectSearchFOBC(CString& strInfo,BOOL bResult, int nSuccessPatIndex /* = 0 */)
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FOBCParam.m_strCmd;
		int nCmdVal = m_FOBCParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? nSuccessPatIndex : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		AttachAxisDataToCmd(vnWriteData);
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FOBCParam.m_strCmd;
		int nCmdVal = m_FOBCParam.m_nCmdVal;
		int nVCmdValue = m_FOBCParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		AttachAxisDataToCmd(vnWriteData);
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FOBCParam.m_strCmd;
	// 	int nCmdVal = m_FOBCParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? nSuccessPatIndex : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;

}

// 打包FACO基准中心对位轴位置
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFACOBenchAxisPos(CString& strInfo,BOOL bResult, BOOL bAlignBench, CCoordPos platOffset, CPlatformAxisPos* vpPlatAxisPos)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FACOParam.m_strCmd;
		int nCmdVal = m_FACOParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X)+6;	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bAlignBench == FALSE || bResult == FALSE|| pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

		return TRUE;
	}
	else
	{
		CString strName = m_FACOParam.m_strCmd;
		int nCmdVal = m_FACOParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD)+6;	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bAlignBench == FALSE || bResult == FALSE|| pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

		return TRUE;
	}

}

BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFAAOAxisPos( CString& strInfo, CCoordPos platOffset,BOOL bResult, CPlatformAxisPos* vpPlatAxisPos)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FAAOParam.m_strCmd;
		int nCmdVal = m_FAAOParam.m_nCmdVal;
		int nVCmdValue = m_FAAOParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (/*bResult == FALSE|| */pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FAAOParam.m_strCmd;
		int nCmdVal = m_FAAOParam.m_nCmdVal;
		int nVCmdValue = m_FAAOParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (/*bResult == FALSE|| */pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}

	return TRUE;
}

// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FACO R1 P2 P3 P4[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFACOAxisPos( CString& strInfo, CCoordPos platOffset,BOOL bResult, CPlatformAxisPos* vpPlatAxisPos)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FACOParam.m_strCmd;
		int nCmdVal = m_FACOParam.m_nCmdVal;
		int nVCmdValue = m_FACOParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (/*bResult == FALSE|| */pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SaveAxisPosDataNeedSend(vnWriteData,strInfo);
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FACOParam.m_strCmd;
		int nCmdVal = m_FACOParam.m_nCmdVal;
		int nVCmdValue = m_FACOParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (/*bResult == FALSE|| */pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData,TRUE))
		{
			return FALSE;
		}
		SaveAxisPosDataNeedSend(vnWriteData,strInfo);
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}

	return TRUE;
}

// 打包FAAO结果
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFAAO(CString& strInfo, BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FAAOParam.m_strCmd;
		int nCmdVal = m_FAAOParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FAAOParam.m_strCmd;
		int nCmdVal = m_FAAOParam.m_nCmdVal;
		int nVCmdValue = m_FAAOParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	return TRUE;
}

// 打包FACO结果
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFACO(CString& strInfo, BOOL bResult)
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FACOParam.m_strCmd;
		int nCmdVal = m_FACOParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		AttachAxisDataToCmd(vnWriteData);
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FACOParam.m_strCmd;
		int nCmdVal = m_FACOParam.m_nCmdVal;
		int nVCmdValue = m_FACOParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		AttachAxisDataToCmd(vnWriteData);
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FACOParam.m_strCmd;
	// 	int nCmdVal = m_FACOParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;

}



// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FOLC R1 P2 P3 P4[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFOLCAxisPos( CString& strInfo, CCoordPos platOffset,BOOL bResult, CPlatformAxisPos* vpPlatAxisPos)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FOLCParam.m_strCmd;
		int nCmdVal = m_FOLCParam.m_nCmdVal;
		int nVCmdValue = m_FOLCParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (/*bResult == FALSE|| */pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SaveAxisPosDataNeedSend(vnWriteData,strInfo);
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else
	{
		CString strName = m_FOLCParam.m_strCmd;
		int nCmdVal = m_FOLCParam.m_nCmdVal;
		int nVCmdValue = m_FOLCParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (/*bResult == FALSE|| */pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData,TRUE))
		{
			return FALSE;
		}

		SaveAxisPosDataNeedSend(vnWriteData,strInfo);
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackPlcReadQRCode(CString& strInfo,int AddrOffset,int nDataNum)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}	

	BOOL bRegType = FALSE;

	if (bRegType)		// 双字节
	{
		CString strName = m_MNPSParam.m_strCmd;
		int nCmdVal = m_MNPSParam.m_nCmdVal;
		int nParam = 0;
		long nRegAdrr = m_nPLCBaseRegAddr +AddrOffset+ m_nPLCIDRegAddr/*atoi(RREG_QRCODE_WORD)*/;// 寄存器地址
		//int  nDataNum = 10;													// 数据量
		int nRegAddrNum = (nDataNum + 3) / 4;
		m_strCmdName = strName;	
		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nRegAddrNum))
		{
			return FALSE;
		}
	}
	else				// 单字节
	{
		CString strName = m_MNPSParam.m_strCmd;
		int nVCmdVal = m_MNPSParam.m_nVCmdValue;
		int nParam = 0;
		long nRegAdrr = m_nPLCBaseRegAddr +AddrOffset+ m_nPLCIDRegAddr/*atoi(RREG_QRCODE_WORD)*/;// 寄存器地址
		//int  nDataNum = 10;													// 数据量
		int nRegAddrNum = (nDataNum + 1) / 2;
		m_strCmdName = strName;	
		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nRegAddrNum,FALSE))
		{
			return FALSE;
		}

	}

	// 	CString strName = m_MNPSParam.m_strCmd;
	// 	int nCmdVal = m_MNPSParam.m_nCmdVal;
	// 	int nParam = 0;
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_CURRENT_POS_X);	// 寄存器地址
	// 	int  nDataNum = 3;													// 数据量
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nDataNum))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackPlcReadSTATIONCode(CString& strInfo,int AddrOffset,int nDataNum/*=1*/)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}	

	BOOL bRegType = FALSE;

	if (bRegType)		// 双字节
	{
		CString strName = m_MNPSParam.m_strCmd;
		int nCmdVal = m_MNPSParam.m_nCmdVal;
		int nParam = 0;
		long nRegAdrr = m_nPLCBaseRegAddr +AddrOffset+ atoi(RREG_STATIONCODE_WORD);// 寄存器地址
		//int  nDataNum = 10;													// 数据量
		int nRegAddrNum = nDataNum ;
		m_strCmdName = strName;	
		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nRegAddrNum))
		{
			return FALSE;
		}
	}
	else				// 单字节
	{
		CString strName = m_MNPSParam.m_strCmd;
		int nVCmdVal = m_MNPSParam.m_nVCmdValue;
		int nParam = 0;
		long nRegAdrr = m_nPLCBaseRegAddr +AddrOffset+ atoi(RREG_STATIONCODE_WORD);// 寄存器地址
		//int  nDataNum = 10;													// 数据量
		int nRegAddrNum = nDataNum;
		m_strCmdName = strName;	
		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nRegAddrNum,FALSE))
		{
			return FALSE;
		}

	}

	return TRUE;	

}

BOOL CCommProtocolXYDFast::PackPlcReadInspectStationCode(CString& strInfo,int AddrOffset,int nDataNum/*=1*/)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}	

	BOOL bRegType = FALSE;

	if (bRegType)		// 双字节
	{
		CString strName = m_MNPSParam.m_strCmd;
		int nCmdVal = m_MNPSParam.m_nCmdVal;
		int nParam = 0;
		long nRegAdrr = m_nPLCBaseRegAddr +AddrOffset+ atoi(RREG_INSPECTSTATIONCODE_WORD);// 寄存器地址
		//int  nDataNum = 10;													// 数据量
		int nRegAddrNum = nDataNum ;
		m_strCmdName = strName;	
		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nRegAddrNum))
		{
			return FALSE;
		}
	}
	else				// 单字节
	{
		CString strName = m_MNPSParam.m_strCmd;
		int nVCmdVal = m_MNPSParam.m_nVCmdValue;
		int nParam = 0;
		long nRegAdrr = m_nPLCBaseRegAddr +AddrOffset+ atoi(RREG_INSPECTSTATIONCODE_WORD);// 寄存器地址
		//int  nDataNum = 10;													// 数据量
		int nRegAddrNum = nDataNum;
		m_strCmdName = strName;	
		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nRegAddrNum,FALSE))
		{
			return FALSE;
		}

	}

	return TRUE;	

}

BOOL CCommProtocolXYDFast::PackPlcReadTimeCode(CString& strInfo,int AddrOffset,int startaddroffset,int nDataNum/*=1*/)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}	

	BOOL bRegType = FALSE;

	if (bRegType)		// 双字节
	{
		CString strName = m_MNPSParam.m_strCmd;
		int nCmdVal = m_MNPSParam.m_nCmdVal;
		int nParam = 0;
		long nRegAdrr = m_nPLCBaseRegAddr +AddrOffset+ startaddroffset;// 寄存器地址
		//int  nDataNum = 10;													// 数据量
		int nRegAddrNum = nDataNum ;
		m_strCmdName = strName;	
		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nRegAddrNum))
		{
			return FALSE;
		}
	}
	else				// 单字节
	{
		CString strName = m_MNPSParam.m_strCmd;
		int nVCmdVal = m_MNPSParam.m_nVCmdValue;
		int nParam = 0;
		long nRegAdrr = m_nPLCBaseRegAddr +AddrOffset+ startaddroffset;// 寄存器地址
		//int  nDataNum = 10;													// 数据量
		int nRegAddrNum = nDataNum;
		m_strCmdName = strName;	
		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nRegAddrNum,FALSE))
		{
			return FALSE;
		}
	}

	return TRUE;

}

BOOL CCommProtocolXYDFast::PackRePlcReadQRCode(CString& strInfo,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}	

	if (m_bRegType)		// 双字节
	{
		CString strName = m_FQRCParam.m_strCmd;
		int nCmdVal = m_FQRCParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else				// 单字节
	{
		CString strName = m_FQRCParam.m_strCmd;
		int nVCmdValue = m_FQRCParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData),FALSE)
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);
	}
	return TRUE;
}

CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswPlcReadQRCode(CString strAsw,vector<int>& vnReceivedData, int nQRLen, BOOL SnCodeInvert)
{
	vector<int> vnRQCode;

	bool bRegType = false;

	// 解析字符串
	if (bRegType)
	{
		int  nDataNum = 20;														// 数据量
		if (!m_pCommProRegBase->AnalyzeAswReadReg(strAsw, nDataNum, vnRQCode))
		{
			return eAswCmdErr;
		}

		if (vnRQCode.size() != nDataNum)
		{
			return eAswCmdErr;
		}

		for(int i = 0 ; i < nDataNum ; i++)
		{
			int nByte1 = (vnRQCode[i]>>24)&0xff;
			int nByte2 = (vnRQCode[i]>>16)&0xff;
			int nByte3 = (vnRQCode[i]>>8)&0xff;
			int nByte4 = (vnRQCode[i])&0xff;
			if(SnCodeInvert)
			{
				vnReceivedData.push_back(nByte2);
				vnReceivedData.push_back(nByte1);
				vnReceivedData.push_back(nByte4);
				vnReceivedData.push_back(nByte3);
			}else
			{
				vnReceivedData.push_back(nByte1);
				vnReceivedData.push_back(nByte2);
				vnReceivedData.push_back(nByte3);
				vnReceivedData.push_back(nByte4);
			}
		}

		return eAswSucceed;
	}
	else
	{
		int  nDataNum = (nQRLen + 1) / 2;//最大														// 数据量
		if (!m_pCommProRegBase->AnalyzeAswReadReg(strAsw, nDataNum, vnRQCode,FALSE))
		{
			return eAswCmdErr;
		}

		if (vnRQCode.size() != nDataNum)
		{
			return eAswCmdErr;
		}		
		for(int i = 0 ; i < nDataNum ; i++)
		{
		
			int nByte1 = (vnRQCode[i]>>8)&0x000000ff;
			int nByte2 = (vnRQCode[i])&0x000000ff;
			if(SnCodeInvert)
			{
				vnReceivedData.push_back(nByte2);
				vnReceivedData.push_back(nByte1);
			}else
			{
				vnReceivedData.push_back(nByte1);
				vnReceivedData.push_back(nByte2);
			}
		}


		if(nDataNum * 2 != nQRLen && vnReceivedData.size() > 0)
		{
			vnReceivedData[vnReceivedData.size()-1] = 0;
		}


		return eAswSucceed;
	}
}


CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswPlcReadTimeCode(CString strAsw,vector<int>& vnReceivedData, int nQRLen, BOOL SnCodeInvert)
{
	vector<int> vnRQCode;

	bool bRegType = false;

	// 解析字符串
	if (bRegType)
	{
		int  nDataNum = 20;														// 数据量
		if (!m_pCommProRegBase->AnalyzeAswReadReg(strAsw, nDataNum, vnRQCode))
		{
			return eAswCmdErr;
		}

		if (vnRQCode.size() != nDataNum)
		{
			return eAswCmdErr;
		}

		for(int i = 0 ; i < nDataNum ; i++)
		{
			int nByte1 = (vnRQCode[i]>>24)&0xff;
			int nByte2 = (vnRQCode[i]>>16)&0xff;
			int nByte3 = (vnRQCode[i]>>8)&0xff;
			int nByte4 = (vnRQCode[i])&0xff;
			if(SnCodeInvert)
			{
				vnReceivedData.push_back(nByte2);
				vnReceivedData.push_back(nByte1);
				vnReceivedData.push_back(nByte4);
				vnReceivedData.push_back(nByte3);
			}else
			{
				vnReceivedData.push_back(nByte1);
				vnReceivedData.push_back(nByte2);
				vnReceivedData.push_back(nByte3);
				vnReceivedData.push_back(nByte4);
			}
		}

		return eAswSucceed;
	}
	else
	{
		int  nDataNum = (nQRLen + 1) / 2;//最大														// 数据量
		if (!m_pCommProRegBase->AnalyzeAswReadReg(strAsw, nDataNum, vnRQCode,FALSE))
		{
			return eAswCmdErr;
		}

		if (vnRQCode.size() != nDataNum)
		{
			return eAswCmdErr;
		}		
		//for(int i = 0 ; i < nDataNum ; i++)
		//{
		//	

		//	/*int nByte1 = (vnRQCode[i]>>8)&0x000000ff;
		//	int nByte2 = (vnRQCode[i])&0x000000ff;
		//	if(SnCodeInvert)
		//	{
		//	vnReceivedData.push_back(nByte2);
		//	vnReceivedData.push_back(nByte1);
		//	}else
		//	{
		//	vnReceivedData.push_back(nByte1);
		//	vnReceivedData.push_back(nByte2);
		//	}*/
		//}
		 vnReceivedData = vnRQCode;

		if(nDataNum * 2 != nQRLen && vnReceivedData.size() > 0)
		{
			vnReceivedData[vnReceivedData.size()-1] = 0;
		}


		return eAswSucceed;

}
}


// 打包FOLC结果
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFOLC(CString& strInfo, BOOL bResult)
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FOLCParam.m_strCmd;
		int nCmdVal = eCmdValGetTargetObjectOffsetFOLC;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		AttachAxisDataToCmd(vnWriteData);
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else
	{
		CString strName = m_FOLCParam.m_strCmd;
		int nCmdVal = m_FOLCParam.m_nCmdVal;
		int nVCmdValue = m_FOLCParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		AttachAxisDataToCmd(vnWriteData);
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);
	}

	// 	CString strName = m_FACOParam.m_strCmd;
	// 	int nCmdVal = m_FACOParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;

}


BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFGTCAxisPos( CString& strInfo, CCoordPos platOffset,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FGTCParam.m_strCmd;
		int nCmdVal = m_FGTCParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		double dParam = 0;
		dParam = platOffset.m_dPosX;
		PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = platOffset.m_dPosY;
		PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		dParam = platOffset.m_dAngle;
		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}
	else
	{
		CString strName = m_FGTCParam.m_strCmd;
		int nCmdVal = m_FGTCParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		double dParam = 0;
		dParam = platOffset.m_dPosX;
		PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = platOffset.m_dPosY;
		PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		dParam = platOffset.m_dAngle;
		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}

	return TRUE;
}


BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFGTC(CString& strInfo, BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FGTCParam.m_strCmd;
		int nCmdVal = m_FGTCParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else
	{
		CString strName = m_FGTCParam.m_strCmd;
		int nCmdVal = m_FGTCParam.m_nCmdVal;
		int nVCmdValue = m_FGTCParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);
	}

	return TRUE;
}


// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FGAP R1 P2 P3 P4[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFGAPAxisPos( CString& strInfo, CCoordPos platOffset,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FGAPParam.m_strCmd;
		int nCmdVal = m_FGAPParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		double dParam = 0;
		dParam = platOffset.m_dPosX;
		PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = platOffset.m_dPosY;
		PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		dParam = platOffset.m_dAngle;
		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);



		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}
	else
	{
		CString strName = m_FGAPParam.m_strCmd;
		int nCmdVal = m_FGAPParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		double dParam = 0;
		dParam = platOffset.m_dPosX;
		PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = platOffset.m_dPosY;
		PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		dParam = platOffset.m_dAngle;
		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);



		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}

	return TRUE;

	// 	CString strName = m_FGAPParam.m_strCmd;
	// 	int nCmdVal = m_FGAPParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);	// 寄存器地址
	// 	int  nDataNum = 3;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	double dParam = 0;
	// 	dParam = platOffset.m_dPosX;
	// 	PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 	dParam = platOffset.m_dPosY;
	// 	PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 	dParam = platOffset.m_dAngle;
	// 	PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 
	// 
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}
	// 
	// 	return TRUE;
}

// 打包FGAP结果
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFGAP(CString& strInfo, BOOL bResult)
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FGAPParam.m_strCmd;
		int nCmdVal = m_FGAPParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else
	{
		CString strName = m_FGAPParam.m_strCmd;
		int nCmdVal = m_FGAPParam.m_nCmdVal;
		int nVCmdValue = m_FGAPParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);
	}

	// 	CString strName = m_FGAPParam.m_strCmd;
	// 	int nCmdVal = m_FGAPParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;

}


// 5.1、FWDR:获取目标/对象Mark的平台坐标系半径（相对于旋转中心的距离）
BOOL CCommProtocolXYDFast::PackRePlcGetSearchWorldRadiusFWDRRadius(CString& strInfo,BOOL bResult, CCoordPos platOffset)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FWDRParam.m_strCmd;
		int nCmdVal = m_FWDRParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);	// 寄存器地址
		int  nDataNum = 1;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		double dParam = 0;
		dParam = platOffset.m_dPosX;
		PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}
	else
	{
		CString strName = m_FWDRParam.m_strCmd;
		int nCmdVal = m_FWDRParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD);	// 寄存器地址
		int  nDataNum = 1;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		double dParam = 0;
		dParam = platOffset.m_dPosX;
		PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}

	return TRUE;
}
// 5.1、FWDR:获取目标/对象Mark的平台坐标系半径（相对于旋转中心的距离）
BOOL CCommProtocolXYDFast::PackRePlcGetSearchWorldRadiusFWDR(CString& strInfo,BOOL bResult)
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FWDRParam.m_strCmd;
		int nCmdVal = m_FWDRParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else
	{
		CString strName = m_FWDRParam.m_strCmd;
		int nCmdVal = m_FWDRParam.m_nCmdVal;
		int nVCmdValue = m_FWDRParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);
	}

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackRePlcGetTargetImagePosFGTPPos(CString& strInfo,BOOL bResult, std::vector<int> vnPosIndex,std::vector<CCoordPos>& vImagePos,std::vector<CPlatformXYDAxisPos> &vPlatformAxis)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}
	if (m_bRegType)
	{
		CString strName = m_FGTPParam.m_strCmd;
		int nCmdVal = m_FGTPParam.m_nCmdVal;
		m_strCmdName = strName;	
		int nParam = 0;

		int nPosNum = 0;
		if (bResult)
		{
			nPosNum = vnPosIndex.size();
		}

		// 寄存器首地址
		long nRegAdrr = m_nPLCTempBaseRegAddr /*+ atoi(RREG_VISION_PLATFORM_TEMP_POS)*/;

		int  nDataNum = (nPosNum*7+nPosNum*3) + 1;	
		//int  nDataNum = nPosNum*4+1;
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		nParam = nPosNum;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

		for (int i=0;i<nPosNum;i++)
		{			
			PackPlcParam(vnWriteData[1 + i*7], vnPosIndex.at(i), m_CommProtocolParam.m_nCommUnitExp);
			double dParam = 0;
			dParam = vImagePos.at(i).GetPosX();
			PackPlcParam(vnWriteData[2 + i*7], dParam, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = vImagePos.at(i).GetPosY();
			PackPlcParam(vnWriteData[3 + i*7], dParam, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = vImagePos.at(i).GetAuxiliaryPosX(0);
			PackPlcParam(vnWriteData[4 + i*7], dParam, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = vImagePos.at(i).GetAuxiliaryPosY(0);
			PackPlcParam(vnWriteData[5 + i*7], dParam, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = vImagePos.at(i).GetAuxiliaryPosX(1);
			PackPlcParam(vnWriteData[6 + i*7], dParam, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = vImagePos.at(i).GetAuxiliaryPosY(1);
			PackPlcParam(vnWriteData[7 + i*7], dParam, m_CommProtocolParam.m_nCommYUnitExp);

		}

		for (int i=0;i<nPosNum;i++)
		{			
			PackPlcParam(vnWriteData[1 + nPosNum*7 + i*3], vnPosIndex.at(i), m_CommProtocolParam.m_nCommUnitExp);
			double dParam = 0;
			dParam = vPlatformAxis.at(i).m_dPosX;
			PackPlcParam(vnWriteData[2 + nPosNum*7 + i*3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = vPlatformAxis.at(i).m_dPosY;
			PackPlcParam(vnWriteData[3 + nPosNum*7 + i*3], dParam, m_CommProtocolParam.m_nCommYUnitExp);


		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}


		return TRUE;
	}
	else
	{
		CString strName = m_FGTPParam.m_strCmd;
		int nCmdVal = m_FGTPParam.m_nCmdVal;
		m_strCmdName = strName;	
		int nParam = 0;

		int nPosNum = 0;
		if (bResult)
		{
			nPosNum = vnPosIndex.size();
		}

		// 寄存器首地址
		long nRegAdrr = m_nPLCTempBaseRegAddr /*+ atoi(RREG_VISION_PLATFORM_TEMP_POS)*/;

		int  nDataNum = (nPosNum*7+nPosNum*3) + 1;		

		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		nParam = nPosNum;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

		for (int i=0;i<nPosNum;i++)
		{			
			PackPlcParam(vnWriteData[1 + i*7], vnPosIndex.at(i), m_CommProtocolParam.m_nCommUnitExp);
			double dParam = 0;
			dParam = vImagePos.at(i).GetPosX();
			PackPlcParam(vnWriteData[2 + i*7], dParam, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = vImagePos.at(i).GetPosY();
			PackPlcParam(vnWriteData[3 + i*7], dParam, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = vImagePos.at(i).GetAuxiliaryPosX(0);
			PackPlcParam(vnWriteData[4 + i*7], dParam, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = vImagePos.at(i).GetAuxiliaryPosY(0);
			PackPlcParam(vnWriteData[5 + i*7], dParam, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = vImagePos.at(i).GetAuxiliaryPosX(1);
			PackPlcParam(vnWriteData[6 + i*7], dParam, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = vImagePos.at(i).GetAuxiliaryPosY(1);
			PackPlcParam(vnWriteData[7 + i*7], dParam, m_CommProtocolParam.m_nCommYUnitExp);

		}

		for (int i=0;i<nPosNum;i++)
		{			
			PackPlcParam(vnWriteData[1 + nPosNum*7 + i*3], vnPosIndex.at(i-nPosNum), m_CommProtocolParam.m_nCommUnitExp);
			double dParam = 0;
			dParam = vPlatformAxis.at(i).m_dPosX;
			PackPlcParam(vnWriteData[2 + nPosNum*7 + i*3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = vPlatformAxis.at(i).m_dPosY;
			PackPlcParam(vnWriteData[3 + nPosNum*7 + i*3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		}
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData, TRUE))
		{
			return FALSE;
		}

		return TRUE;
	}

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackRePlcGetTargetPlartformPosFGTWPos(CString& strInfo,BOOL bResult,std::vector<int> vnPosIndex, std::vector<CCoordPos>& vCoordPos,std::vector<CPlatformXYDAxisPos> &vPlatformAxis)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}
	if (m_bRegType)
	{
		CString strName = m_FGTWParam.m_strCmd;
		int nCmdVal = m_FGTWParam.m_nCmdVal;
		m_strCmdName = strName;	
		int nParam = 0;

		int nPosNum = 0;
		if (bResult)
		{
			nPosNum = vnPosIndex.size();
		}

		// 寄存器首地址
		long nRegAdrr = m_nPLCTempBaseRegAddr /*+ atoi(RREG_VISION_PLATFORM_TEMP_POS)*/;

		int  nDataNum = ((nPosNum*2) * 4) + 1;	
		//int  nDataNum = nPosNum*4+1;
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		nParam = nPosNum;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

		for (int i=0;i<nPosNum;i++)
		{			
			PackPlcParam(vnWriteData[1 + i*4], vnPosIndex.at(i), m_CommProtocolParam.m_nCommUnitExp);
			double dParam = 0;
			dParam = vCoordPos.at(i).GetPosX();
			PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = vCoordPos.at(i).GetPosY();
			PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = vCoordPos.at(i).GetAngle();
			PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);
		}

		for (int i=nPosNum;i<nPosNum*2;i++)
		{			
			PackPlcParam(vnWriteData[1 + i*4], vnPosIndex.at(i-nPosNum), m_CommProtocolParam.m_nCommUnitExp);
			double dParam = 0;
			dParam = vPlatformAxis.at(i-nPosNum).m_dPosX;
			PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = vPlatformAxis.at(i-nPosNum).m_dPosY;
			PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = vPlatformAxis.at(i-nPosNum).m_dAngle;
			PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}


		return TRUE;
	}
	else
	{
		CString strName = m_FGTWParam.m_strCmd;
		int nCmdVal = m_FGTWParam.m_nCmdVal;
		m_strCmdName = strName;	
		int nParam = 0;

		int nPosNum = 0;
		if (bResult)
		{
			nPosNum = vnPosIndex.size();
		}

		// 寄存器首地址
		long nRegAdrr = m_nPLCTempBaseRegAddr /*+ atoi(RREG_VISION_PLATFORM_TEMP_POS)*/;

		int  nDataNum = ((nPosNum*2) * 4) + 1;		

		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		nParam = nPosNum;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

		for (int i=0;i<nPosNum;i++)
		{			
			PackPlcParam(vnWriteData[1 + i*4], vnPosIndex.at(i), m_CommProtocolParam.m_nCommUnitExp);
			double dParam = 0;
			dParam = vCoordPos.at(i).GetPosX();
			PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = vCoordPos.at(i).GetPosY();
			PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = vCoordPos.at(i).GetAngle();
			PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);
		}

		for (int i=nPosNum;i<nPosNum*2;i++)
		{			
			PackPlcParam(vnWriteData[1 + i*4], vnPosIndex.at(i-nPosNum), m_CommProtocolParam.m_nCommUnitExp);
			double dParam = 0;
			dParam = vPlatformAxis.at(i-nPosNum).m_dPosX;
			PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = vPlatformAxis.at(i-nPosNum).m_dPosY;
			PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = vPlatformAxis.at(i-nPosNum).m_dAngle;
			PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);
		}
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData, TRUE))
		{
			return FALSE;
		}

		return TRUE;
	}

	return TRUE;
}

// 5.1、FGOW:拍照取得对象（对象靶标）的平台坐标上的位置
BOOL CCommProtocolXYDFast::PackRePlcGetObjectWorldPosFGOWAxisPos(CString& strInfo,BOOL bResult, CCoordPos platOffset)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FGOWParam.m_strCmd;
		int nCmdVal = m_FGOWParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		double dParam = 0;
		dParam = platOffset.m_dPosX;
		PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);

		dParam = platOffset.m_dPosY;
		PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}
	else
	{
		CString strName = m_FGOWParam.m_strCmd;
		int nCmdVal = m_FGOWParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		double dParam = 0;
		dParam = platOffset.m_dPosX;
		PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);

		dParam = platOffset.m_dPosY;
		PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackRePlcGetTargetPlartformPosFGTW(CString& strInfo,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}
	if (m_bRegType)
	{
		CString strName = m_FGTWParam.m_strCmd;
		int nCmdVal = m_FGTWParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else
	{
		CString strName = m_FGTWParam.m_strCmd;
		int nCmdVal = m_FGTWParam.m_nCmdVal;
		int nVCmdValue = m_FGTWParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);
	}

	return TRUE;
}
BOOL CCommProtocolXYDFast::PackRePlcGetTargetImagePosFGTP(CString& strInfo,BOOL bResult)

{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}
	if (m_bRegType)
	{
		CString strName = m_FGTPParam.m_strCmd;
		int nCmdVal = m_FGTPParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else
	{
		CString strName = m_FGTPParam.m_strCmd;
		int nCmdVal = m_FGTPParam.m_nCmdVal;
		int nVCmdValue = m_FGTPParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);
	}

	return TRUE;
}
// 5.1、FGOW:拍照取得对象（对象靶标）的平台坐标上的位置
BOOL CCommProtocolXYDFast::PackRePlcGetObjectWorldPosFGOW(CString& strInfo,BOOL bResult)
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FGOWParam.m_strCmd;
		int nCmdVal = m_FGOWParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else
	{
		CString strName = m_FGOWParam.m_strCmd;
		int nCmdVal = m_FGOWParam.m_nCmdVal;
		int nVCmdValue = m_FGOWParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);
	}

	return TRUE;
}

// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FABO R1 P2 P3 P4[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFABOAxisPos( CString& strInfo, CCoordPos platOffset,BOOL bResult, CPlatformAxisPos* vpPlatAxisPos)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FABOParam.m_strCmd;
		int nCmdVal = m_FABOParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bResult == FALSE|| pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SaveAxisPosDataNeedSend(vnWriteData,strInfo);
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}
	else
	{
		CString strName = m_FABOParam.m_strCmd;
		int nCmdVal = m_FABOParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bResult == FALSE|| pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, vnWriteData.size(), vnWriteData.size(), vnWriteData,TRUE))
		{
			return FALSE;
		}

		SaveAxisPosDataNeedSend(vnWriteData,strInfo);
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}

	return TRUE;

}


// 打包FABO结果
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFABO(CString& strInfo, BOOL bResult)
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FABOParam.m_strCmd;
		int nCmdVal = m_FABOParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		AttachAxisDataToCmd(vnWriteData);
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FABOParam.m_strCmd;
		int nCmdVal = m_FABOParam.m_nCmdVal;
		int nVCmdValue = m_FABOParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		AttachAxisDataToCmd(vnWriteData);
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FABOParam.m_strCmd;
	// 	int nCmdVal = m_FABOParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;

}


// 打包FAAL基准中心对位轴位置
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFAALBenchAxisPos(CString& strInfo,BOOL bResult, BOOL bAlignBench, CCoordPos platOffset, CPlatformAxisPos* vpPlatAxisPos)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FAALParam.m_strCmd;
		int nCmdVal = m_FAALParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X)+6;	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bAlignBench == FALSE || bResult == FALSE|| pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

		return TRUE;
	}
	else
	{
		CString strName = m_FAALParam.m_strCmd;
		int nCmdVal = m_FAALParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD)+6;	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bAlignBench == FALSE || bResult == FALSE|| pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}

	// 	CString strName = m_FAABParam.m_strCmd;
	// 	int nCmdVal = m_FAABParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);	// 寄存器地址
	// 	int  nDataNum = 3;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 
	// 	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	// 	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	// 	if (bAlignBench == FALSE || bResult == FALSE|| pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
	// 	{
	// 		if (eCPOrderYXD == m_eCmdParamOrderType)
	// 		{
	// 			double dParam = 0;
	// 			dParam = platOffset.m_dPosX;
	// 			PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 			dParam = platOffset.m_dPosY;
	// 			PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 			dParam = platOffset.m_dAngle;
	// 			PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 		}
	// 		else
	// 		{
	// 			double dParam = 0;
	// 			dParam = platOffset.m_dPosX;
	// 			PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 			dParam = platOffset.m_dPosY;
	// 			PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 			dParam = platOffset.m_dAngle;
	// 			PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 		}
	// 
	// 	}
	// 	else
	// 	{
	// 		switch(m_eMidPlatformType)
	// 		{
	// 		case ePlatformXYD:
	// 			{
	// 				if (eCPOrderYXD == m_eCmdParamOrderType)
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 				else
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 			}
	// 			break;
	// 		case ePlatformXYPD:
	// 			{
	// 				if (eCPOrderYXD == m_eCmdParamOrderType)
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 				else
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 			}
	// 			break;
	// 		case ePlatformXD:
	// 			{
	// 				if (eCPOrderYXD == m_eCmdParamOrderType)
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 				else
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 			}
	// 			break;
	// 		case ePlatformXY:
	// 			{
	// 				if (eCPOrderYXD == m_eCmdParamOrderType)
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 				else
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 			}
	// 			break;
	// 		case ePlatformXDPY:
	// 			{
	// 				if (eCPOrderYXD == m_eCmdParamOrderType)
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 				else
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 			}
	// 			break;
	// 		case ePlatformXDPY1:
	// 			{
	// 				if (eCPOrderYXD == m_eCmdParamOrderType)
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 				else
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 			}
	// 			break;
	// 		case ePlatformYD:
	// 			{
	// 				if (eCPOrderYXD == m_eCmdParamOrderType)
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 				else
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 			}
	// 			break;
	// 		case ePlatformXY1Y2:
	// 			{
	// 				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
	// 				{
	// 					double dToStartX1 = 0.0;
	// 					double dToStartY1 = 0.0;
	// 					double dToStartY2 = 0.0;
	// 
	// 					double dToEndX1 = 0.0;
	// 					double dToEndY1 = 0.0;
	// 					double dToEndY2 = 0.0;
	// 
	// 					double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
	// 					double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
	// 					double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;
	// 
	// 					double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
	// 					double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
	// 					double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;
	// 
	// 					CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;
	// 
	// 					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
	// 						dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);
	// 
	// 					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
	// 						dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);
	// 
	// 
	// 					double dParam = 0;
	// 					dParam = dToEndX1 - dToStartX1;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = dToEndY1 - dToStartY1;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = dToEndY2 - dToStartY2;
	// 					PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				}
	// 				else
	// 				{
	// 					return FALSE;
	// 				}
	// 			}
	// 			break;
	// 		case ePlatformX1X2Y:
	// 			{
	// 				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
	// 				{
	// 					double dToStartX1 = 0.0;
	// 					double dToStartX2 = 0.0;
	// 					double dToStartY1 = 0.0;
	// 
	// 					double dToEndX1 = 0.0;
	// 					double dToEndX2 = 0.0;
	// 					double dToEndY1 = 0.0;
	// 
	// 					double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
	// 					double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
	// 					double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;
	// 
	// 					double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
	// 					double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
	// 					double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;
	// 
	// 					CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;
	// 
	// 					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
	// 						dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
	// 					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
	// 						dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);
	// 
	// 					//dX1 = dX1 + 5.5;
	// 					//dX2 = dX2 + 5.5;
	// 					//dY1 = dY1 + 5.5;
	// 
	// 					double dParam = 0;
	// 					dParam = dToEndY1 - dToStartY1;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = dToEndX1 - dToStartX1;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = dToEndX2 - dToStartX2;
	// 					PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				}
	// 				else
	// 				{
	// 					return FALSE;
	// 				}
	// 			}
	// 			break;
	// 		default:
	// 			{
	// 				if (eCPOrderYXD == m_eCmdParamOrderType)
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 				else
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 			}
	// 		}
	// 	}
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}
	// 
	// 	return TRUE;
}


// 打包FAAC基准中心对位轴位置
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFAACBenchAxisPos(CString& strInfo,BOOL bResult, BOOL bAlignBench, CCoordPos platOffset, CPlatformAxisPos* vpPlatAxisPos)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FAACParam.m_strCmd;
		int nCmdVal = m_FAACParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X)+6;	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bAlignBench == FALSE || bResult == FALSE|| pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

		return TRUE;
	}
	else
	{
		CString strName = m_FAALParam.m_strCmd;
		int nCmdVal = m_FAALParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD)+6;	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bAlignBench == FALSE || bResult == FALSE|| pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}
}


BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFXYABenchAxisPos(CString& strInfo,BOOL bResult, BOOL bAlignBench, CCoordPos platOffset, CPlatformAxisPos* vpPlatAxisPos)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FXYAParam.m_strCmd;
		int nCmdVal = m_FXYAParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X)+6;	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bAlignBench == FALSE || bResult == FALSE|| pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;
				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

		return TRUE;
	}
	else
	{
		CString strName = m_FXYAParam.m_strCmd;
		int nCmdVal = m_FXYAParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD)+6;	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bAlignBench == FALSE || bResult == FALSE|| pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}
}



// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FAAL R1[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFAAL( CString& strInfo, BOOL bResult)
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FAALParam.m_strCmd;
		int nCmdVal = m_FAALParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FAALParam.m_strCmd;
		int nCmdVal = m_FAALParam.m_nCmdVal;
		int nVCmdValue = m_FAALParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FAALParam.m_strCmd;
	// 	int nCmdVal = m_FAALParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFXYA( CString& strInfo, BOOL bResult)
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}


	if (m_bRegType)
	{
		CString strName = m_FXYAParam.m_strCmd;
		int nCmdVal = m_FXYAParam.m_nCmdVal;
		int nVCmdValue = m_FXYAParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FXYAParam.m_strCmd;
		int nCmdVal = m_FXYAParam.m_nCmdVal;
		int nVCmdValue = m_FXYAParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}

// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FAAB R1 R2 R3 R4[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFAABAxisPos( CString& strInfo, BOOL bResult, BOOL bAlignBench, CCoordPos platOffset, CPlatformAxisPos* vpPlatAxisPos)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FAABParam.m_strCmd;
		int nCmdVal = m_FAABParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bAlignBench == FALSE || bResult == FALSE|| pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;

			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}
	else
	{
		CString strName = m_FAABParam.m_strCmd;
		int nCmdVal = m_FAABParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bAlignBench == FALSE || bResult == FALSE|| pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXDPY1:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;
			case ePlatformYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;
			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}

	// 	CString strName = m_FAABParam.m_strCmd;
	// 	int nCmdVal = m_FAABParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);	// 寄存器地址
	// 	int  nDataNum = 3;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 
	// 	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	// 	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	// 	if (bAlignBench == FALSE || bResult == FALSE|| pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
	// 	{
	// 		if (eCPOrderYXD == m_eCmdParamOrderType)
	// 		{
	// 			double dParam = 0;
	// 			dParam = platOffset.m_dPosX;
	// 			PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 			dParam = platOffset.m_dPosY;
	// 			PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 			dParam = platOffset.m_dAngle;
	// 			PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 		}
	// 		else
	// 		{
	// 			double dParam = 0;
	// 			dParam = platOffset.m_dPosX;
	// 			PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 			dParam = platOffset.m_dPosY;
	// 			PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 			dParam = platOffset.m_dAngle;
	// 			PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 		}
	// 
	// 	}
	// 	else
	// 	{
	// 		switch(m_eMidPlatformType)
	// 		{
	// 		case ePlatformXYD:
	// 			{
	// 				if (eCPOrderYXD == m_eCmdParamOrderType)
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 				else
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 			}
	// 			break;
	// 		case ePlatformXYPD:
	// 			{
	// 				if (eCPOrderYXD == m_eCmdParamOrderType)
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 				else
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 			}
	// 			break;
	// 		case ePlatformXD:
	// 			{
	// 				if (eCPOrderYXD == m_eCmdParamOrderType)
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 				else
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 			}
	// 			break;
	// 		case ePlatformXY:
	// 			{
	// 				if (eCPOrderYXD == m_eCmdParamOrderType)
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 				else
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 			}
	// 			break;
	// 		case ePlatformXDPY:
	// 			{
	// 				if (eCPOrderYXD == m_eCmdParamOrderType)
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 				else
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 			}
	// 			break;
	// 		case ePlatformXDPY1:
	// 			{
	// 				if (eCPOrderYXD == m_eCmdParamOrderType)
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 				else
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 			}
	// 			break;
	// 		case ePlatformYD:
	// 			{
	// 				if (eCPOrderYXD == m_eCmdParamOrderType)
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 				else
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 			}
	// 			break;
	// 		case ePlatformXY1Y2:
	// 			{
	// 				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
	// 				{
	// 					double dToStartX1 = 0.0;
	// 					double dToStartY1 = 0.0;
	// 					double dToStartY2 = 0.0;
	// 
	// 					double dToEndX1 = 0.0;
	// 					double dToEndY1 = 0.0;
	// 					double dToEndY2 = 0.0;
	// 
	// 					double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
	// 					double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
	// 					double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;
	// 
	// 					double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
	// 					double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
	// 					double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;
	// 
	// 					CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;
	// 
	// 					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
	// 						dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);
	// 
	// 					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
	// 						dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);
	// 
	// 
	// 					double dParam = 0;
	// 					dParam = dToEndX1 - dToStartX1;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = dToEndY1 - dToStartY1;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = dToEndY2 - dToStartY2;
	// 					PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				}
	// 				else
	// 				{
	// 					return FALSE;
	// 				}
	// 			}
	// 			break;
	// 		case ePlatformX1X2Y:
	// 			{
	// 				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
	// 				{
	// 					double dToStartX1 = 0.0;
	// 					double dToStartX2 = 0.0;
	// 					double dToStartY1 = 0.0;
	// 
	// 					double dToEndX1 = 0.0;
	// 					double dToEndX2 = 0.0;
	// 					double dToEndY1 = 0.0;
	// 
	// 					double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
	// 					double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
	// 					double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;
	// 
	// 					double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
	// 					double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
	// 					double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;
	// 
	// 					CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;
	// 
	// 					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
	// 						dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
	// 					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
	// 						dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);
	// 
	// 					//dX1 = dX1 + 5.5;
	// 					//dX2 = dX2 + 5.5;
	// 					//dY1 = dY1 + 5.5;
	// 
	// 					double dParam = 0;
	// 					dParam = dToEndY1 - dToStartY1;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = dToEndX1 - dToStartX1;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = dToEndX2 - dToStartX2;
	// 					PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				}
	// 				else
	// 				{
	// 					return FALSE;
	// 				}
	// 			}
	// 			break;
	// 		default:
	// 			{
	// 				if (eCPOrderYXD == m_eCmdParamOrderType)
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 				else
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 			}
	// 		}
	// 	}
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}
	// 
	// 	return TRUE;
}


// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FACB R1 R2 R3 R4[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFACBAxisPos( CString& strInfo, BOOL bResult, BOOL bAlignBench, CCoordPos platOffset, CPlatformAxisPos* vpPlatAxisPos)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FACBParam.m_strCmd;
		int nCmdVal = m_FACBParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bAlignBench == FALSE || bResult == FALSE|| pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXDPY:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;
			case ePlatformXDPY1:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;
			case ePlatformYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;
			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}
	else
	{
		CString strName = m_FACBParam.m_strCmd;
		int nCmdVal = m_FACBParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bAlignBench == FALSE || bResult == FALSE|| pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXDPY:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;
			case ePlatformXDPY1:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;
			case ePlatformYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;
			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}

	return TRUE;
	// 	CString strName = m_FACBParam.m_strCmd;
	// 	int nCmdVal = m_FACBParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);	// 寄存器地址
	// 	int  nDataNum = 3;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 
	// 	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	// 	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	// 	if (bAlignBench == FALSE || bResult == FALSE|| pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
	// 	{
	// 		if (eCPOrderYXD == m_eCmdParamOrderType)
	// 		{
	// 			double dParam = 0;
	// 			dParam = platOffset.m_dPosX;
	// 			PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 			dParam = platOffset.m_dPosY;
	// 			PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 			dParam = platOffset.m_dAngle;
	// 			PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 		}
	// 		else
	// 		{
	// 			double dParam = 0;
	// 			dParam = platOffset.m_dPosX;
	// 			PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 			dParam = platOffset.m_dPosY;
	// 			PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 			dParam = platOffset.m_dAngle;
	// 			PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 		}
	// 
	// 	}
	// 	else
	// 	{
	// 		switch(m_eMidPlatformType)
	// 		{
	// 		case ePlatformXYD:
	// 			{
	// 				if (eCPOrderYXD == m_eCmdParamOrderType)
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 				else
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 			}
	// 			break;
	// 		case ePlatformXYPD:
	// 			{
	// 				if (eCPOrderYXD == m_eCmdParamOrderType)
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 				else
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 			}
	// 			break;
	// 		case ePlatformXD:
	// 			{
	// 				if (eCPOrderYXD == m_eCmdParamOrderType)
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 				else
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 			}
	// 			break;
	// 		case ePlatformXY:
	// 			{
	// 				if (eCPOrderYXD == m_eCmdParamOrderType)
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 				else
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 			}
	// 			break;
	// 		case ePlatformXDPY:
	// 			{
	// 				if (eCPOrderYXD == m_eCmdParamOrderType)
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 				else
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 			}
	// 			break;
	// 		case ePlatformXDPY1:
	// 			{
	// 				if (eCPOrderYXD == m_eCmdParamOrderType)
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 				else
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 			}
	// 			break;
	// 		case ePlatformYD:
	// 			{
	// 				if (eCPOrderYXD == m_eCmdParamOrderType)
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 				else
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 			}
	// 			break;
	// 		case ePlatformXY1Y2:
	// 			{
	// 				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
	// 				{
	// 					double dToStartX1 = 0.0;
	// 					double dToStartY1 = 0.0;
	// 					double dToStartY2 = 0.0;
	// 
	// 					double dToEndX1 = 0.0;
	// 					double dToEndY1 = 0.0;
	// 					double dToEndY2 = 0.0;
	// 
	// 					double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
	// 					double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
	// 					double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;
	// 
	// 					double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
	// 					double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
	// 					double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;
	// 
	// 					CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;
	// 
	// 					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
	// 						dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);
	// 
	// 					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
	// 						dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);
	// 
	// 
	// 					double dParam = 0;
	// 					dParam = dToEndX1 - dToStartX1;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = dToEndY1 - dToStartY1;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = dToEndY2 - dToStartY2;
	// 					PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				}
	// 				else
	// 				{
	// 					return FALSE;
	// 				}
	// 			}
	// 			break;
	// 		case ePlatformX1X2Y:
	// 			{
	// 				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
	// 				{
	// 					double dToStartX1 = 0.0;
	// 					double dToStartX2 = 0.0;
	// 					double dToStartY1 = 0.0;
	// 
	// 					double dToEndX1 = 0.0;
	// 					double dToEndX2 = 0.0;
	// 					double dToEndY1 = 0.0;
	// 
	// 					double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
	// 					double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
	// 					double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;
	// 
	// 					double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
	// 					double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
	// 					double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;
	// 
	// 					CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;
	// 
	// 					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
	// 						dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
	// 					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
	// 						dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);
	// 
	// 					//dX1 = dX1 + 5.5;
	// 					//dX2 = dX2 + 5.5;
	// 					//dY1 = dY1 + 5.5;
	// 
	// 					double dParam = 0;
	// 					dParam = dToEndY1 - dToStartY1;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = dToEndX1 - dToStartX1;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = dToEndX2 - dToStartX2;
	// 					PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 				}
	// 				else
	// 				{
	// 					return FALSE;
	// 				}
	// 			}
	// 			break;
	// 		default:
	// 			{
	// 				if (eCPOrderYXD == m_eCmdParamOrderType)
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 				else
	// 				{
	// 					double dParam = 0;
	// 					dParam = platOffset.m_dPosX;
	// 					PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dPosY;
	// 					PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
	// 					dParam = platOffset.m_dAngle;
	// 					PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
	// 				}
	// 			}
	// 		}
	// 	}
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}
	// 
	// 	return TRUE;
}

// 打包FAAB结果
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFAAB(CString& strInfo,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)			// 双字节
	{
		CString strName = m_FAABParam.m_strCmd;
		int nCmdVal = m_FAABParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else					// 单字节
	{
		CString strName = m_FAABParam.m_strCmd;
		int nCmdVal = m_FAABParam.m_nCmdVal;
		int nVCmdValue = m_FAABParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);
	}

	// 	CString strName = m_FAABParam.m_strCmd;
	// 	int nCmdVal = m_FAABParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}

// 打包FACB结果
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFACB(CString& strInfo,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}


	if (m_bRegType)		// 双字节
	{
		CString strName = m_FACBParam.m_strCmd;
		int nCmdVal = m_FACBParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else				// 单字节
	{
		CString strName = m_FACBParam.m_strCmd;
		int nCmdVal = m_FACBParam.m_nCmdVal;
		int nVCmdValue = m_FACBParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData, FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);
	}

	// 	CString strName = m_FACBParam.m_strCmd;
	// 	int nCmdVal = m_FACBParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}

// 打包FAAC轴位置
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFAACAxisPos( CString& strInfo, CCoordPos platOffset,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FAACParam.m_strCmd;
		int nCmdVal = m_FAACParam.m_nCmdVal;
		int nVCmdValue = m_FAACParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		// 		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		// 		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (/*bResult == FALSE|| *//*pPlatformXYDAixisPos == NULL || */m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXDPY:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;
			case ePlatformXDPY1:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;
			case ePlatformYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;
				// 			case ePlatformXY1Y2:
				// 				{
				// 					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				// 					{
				// 						double dToStartX1 = 0.0;
				// 						double dToStartY1 = 0.0;
				// 						double dToStartY2 = 0.0;
				// 
				// 						double dToEndX1 = 0.0;
				// 						double dToEndY1 = 0.0;
				// 						double dToEndY2 = 0.0;
				// 
				// 						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
				// 						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
				// 						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;
				// 
				// 						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
				// 						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
				// 						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;
				// 
				// 						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;
				// 
				// 						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
				// 							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);
				// 
				// 						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
				// 							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);
				// 
				// 
				// 						double dParam = 0;
				// 						dParam = dToEndX1 - dToStartX1;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
				// 						dParam = dToEndY1 - dToStartY1;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
				// 						dParam = dToEndY2 - dToStartY2;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
				// 					}
				// 					else
				// 					{
				// 						return FALSE;
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX1X2Y:
				// 				{
				// 					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				// 					{
				// 						double dToStartX1 = 0.0;
				// 						double dToStartX2 = 0.0;
				// 						double dToStartY1 = 0.0;
				// 
				// 						double dToEndX1 = 0.0;
				// 						double dToEndX2 = 0.0;
				// 						double dToEndY1 = 0.0;
				// 
				// 						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
				// 						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
				// 						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;
				// 
				// 						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
				// 						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
				// 						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;
				// 
				// 						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;
				// 
				// 						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
				// 							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
				// 						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
				// 							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);
				// 
				// 						//dX1 = dX1 + 5.5;
				// 						//dX2 = dX2 + 5.5;
				// 						//dY1 = dY1 + 5.5;
				// 
				// 						double dParam = 0;
				// 						dParam = dToEndY1 - dToStartY1;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
				// 						dParam = dToEndX1 - dToStartX1;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
				// 						dParam = dToEndX2 - dToStartX2;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
				// 					}
				// 					else
				// 					{
				// 						return FALSE;
				// 					}
				// 				}
				// 				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else
	{
		CString strName = m_FAACParam.m_strCmd;
		int nCmdVal = m_FAACParam.m_nCmdVal;
		int nVCmdValue = m_FAACParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		// 		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		// 		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (/*bResult == FALSE|| *//*pPlatformXYDAixisPos == NULL || */m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXDPY:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;
			case ePlatformXDPY1:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;
			case ePlatformYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;
				// 			case ePlatformXY1Y2:
				// 				{
				// 					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				// 					{
				// 						double dToStartX1 = 0.0;
				// 						double dToStartY1 = 0.0;
				// 						double dToStartY2 = 0.0;
				// 
				// 						double dToEndX1 = 0.0;
				// 						double dToEndY1 = 0.0;
				// 						double dToEndY2 = 0.0;
				// 
				// 						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
				// 						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
				// 						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;
				// 
				// 						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
				// 						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
				// 						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;
				// 
				// 						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;
				// 
				// 						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
				// 							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);
				// 
				// 						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
				// 							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);
				// 
				// 
				// 						double dParam = 0;
				// 						dParam = dToEndX1 - dToStartX1;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
				// 						dParam = dToEndY1 - dToStartY1;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
				// 						dParam = dToEndY2 - dToStartY2;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
				// 					}
				// 					else
				// 					{
				// 						return FALSE;
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX1X2Y:
				// 				{
				// 					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				// 					{
				// 						double dToStartX1 = 0.0;
				// 						double dToStartX2 = 0.0;
				// 						double dToStartY1 = 0.0;
				// 
				// 						double dToEndX1 = 0.0;
				// 						double dToEndX2 = 0.0;
				// 						double dToEndY1 = 0.0;
				// 
				// 						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
				// 						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
				// 						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;
				// 
				// 						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
				// 						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
				// 						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;
				// 
				// 						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;
				// 
				// 						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
				// 							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
				// 						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
				// 							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);
				// 
				// 						//dX1 = dX1 + 5.5;
				// 						//dX2 = dX2 + 5.5;
				// 						//dY1 = dY1 + 5.5;
				// 
				// 						double dParam = 0;
				// 						dParam = dToEndY1 - dToStartY1;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
				// 						dParam = dToEndX1 - dToStartX1;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
				// 						dParam = dToEndX2 - dToStartX2;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
				// 					}
				// 					else
				// 					{
				// 						return FALSE;
				// 					}
				// 				}
				// 				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}

	return TRUE;
}

// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FAAC R1[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFAAC( CString& strInfo, BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)		// 双字节
	{
		CString strName = m_FAACParam.m_strCmd;
		int nCmdVal = m_FAACParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else				// 单字节
	{
		CString strName = m_FAACParam.m_strCmd;
		int nCmdVal = m_FAACParam.m_nCmdVal;
		int nVCmdValue = m_FAACParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);
	}

	// 	CString strName = m_FAACParam.m_strCmd;
	// 	int nCmdVal = m_FAACParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}

// 打包对象搜索结果
BOOL CCommProtocolXYDFast::PackRePlcACFInspectFCHB(CString& strInfo,BOOL bResult, int nSuccessPatIndex /* = 0 */)
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)	
	{
		CString strName = m_FCHBParam.m_strCmd;
		int nCmdVal = m_FCHBParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? nSuccessPatIndex : -1;
		PackPlcParam(vnWriteData[2], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FCHBParam.m_strCmd;
		int nCmdVal = m_FCHBParam.m_nCmdVal;
		int nVCmdValue = m_FCHBParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? nSuccessPatIndex : -1;
		PackPlcParam(vnWriteData[2], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);
	}


	return TRUE;

}


// 打包对象搜索结果
BOOL CCommProtocolXYDFast::PackRePlcACFInspectFCHBD(CString& strInfo, std::vector<double> vdDistance)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	int nDataNum = vdDistance.size();
	if (nDataNum < 0)
	{
		return FALSE;
	}

	if (m_bRegType)	
	{
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);	// 寄存器地址

		int nWriteData = 0;
		std::vector<int> vnWriteData;
		for (int i=0; i<nDataNum; i++)
		{
			PackPlcParam(nWriteData, vdDistance.at(i), m_CommProtocolParam.m_nCommXUnitExp);
			vnWriteData.push_back(nWriteData);
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else
	{
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD);	// 寄存器地址

		int nWriteData = 0;
		std::vector<int> vnWriteData;
		for (int i=0; i<nDataNum; i++)
		{
			PackPlcParam(nWriteData, vdDistance.at(i), m_CommProtocolParam.m_nCommXUnitExp);
			vnWriteData.push_back(nWriteData);
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}

	return TRUE;
}


BOOL CCommProtocolXYDFast::PackRePlcACFInspectFCHBAreaInspectSubResult(CString& strInfo, std::vector<BOOL> vbAreaInspectSubResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (vbAreaInspectSubResult.size() < 0)
	{
		return FALSE;
	}

	if (m_bRegType)	
	{
		long nRegAdrr = m_nPLCTempBaseRegAddr ;	// 备用寄存器地址
		int nParam = 0;
		int nWriteData = 0;
		std::vector<int> vnWriteData;

		// 将子结果数量作为第一个数据发送，以便于帮助PLC判断
		nParam = vbAreaInspectSubResult.size();
		PackPlcParam(nWriteData, nParam, m_CommProtocolParam.m_nCommUnitExp);
		vnWriteData.push_back(nWriteData);

		// 将全部子结果从第二个数据开始依次发送
		for (int i=0; i<vbAreaInspectSubResult.size(); i++)
		{
			nParam = vbAreaInspectSubResult[i]? 0: -1;
			PackPlcParam(nWriteData, nParam, m_CommProtocolParam.m_nCommUnitExp);
			vnWriteData.push_back(nWriteData);
		}

		int nDataNum = vbAreaInspectSubResult.size()+1;
		if (vnWriteData.size() != nDataNum)
		{
			return FALSE;
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData, TRUE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,nDataNum,vnWriteData,TRUE);
	}
	else
	{
		long nRegAdrr = m_nPLCTempBaseRegAddr ;	// 备用寄存器地址
		int nParam = 0;
		int nWriteData = 0;
		std::vector<int> vnWriteData;

		// 将子结果数量作为第一个数据发送，以便于帮助PLC判断
		nParam = vbAreaInspectSubResult.size();
		PackPlcParam(nWriteData, nParam, m_CommProtocolParam.m_nCommUnitExp);
		vnWriteData.push_back(nWriteData);

		// 将全部子结果从第二个数据开始依次发送
		for (int i=0; i<vbAreaInspectSubResult.size(); i++)
		{
			nParam = vbAreaInspectSubResult[i]? 1: 2;
			PackPlcParam(nWriteData, nParam, m_CommProtocolParam.m_nCommUnitExp);
			vnWriteData.push_back(nWriteData);
		}

		int nDataNum = vbAreaInspectSubResult.size()+1;
		if (vnWriteData.size() != nDataNum)
		{
			return FALSE;
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData, FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,nDataNum,vnWriteData,FALSE);
	}

	return TRUE;
}



// 打包对象搜索结果
BOOL CCommProtocolXYDFast::PackRePlcACFInspectFCHC(CString& strInfo,BOOL bResult, int nSuccessPatIndex /* = 0 */)
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)	
	{
		CString strName = m_FCHCParam.m_strCmd;
		int nCmdVal = m_FCHCParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? nSuccessPatIndex : -1;
		PackPlcParam(vnWriteData[2], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FCHCParam.m_strCmd;
		int nCmdVal = m_FCHCParam.m_nCmdVal;
		int nVCmdValue = m_FCHCParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? nSuccessPatIndex : -1;
		PackPlcParam(vnWriteData[2], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}


	return TRUE;

}


// 打包对象搜索结果
BOOL CCommProtocolXYDFast::PackRePlcFDRP(CString& strInfo,BOOL bResult)
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)	
	{
		CString strName = m_FDRPParam.m_strCmd;
		int nCmdVal = m_FDRPParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		CString strName = m_FDRPParam.m_strCmd;
		int nCmdVal = m_FDRPParam.m_nCmdVal;
		int nVCmdValue = m_FDRPParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);
	}

	return TRUE;

}


BOOL CCommProtocolXYDFast::PackRePlcClearProductFPEP(CString& strInfo,BOOL bResult) 
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FPEPParam.m_strCmd;
		int nCmdVal = m_FPEPParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,nDataNum,vnWriteData,TRUE);
	}
	else
	{
		CString strName = m_FPEPParam.m_strCmd;
		int nCmdVal = m_FPEPParam.m_nCmdVal;
		int nVCmdValue = m_FPEPParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,nDataNum,vnWriteData,FALSE);
	}

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackRePlcProductCopyFPCP(CString& strInfo, BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FPCPParam.m_strCmd;
		int nCmdVal = m_FPCPParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,nDataNum,vnWriteData,TRUE);
	}
	else
	{
		CString strName = m_FPCPParam.m_strCmd;
		int nCmdVal = m_FPCPParam.m_nCmdVal;
		int nVCmdValue = m_FPCPParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,nDataNum,vnWriteData,FALSE);
	}

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackRePlcProductRenameFPRN(CString& strInfo,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FPRNParam.m_strCmd;
		int nCmdVal = m_FPRNParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,nDataNum,vnWriteData,TRUE);
	}
	else
	{
		CString strName = m_FPRNParam.m_strCmd;
		int nCmdVal = m_FPRNParam.m_nCmdVal;
		int nVCmdValue = m_FPRNParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,nDataNum,vnWriteData,FALSE);
	}

	return TRUE;
}


// 打包FAOT轴位置
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFAOTAxisPos(CString& strInfo,BOOL bResult, BOOL bAlignBench, CCoordPos platOffset)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FAOTParam.m_strCmd;
		int nCmdVal = m_FAOTParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		// 		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		// 		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bAlignBench == FALSE || bResult == FALSE/*|| pPlatformXYDAixisPos == NULL */|| m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					// 					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					// 					{
					// 						double dToStartX1 = 0.0;
					// 						double dToStartY1 = 0.0;
					// 						double dToStartY2 = 0.0;
					// 
					// 						double dToEndX1 = 0.0;
					// 						double dToEndY1 = 0.0;
					// 						double dToEndY2 = 0.0;
					// 
					// 						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
					// 						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
					// 						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;
					// 
					// 						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
					// 						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
					// 						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;
					// 
					// 						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;
					// 
					// 						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
					// 							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);
					// 
					// 						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
					// 							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);
					// 
					// 
					// 						double dParam = 0;
					// 						dParam = dToEndX1 - dToStartX1;
					// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
					// 						dParam = dToEndY1 - dToStartY1;
					// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
					// 						dParam = dToEndY2 - dToStartY2;
					// 						PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
					// 					}
					// 					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					// 					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					// 					{
					// 						double dToStartX1 = 0.0;
					// 						double dToStartX2 = 0.0;
					// 						double dToStartY1 = 0.0;
					// 
					// 						double dToEndX1 = 0.0;
					// 						double dToEndX2 = 0.0;
					// 						double dToEndY1 = 0.0;
					// 
					// 						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
					// 						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
					// 						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;
					// 
					// 						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
					// 						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
					// 						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;
					// 
					// 						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;
					// 
					// 						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
					// 							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
					// 						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
					// 							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);
					// 
					// 						//dX1 = dX1 + 5.5;
					// 						//dX2 = dX2 + 5.5;
					// 						//dY1 = dY1 + 5.5;
					// 
					// 						double dParam = 0;
					// 						dParam = dToEndY1 - dToStartY1;
					// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
					// 						dParam = dToEndX1 - dToStartX1;
					// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
					// 						dParam = dToEndX2 - dToStartX2;
					// 						PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
					// 					}
					// 					else
					{
						return FALSE;
					}
				}
				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}
	else
	{
		CString strName = m_FAOTParam.m_strCmd;
		int nCmdVal = m_FAOTParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		// 		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		// 		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bAlignBench == FALSE || bResult == FALSE/*|| pPlatformXYDAixisPos == NULL */|| m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					// 					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					// 					{
					// 						double dToStartX1 = 0.0;
					// 						double dToStartY1 = 0.0;
					// 						double dToStartY2 = 0.0;
					// 
					// 						double dToEndX1 = 0.0;
					// 						double dToEndY1 = 0.0;
					// 						double dToEndY2 = 0.0;
					// 
					// 						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
					// 						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
					// 						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;
					// 
					// 						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
					// 						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
					// 						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;
					// 
					// 						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;
					// 
					// 						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
					// 							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);
					// 
					// 						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
					// 							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);
					// 
					// 
					// 						double dParam = 0;
					// 						dParam = dToEndX1 - dToStartX1;
					// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
					// 						dParam = dToEndY1 - dToStartY1;
					// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
					// 						dParam = dToEndY2 - dToStartY2;
					// 						PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
					// 					}
					// 					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					// 					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					// 					{
					// 						double dToStartX1 = 0.0;
					// 						double dToStartX2 = 0.0;
					// 						double dToStartY1 = 0.0;
					// 
					// 						double dToEndX1 = 0.0;
					// 						double dToEndX2 = 0.0;
					// 						double dToEndY1 = 0.0;
					// 
					// 						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
					// 						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
					// 						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;
					// 
					// 						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
					// 						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
					// 						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;
					// 
					// 						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;
					// 
					// 						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
					// 							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
					// 						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
					// 							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);
					// 
					// 						//dX1 = dX1 + 5.5;
					// 						//dX2 = dX2 + 5.5;
					// 						//dY1 = dY1 + 5.5;
					// 
					// 						double dParam = 0;
					// 						dParam = dToEndY1 - dToStartY1;
					// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
					// 						dParam = dToEndX1 - dToStartX1;
					// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
					// 						dParam = dToEndX2 - dToStartX2;
					// 						PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
					// 					}
					// 					else
					{
						return FALSE;
					}
				}
				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}

	return TRUE;
}


// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FAOT R1[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFAOT( CString& strInfo, BOOL bResult)
{


	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	CString strName = m_FAOTParam.m_strCmd;
	int nCmdVal = m_FAOTParam.m_nCmdVal;
	int nParam = 0;

	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	int  nDataNum = 2;											// 数据量
	std::vector<int> vnWriteData;
	vnWriteData.resize(nDataNum);

	m_strCmdName = strName;	

	nParam = nCmdVal;
	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	nParam = bResult ? 0 : -1;
	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	{
		return FALSE;
	}
	SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	return TRUE;
}


// 打包FALX轴位置
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFALXAxisPos(CString& strInfo,BOOL bResult, BOOL bAlignBench, CCoordPos platOffset)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FALXParam.m_strCmd;
		int nCmdVal = m_FALXParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		// 		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		// 		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bAlignBench == FALSE || bResult == FALSE/*|| pPlatformXYDAixisPos == NULL */|| m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					// 					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					// 					{
					// 						double dToStartX1 = 0.0;
					// 						double dToStartY1 = 0.0;
					// 						double dToStartY2 = 0.0;
					// 
					// 						double dToEndX1 = 0.0;
					// 						double dToEndY1 = 0.0;
					// 						double dToEndY2 = 0.0;
					// 
					// 						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
					// 						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
					// 						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;
					// 
					// 						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
					// 						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
					// 						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;
					// 
					// 						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;
					// 
					// 						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
					// 							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);
					// 
					// 						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
					// 							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);
					// 
					// 
					// 						double dParam = 0;
					// 						dParam = dToEndX1 - dToStartX1;
					// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
					// 						dParam = dToEndY1 - dToStartY1;
					// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
					// 						dParam = dToEndY2 - dToStartY2;
					// 						PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
					// 					}
					// 					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					// 					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					// 					{
					// 						double dToStartX1 = 0.0;
					// 						double dToStartX2 = 0.0;
					// 						double dToStartY1 = 0.0;
					// 
					// 						double dToEndX1 = 0.0;
					// 						double dToEndX2 = 0.0;
					// 						double dToEndY1 = 0.0;
					// 
					// 						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
					// 						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
					// 						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;
					// 
					// 						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
					// 						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
					// 						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;
					// 
					// 						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;
					// 
					// 						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
					// 							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
					// 						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
					// 							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);
					// 
					// 						//dX1 = dX1 + 5.5;
					// 						//dX2 = dX2 + 5.5;
					// 						//dY1 = dY1 + 5.5;
					// 
					// 						double dParam = 0;
					// 						dParam = dToEndY1 - dToStartY1;
					// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
					// 						dParam = dToEndX1 - dToStartX1;
					// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
					// 						dParam = dToEndX2 - dToStartX2;
					// 						PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
					// 					}
					// 					else
					{
						return FALSE;
					}
				}
				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}
	else
	{
		CString strName = m_FALXParam.m_strCmd;
		int nCmdVal = m_FALXParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		// 		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		// 		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bAlignBench == FALSE || bResult == FALSE/*|| pPlatformXYDAixisPos == NULL */|| m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					// 					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					// 					{
					// 						double dToStartX1 = 0.0;
					// 						double dToStartY1 = 0.0;
					// 						double dToStartY2 = 0.0;
					// 
					// 						double dToEndX1 = 0.0;
					// 						double dToEndY1 = 0.0;
					// 						double dToEndY2 = 0.0;
					// 
					// 						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
					// 						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
					// 						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;
					// 
					// 						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
					// 						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
					// 						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;
					// 
					// 						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;
					// 
					// 						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
					// 							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);
					// 
					// 						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
					// 							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);
					// 
					// 
					// 						double dParam = 0;
					// 						dParam = dToEndX1 - dToStartX1;
					// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
					// 						dParam = dToEndY1 - dToStartY1;
					// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
					// 						dParam = dToEndY2 - dToStartY2;
					// 						PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
					// 					}
					// 					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					// 					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					// 					{
					// 						double dToStartX1 = 0.0;
					// 						double dToStartX2 = 0.0;
					// 						double dToStartY1 = 0.0;
					// 
					// 						double dToEndX1 = 0.0;
					// 						double dToEndX2 = 0.0;
					// 						double dToEndY1 = 0.0;
					// 
					// 						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
					// 						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
					// 						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;
					// 
					// 						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
					// 						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
					// 						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;
					// 
					// 						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;
					// 
					// 						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
					// 							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
					// 						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
					// 							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);
					// 
					// 						//dX1 = dX1 + 5.5;
					// 						//dX2 = dX2 + 5.5;
					// 						//dY1 = dY1 + 5.5;
					// 
					// 						double dParam = 0;
					// 						dParam = dToEndY1 - dToStartY1;
					// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
					// 						dParam = dToEndX1 - dToStartX1;
					// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
					// 						dParam = dToEndX2 - dToStartX2;
					// 						PackPlcParam(vnWriteData[3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
					// 					}
					// 					else
					{
						return FALSE;
					}
				}
				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}

	return TRUE;
}


// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FALX R1[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFALX( CString& strInfo, BOOL bResult)
{


	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	CString strName = m_FALXParam.m_strCmd;
	int nCmdVal = m_FALXParam.m_nCmdVal;
	int nParam = 0;

	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	int  nDataNum = 2;											// 数据量
	std::vector<int> vnWriteData;
	vnWriteData.resize(nDataNum);

	m_strCmdName = strName;	

	nParam = nCmdVal;
	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	nParam = bResult ? 0 : -1;
	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	{
		return FALSE;
	}
	SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	return TRUE;
}


// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FAHL R1[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFAHL( CString& strInfo, BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)		// 双字节
	{
		CString strName = m_FAHLParam.m_strCmd;
		int nCmdVal = m_FAHLParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		AttachAxisDataToCmd(vnWriteData);
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else				// 单字节
	{
		CString strName = m_FAHLParam.m_strCmd;
		int nCmdVal = m_FAHLParam.m_nCmdVal;
		int nVCmdValue = m_FAHLParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		AttachAxisDataToCmd(vnWriteData);
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);
	}

	// 	CString strName = m_FAHLParam.m_strCmd;
	// 	int nCmdVal = m_FAHLParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}

// 打包FALG基准中心对位轴位置
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFALGBenchAxisPos(CString& strInfo,BOOL bResult, BOOL bAlignBench, CCoordPos platOffset, CPlatformAxisPos* vpPlatAxisPos)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FALGParam.m_strCmd;
		int nCmdVal = m_FALGParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X)+6;	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bAlignBench == FALSE || bResult == FALSE|| pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}
	else
	{
		CString strName = m_FALGParam.m_strCmd;
		int nCmdVal = m_FALGParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD)+6;	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bAlignBench == FALSE || bResult == FALSE|| pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}
}

BOOL CCommProtocolXYDFast::PackRePlcAlignInspectDistanceInfo(CString& strInfo,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_BACKUP);	// 寄存器地址
		int  nDataNum = 0;	
		if (m_bEnablePackInspectDistance)
		{
			for (int k=0;k<m_vstL2LDistanceResult.size();k++)
			{
				if (m_vstL2LDistanceResult.at(k).m_bPosSearchFinished)
				{
					nDataNum+=3;
				}
			}
		}// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);
		if(nDataNum==0)
		{
			// 暂时规避，出现nDataNum=0时，打包的strInfo 异常，PLC无法识别指令问题
			nDataNum=1;
		}


		if (m_bEnablePackInspectDistance)
		{
			int nAdressIndex=-1;
			double dParam = 0;
			int nParam=0;
			for (int i =0;i<m_vstL2LDistanceResult.size();i++)
			{
				if (m_vstL2LDistanceResult.at(i).m_bPosSearchFinished)
				{
					nAdressIndex+=1;
					dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[0];
					PackPlcParam(vnWriteData[3*nAdressIndex], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[1];
					PackPlcParam(vnWriteData[3*nAdressIndex+1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					BOOL bOK = TRUE;
					for(int j=0;j<2;j++)
					{
						if (m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_nResult[j]!=1)
						{
							bOK=bOK&&FALSE;
						}
					}
					nParam = bOK? 0 : -1;
					PackPlcParam(vnWriteData[3*nAdressIndex+2], nParam, m_CommProtocolParam.m_nCommUnitExp);
				}

			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);


		return TRUE;
	}
	else
	{

		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_BACKUP_WORD);	// 寄存器地址
		int  nDataNum = 0;											// 数据量
		if (m_bEnablePackInspectDistance)
		{
			for (int k=0;k<m_vstL2LDistanceResult.size();k++)
			{
				if (m_vstL2LDistanceResult.at(k).m_bPosSearchFinished)
				{
					nDataNum+=3;
				}
			}
		}
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		if (m_bEnablePackInspectDistance)
		{
			int nAdressIndex=-1;
			double dParam = 0;
			int nParam=0;
			for (int i =0;i<m_vstL2LDistanceResult.size();i++)
			{
				if (m_vstL2LDistanceResult.at(i).m_bPosSearchFinished)
				{
					nAdressIndex+=1;
					dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[0];
					PackPlcParam(vnWriteData[3*nAdressIndex], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[1];
					PackPlcParam(vnWriteData[3*nAdressIndex+1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					BOOL bOK = TRUE;
					for(int j=0;j<2;j++)
					{
						if (m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_nResult[j]!=1)
						{
							bOK=bOK&&FALSE;
						}
					}
					nParam = bOK? 0 : -1;
					PackPlcParam(vnWriteData[3*nAdressIndex+2], nParam, m_CommProtocolParam.m_nCommUnitExp);
				}

			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

		return TRUE;
	}

	return TRUE;
}

// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FALG R1 P2 P3 P4[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFALGAxisPos( CString& strInfo,CPlatformAxisPos* vpPlatAxisPos,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FALGParam.m_strCmd;
		int nCmdVal = m_FALGParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bResult == FALSE || m_pMidPlatformInfo == NULL)
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

			}
			else
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dY1 = 0.0;
						double dY2 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(dX0, dY0, dD0, dY1, dY2, dX1);


						double dParam = 0;
						dParam = dX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dX2 = 0.0;
						double dY1 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(dX0, dY0, dD0, dX1, dX2, dY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
				}
			}
		}


		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SaveAxisPosDataNeedSend(vnWriteData,strInfo);
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);


		return TRUE;
	}
	else
	{
		CString strName = m_FALGParam.m_strCmd;
		int nCmdVal = m_FALGParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bResult == FALSE || m_pMidPlatformInfo == NULL)
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

			}
			else
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dY1 = 0.0;
						double dY2 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(dX0, dY0, dD0, dY1, dY2, dX1);


						double dParam = 0;
						dParam = dX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dX2 = 0.0;
						double dY1 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(dX0, dY0, dD0, dX1, dX2, dY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
				}
			}
		}


		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData,TRUE))
		{
			return FALSE;
		}
		SaveAxisPosDataNeedSend(vnWriteData,strInfo);
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

		return TRUE;
	}

	return TRUE;

}

// 打包FALG结果
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFALG(CString& strInfo, BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)		// 双字节
	{
		CString strName = m_FALGParam.m_strCmd;
		int nCmdVal = m_FALGParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		AttachAxisDataToCmd(vnWriteData);
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else				// 单字节
	{
		CString strName = m_FALGParam.m_strCmd;
		int nCmdVal = m_FALGParam.m_nCmdVal;
		int nVCmdValue = m_FALGParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		AttachAxisDataToCmd(vnWriteData);
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData, FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FALGParam.m_strCmd;
	// 	int nCmdVal = m_FALGParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}

// BOOL CCommProtocolXYDFast::PackRePlcMulAlignPosResultInfoFALPAxisPos(CString& strInfo,std::vector<CPlatformXYDAxisPos> vPlatformXYDAxisPos,BOOL bResult)
// {
// 	if (m_pCommProRegBase == NULL)
// 	{
// 		return FALSE;
// 	}
// 
// 	if (m_bRegType)
// 	{
// 		CString strName = m_FALPParam.m_strCmd;
// 		int nCmdVal = m_FALPParam.m_nCmdVal;
// 		m_strCmdName = strName;	
// 		int nParam = 0;
// 
// 		int nTempDataNum = vPlatformXYDAxisPos.size();
// 
// 		// 寄存器首地址
// 		long nRegAdrr = m_nPLCTempBaseRegAddr + atoi(RREG_VISION_PLATFORM_TEMP_POS);
// 
// 		int  nDataNum = nTempDataNum * 3;	
// 
// 		std::vector<int> vnWriteData;
// 		vnWriteData.resize(nDataNum);
// 
// 		for (int i = 0; i < nTempDataNum; i++)
// 		{
// 
// 			CPlatformXYDAxisPos pPlatformXYDAixisPos; 		
// 			pPlatformXYDAixisPos = (CPlatformXYDAxisPos)(vPlatformXYDAxisPos.at(i));	
// 
// 			if (bResult == FALSE || m_pMidPlatformInfo == NULL)
// 			{
// 				if (eCPOrderYXD == m_eCmdParamOrderType)
// 				{
// 					double dParam = 0;
// 					dParam = pPlatformXYDAixisPos.m_dPosX;
// 					PackPlcParam(vnWriteData[1 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 					dParam = pPlatformXYDAixisPos.m_dPosY;
// 					PackPlcParam(vnWriteData[0 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 					dParam = pPlatformXYDAixisPos.m_dAngle;
// 					PackPlcParam(vnWriteData[2 + i*3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 				}
// 				else
// 				{
// 					double dParam = 0;
// 					dParam = pPlatformXYDAixisPos.m_dPosX;
// 					PackPlcParam(vnWriteData[0 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 					dParam = pPlatformXYDAixisPos.m_dPosY;
// 					PackPlcParam(vnWriteData[1 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 					dParam = pPlatformXYDAixisPos.m_dAngle;
// 					PackPlcParam(vnWriteData[2 + i*3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 				}
// 
// 			}
// 			else
// 			{
// 				switch(m_eMidPlatformType)
// 				{
// 				case ePlatformXYD:
// 					{
// 						if (eCPOrderYXD == m_eCmdParamOrderType)
// 						{
// 							double dParam = 0;
// 							dParam = pPlatformXYDAixisPos.m_dPosX;
// 							PackPlcParam(vnWriteData[1 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dPosY;
// 							PackPlcParam(vnWriteData[0 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dAngle;
// 							PackPlcParam(vnWriteData[2 + i*3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						}
// 						else
// 						{
// 							double dParam = 0;
// 							dParam = pPlatformXYDAixisPos.m_dPosX;
// 							PackPlcParam(vnWriteData[0 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dPosY;
// 							PackPlcParam(vnWriteData[1 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dAngle;
// 							PackPlcParam(vnWriteData[2 + i*3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						}
// 					}
// 					break;
// 
// 				case ePlatformXD:
// 					{
// 						if (eCPOrderYXD == m_eCmdParamOrderType)
// 						{
// 							double dParam = 0;
// 							dParam = pPlatformXYDAixisPos.m_dPosX;
// 							PackPlcParam(vnWriteData[1 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dPosY;
// 							PackPlcParam(vnWriteData[0 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dAngle;
// 							PackPlcParam(vnWriteData[2 + i*3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						}
// 						else
// 						{
// 							double dParam = 0;
// 							dParam = pPlatformXYDAixisPos.m_dPosX;
// 							PackPlcParam(vnWriteData[0 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dPosY;
// 							PackPlcParam(vnWriteData[1 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dAngle;
// 							PackPlcParam(vnWriteData[2 + i*3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						}
// 					}
// 					break;
// 
// 				case ePlatformYD:
// 					{
// 						if (eCPOrderYXD == m_eCmdParamOrderType)
// 						{
// 							double dParam = 0;
// 							dParam = pPlatformXYDAixisPos.m_dPosX;
// 							PackPlcParam(vnWriteData[1 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dPosY;
// 							PackPlcParam(vnWriteData[0 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dAngle;
// 							PackPlcParam(vnWriteData[2 + i*3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						}
// 						else
// 						{
// 							double dParam = 0;
// 							dParam = pPlatformXYDAixisPos.m_dPosX;
// 							PackPlcParam(vnWriteData[0 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dPosY;
// 							PackPlcParam(vnWriteData[1 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dAngle;
// 							PackPlcParam(vnWriteData[2 + i*3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						}
// 					}
// 					break;
// 
// 				case ePlatformXY:
// 					{
// 						if (eCPOrderYXD == m_eCmdParamOrderType)
// 						{
// 							double dParam = 0;
// 							dParam = pPlatformXYDAixisPos.m_dPosX;
// 							PackPlcParam(vnWriteData[1 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dPosY;
// 							PackPlcParam(vnWriteData[0 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dAngle;
// 							PackPlcParam(vnWriteData[2 + 1*3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						}
// 						else
// 						{
// 							double dParam = 0;
// 							dParam = pPlatformXYDAixisPos.m_dPosX;
// 							PackPlcParam(vnWriteData[0 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dPosY;
// 							PackPlcParam(vnWriteData[1 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dAngle;
// 							PackPlcParam(vnWriteData[2 + i*3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						}
// 					}
// 					break;
// 
// 				default:
// 					{
// 						if (eCPOrderYXD == m_eCmdParamOrderType)
// 						{
// 							double dParam = 0;
// 							dParam = pPlatformXYDAixisPos.m_dPosX;
// 							PackPlcParam(vnWriteData[1 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dPosY;
// 							PackPlcParam(vnWriteData[0 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dAngle;
// 							PackPlcParam(vnWriteData[2 + i*3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						}
// 						else
// 						{
// 							double dParam = 0;
// 							dParam = pPlatformXYDAixisPos.m_dPosX;
// 							PackPlcParam(vnWriteData[0 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dPosY;
// 							PackPlcParam(vnWriteData[1 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dAngle;
// 							PackPlcParam(vnWriteData[2 + i*3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						}
// 					}
// 				}
// 			}
// 
// 		}
// 
// 		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
// 		{
// 			return FALSE;
// 		}
// 
// 
// 		return TRUE;
// 	}
// 	else
// 	{
// 		CString strName = m_FALPParam.m_strCmd;
// 		int nCmdVal = m_FALPParam.m_nCmdVal;
// 		m_strCmdName = strName;	
// 		int nParam = 0;
// 
// 		int nTempDataNum = vPlatformXYDAxisPos.size();
// 
// 		// 寄存器首地址
// 		long nRegAdrr = m_nPLCTempBaseRegAddr + atoi(RREG_VISION_PLATFORM_TEMP_POS);
// 
// 		int  nDataNum = nTempDataNum * 3;	
// 
// 		std::vector<int> vnWriteData;
// 		vnWriteData.resize(nDataNum);
// 
// 		for (int i = 0; i < nTempDataNum; i++)
// 		{
// 
// 			CPlatformXYDAxisPos pPlatformXYDAixisPos; 		
// 			pPlatformXYDAixisPos = (CPlatformXYDAxisPos)(vPlatformXYDAxisPos.at(i));	
// 
// 
// 			if (bResult == FALSE || m_pMidPlatformInfo == NULL)
// 			{
// 				if (eCPOrderYXD == m_eCmdParamOrderType)
// 				{
// 					double dParam = 0;
// 					dParam = pPlatformXYDAixisPos.m_dPosX;
// 					PackPlcParam(vnWriteData[1 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 					dParam = pPlatformXYDAixisPos.m_dPosY;
// 					PackPlcParam(vnWriteData[0 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 					dParam = pPlatformXYDAixisPos.m_dAngle;
// 					PackPlcParam(vnWriteData[2 + i*3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 				}
// 				else
// 				{
// 					double dParam = 0;
// 					dParam = pPlatformXYDAixisPos.m_dPosX;
// 					PackPlcParam(vnWriteData[0 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 					dParam = pPlatformXYDAixisPos.m_dPosY;
// 					PackPlcParam(vnWriteData[1 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 					dParam = pPlatformXYDAixisPos.m_dAngle;
// 					PackPlcParam(vnWriteData[2 + i*3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 				}
// 
// 			}
// 			else
// 			{
// 				switch(m_eMidPlatformType)
// 				{
// 				case ePlatformXYD:
// 					{
// 						if (eCPOrderYXD == m_eCmdParamOrderType)
// 						{
// 							double dParam = 0;
// 							dParam = pPlatformXYDAixisPos.m_dPosX;
// 							PackPlcParam(vnWriteData[1 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dPosY;
// 							PackPlcParam(vnWriteData[0 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dAngle;
// 							PackPlcParam(vnWriteData[2 + i*3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						}
// 						else
// 						{
// 							double dParam = 0;
// 							dParam = pPlatformXYDAixisPos.m_dPosX;
// 							PackPlcParam(vnWriteData[0 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dPosY;
// 							PackPlcParam(vnWriteData[1 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dAngle;
// 							PackPlcParam(vnWriteData[2 + i*3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						}
// 					}
// 					break;
// 
// 				case ePlatformXD:
// 					{
// 						if (eCPOrderYXD == m_eCmdParamOrderType)
// 						{
// 							double dParam = 0;
// 							dParam = pPlatformXYDAixisPos.m_dPosX;
// 							PackPlcParam(vnWriteData[1 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dPosY;
// 							PackPlcParam(vnWriteData[0 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dAngle;
// 							PackPlcParam(vnWriteData[2 + i*3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						}
// 						else
// 						{
// 							double dParam = 0;
// 							dParam = pPlatformXYDAixisPos.m_dPosX;
// 							PackPlcParam(vnWriteData[0 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dPosY;
// 							PackPlcParam(vnWriteData[1 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dAngle;
// 							PackPlcParam(vnWriteData[2 + i*3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						}
// 					}
// 					break;
// 
// 				case ePlatformYD:
// 					{
// 						if (eCPOrderYXD == m_eCmdParamOrderType)
// 						{
// 							double dParam = 0;
// 							dParam = pPlatformXYDAixisPos.m_dPosX;
// 							PackPlcParam(vnWriteData[1 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dPosY;
// 							PackPlcParam(vnWriteData[0 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dAngle;
// 							PackPlcParam(vnWriteData[2 + i*3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						}
// 						else
// 						{
// 							double dParam = 0;
// 							dParam = pPlatformXYDAixisPos.m_dPosX;
// 							PackPlcParam(vnWriteData[0 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dPosY;
// 							PackPlcParam(vnWriteData[1 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dAngle;
// 							PackPlcParam(vnWriteData[2 + i*3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						}
// 					}
// 					break;
// 
// 				case ePlatformXY:
// 					{
// 						if (eCPOrderYXD == m_eCmdParamOrderType)
// 						{
// 							double dParam = 0;
// 							dParam = pPlatformXYDAixisPos.m_dPosX;
// 							PackPlcParam(vnWriteData[1 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dPosY;
// 							PackPlcParam(vnWriteData[0 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dAngle;
// 							PackPlcParam(vnWriteData[2 + 1*3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						}
// 						else
// 						{
// 							double dParam = 0;
// 							dParam = pPlatformXYDAixisPos.m_dPosX;
// 							PackPlcParam(vnWriteData[0 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dPosY;
// 							PackPlcParam(vnWriteData[1 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dAngle;
// 							PackPlcParam(vnWriteData[2 + i*3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						}
// 					}
// 					break;
// 
// 				default:
// 					{
// 						if (eCPOrderYXD == m_eCmdParamOrderType)
// 						{
// 							double dParam = 0;
// 							dParam = pPlatformXYDAixisPos.m_dPosX;
// 							PackPlcParam(vnWriteData[1 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dPosY;
// 							PackPlcParam(vnWriteData[0 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dAngle;
// 							PackPlcParam(vnWriteData[2 + i*3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						}
// 						else
// 						{
// 							double dParam = 0;
// 							dParam = pPlatformXYDAixisPos.m_dPosX;
// 							PackPlcParam(vnWriteData[0 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dPosY;
// 							PackPlcParam(vnWriteData[1 + i*3], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
// 							dParam = pPlatformXYDAixisPos.m_dAngle;
// 							PackPlcParam(vnWriteData[2 + i*3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
// 
// 						}
// 					}
// 				}
// 			}
// 		}
// 
// 		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData, FALSE))
// 		{
// 			return FALSE;
// 		}
// 
// 
// 		return TRUE;
// 	}
// 
// 	return TRUE;
// 
// }

BOOL CCommProtocolXYDFast::PackRePlcMulAlignPosResultInfoFALPAxisPos(CString& strInfo,std::vector<int> &vnInfo,int &nRegAddr,std::vector<std::vector<CPlatformXYDAxisPos>> vvPlatformXYDAxisPos,BOOL bResult,int nPickMutiExMode/* = 0*/)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}
	int nExNum = vvPlatformXYDAxisPos.size();
	if (m_bRegType)
	{
		CString strName = m_FALPParam.m_strCmd;
		int nCmdVal = m_FALPParam.m_nCmdVal;
		m_strCmdName = strName;	
		int nParam = 0;

		int nTempDataNum = 0;
		if(nExNum > 0)
		{
			nTempDataNum = vvPlatformXYDAxisPos[0].size();
		}
		int  nDataNum = (nTempDataNum * 4) + 1;	
		int nTotalDataNum = nDataNum * nExNum;
		std::vector<int> vnTotalWriteData;//全部扩展的写入数据
		/*vnTotalWriteData.resize(nTotalDataNum);*/
		// 寄存器首地址
		long nRegAddress = m_nPLCTempBaseRegAddr /*+ atoi(RREG_VISION_PLATFORM_TEMP_POS)*/;
		nRegAddr = nRegAddress;
		for(int nExIndex = 0;nExIndex <vvPlatformXYDAxisPos.size();nExIndex++)
		{
			std::vector<int> vnWriteData;//单个扩展的写入数据
			vnWriteData.resize(nDataNum);
			if(nPickMutiExMode > 200 && nPickMutiExMode<300 && nTempDataNum < nPickMutiExMode%100)
			{
				vnWriteData.resize(1 + 4 * (nPickMutiExMode%100),0);
			}
			// 总数
			nParam = nTempDataNum;
			PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

			for (int i = 0; i < nTempDataNum; i++)
			{

				CPlatformXYDAxisPos pPlatformXYDAixisPos; 		
				pPlatformXYDAixisPos = (CPlatformXYDAxisPos)(vvPlatformXYDAxisPos[nExIndex].at(i));	

				if (bResult == FALSE || m_pMidPlatformInfo == NULL)
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						// 					// 索引
						// 					int nParam = 0;
						// 					nParam = i;
						PackPlcParam(vnWriteData[1 + i*4], i+1, m_CommProtocolParam.m_nCommUnitExp);

						double dParam = 0;
						dParam = pPlatformXYDAixisPos.m_dPosX;
						PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos.m_dPosY;
						PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos.m_dAngle;
						PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
					else
					{
						// 					// 索引
						// 					int nParam = 0;
						// 					nParam = i;
						PackPlcParam(vnWriteData[1 + i*4], i+1, m_CommProtocolParam.m_nCommUnitExp);

						double dParam = 0;
						dParam = pPlatformXYDAixisPos.m_dPosX;
						PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos.m_dPosY;
						PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos.m_dAngle;
						PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}

				}
				else
				{
					switch(m_eMidPlatformType)
					{
					case ePlatformXYD:
						{
							if (eCPOrderYXD == m_eCmdParamOrderType)
							{
								// 							// 索引
								// 							int nParam = 0;
								// 							nParam = i;
								PackPlcParam(vnWriteData[1 + i*4], i+1, m_CommProtocolParam.m_nCommUnitExp);

								double dParam = 0;
								dParam = pPlatformXYDAixisPos.m_dPosX;
								PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
								dParam = pPlatformXYDAixisPos.m_dPosY;
								PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
								dParam = pPlatformXYDAixisPos.m_dAngle;
								PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

							}
							else
							{
								// 							// 索引
								// 							int nParam = 0;
								// 							nParam = i;
								PackPlcParam(vnWriteData[1 + i*4], i+1, m_CommProtocolParam.m_nCommUnitExp);

								double dParam = 0;
								dParam = pPlatformXYDAixisPos.m_dPosX;
								PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
								dParam = pPlatformXYDAixisPos.m_dPosY;
								PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
								dParam = pPlatformXYDAixisPos.m_dAngle;
								PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

							}
						}
						break;

					case ePlatformXD:
						{
							if (eCPOrderYXD == m_eCmdParamOrderType)
							{
								// 							// 索引
								// 							int nParam = 0;
								// 							nParam = i;
								PackPlcParam(vnWriteData[1 + i*4], i+1, m_CommProtocolParam.m_nCommUnitExp);

								double dParam = 0;
								dParam = pPlatformXYDAixisPos.m_dPosX;
								PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
								dParam = pPlatformXYDAixisPos.m_dPosY;
								PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
								dParam = pPlatformXYDAixisPos.m_dAngle;
								PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

							}
							else
							{
								// 索引
								// 							int nParam = 0;
								// 							nParam = i;
								PackPlcParam(vnWriteData[1 + i*4], i+1, m_CommProtocolParam.m_nCommUnitExp);

								double dParam = 0;
								dParam = pPlatformXYDAixisPos.m_dPosX;
								PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
								dParam = pPlatformXYDAixisPos.m_dPosY;
								PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
								dParam = pPlatformXYDAixisPos.m_dAngle;
								PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

							}
						}
						break;

					case ePlatformYD:
						{
							if (eCPOrderYXD == m_eCmdParamOrderType)
							{
								// 							// 索引
								// 							int nParam = 0;
								// 							nParam = i;
								PackPlcParam(vnWriteData[1 + i*4], i+1, m_CommProtocolParam.m_nCommUnitExp);

								double dParam = 0;
								dParam = pPlatformXYDAixisPos.m_dPosX;
								PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
								dParam = pPlatformXYDAixisPos.m_dPosY;
								PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
								dParam = pPlatformXYDAixisPos.m_dAngle;
								PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

							}
							else
							{
								// 							// 索引
								// 							int nParam = 0;
								// 							nParam = i;
								PackPlcParam(vnWriteData[1 + i*4], i+1, m_CommProtocolParam.m_nCommUnitExp);

								double dParam = 0;
								dParam = pPlatformXYDAixisPos.m_dPosX;
								PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
								dParam = pPlatformXYDAixisPos.m_dPosY;
								PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
								dParam = pPlatformXYDAixisPos.m_dAngle;
								PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

							}
						}
						break;

					case ePlatformXY:
						{
							if (eCPOrderYXD == m_eCmdParamOrderType)
							{
								// 							// 索引
								// 							int nParam = 0;
								// 							nParam = i;
								PackPlcParam(vnWriteData[1 + i*4], i+1, m_CommProtocolParam.m_nCommUnitExp);

								double dParam = 0;
								dParam = pPlatformXYDAixisPos.m_dPosX;
								PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
								dParam = pPlatformXYDAixisPos.m_dPosY;
								PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
								dParam = pPlatformXYDAixisPos.m_dAngle;
								PackPlcParam(vnWriteData[4 + 1*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

							}
							else
							{
								// 							// 索引
								// 							int nParam = 0;
								// 							nParam = i;
								PackPlcParam(vnWriteData[1 + i*4], i+1, m_CommProtocolParam.m_nCommUnitExp);

								double dParam = 0;
								dParam = pPlatformXYDAixisPos.m_dPosX;
								PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
								dParam = pPlatformXYDAixisPos.m_dPosY;
								PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
								dParam = pPlatformXYDAixisPos.m_dAngle;
								PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

							}
						}
						break;

					default:
						{
							if (eCPOrderYXD == m_eCmdParamOrderType)
							{
								// 							// 索引
								// 							int nParam = 0;
								// 							nParam = i;
								PackPlcParam(vnWriteData[1 + i*4], i+1, m_CommProtocolParam.m_nCommUnitExp);

								double dParam = 0;
								dParam = pPlatformXYDAixisPos.m_dPosX;
								PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
								dParam = pPlatformXYDAixisPos.m_dPosY;
								PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
								dParam = pPlatformXYDAixisPos.m_dAngle;
								PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

							}
							else
							{
								// 							// 索引
								// 							int nParam = 0;
								// 							nParam = i;
								PackPlcParam(vnWriteData[1 + i*4], i+1, m_CommProtocolParam.m_nCommUnitExp);

								double dParam = 0;
								dParam = pPlatformXYDAixisPos.m_dPosX;
								PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
								dParam = pPlatformXYDAixisPos.m_dPosY;
								PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
								dParam = pPlatformXYDAixisPos.m_dAngle;
								PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

							}
						}
					}
				}
			}

			vnTotalWriteData.insert(vnTotalWriteData.end(),vnWriteData.begin(),vnWriteData.end());

		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAddress, vnTotalWriteData.size(), vnTotalWriteData))
		{
			return FALSE;
		}		

		vnInfo = vnTotalWriteData;
	}
	else
	{
		CString strName = m_FALPParam.m_strCmd;
		int nCmdVal = m_FALPParam.m_nCmdVal;
		m_strCmdName = strName;	
		int nParam = 0;

		int nTempDataNum = 0;
		if(nExNum > 0)
		{
			nTempDataNum = vvPlatformXYDAxisPos[0].size();
		}
		int  nDataNum = (nTempDataNum * 4) + 1;	
		int nTotalDataNum = nDataNum * nExNum;
		std::vector<int> vnTotalWriteData;//全部扩展的写入数据
		/*vnTotalWriteData.resize(nTotalDataNum);*/
		// 寄存器首地址
		long nRegAddress = m_nPLCTempBaseRegAddr /*+ atoi(RREG_VISION_PLATFORM_TEMP_POS)*/;
		nRegAddr = nRegAddress;
		for(int nExIndex = 0;nExIndex <vvPlatformXYDAxisPos.size();nExIndex++)
		{


			std::vector<int> vnWriteData;
			vnWriteData.resize(nDataNum);
			if(nPickMutiExMode > 200 && nPickMutiExMode<300 && nTempDataNum < nPickMutiExMode%100)
			{
				vnWriteData.resize(1 + 4 * (nPickMutiExMode%100),0);
			}
			// 总数
			nParam = nTempDataNum;
			PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

			for (int i = 0; i < nTempDataNum; i++)
			{

				CPlatformXYDAxisPos pPlatformXYDAixisPos; 		
				pPlatformXYDAixisPos = (CPlatformXYDAxisPos)(vvPlatformXYDAxisPos[nExIndex].at(i));	


				if (bResult == FALSE || m_pMidPlatformInfo == NULL)
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						// 					// 索引
						// 					int nParam = 0;
						// 					nParam = i;
						PackPlcParam(vnWriteData[1 + i*4], i+1, m_CommProtocolParam.m_nCommUnitExp);

						double dParam = 0;
						dParam = pPlatformXYDAixisPos.m_dPosX;
						PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos.m_dPosY;
						PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos.m_dAngle;
						PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
					else
					{
						// 					// 索引
						// 					int nParam = 0;
						// 					nParam = i;
						PackPlcParam(vnWriteData[1 + i*4], i+1, m_CommProtocolParam.m_nCommUnitExp);

						double dParam = 0;
						dParam = pPlatformXYDAixisPos.m_dPosX;
						PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos.m_dPosY;
						PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos.m_dAngle;
						PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}

				}
				else
				{
					switch(m_eMidPlatformType)
					{
					case ePlatformXYD:
						{
							if (eCPOrderYXD == m_eCmdParamOrderType)
							{
								// 							// 索引
								// 							int nParam = 0;
								// 							nParam = i;
								PackPlcParam(vnWriteData[1 + i*4], i+1, m_CommProtocolParam.m_nCommUnitExp);

								double dParam = 0;
								dParam = pPlatformXYDAixisPos.m_dPosX;
								PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
								dParam = pPlatformXYDAixisPos.m_dPosY;
								PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
								dParam = pPlatformXYDAixisPos.m_dAngle;
								PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

							}
							else
							{
								// 							// 索引
								// 							int nParam = 0;
								// 							nParam = i;
								PackPlcParam(vnWriteData[1 + i*4], i+1, m_CommProtocolParam.m_nCommUnitExp);

								double dParam = 0;
								dParam = pPlatformXYDAixisPos.m_dPosX;
								PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
								dParam = pPlatformXYDAixisPos.m_dPosY;
								PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
								dParam = pPlatformXYDAixisPos.m_dAngle;
								PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

							}
						}
						break;

					case ePlatformXD:
						{
							if (eCPOrderYXD == m_eCmdParamOrderType)
							{
								// 							// 索引
								// 							int nParam = 0;
								// 							nParam = i;
								PackPlcParam(vnWriteData[1 + i*4], i+1, m_CommProtocolParam.m_nCommUnitExp);

								double dParam = 0;
								dParam = pPlatformXYDAixisPos.m_dPosX;
								PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
								dParam = pPlatformXYDAixisPos.m_dPosY;
								PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
								dParam = pPlatformXYDAixisPos.m_dAngle;
								PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

							}
							else
							{
								// 							// 索引
								// 							int nParam = 0;
								// 							nParam = i;
								PackPlcParam(vnWriteData[1 + i*4], i+1, m_CommProtocolParam.m_nCommUnitExp);

								double dParam = 0;
								dParam = pPlatformXYDAixisPos.m_dPosX;
								PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
								dParam = pPlatformXYDAixisPos.m_dPosY;
								PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
								dParam = pPlatformXYDAixisPos.m_dAngle;
								PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

							}
						}
						break;

					case ePlatformYD:
						{
							if (eCPOrderYXD == m_eCmdParamOrderType)
							{
								// 							// 索引
								// 							int nParam = 0;
								// 							nParam = i;
								PackPlcParam(vnWriteData[1 + i*4], i+1, m_CommProtocolParam.m_nCommUnitExp);

								double dParam = 0;
								dParam = pPlatformXYDAixisPos.m_dPosX;
								PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
								dParam = pPlatformXYDAixisPos.m_dPosY;
								PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
								dParam = pPlatformXYDAixisPos.m_dAngle;
								PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

							}
							else
							{
								// 							// 索引
								// 							int nParam = 0;
								// 							nParam = i;
								PackPlcParam(vnWriteData[1 + i*4], i+1, m_CommProtocolParam.m_nCommUnitExp);

								double dParam = 0;
								dParam = pPlatformXYDAixisPos.m_dPosX;
								PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
								dParam = pPlatformXYDAixisPos.m_dPosY;
								PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
								dParam = pPlatformXYDAixisPos.m_dAngle;
								PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

							}
						}
						break;

					case ePlatformXY:
						{
							if (eCPOrderYXD == m_eCmdParamOrderType)
							{
								// 							// 索引
								// 							int nParam = 0;
								// 							nParam = i;
								PackPlcParam(vnWriteData[1 + i*4], i+1, m_CommProtocolParam.m_nCommUnitExp);

								double dParam = 0;
								dParam = pPlatformXYDAixisPos.m_dPosX;
								PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
								dParam = pPlatformXYDAixisPos.m_dPosY;
								PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
								dParam = pPlatformXYDAixisPos.m_dAngle;
								PackPlcParam(vnWriteData[4 + 1*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

							}
							else
							{
								// 							// 索引
								// 							int nParam = 0;
								// 							nParam = i;
								PackPlcParam(vnWriteData[1 + i*4], i+1, m_CommProtocolParam.m_nCommUnitExp);

								double dParam = 0;
								dParam = pPlatformXYDAixisPos.m_dPosX;
								PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
								dParam = pPlatformXYDAixisPos.m_dPosY;
								PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
								dParam = pPlatformXYDAixisPos.m_dAngle;
								PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

							}
						}
						break;

					default:
						{
							if (eCPOrderYXD == m_eCmdParamOrderType)
							{
								// 							// 索引
								// 							int nParam = 0;
								// 							nParam = i;
								PackPlcParam(vnWriteData[1 + i*4], i+1, m_CommProtocolParam.m_nCommUnitExp);

								double dParam = 0;
								dParam = pPlatformXYDAixisPos.m_dPosX;
								PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
								dParam = pPlatformXYDAixisPos.m_dPosY;
								PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
								dParam = pPlatformXYDAixisPos.m_dAngle;
								PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

							}
							else
							{
								// 							// 索引
								// 							int nParam = 0;
								// 							nParam = i;
								PackPlcParam(vnWriteData[1 + i*4], i+1, m_CommProtocolParam.m_nCommUnitExp);

								double dParam = 0;
								dParam = pPlatformXYDAixisPos.m_dPosX;
								PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
								dParam = pPlatformXYDAixisPos.m_dPosY;
								PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
								dParam = pPlatformXYDAixisPos.m_dAngle;
								PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

							}
						}
					}
				}
			}

			vnTotalWriteData.insert(vnTotalWriteData.end(),vnWriteData.begin(),vnWriteData.end());
		}
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAddress, vnTotalWriteData.size(), vnTotalWriteData, TRUE))
		{
			return FALSE;
		}
		vnInfo = vnTotalWriteData;
	}

	return TRUE;

}

BOOL CCommProtocolXYDFast::PackRePlcMulAlignPosResultInfoFMCOAxisPos(CString& strInfo,std::vector<pair<CCoordPos, int>> vpPlatformXYDOffset,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FMCOParam.m_strCmd;
		int nCmdVal = m_FMCOParam.m_nCmdVal;
		m_strCmdName = strName;	
		int nParam = 0;

		int nTempDataNum = vpPlatformXYDOffset.size();

		// 寄存器首地址
		long nRegAdrr = m_nPLCTempBaseRegAddr /*+ atoi(RREG_VISION_PLATFORM_TEMP_POS)*/;

		int  nDataNum = (nTempDataNum * 4) + 1;	

		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		// 总数
		nParam = nTempDataNum;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

		for (int i = 0; i < nTempDataNum; i++)
		{
			CCoordPos pPlatformXYDAixisOffset = vpPlatformXYDOffset.at(i).first;	
			int nPos = vpPlatformXYDOffset.at(i).second;

			if (bResult == FALSE || m_pMidPlatformInfo == NULL)
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					// 					// 索引
					// 					int nParam = 0;
					// 					nParam = i;
					PackPlcParam(vnWriteData[1 + i*4], nPos+1, m_CommProtocolParam.m_nCommUnitExp);

					double dParam = 0;
					dParam = pPlatformXYDAixisOffset.m_dPosX;
					PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisOffset.m_dPosY;
					PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisOffset.m_dAngle;
					PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					// 					// 索引
					// 					int nParam = 0;
					// 					nParam = i;
					PackPlcParam(vnWriteData[1 + i*4], nPos+1, m_CommProtocolParam.m_nCommUnitExp);

					double dParam = 0;
					dParam = pPlatformXYDAixisOffset.m_dPosX;
					PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisOffset.m_dPosY;
					PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisOffset.m_dAngle;
					PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

				}

			}
			else
			{
				switch(m_eMidPlatformType)
				{
				case ePlatformXYD:
					{
						if (eCPOrderYXD == m_eCmdParamOrderType)
						{
							// 							// 索引
							// 							int nParam = 0;
							// 							nParam = i;
							PackPlcParam(vnWriteData[1 + i*4], nPos+1, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisOffset.m_dPosX;
							PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dPosY;
							PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dAngle;
							PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

						}
						else
						{
							// 							// 索引
							// 							int nParam = 0;
							// 							nParam = i;
							PackPlcParam(vnWriteData[1 + i*4], nPos+1, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisOffset.m_dPosX;
							PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dPosY;
							PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dAngle;
							PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

						}
					}
					break;

				case ePlatformXD:
					{
						if (eCPOrderYXD == m_eCmdParamOrderType)
						{
							// 							// 索引
							// 							int nParam = 0;
							// 							nParam = i;
							PackPlcParam(vnWriteData[1 + i*4], nPos+1, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisOffset.m_dPosX;
							PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dPosY;
							PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dAngle;
							PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

						}
						else
						{
							// 索引
							// 							int nParam = 0;
							// 							nParam = i;
							PackPlcParam(vnWriteData[1 + i*4], nPos+1, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisOffset.m_dPosX;
							PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dPosY;
							PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dAngle;
							PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

						}
					}
					break;

				case ePlatformYD:
					{
						if (eCPOrderYXD == m_eCmdParamOrderType)
						{
							// 							// 索引
							// 							int nParam = 0;
							// 							nParam = i;
							PackPlcParam(vnWriteData[1 + i*4], nPos+1, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisOffset.m_dPosX;
							PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dPosY;
							PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dAngle;
							PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

						}
						else
						{
							// 							// 索引
							// 							int nParam = 0;
							// 							nParam = i;
							PackPlcParam(vnWriteData[1 + i*4], nPos+1, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisOffset.m_dPosX;
							PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dPosY;
							PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dAngle;
							PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

						}
					}
					break;

				case ePlatformXY:
					{
						if (eCPOrderYXD == m_eCmdParamOrderType)
						{
							// 							// 索引
							// 							int nParam = 0;
							// 							nParam = i;
							PackPlcParam(vnWriteData[1 + i*4], nPos+1, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisOffset.m_dPosX;
							PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dPosY;
							PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dAngle;
							PackPlcParam(vnWriteData[4 + 1*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

						}
						else
						{
							// 							// 索引
							// 							int nParam = 0;
							// 							nParam = i;
							PackPlcParam(vnWriteData[1 + i*4], nPos+1, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisOffset.m_dPosX;
							PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dPosY;
							PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dAngle;
							PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

						}
					}
					break;

				default:
					{
						if (eCPOrderYXD == m_eCmdParamOrderType)
						{
							// 							// 索引
							// 							int nParam = 0;
							// 							nParam = i;
							PackPlcParam(vnWriteData[1 + i*4], nPos+1, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisOffset.m_dPosX;
							PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dPosY;
							PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dAngle;
							PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

						}
						else
						{
							// 							// 索引
							// 							int nParam = 0;
							// 							nParam = i;
							PackPlcParam(vnWriteData[1 + i*4], nPos+1, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisOffset.m_dPosX;
							PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dPosY;
							PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dAngle;
							PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

						}
					}
				}
			}

		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

		return TRUE;
	}
	else
	{
		CString strName = m_FMCOParam.m_strCmd;
		int nCmdVal = m_FMCOParam.m_nCmdVal;
		m_strCmdName = strName;	
		int nParam = 0;

		int nTempDataNum = vpPlatformXYDOffset.size();
		int nFaildNum = 0;

		// 寄存器首地址
		long nRegAdrr = m_nPLCTempBaseRegAddr /*+ atoi(RREG_VISION_PLATFORM_TEMP_POS)*/;

		int  nDataNum = (nTempDataNum * 4) + 1;	

		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		// 总数
		nParam = nTempDataNum;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

		for (int i = 0; i < nTempDataNum; i++)
		{

			CCoordPos pPlatformXYDAixisOffset = vpPlatformXYDOffset.at(i).first;	
			int nPos = vpPlatformXYDOffset.at(i).second;

			if (bResult == FALSE || m_pMidPlatformInfo == NULL)
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					// 					// 索引
					// 					int nParam = 0;
					// 					nParam = i;
					PackPlcParam(vnWriteData[1 + i*4], nPos+1, m_CommProtocolParam.m_nCommUnitExp);

					double dParam = 0;
					dParam = pPlatformXYDAixisOffset.m_dPosX;
					PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisOffset.m_dPosY;
					PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisOffset.m_dAngle;
					PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					// 					// 索引
					// 					int nParam = 0;
					// 					nParam = i;
					PackPlcParam(vnWriteData[1 + i*4], nPos+1, m_CommProtocolParam.m_nCommUnitExp);

					double dParam = 0;
					dParam = pPlatformXYDAixisOffset.m_dPosX;
					PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisOffset.m_dPosY;
					PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisOffset.m_dAngle;
					PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

				}

			}
			else
			{
				switch(m_eMidPlatformType)
				{
				case ePlatformXYD:
					{
						if (eCPOrderYXD == m_eCmdParamOrderType)
						{
							// 							// 索引
							// 							int nParam = 0;
							// 							nParam = i;
							PackPlcParam(vnWriteData[1 + i*4], nPos+1, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisOffset.m_dPosX;
							PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dPosY;
							PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dAngle;
							PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

						}
						else
						{
							// 							// 索引
							// 							int nParam = 0;
							// 							nParam = i;
							PackPlcParam(vnWriteData[1 + i*4], nPos+1, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisOffset.m_dPosX;
							PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dPosY;
							PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dAngle;
							PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

						}
					}
					break;

				case ePlatformXD:
					{
						if (eCPOrderYXD == m_eCmdParamOrderType)
						{
							// 							// 索引
							// 							int nParam = 0;
							// 							nParam = i;
							PackPlcParam(vnWriteData[1 + i*4], nPos+1, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisOffset.m_dPosX;
							PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dPosY;
							PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dAngle;
							PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

						}
						else
						{
							// 							// 索引
							// 							int nParam = 0;
							// 							nParam = i;
							PackPlcParam(vnWriteData[1 + i*4], nPos+1, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisOffset.m_dPosX;
							PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dPosY;
							PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dAngle;
							PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

						}
					}
					break;

				case ePlatformYD:
					{
						if (eCPOrderYXD == m_eCmdParamOrderType)
						{
							// 							// 索引
							// 							int nParam = 0;
							// 							nParam = i;
							PackPlcParam(vnWriteData[1 + i*4], nPos+1, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisOffset.m_dPosX;
							PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dPosY;
							PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dAngle;
							PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

						}
						else
						{
							// 							// 索引
							// 							int nParam = 0;
							// 							nParam = i;
							PackPlcParam(vnWriteData[1 + i*4], nPos+1, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisOffset.m_dPosX;
							PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dPosY;
							PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dAngle;
							PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

						}
					}
					break;

				case ePlatformXY:
					{
						if (eCPOrderYXD == m_eCmdParamOrderType)
						{
							// 							// 索引
							// 							int nParam = 0;
							// 							nParam = i;
							PackPlcParam(vnWriteData[1 + i*4], nPos+1, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisOffset.m_dPosX;
							PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dPosY;
							PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dAngle;
							PackPlcParam(vnWriteData[4 + 1*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

						}
						else
						{
							// 							// 索引
							// 							int nParam = 0;
							// 							nParam = i;
							PackPlcParam(vnWriteData[1 + i*4], nPos+1, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisOffset.m_dPosX;
							PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dPosY;
							PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dAngle;
							PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

						}
					}
					break;

				default:
					{
						if (eCPOrderYXD == m_eCmdParamOrderType)
						{
							// 							// 索引
							// 							int nParam = 0;
							// 							nParam = i;
							PackPlcParam(vnWriteData[1 + i*4], nPos+1, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisOffset.m_dPosX;
							PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dPosY;
							PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dAngle;
							PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

						}
						else
						{
							// 							// 索引
							// 							int nParam = 0;
							// 							nParam = i;
							PackPlcParam(vnWriteData[1 + i*4], nPos+1, m_CommProtocolParam.m_nCommUnitExp);

							double dParam = 0;
							dParam = pPlatformXYDAixisOffset.m_dPosX;
							PackPlcParam(vnWriteData[2 + i*4], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dPosY;
							PackPlcParam(vnWriteData[3 + i*4], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = pPlatformXYDAixisOffset.m_dAngle;
							PackPlcParam(vnWriteData[4 + i*4], dParam, m_CommProtocolParam.m_nCommDUnitExp);

						}
					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData, TRUE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}

	return TRUE;

}

// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FALP R1 P2 P3 P4[ETX]）
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFALPAxisPos( CString& strInfo,CPlatformAxisPos* vpPlatAxisPos,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FALPParam.m_strCmd;
		int nCmdVal = m_FALPParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bResult == FALSE || m_pMidPlatformInfo == NULL)
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

			}
			else
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dY1 = 0.0;
						double dY2 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(dX0, dY0, dD0, dY1, dY2, dX1);


						double dParam = 0;
						dParam = dX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dX2 = 0.0;
						double dY1 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(dX0, dY0, dD0, dX1, dX2, dY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
				}
			}
		}


		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SaveAxisPosDataNeedSend(vnWriteData,strInfo);
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);


		return TRUE;
	}
	else
	{
		CString strName = m_FALPParam.m_strCmd;
		int nCmdVal = m_FALPParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bResult == FALSE || m_pMidPlatformInfo == NULL)
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

			}
			else
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 
				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dY1 = 0.0;
						double dY2 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(dX0, dY0, dD0, dY1, dY2, dX1);


						double dParam = 0;
						dParam = dX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dX2 = 0.0;
						double dY1 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(dX0, dY0, dD0, dX1, dX2, dY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
				}
			}
		}


		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData,TRUE))
		{
			return FALSE;
		}
		SaveAxisPosDataNeedSend(vnWriteData,strInfo);
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

		return TRUE;
	}

	return TRUE;

}

BOOL CCommProtocolXYDFast::PackRePlcAlignResultNumberInfoFALPAxisPos( CString& strInfo,CPlatformAxisPos* vpPlatAxisPos,int nResultNumber)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FALPParam.m_strCmd;
		int nCmdVal = m_FALPParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (nResultNumber != 1 || m_pMidPlatformInfo == NULL)
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

			}
			else
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dY1 = 0.0;
						double dY2 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(dX0, dY0, dD0, dY1, dY2, dX1);


						double dParam = 0;
						dParam = dX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dX2 = 0.0;
						double dY1 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(dX0, dY0, dD0, dX1, dX2, dY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
				}
			}
		}


		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);


		return TRUE;
	}
	else
	{
		CString strName = m_FALPParam.m_strCmd;
		int nCmdVal = m_FALPParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (nResultNumber != 1 || m_pMidPlatformInfo == NULL)
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

			}
			else
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dY1 = 0.0;
						double dY2 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(dX0, dY0, dD0, dY1, dY2, dX1);


						double dParam = 0;
						dParam = dX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dX2 = 0.0;
						double dY1 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(dX0, dY0, dD0, dX1, dX2, dY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
				}
			}
		}


		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
		return TRUE;
	}

	return TRUE;
}

// 打包FALP结果
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFALP(CString& strInfo, BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)		// 双字节
	{
		CString strName = m_FALPParam.m_strCmd;
		int nCmdVal = m_FALPParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		/*nParam = bResult ? 0 : -1;*/
		if(bResult == 1)
		{
			nParam = 0;
		}
		else if(bResult == 2)
		{
			nParam = 2;
		}
		else
		{
			nParam = -1;
		}
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		AttachAxisDataToCmd(vnWriteData);
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else				// 单字节
	{
		CString strName = m_FALPParam.m_strCmd;
		int nCmdVal = m_FALPParam.m_nCmdVal;
		int nVCmdValue = m_FALPParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		//nParam = bResult ? 1 : 2;
		if(bResult == 1)
		{
			nParam = 1;
		}
		else if(bResult == 2)
		{
			nParam = 3;
		}
		else
		{
			nParam = 2;
		}
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		AttachAxisDataToCmd(vnWriteData);
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData, FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	// 	CString strName = m_FALPParam.m_strCmd;
	// 	int nCmdVal = m_FALPParam.m_nCmdVal;
	// 	int nParam = 0;
	// 
	// 	long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
	// 	int  nDataNum = 2;											// 数据量
	// 	std::vector<int> vnWriteData;
	// 	vnWriteData.resize(nDataNum);
	// 
	// 	m_strCmdName = strName;	
	// 
	// 	nParam = nCmdVal;
	// 	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 	nParam = bResult ? 0 : -1;
	// 	PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
	// 	{
	// 		return FALSE;
	// 	}

	return TRUE;
}

// 打包FALP结果
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFMCO(CString& strInfo, BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)		// 双字节
	{
		CString strName = m_FMCOParam.m_strCmd;
		int nCmdVal = m_FMCOParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else				// 单字节
	{
		CString strName = m_FMCOParam.m_strCmd;
		int nCmdVal = m_FMCOParam.m_nCmdVal;
		int nVCmdValue = m_FMCOParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData, FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	return TRUE;
}


// 打包FALP结果
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFALP_int(CString& strInfo, int nResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)		// 双字节
	{
		CString strName = m_FALPParam.m_strCmd;
		int nCmdVal = m_FALPParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = nResult;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else				// 单字节
	{
		CString strName = m_FALPParam.m_strCmd;
		int nCmdVal = m_FALPParam.m_nCmdVal;
		int nVCmdValue = m_FALPParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (nResult <= -1)
		{
			nParam = 2;
		}
		else if(nResult == 1)
		{
			nParam = 3;
		}
		else if (nResult == 0)
		{
			nParam = 1;
		}
		else
		{
			nParam = abs(nResult)+2;
		}


		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData, FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}



	return TRUE;
}


BOOL CCommProtocolXYDFast::PackRePlcAlignResultNumberInfoFALP(CString& strInfo, int nResultNumber)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)		// 双字节
	{
		CString strName = m_FALPParam.m_strCmd;
		int nCmdVal = m_FALPParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		//		nParam = bResult ? 0 : -1;
		if (nResultNumber == 1)
		{
			nParam = 1;
		}
		else
		{
			nParam = -1;
		}

		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else				// 单字节
	{
		CString strName = m_FALPParam.m_strCmd;
		int nCmdVal = m_FALPParam.m_nCmdVal;
		int nVCmdValue = m_FALPParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		//		nParam = bResult ? 1 : 2;
		if (nResultNumber == 1)
		{
			nParam = 3;
		}
		else
		{
			nParam = 2;
		}
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData, FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);

	}

	return TRUE;
}



// 打包“指定平台各轴移动到的相对位置”指令: （[STX]FOLC R1 P2 P3 P4[ETX]）
BOOL CCommProtocolXYDFast::PackReAlignResultInfoFOLC( CString& strInfo, CCoordPos platOffset,BOOL bResult, CPlatformAxisPos* vpPlatAxisPos)
{

	CString strHead = m_strHead;
	CString strName= m_FOLCParam.m_strCmd;
	CString strParam[4];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	double dParam = 0;
	// 	dParam = platOffset.m_dPosX;
	// 	PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
	// 	dParam = platOffset.m_dPosY;
	// 	PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXYUnitExp);
	// 	dParam = platOffset.m_dAngle;
	// 	PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	if (/*bResult == FALSE|| */pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
		}
		else
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
		}

	}
	else
	{
		switch(m_eMidPlatformType)
		{
		case ePlatformXYD:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = platOffset.m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffset.m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffset.m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				}
				else
				{
					double dParam = 0;
					dParam = platOffset.m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffset.m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffset.m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				}
			}
			break;

			// 		case ePlatformXYPD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformX:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXDPY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXDPY1:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformYD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;

		case ePlatformXY1Y2:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dToStartX1 = 0.0;
					double dToStartY1 = 0.0;
					double dToStartY2 = 0.0;

					double dToEndX1 = 0.0;
					double dToEndY1 = 0.0;
					double dToEndY2 = 0.0;

					double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
					double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
					double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

					double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
					double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
					double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

					CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
						dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
						dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


					double dParam = 0;
					dParam = dToEndX1 - dToStartX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dToEndY1 - dToStartY1;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = dToEndY2 - dToStartY2;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;
		case ePlatformX1X2Y:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dToStartX1 = 0.0;
					double dToStartX2 = 0.0;
					double dToStartY1 = 0.0;

					double dToEndX1 = 0.0;
					double dToEndX2 = 0.0;
					double dToEndY1 = 0.0;

					double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
					double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
					double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

					double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
					double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
					double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

					CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
						dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
						dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

					//dX1 = dX1 + 5.5;
					//dX2 = dX2 + 5.5;
					//dY1 = dY1 + 5.5;

					double dParam = 0;
					dParam = dToEndX1 - dToStartX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dToEndX2 - dToStartX2;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dToEndY1 - dToStartY1;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;
		default:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = platOffset.m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffset.m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffset.m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				}
				else
				{
					double dParam = 0;
					dParam = platOffset.m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffset.m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffset.m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				}
			}
		}
	}

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;

	return TRUE;

}

// 检测产品有、无
BOOL CCommProtocolXYDFast::PackRePlcProductInspectFINS( CString& strInfo, BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)		// 双字节
	{
		CString strName = m_FINSParam.m_strCmd;
		int nCmdVal = m_FINSParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
	}
	else				// 单字节
	{
		CString strName = m_FINSParam.m_strCmd;
		int nCmdVal = m_FINSParam.m_nCmdVal;
		int nVCmdValue = m_FINSParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
	}

	return TRUE;
}

// 专用焊接指令
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFWEL( CString& strInfo, BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)		// 双字
	{
		CString strName = m_FWELParam.m_strCmd;
		int nCmdVal = m_FWELParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
	}
	else				// 单字
	{
		CString strName = m_FWELParam.m_strCmd;
		int nCmdVal		= m_FWELParam.m_nCmdVal;
		int nVCmdValue	= m_FWELParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
	}

	return TRUE;

}

BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFWELAxisPos(CString& strInfo,CCoordPos platOffset,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FWELParam.m_strCmd;
		int nCmdVal = m_FWELParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X)+6;	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		double dParam = 0;
		dParam = platOffset.m_dPosX;
		PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = platOffset.m_dPosY;
		PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		dParam = platOffset.m_dAngle;
		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}

		return TRUE;
	}
	else
	{
		CString strName = m_FWELParam.m_strCmd;
		int nCmdVal = m_FWELParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD)+6;	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		double dParam = 0;
		dParam = platOffset.m_dPosX;
		PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = platOffset.m_dPosY;
		PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		dParam = platOffset.m_dAngle;
		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}

		return TRUE;
	}

	return TRUE;

}
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFSOL( CString& strInfo, BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)		// 双字
	{
		CString strName = m_FSOLParam.m_strCmd;
		int nCmdVal = m_FSOLParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData))
		{
			return FALSE;
		}
	}
	else				// 单字
	{
		CString strName = m_FSOLParam.m_strCmd;
		int nCmdVal		= m_FSOLParam.m_nCmdVal;
		int nVCmdValue	= m_FSOLParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
	}

	return TRUE;

}

BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFSOLAxisPos(CString& strInfo,CCoordPos platOffset,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FSOLParam.m_strCmd;
		int nCmdVal = m_FSOLParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X)+6;	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		double dParam = 0;
		dParam = platOffset.m_dPosX;
		PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = platOffset.m_dPosY;
		PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		dParam = platOffset.m_dAngle;
		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData))
		{
			return FALSE;
		}

		return TRUE;
	}
	else
	{
		CString strName = m_FSOLParam.m_strCmd;
		int nCmdVal = m_FSOLParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD)+6;	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	

		double dParam = 0;
		dParam = platOffset.m_dPosX;
		PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = platOffset.m_dPosY;
		PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		dParam = platOffset.m_dAngle;
		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}

		return TRUE;
	}

	return TRUE;

}

BOOL CCommProtocolXYDFast::PackRePlcObjTarSearchFPCB(CString& strInfo,BOOL bResult,std::vector<CCoordPos> markPos)
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FPCBParam.m_strCmd;
		int nCmdVal = m_FPCBParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2 + 2*markPos.size();											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		for (int i=0;i<markPos.size();i++)
		{
			PackPlcParam(vnWriteData[2+2*i],markPos.at(i).m_dPosX,m_CommProtocolParam.m_nCommXUnitExp);
			PackPlcParam(vnWriteData[2+2*i+1],markPos.at(i).m_dPosY,m_CommProtocolParam.m_nCommYUnitExp);
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else
	{
		CString strName = m_FPCBParam.m_strCmd;
		int nCmdVal = m_FPCBParam.m_nCmdVal;
		int nVCmdValue = m_FPCBParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2+2*markPos.size();											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		for (int i=0;i<markPos.size();i++)
		{
			PackPlcParam(vnWriteData[2+2*i],markPos.at(i).m_dPosX,m_CommProtocolParam.m_nCommXUnitExp);
			PackPlcParam(vnWriteData[2+2*i+1],markPos.at(i).m_dPosY,m_CommProtocolParam.m_nCommYUnitExp);
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);
	}


	return TRUE;

}

BOOL CCommProtocolXYDFast::PackRePlcPCBPrecisionFPIS( CString& strInfo, BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)		// 双字节
	{
		CString strName = m_FPISParam.m_strCmd;
		int nCmdVal = m_FPISParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else				// 单字节
	{
		CString strName = m_FPISParam.m_strCmd;
		int nCmdVal = m_FPISParam.m_nCmdVal;
		int nVCmdValue = m_FPISParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);
	}

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackRePlcPCBPrecisionFCPI( CString& strInfo, BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)		// 双字节
	{
		CString strName = m_FCPIParam.m_strCmd;
		int nCmdVal = m_FCPIParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else				// 单字节
	{
		CString strName = m_FCPIParam.m_strCmd;
		int nCmdVal = m_FCPIParam.m_nCmdVal;
		int nVCmdValue = m_FCPIParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);
	}

	return TRUE;
}
// 设置产品曝光
BOOL CCommProtocolXYDFast::PackRePlcSetProductExposureFSPE( CString& strInfo, BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)		// 双字节
	{
		CString strName = m_FSPEParam.m_strCmd;
		int nCmdVal = m_FSPEParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else				// 单字节
	{
		CString strName = m_FSPEParam.m_strCmd;
		int nCmdVal = m_FSPEParam.m_nCmdVal;
		int nVCmdValue = m_FSPEParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);
	}

	return TRUE;
}

// 打包FTGG轴位置
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFTGGAxisPos(CString& strInfo,CCoordPos imageOffset,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FTGGParam.m_strCmd;
		int nCmdVal = m_FTGGParam.m_nCmdVal;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);		// 寄存器地址
		int  nDataNum = 2;														// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		double dParam = 0;
		dParam = imageOffset.m_dPosX;
		PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = imageOffset.m_dPosY;
		PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		// 		dParam = imageOffset.m_dAngle;
		// 		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else
	{
		CString strName = m_FTGGParam.m_strCmd;
		int nCmdVal = m_FTGGParam.m_nCmdVal;
		int nVCmdValue = m_FTGGParam.m_nVCmdValue;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD);	// 寄存器地址
		int  nDataNum = 2;															// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		double dParam = 0;
		dParam = imageOffset.m_dPosX;
		PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = imageOffset.m_dPosY;
		PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		// 		dParam = imageOffset.m_dAngle;
		// 		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData, TRUE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}

	return TRUE;
}

// 打包FTGG结果
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFTGG(CString& strInfo, BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FTGGParam.m_strCmd;
		int nCmdVal = m_FTGGParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);		// 寄存器地址
		int  nDataNum = 2;													// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else
	{
		CString strName = m_FTGGParam.m_strCmd;
		int nCmdVal = m_FTGGParam.m_nCmdVal;
		int nVCmdValue = m_FTGGParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;														// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);
	}

	return TRUE;
}



// 打包FOBG轴位置
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFOBGAxisPos(CString& strInfo,CCoordPos imageOffset,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FOBGParam.m_strCmd;
		int nCmdVal = m_FOBGParam.m_nCmdVal;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);		// 寄存器地址
		int  nDataNum = 2;														// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		double dParam = 0;
		dParam = imageOffset.m_dPosX;
		PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = imageOffset.m_dPosY;
		PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		// 		dParam = imageOffset.m_dAngle;
		// 		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else
	{
		CString strName = m_FOBGParam.m_strCmd;
		int nCmdVal = m_FOBGParam.m_nCmdVal;
		int nVCmdValue = m_FOBGParam.m_nVCmdValue;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD);	// 寄存器地址
		int  nDataNum = 2;															// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		double dParam = 0;
		dParam = imageOffset.m_dPosX;
		PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
		dParam = imageOffset.m_dPosY;
		PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
		// 		dParam = imageOffset.m_dAngle;
		// 		PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData, TRUE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}

	return TRUE;
}

// 打包FOBG结果
BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFOBG(CString& strInfo, BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FOBGParam.m_strCmd;
		int nCmdVal = m_FOBGParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);		// 寄存器地址
		int  nDataNum = 2;													// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);
	}
	else
	{
		CString strName = m_FOBGParam.m_strCmd;
		int nCmdVal = m_FOBGParam.m_nCmdVal;
		int nVCmdValue = m_FOBGParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;														// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,FALSE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,FALSE);
	}

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackRePlcTargetSearchFTGCAndFALGOrACOAll(CString& strInfo,BOOL bResult, BOOL bTriggered,int nSuccessPatIndex,CPlatformAxisPos* vpPlatAxisPos)
{

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FTGCParam.m_strCmd;
		int nCmdVal = m_FTGCParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_TRIGGER);	// 寄存器地址
		int  nDataNum = 10;											// 数据量

		if (m_bEnablePackInspectDistance)
		{
			nDataNum=10;
			for (int k=0;k<m_vstL2LDistanceResult.size();k++)
			{
				if (m_vstL2LDistanceResult.at(k).m_bPosSearchFinished)
				{
					nDataNum+=3;
				}
			}
			//nDataNum = 10 + m_vdDistance.size();
		}

		std::vector<int> vnWriteDataAll;
		vnWriteDataAll.resize(nDataNum,0);

		m_strCmdName = strName;	
		//nParam = bTriggered ? PLC_CMD_VAL_TRIGGERED : PLC_CMD_VAL_NOT_TRIGGERED;
		nParam = PLC_CMD_VAL_NOT_TRIGGERED;
		PackPlcParam(vnWriteDataAll[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

		nParam = nCmdVal;
		PackPlcParam(vnWriteDataAll[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? nSuccessPatIndex : -1;
		PackPlcParam(vnWriteDataAll[2], nParam, m_CommProtocolParam.m_nCommUnitExp);
		/*nParam=bResult ? 1 : -1;
		PackPlcParam(vnWriteDataAll[3], nParam, m_CommProtocolParam.m_nCommUnitExp);*/
		std::vector<int> vnWriteDataAxis;
		vnWriteDataAxis.resize(3);

		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bResult == FALSE || m_pMidPlatformInfo == NULL)
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

			}
			else
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dY1 = 0.0;
						double dY2 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(dX0, dY0, dD0, dY1, dY2, dX1);


						double dParam = 0;
						dParam = dX1;
						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dY1;
						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dY2;
						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dX2 = 0.0;
						double dY1 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(dX0, dY0, dD0, dX1, dX2, dY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dY1;
						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dX1;
						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dX2;
						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
				}
			}
		}

		vnWriteDataAll[7] = vnWriteDataAxis[0];
		vnWriteDataAll[8] = vnWriteDataAxis[1];
		vnWriteDataAll[9] = vnWriteDataAxis[2];

		if (m_bEnablePackInspectDistance)
		{
			/*	for (int i =0;i<m_vdDistance.size();i++)
			{
			double dParam = 0;
			dParam = m_vdDistance.at(i);
			PackPlcParam(vnWriteDataAll[10+i], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
			}*/
			int nAdressIndex=-1;
			double dParam = 0;
			int nParam=0;
			for (int i =0;i<m_vstL2LDistanceResult.size();i++)
			{
				if (m_vstL2LDistanceResult.at(i).m_bPosSearchFinished)
				{
					nAdressIndex+=1;
					dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[0];
					PackPlcParam(vnWriteDataAll[10+3*nAdressIndex], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[1];
					PackPlcParam(vnWriteDataAll[10+3*nAdressIndex+1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					BOOL bOK = TRUE;
					for(int j=0;j<2;j++)
					{
						if (m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_nResult[j]!=1)
						{
							bOK=bOK&&FALSE;
						}
					}
					nParam = bOK? 0 : -1;
					PackPlcParam(vnWriteDataAll[10+3*nAdressIndex+2], nParam, m_CommProtocolParam.m_nCommUnitExp);
				}

			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteDataAll))
		{
			return FALSE;
		}
	}
	else
	{
		return FALSE;
	}

	return TRUE;

}
BOOL CCommProtocolXYDFast::PackRePlcObjectSearchFOBCAndFALGOrACOAll(CString& strInfo,BOOL bResult, BOOL bTriggered,int nSuccessPatIndex,CPlatformAxisPos* vpPlatAxisPos)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FOBCParam.m_strCmd;
		int nCmdVal = m_FOBCParam.m_nCmdVal;
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_TRIGGER);	// 寄存器地址
		int  nDataNum = 10;											        // 数据量
		if (m_bEnablePackInspectDistance)
		{
			nDataNum=10;
			for (int k=0;k<m_vstL2LDistanceResult.size();k++)
			{
				if (m_vstL2LDistanceResult.at(k).m_bPosSearchFinished)
				{
					nDataNum+=3;
				}
			}
			//nDataNum = 10 + m_vdDistance.size();
		}
		std::vector<int> vnWriteDataAll;
		vnWriteDataAll.resize(nDataNum,0);

		m_strCmdName = strName;	
		//nParam = bTriggered ? PLC_CMD_VAL_TRIGGERED : PLC_CMD_VAL_NOT_TRIGGERED;
		nParam = PLC_CMD_VAL_NOT_TRIGGERED;
		PackPlcParam(vnWriteDataAll[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

		nParam = nCmdVal;
		PackPlcParam(vnWriteDataAll[1], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? nSuccessPatIndex : -1;
		PackPlcParam(vnWriteDataAll[2], nParam, m_CommProtocolParam.m_nCommUnitExp);
		/*nParam=bResult ? 1 : -1;
		PackPlcParam(vnWriteDataAll[3], nParam, m_CommProtocolParam.m_nCommUnitExp);*/
		std::vector<int> vnWriteDataAxis;
		vnWriteDataAxis.resize(3);

		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bResult == FALSE || m_pMidPlatformInfo == NULL)
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dY1 = 0.0;
						double dY2 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(dX0, dY0, dD0, dY1, dY2, dX1);


						double dParam = 0;
						dParam = dX1;
						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dY1;
						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dY2;
						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dX2 = 0.0;
						double dY1 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(dX0, dY0, dD0, dX1, dX2, dY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dY1;
						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dX1;
						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dX2;
						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteDataAxis[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteDataAxis[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteDataAxis[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
				}
			}
		}

		vnWriteDataAll[7] = vnWriteDataAxis[0];
		vnWriteDataAll[8] = vnWriteDataAxis[1];
		vnWriteDataAll[9] = vnWriteDataAxis[2];

		if (m_bEnablePackInspectDistance)
		{
			/*	for (int i =0;i<m_vdDistance.size();i++)
			{
			double dParam = 0;
			dParam = m_vdDistance.at(i);
			PackPlcParam(vnWriteDataAll[10+i], dParam, m_CommProtocolParam.m_nCommXYUnitExp);
			}*/
			int nAdressIndex=-1;
			double dParam = 0;
			int nParam=0;
			for (int i =0;i<m_vstL2LDistanceResult.size();i++)
			{
				if (m_vstL2LDistanceResult.at(i).m_bPosSearchFinished)
				{
					nAdressIndex+=1;
					dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[0];
					PackPlcParam(vnWriteDataAll[10+3*nAdressIndex], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[1];
					PackPlcParam(vnWriteDataAll[10+3*nAdressIndex+1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					BOOL bOK = TRUE;
					for(int j=0;j<2;j++)
					{
						if (m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_nResult[j]!=1)
						{
							bOK=bOK&&FALSE;
						}
					}
					nParam = bOK? 0 : -1;
					PackPlcParam(vnWriteDataAll[10+3*nAdressIndex+2], nParam, m_CommProtocolParam.m_nCommUnitExp);
				}
			}
		}
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteDataAll))
		{
			return FALSE;
		}
	}
	else
	{
		return FALSE;
	}

	return TRUE;

}
BOOL CCommProtocolXYDFast::PackReTargetSearchFTGTAndALGOrACO(CString& strInfo,BOOL bResult,CPlatformAxisPos* vpPlatAxisPos)
{
	CString strHead = m_strHead;
	CString strName= m_FTGTParam.m_strCmd;
	CString strParam[16];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	if (m_pMidPlatformInfo == NULL)
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}
		else
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}

	}
	else
	{
		switch(m_eMidPlatformType)
		{
		case ePlatformXYD:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
			}
			break;

			// 		case ePlatformXYPD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformX:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXDPY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXDPY1:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformYD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

		case ePlatformXY1Y2:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dY1 = 0.0;
					double dY2 = 0.0;

					double dX0 = pPlatformXYDAixisPos->m_dPosX;
					double dY0 = pPlatformXYDAixisPos->m_dPosY;
					double dD0 = pPlatformXYDAixisPos->m_dAngle;
					CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(dX0, dY0, dD0, dY1, dY2, dX1);


					double dParam = 0;
					dParam = dX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dY1;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = dY2;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;
		case ePlatformX1X2Y:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dX2 = 0.0;
					double dY1 = 0.0;

					double dX0 = pPlatformXYDAixisPos->m_dPosX;
					double dY0 = pPlatformXYDAixisPos->m_dPosY;
					double dD0 = pPlatformXYDAixisPos->m_dAngle;
					CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(dX0, dY0, dD0, dX1, dX2, dY1);

					//dX1 = dX1 + 5.5;
					//dX2 = dX2 + 5.5;
					//dY1 = dY1 + 5.5;

					double dParam = 0;
					dParam = dY1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = dX1;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dX2;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;
		default:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
			}
		}
	}
	//构造写命令
	strInfo.Empty();
	if (m_bEnablePackInspectDistance)
	{

		int nAdressIndex=-1;
		double dParam = 0;
		int nParam=0;
		for (int i =0;i<m_vstL2LDistanceResult.size();i++)
		{
			if (m_vstL2LDistanceResult.at(i).m_bPosSearchFinished)
			{
				nAdressIndex+=1;
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[0];
				PackParam(strParam[4+nAdressIndex*3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[1];
				PackParam(strParam[4+nAdressIndex*3+1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);

				BOOL bOK = TRUE;
				for(int j=0;j<2;j++)
				{
					if (m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_nResult[j]!=1)
					{
						bOK=bOK&&FALSE;
					}
				}
				nParam = bOK? 0 : -1;
				PackParam(strParam[4+nAdressIndex*3+2], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
			}

		}
		strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1]+ strBlank + strParam[2]+ strBlank + strParam[3];
		for (int i=0;i<=nAdressIndex;i++)
		{
			strInfo=strInfo+strBlank+strParam[4+3*i]+strBlank+strParam[4+3*i+1]+strBlank+strParam[4+3*i+2];
		}
		strInfo=strInfo+strTail;
		return TRUE;
	}
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1]+ strBlank + strParam[2]+ strBlank + strParam[3]+ strTail;

	return TRUE;


}
BOOL CCommProtocolXYDFast::PackReTargetSearchFTGCAndALGOrACO(CString& strInfo,BOOL bResult, int nSuccessPatIndex,CPlatformAxisPos* vpPlatAxisPos)
{
	CString strHead = m_strHead;
	CString strName= m_FTGCParam.m_strCmd;
	CString strParam[16];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = nSuccessPatIndex;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	if (m_pMidPlatformInfo == NULL)
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}
		else
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}

	}
	else
	{
		switch(m_eMidPlatformType)
		{
		case ePlatformXYD:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
			}
			break;

			// 		case ePlatformXYPD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformX:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXDPY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXDPY1:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformYD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

		case ePlatformXY1Y2:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dY1 = 0.0;
					double dY2 = 0.0;

					double dX0 = pPlatformXYDAixisPos->m_dPosX;
					double dY0 = pPlatformXYDAixisPos->m_dPosY;
					double dD0 = pPlatformXYDAixisPos->m_dAngle;
					CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(dX0, dY0, dD0, dY1, dY2, dX1);


					double dParam = 0;
					dParam = dX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dY1;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = dY2;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;
		case ePlatformX1X2Y:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dX2 = 0.0;
					double dY1 = 0.0;

					double dX0 = pPlatformXYDAixisPos->m_dPosX;
					double dY0 = pPlatformXYDAixisPos->m_dPosY;
					double dD0 = pPlatformXYDAixisPos->m_dAngle;
					CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(dX0, dY0, dD0, dX1, dX2, dY1);

					//dX1 = dX1 + 5.5;
					//dX2 = dX2 + 5.5;
					//dY1 = dY1 + 5.5;

					double dParam = 0;
					dParam = dY1;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = dX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dX2;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;
		default:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
			}
		}
	}
	//构造写命令
	strInfo.Empty();
	if (m_bEnablePackInspectDistance)
	{

		int nAdressIndex=-1;
		double dParam = 0;
		int nParam=0;
		for (int i =0;i<m_vstL2LDistanceResult.size();i++)
		{
			if (m_vstL2LDistanceResult.at(i).m_bPosSearchFinished)
			{
				nAdressIndex+=1;
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[0];
				PackParam(strParam[4+nAdressIndex*3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[1];
				PackParam(strParam[4+nAdressIndex*3+1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);

				BOOL bOK = TRUE;
				for(int j=0;j<2;j++)
				{
					if (m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_nResult[j]!=1)
					{
						bOK=bOK&&FALSE;
					}
				}
				nParam = bOK? 0 : -1;
				PackParam(strParam[4+nAdressIndex*3+2], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
			}

		}
		strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1]+ strBlank + strParam[2]+ strBlank + strParam[3];
		for (int i=0;i<=nAdressIndex;i++)
		{
			strInfo=strInfo+strBlank+strParam[4+3*i]+strBlank+strParam[4+3*i+1]+strBlank+strParam[4+3*i+2];
		}
		strInfo=strInfo+strTail;
		return TRUE;
	}
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1]+ strBlank + strParam[2]+ strBlank + strParam[3]+ strTail;

	return TRUE;


}
BOOL CCommProtocolXYDFast::PackReObjectSearchFOBJAndALGOrACO(CString& strInfo,BOOL bResult,CPlatformAxisPos* vpPlatAxisPos)
{
	CString strHead = m_strHead;
	CString strName= m_FOBJParam.m_strCmd;
	CString strParam[16];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	if (m_pMidPlatformInfo == NULL)
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}
		else
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}

	}
	else
	{
		switch(m_eMidPlatformType)
		{
		case ePlatformXYD:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
			}
			break;

			// 		case ePlatformXYPD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformX:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXDPY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXDPY1:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformYD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

		case ePlatformXY1Y2:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dY1 = 0.0;
					double dY2 = 0.0;

					double dX0 = pPlatformXYDAixisPos->m_dPosX;
					double dY0 = pPlatformXYDAixisPos->m_dPosY;
					double dD0 = pPlatformXYDAixisPos->m_dAngle;
					CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(dX0, dY0, dD0, dY1, dY2, dX1);


					double dParam = 0;
					dParam = dX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dY1;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = dY2;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;
		case ePlatformX1X2Y:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dX2 = 0.0;
					double dY1 = 0.0;

					double dX0 = pPlatformXYDAixisPos->m_dPosX;
					double dY0 = pPlatformXYDAixisPos->m_dPosY;
					double dD0 = pPlatformXYDAixisPos->m_dAngle;
					CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(dX0, dY0, dD0, dX1, dX2, dY1);

					//dX1 = dX1 + 5.5;
					//dX2 = dX2 + 5.5;
					//dY1 = dY1 + 5.5;

					double dParam = 0;
					dParam = dY1;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = dX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dX2;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;
		default:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
			}
		}
	}
	//构造写命令
	strInfo.Empty();
	if (m_bEnablePackInspectDistance)
	{

		int nAdressIndex=-1;
		double dParam = 0;
		int nParam=0;
		for (int i =0;i<m_vstL2LDistanceResult.size();i++)
		{
			if (m_vstL2LDistanceResult.at(i).m_bPosSearchFinished)
			{
				nAdressIndex+=1;
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[0];
				PackParam(strParam[4+nAdressIndex*3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[1];
				PackParam(strParam[4+nAdressIndex*3+1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);

				BOOL bOK = TRUE;
				for(int j=0;j<2;j++)
				{
					if (m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_nResult[j]!=1)
					{
						bOK=bOK&&FALSE;
					}
				}
				nParam = bOK? 0 : -1;
				PackParam(strParam[4+nAdressIndex*3+2], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
			}

		}
		strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1]+ strBlank + strParam[2]+ strBlank + strParam[3];
		for (int i=0;i<=nAdressIndex;i++)
		{
			strInfo=strInfo+strBlank+strParam[4+3*i]+strBlank+strParam[4+3*i+1]+strBlank+strParam[4+3*i+2];
		}
		strInfo=strInfo+strTail;
		return TRUE;
	}
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1]+ strBlank + strParam[2]+ strBlank + strParam[3]+ strTail;

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackReObjectSearchFOBCAndALGOrACO(CString& strInfo,BOOL bResult, int nSuccessPatIndex,CPlatformAxisPos* vpPlatAxisPos)
{
	CString strHead = m_strHead;
	CString strName= m_FOBCParam.m_strCmd;
	CString strParam[16];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = nSuccessPatIndex;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	if (m_pMidPlatformInfo == NULL)
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}
		else
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}

	}
	else
	{
		switch(m_eMidPlatformType)
		{
		case ePlatformXYD:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
			}
			break;

			// 		case ePlatformXYPD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformX:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXDPY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXDPY1:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformYD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

		case ePlatformXY1Y2:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dY1 = 0.0;
					double dY2 = 0.0;

					double dX0 = pPlatformXYDAixisPos->m_dPosX;
					double dY0 = pPlatformXYDAixisPos->m_dPosY;
					double dD0 = pPlatformXYDAixisPos->m_dAngle;
					CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(dX0, dY0, dD0, dY1, dY2, dX1);


					double dParam = 0;
					dParam = dX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dY1;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = dY2;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;
		case ePlatformX1X2Y:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dX2 = 0.0;
					double dY1 = 0.0;

					double dX0 = pPlatformXYDAixisPos->m_dPosX;
					double dY0 = pPlatformXYDAixisPos->m_dPosY;
					double dD0 = pPlatformXYDAixisPos->m_dAngle;
					CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(dX0, dY0, dD0, dX1, dX2, dY1);

					//dX1 = dX1 + 5.5;
					//dX2 = dX2 + 5.5;
					//dY1 = dY1 + 5.5;

					double dParam = 0;
					dParam = dY1;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = dX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dX2;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;
		default:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
			}
		}
	}
	//构造写命令
	strInfo.Empty();
	if (m_bEnablePackInspectDistance)
	{

		int nAdressIndex=-1;
		double dParam = 0;
		int nParam=0;
		for (int i =0;i<m_vstL2LDistanceResult.size();i++)
		{
			if (m_vstL2LDistanceResult.at(i).m_bPosSearchFinished)
			{
				nAdressIndex+=1;
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[0];
				PackParam(strParam[4+nAdressIndex*3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[1];
				PackParam(strParam[4+nAdressIndex*3+1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);

				BOOL bOK = TRUE;
				for(int j=0;j<2;j++)
				{
					if (m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_nResult[j]!=1)
					{
						bOK=bOK&&FALSE;
					}
				}
				nParam = bOK? 0 : -1;
				PackParam(strParam[4+nAdressIndex*3+2], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
			}

		}
		strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1]+ strBlank + strParam[2]+ strBlank + strParam[3];
		for (int i=0;i<=nAdressIndex;i++)
		{
			strInfo=strInfo+strBlank+strParam[4+3*i]+strBlank+strParam[4+3*i+1]+strBlank+strParam[4+3*i+2];
		}
		strInfo=strInfo+strTail;
		return TRUE;
	}
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1]+ strBlank + strParam[2]+ strBlank + strParam[3]+ strTail;

	return TRUE;
}
BOOL CCommProtocolXYDFast::PackRePlcAlignAfterSearchAxisPos(CString& strInfo,BOOL bResult,CPlatformAxisPos* vpPlatAxisPos)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bResult == FALSE || m_pMidPlatformInfo == NULL)
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

			}
			else
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dY1 = 0.0;
						double dY2 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(dX0, dY0, dD0, dY1, dY2, dX1);


						double dParam = 0;
						dParam = dX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dX2 = 0.0;
						double dY1 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(dX0, dY0, dD0, dX1, dX2, dY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData))
		{
			return FALSE;
		}
		SaveAxisPosDataNeedSend(vnWriteData,strInfo);
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	else
	{
		int nParam = 0;

		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_PLATFORM_MOVE_POS_X_WORD);	// 寄存器地址
		int  nDataNum = 3;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bResult == FALSE || m_pMidPlatformInfo == NULL)
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

			}
			else
			{
				double dParam = 0;
				dParam = pPlatformXYDAixisPos->m_dPosX;
				PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = pPlatformXYDAixisPos->m_dPosY;
				PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = pPlatformXYDAixisPos->m_dAngle;
				PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = pPlatformXYDAixisPos->m_dPosX;
				// 						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dPosY;
				// 						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = pPlatformXYDAixisPos->m_dAngle;
				// 						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dY1 = 0.0;
						double dY2 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(dX0, dY0, dD0, dY1, dY2, dX1);


						double dParam = 0;
						dParam = dX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dY1;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dY2;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dX1 = 0.0;
						double dX2 = 0.0;
						double dY1 = 0.0;

						double dX0 = pPlatformXYDAixisPos->m_dPosX;
						double dY0 = pPlatformXYDAixisPos->m_dPosY;
						double dD0 = pPlatformXYDAixisPos->m_dAngle;
						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(dX0, dY0, dD0, dX1, dX2, dY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dY1;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dX1;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dX2;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
					else
					{
						double dParam = 0;
						dParam = pPlatformXYDAixisPos->m_dPosX;
						PackPlcParam(vnWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = pPlatformXYDAixisPos->m_dPosY;
						PackPlcParam(vnWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = pPlatformXYDAixisPos->m_dAngle;
						PackPlcParam(vnWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);

					}
				}
			}
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, vnWriteData.size(), vnWriteData,TRUE))
		{
			return FALSE;
		}
		SaveAxisPosDataNeedSend(vnWriteData,strInfo);                                
		SetWriteRegTranslateResultInfo(nRegAdrr,vnWriteData.size(),vnWriteData,TRUE);

	}
	return TRUE;
}

// 打包握手信息
BOOL CCommProtocolXYDFast::PackPlcShakeHands(CString& strInfo)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (!m_pCommProRegBase->PackShakeHandsRegInfo(strInfo))
	{
		return FALSE;
	}

	CString strTranlateResultInfo;
	strTranlateResultInfo.Format("发送握手");
	m_dstrTranlateResultInfo.push_back(strTranlateResultInfo);

	return TRUE;
}
// 解析握手信息
CmdAnsweredStatus CCommProtocolXYDFast::AnalyzeAswPlcShakeHands(CString strAsw)
{
	if (m_pCommProRegBase == NULL)
	{
		return eAswCmdErr;
	}

	if (!m_pCommProRegBase->AnalyzeShakeHandsReg(strAsw))
	{
		CString strTranlateResultInfo;
		strTranlateResultInfo.Format("握手,状态：失败");
		m_dstrTranlateResultInfo.push_back(strTranlateResultInfo);

		return eAswCmdErr;
	}
	else
	{
		CString strTranlateResultInfo;
		strTranlateResultInfo.Format("握手,状态：成功");
		m_dstrTranlateResultInfo.push_back(strTranlateResultInfo);

		return eAswSucceed;
	}
}

BOOL CCommProtocolXYDFast::PackReAlignResultInfoFACO(CString& strInfo,std::vector<CCoordPos> vPlatOffset,BOOL bResult, CPlatformAxisPos* vpPlatAxisPos)
{
	CString strHead = m_strHead;
	CString strName= m_FACOParam.m_strCmd;
	CString strParam[5];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);
	int nTempNum = vPlatOffset.size();
	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	nParam = nTempNum;
	PackParam(strParam[1], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	CCoordPos platOffset;

	std::vector<CString> vsWriteData[3];
	vsWriteData[0].resize(nTempNum);
	vsWriteData[1].resize(nTempNum);
	vsWriteData[2].resize(nTempNum);

	for(int i = 0; i < vPlatOffset.size(); i++)
	{
		platOffset = vPlatOffset.at(i);

		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (/*bResult == FALSE|| */pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dPosY;
				PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dAngle;
				PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				vsWriteData[1].at(i) = strParam[3];
				vsWriteData[0].at(i) = strParam[2];
				vsWriteData[2].at(i) = strParam[4];
			}
			else
			{
				double dParam = 0;
				dParam = platOffset.m_dPosX;
				PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffset.m_dPosY;
				PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffset.m_dAngle;
				PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				vsWriteData[0].at(i) = strParam[2];
				vsWriteData[1].at(i) = strParam[3];
				vsWriteData[2].at(i) = strParam[4];
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dPosY;
						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dAngle;
						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

						vsWriteData[1].at(i) = strParam[3];
						vsWriteData[0].at(i) = strParam[2];
						vsWriteData[2].at(i) = strParam[4];
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

						vsWriteData[0].at(i) = strParam[2];
						vsWriteData[1].at(i) = strParam[3];
						vsWriteData[2].at(i) = strParam[4];
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 						vsWriteData[1].at(i) = strParam[3];
				// 						vsWriteData[0].at(i) = strParam[2];
				// 						vsWriteData[2].at(i) = strParam[4];
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 						vsWriteData[0].at(i) = strParam[2];
				// 						vsWriteData[1].at(i) = strParam[3];
				// 						vsWriteData[2].at(i) = strParam[4];
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 						vsWriteData[1].at(i) = strParam[3];
				// 						vsWriteData[0].at(i) = strParam[2];
				// 						vsWriteData[2].at(i) = strParam[4];
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 						vsWriteData[0].at(i) = strParam[2];
				// 						vsWriteData[1].at(i) = strParam[3];
				// 						vsWriteData[2].at(i) = strParam[4];
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 						vsWriteData[1].at(i) = strParam[3];
				// 						vsWriteData[0].at(i) = strParam[2];
				// 						vsWriteData[2].at(i) = strParam[4];
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 						vsWriteData[0].at(i) = strParam[2];
				// 						vsWriteData[1].at(i) = strParam[3];
				// 						vsWriteData[2].at(i) = strParam[4];
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 						vsWriteData[1].at(i) = strParam[3];
				// 						vsWriteData[0].at(i) = strParam[2];
				// 						vsWriteData[2].at(i) = strParam[4];
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 						vsWriteData[0].at(i) = strParam[2];
				// 						vsWriteData[1].at(i) = strParam[3];
				// 						vsWriteData[2].at(i) = strParam[4];
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 						vsWriteData[1].at(i) = strParam[3];
				// 						vsWriteData[0].at(i) = strParam[2];
				// 						vsWriteData[2].at(i) = strParam[4];
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 						vsWriteData[0].at(i) = strParam[2];
				// 						vsWriteData[1].at(i) = strParam[3];
				// 						vsWriteData[2].at(i) = strParam[4];
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 						vsWriteData[1].at(i) = strParam[3];
				// 						vsWriteData[0].at(i) = strParam[2];
				// 						vsWriteData[2].at(i) = strParam[4];
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 						vsWriteData[0].at(i) = strParam[2];
				// 						vsWriteData[1].at(i) = strParam[3];
				// 						vsWriteData[2].at(i) = strParam[4];
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 						vsWriteData[1].at(i) = strParam[3];
				// 						vsWriteData[0].at(i) = strParam[2];
				// 						vsWriteData[2].at(i) = strParam[4];
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 						dParam = platOffset.m_dPosX;
				// 						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffset.m_dPosY;
				// 						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffset.m_dAngle;
				// 						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				// 
				// 						vsWriteData[0].at(i) = strParam[2];
				// 						vsWriteData[1].at(i) = strParam[3];
				// 						vsWriteData[2].at(i) = strParam[4];
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);

						vsWriteData[0].at(i) = strParam[2];
						vsWriteData[1].at(i) = strParam[3];
						vsWriteData[2].at(i) = strParam[4];
					}
					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndY1 - dToStartY1;
						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX1 - dToStartX1;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);

						vsWriteData[0].at(i) = strParam[2];
						vsWriteData[1].at(i) = strParam[3];
						vsWriteData[2].at(i) = strParam[4];
					}
					else
					{
						return FALSE;
					}
				}
				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dPosY;
						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dAngle;
						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

						vsWriteData[1].at(i) = strParam[3];
						vsWriteData[0].at(i) = strParam[2];
						vsWriteData[2].at(i) = strParam[4];
					}
					else
					{
						double dParam = 0;
						dParam = platOffset.m_dPosX;
						PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffset.m_dPosY;
						PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffset.m_dAngle;
						PackParam(strParam[4], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

						vsWriteData[0].at(i) = strParam[2];
						vsWriteData[1].at(i) = strParam[3];
						vsWriteData[2].at(i) = strParam[4];
					}
				}
			}
		}
	}

	CString strTempInfo = _T("");
	for (int i = 0; i < nTempNum; i++)
	{
		CString strTemp = strBlank + vsWriteData[0].at(i) + strBlank + vsWriteData[1].at(i) + strBlank + vsWriteData[2].at(i);
		strTempInfo = strTempInfo + strTemp;
	}

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strTempInfo + strTail;
	//strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + strTail;

	return TRUE;

}

BOOL CCommProtocolXYDFast::PackReAlignResultInfoFACO(CString& strInfo,CCoordPos platOffset, CCoordPos platOffsetResive, BOOL bResult, CPlatformAxisPos* vpPlatAxisPos)
{
	CString strHead = m_strHead;
	CString strName= m_FACOParam.m_strCmd;
	CString strParam[4];
	CString strParamResive[3];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
	// 
	// 	double dParam = 0;
	// 	dParam = platOffset.m_dPosX;
	// 	PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
	// 	dParam = platOffset.m_dPosY;
	// 	PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
	// 	dParam = platOffset.m_dAngle;
	// 	PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	if (/*bResult == FALSE|| */pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);


			dParam = platOffsetResive.m_dPosX;
			PackParam(strParamResive[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffsetResive.m_dPosY;
			PackParam(strParamResive[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffsetResive.m_dAngle;
			PackParam(strParamResive[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
		}
		else
		{
			double dParam = 0;
			dParam = platOffset.m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffset.m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffset.m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

			dParam = platOffsetResive.m_dPosX;
			PackParam(strParamResive[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = platOffsetResive.m_dPosY;
			PackParam(strParamResive[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = platOffsetResive.m_dAngle;
			PackParam(strParamResive[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
		}

	}
	else
	{
		switch(m_eMidPlatformType)
		{
		case ePlatformXYD:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = platOffset.m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffset.m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffset.m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

					dParam = platOffsetResive.m_dPosX;
					PackParam(strParamResive[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffsetResive.m_dPosY;
					PackParam(strParamResive[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffsetResive.m_dAngle;
					PackParam(strParamResive[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				}
				else
				{
					double dParam = 0;
					dParam = platOffset.m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffset.m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffset.m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

					dParam = platOffsetResive.m_dPosX;
					PackParam(strParamResive[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffsetResive.m_dPosY;
					PackParam(strParamResive[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffsetResive.m_dAngle;
					PackParam(strParamResive[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				}
			}
			break;

			// 		case ePlatformXYPD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = platOffsetResive.m_dPosX;
			// 					PackParam(strParamResive[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffsetResive.m_dPosY;
			// 					PackParam(strParamResive[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffsetResive.m_dAngle;
			// 					PackParam(strParamResive[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = platOffsetResive.m_dPosX;
			// 					PackParam(strParamResive[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffsetResive.m_dPosY;
			// 					PackParam(strParamResive[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffsetResive.m_dAngle;
			// 					PackParam(strParamResive[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = platOffsetResive.m_dPosX;
			// 					PackParam(strParamResive[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffsetResive.m_dPosY;
			// 					PackParam(strParamResive[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffsetResive.m_dAngle;
			// 					PackParam(strParamResive[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = platOffsetResive.m_dPosX;
			// 					PackParam(strParamResive[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffsetResive.m_dPosY;
			// 					PackParam(strParamResive[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffsetResive.m_dAngle;
			// 					PackParam(strParamResive[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 
			// 					dParam = platOffsetResive.m_dPosX;
			// 					PackParam(strParamResive[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffsetResive.m_dPosY;
			// 					PackParam(strParamResive[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffsetResive.m_dAngle;
			// 					PackParam(strParamResive[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = platOffsetResive.m_dPosX;
			// 					PackParam(strParamResive[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffsetResive.m_dPosY;
			// 					PackParam(strParamResive[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffsetResive.m_dAngle;
			// 					PackParam(strParamResive[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformX:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 
			// 					dParam = platOffsetResive.m_dPosX;
			// 					PackParam(strParamResive[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffsetResive.m_dPosY;
			// 					PackParam(strParamResive[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffsetResive.m_dAngle;
			// 					PackParam(strParamResive[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = platOffsetResive.m_dPosX;
			// 					PackParam(strParamResive[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffsetResive.m_dPosY;
			// 					PackParam(strParamResive[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffsetResive.m_dAngle;
			// 					PackParam(strParamResive[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXDPY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 
			// 					dParam = platOffsetResive.m_dPosX;
			// 					PackParam(strParamResive[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffsetResive.m_dPosY;
			// 					PackParam(strParamResive[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffsetResive.m_dAngle;
			// 					PackParam(strParamResive[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = platOffsetResive.m_dPosX;
			// 					PackParam(strParamResive[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffsetResive.m_dPosY;
			// 					PackParam(strParamResive[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffsetResive.m_dAngle;
			// 					PackParam(strParamResive[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXDPY1:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = platOffsetResive.m_dPosX;
			// 					PackParam(strParamResive[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffsetResive.m_dPosY;
			// 					PackParam(strParamResive[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffsetResive.m_dAngle;
			// 					PackParam(strParamResive[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = platOffsetResive.m_dPosX;
			// 					PackParam(strParamResive[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffsetResive.m_dPosY;
			// 					PackParam(strParamResive[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffsetResive.m_dAngle;
			// 					PackParam(strParamResive[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformYD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = platOffsetResive.m_dPosX;
			// 					PackParam(strParamResive[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffsetResive.m_dPosY;
			// 					PackParam(strParamResive[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffsetResive.m_dAngle;
			// 					PackParam(strParamResive[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = platOffset.m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffset.m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffset.m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = platOffsetResive.m_dPosX;
			// 					PackParam(strParamResive[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = platOffsetResive.m_dPosY;
			// 					PackParam(strParamResive[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = platOffsetResive.m_dAngle;
			// 					PackParam(strParamResive[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;

		case ePlatformXY1Y2:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dToStartX1 = 0.0;
					double dToStartY1 = 0.0;
					double dToStartY2 = 0.0;

					double dToEndX1 = 0.0;
					double dToEndY1 = 0.0;
					double dToEndY2 = 0.0;

					double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
					double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
					double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

					double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
					double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;				                            
					double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

					CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
						dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
						dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


					double dParam = 0;
					dParam = dToEndX1 - dToStartX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dToEndY1 - dToStartY1;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = dToEndY2 - dToStartY2;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;
		case ePlatformX1X2Y:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dToStartX1 = 0.0;
					double dToStartX2 = 0.0;
					double dToStartY1 = 0.0;

					double dToEndX1 = 0.0;
					double dToEndX2 = 0.0;
					double dToEndY1 = 0.0;

					double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
					double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
					double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

					double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
					double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
					double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

					CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
						dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
						dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

					//dX1 = dX1 + 5.5;
					//dX2 = dX2 + 5.5;
					//dY1 = dY1 + 5.5;

					double dParam = 0;
					dParam = dToEndX1 - dToStartX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dToEndX2 - dToStartX2;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dToEndY1 - dToStartY1;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;
		default:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = platOffset.m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffset.m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffset.m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);


					dParam = platOffsetResive.m_dPosX;
					PackParam(strParamResive[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffsetResive.m_dPosY;
					PackParam(strParamResive[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffsetResive.m_dAngle;
					PackParam(strParamResive[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				}
				else
				{
					double dParam = 0;
					dParam = platOffset.m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffset.m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffset.m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

					dParam = platOffsetResive.m_dPosX;
					PackParam(strParamResive[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffsetResive.m_dPosY;
					PackParam(strParamResive[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffsetResive.m_dAngle;
					PackParam(strParamResive[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				}
			}
		}
	}

	//构造写命令
	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strParam[2] + strBlank + strParam[3] + 
		strBlank +  strParamResive[0] + strBlank + strParamResive[1] + strBlank + strParamResive[2]+ strTail;

	return TRUE;
}

// 打包FACO基准中心对位轴位置
BOOL CCommProtocolXYDFast::PackRePlcAlignPickReviseResultInfoFACOBenchAxisPos(CString& strInfo,BOOL bResult, BOOL bAlignBench, CCoordPos platOffsetRevise, CPlatformAxisPos* vpPlatAxisPos)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FACOParam.m_strCmd;
		int nCmdVal = m_FACOParam.m_nCmdVal;
		int nParam = 0;


		long nTmpRegAddr = m_nPLCTempBaseRegAddr /*+ atoi(RREG_VISION_PLATFORM_TEMP_POS)*/;
		int nTmpDataNum = 3;
		std::vector<int> vnTmpWriteData;

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bAlignBench == FALSE || bResult == FALSE|| pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;

				dParam = platOffsetRevise.m_dPosX;
				PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffsetRevise.m_dPosY;
				PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffsetRevise.m_dAngle;
				PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;


				dParam = platOffsetRevise.m_dPosX;
				PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffsetRevise.m_dPosY;
				PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffsetRevise.m_dAngle;
				PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;

						dParam = platOffsetRevise.m_dPosX;
						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffsetRevise.m_dPosY;
						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffsetRevise.m_dAngle;
						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;

						dParam = platOffsetRevise.m_dPosX;
						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffsetRevise.m_dPosY;
						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffsetRevise.m_dAngle;
						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffsetRevise.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffsetRevise.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffsetRevise.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffsetRevise.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffsetRevise.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffsetRevise.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;

						dParam = platOffsetRevise.m_dPosX;
						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffsetRevise.m_dPosY;
						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffsetRevise.m_dAngle;
						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;

						dParam = platOffsetRevise.m_dPosX;
						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffsetRevise.m_dPosY;
						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffsetRevise.m_dAngle;
						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}


		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nTmpRegAddr, nTmpDataNum, vnTmpWriteData))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nTmpRegAddr, nTmpDataNum, vnTmpWriteData, TRUE);

		return TRUE;
	}
	else
	{
		CString strName = m_FACOParam.m_strCmd;
		int nCmdVal = m_FACOParam.m_nCmdVal;
		int nParam = 0;



		long nTmpRegAddr = m_nPLCTempBaseRegAddr /*+ atoi(RREG_VISION_PLATFORM_TEMP_POS)*/;
		int nTmpDataNum = 3;
		std::vector<int> vnTmpWriteData;

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (bAlignBench == FALSE || bResult == FALSE|| pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;

				dParam = platOffsetRevise.m_dPosX;
				PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffsetRevise.m_dPosY;
				PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffsetRevise.m_dAngle;
				PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);


			}
			else
			{
				double dParam = 0;

				dParam = platOffsetRevise.m_dPosX;
				PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffsetRevise.m_dPosY;
				PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffsetRevise.m_dAngle;
				PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;

						dParam = platOffsetRevise.m_dPosX;
						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffsetRevise.m_dPosY;
						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffsetRevise.m_dAngle;
						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;

						dParam = platOffsetRevise.m_dPosX;
						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffsetRevise.m_dPosY;
						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffsetRevise.m_dAngle;
						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffsetRevise.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffsetRevise.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffsetRevise.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffsetRevise.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffsetRevise.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffsetRevise.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;

						dParam = platOffsetRevise.m_dPosX;
						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffsetRevise.m_dPosY;
						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffsetRevise.m_dAngle;
						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;

						dParam = platOffsetRevise.m_dPosX;
						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffsetRevise.m_dPosY;
						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffsetRevise.m_dAngle;
						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}


		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nTmpRegAddr, nTmpDataNum, vnTmpWriteData,TRUE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nTmpRegAddr,nTmpDataNum,vnTmpWriteData,TRUE);

		return TRUE;
	}
}

BOOL CCommProtocolXYDFast::PackRePlcAlignResultInfoFACOAxisPos(CString& strInfo, std::vector<CCoordPos> vPlatOffset,BOOL bResult, CPlatformAxisPos* vpPlatAxisPos)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FACOParam.m_strCmd;
		int nCmdVal = m_FACOParam.m_nCmdVal;
		int nVCmdValue = m_FACOParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCTempBaseRegAddr /*+ atoi(RREG_VISION_PLATFORM_TEMP_POS)*/;

		int nTempDataNum = vPlatOffset.size();
		int  nDataNum = (nTempDataNum * 3) + 1;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		// 总数
		nParam = nTempDataNum;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

		m_strCmdName = strName;	

		for(int i = 0; i < nTempDataNum; i++)
		{
			CCoordPos platOffset;
			platOffset = vPlatOffset.at(i);

			CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			if (/*bResult == FALSE|| */pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = platOffset.m_dPosX;
					PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffset.m_dPosY;
					PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffset.m_dAngle;
					PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				}
				else
				{
					double dParam = 0;
					dParam = platOffset.m_dPosX;
					PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffset.m_dPosY;
					PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffset.m_dAngle;
					PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				}

			}
			else
			{
				switch(m_eMidPlatformType)
				{
				case ePlatformXYD:
					{
						if (eCPOrderYXD == m_eCmdParamOrderType)
						{
							double dParam = 0;
							dParam = platOffset.m_dPosX;
							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = platOffset.m_dPosY;
							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = platOffset.m_dAngle;
							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
						}
						else
						{
							double dParam = 0;
							dParam = platOffset.m_dPosX;
							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = platOffset.m_dPosY;
							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = platOffset.m_dAngle;
							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
						}
					}
					break;

					// 				case ePlatformXYPD:
					// 					{
					// 						if (eCPOrderYXD == m_eCmdParamOrderType)
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 						else
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 					}
					// 					break;
					// 				case ePlatformXD:
					// 					{
					// 						if (eCPOrderYXD == m_eCmdParamOrderType)
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 						else
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 					}
					// 					break;
					// 				case ePlatformXY:
					// 					{
					// 						if (eCPOrderYXD == m_eCmdParamOrderType)
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 						else
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 					}
					// 					break;
					// 				case ePlatformX:
					// 					{
					// 						if (eCPOrderYXD == m_eCmdParamOrderType)
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 						else
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 					}
					// 					break;
					// 				case ePlatformXDPY:
					// 					{
					// 						if (eCPOrderYXD == m_eCmdParamOrderType)
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 						else
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 					}
					// 					break;
					// 				case ePlatformXDPY1:
					// 					{
					// 						if (eCPOrderYXD == m_eCmdParamOrderType)
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 						else
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 					}
					// 					break;
					// 				case ePlatformYD:
					// 					{
					// 						if (eCPOrderYXD == m_eCmdParamOrderType)
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 						else
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 					}
					// 					break;

				case ePlatformXY1Y2:
					{
						if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
						{
							double dToStartX1 = 0.0;
							double dToStartY1 = 0.0;
							double dToStartY2 = 0.0;

							double dToEndX1 = 0.0;
							double dToEndY1 = 0.0;
							double dToEndY2 = 0.0;

							double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
							double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
							double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

							double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
							double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
							double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

							CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

							pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
								dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

							pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
								dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


							double dParam = 0;
							dParam = dToEndX1 - dToStartX1;
							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = dToEndY1 - dToStartY1;
							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = dToEndY2 - dToStartY2;
							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						}
						else
						{
							return FALSE;
						}
					}
					break;
				case ePlatformX1X2Y:
					{
						if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
						{
							double dToStartX1 = 0.0;
							double dToStartX2 = 0.0;
							double dToStartY1 = 0.0;

							double dToEndX1 = 0.0;
							double dToEndX2 = 0.0;
							double dToEndY1 = 0.0;

							double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
							double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
							double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

							double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
							double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
							double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

							CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

							pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
								dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
							pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
								dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

							//dX1 = dX1 + 5.5;
							//dX2 = dX2 + 5.5;
							//dY1 = dY1 + 5.5;

							double dParam = 0;
							dParam = dToEndY1 - dToStartY1;
							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = dToEndX1 - dToStartX1;
							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = dToEndX2 - dToStartX2;
							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						}
						else
						{
							return FALSE;
						}
					}
					break;
				default:
					{
						if (eCPOrderYXD == m_eCmdParamOrderType)
						{
							double dParam = 0;
							dParam = platOffset.m_dPosX;
							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = platOffset.m_dPosY;
							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = platOffset.m_dAngle;
							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
						}
						else
						{
							double dParam = 0;
							dParam = platOffset.m_dPosX;
							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = platOffset.m_dPosY;
							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = platOffset.m_dAngle;
							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
						}
					}
				}
			}
		}



		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData))
		{
			return FALSE;
		}
	}
	else
	{
		CString strName = m_FACOParam.m_strCmd;
		int nCmdVal = m_FACOParam.m_nCmdVal;
		int nVCmdValue = m_FACOParam.m_nVCmdValue;
		int nParam = 0;

		long nRegAdrr = m_nPLCTempBaseRegAddr /*+ atoi(RREG_VISION_PLATFORM_TEMP_POS)*/;

		int nTempDataNum = vPlatOffset.size();
		int  nDataNum = (nTempDataNum * 3) + 1;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		// 总数
		nParam = nTempDataNum;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

		m_strCmdName = strName;	

		for(int i = 0; i < nTempDataNum; i++)
		{
			CCoordPos platOffset;
			platOffset = vPlatOffset.at(i);

			CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
			pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
			if (/*bResult == FALSE|| */pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = platOffset.m_dPosX;
					PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffset.m_dPosY;
					PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffset.m_dAngle;
					PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				}
				else
				{
					double dParam = 0;
					dParam = platOffset.m_dPosX;
					PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = platOffset.m_dPosY;
					PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = platOffset.m_dAngle;
					PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				}

			}
			else
			{
				switch(m_eMidPlatformType)
				{
				case ePlatformXYD:
					{
						if (eCPOrderYXD == m_eCmdParamOrderType)
						{
							double dParam = 0;
							dParam = platOffset.m_dPosX;
							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = platOffset.m_dPosY;
							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = platOffset.m_dAngle;
							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
						}
						else
						{
							double dParam = 0;
							dParam = platOffset.m_dPosX;
							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = platOffset.m_dPosY;
							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = platOffset.m_dAngle;
							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
						}
					}
					break;

					// 				case ePlatformXYPD:
					// 					{
					// 						if (eCPOrderYXD == m_eCmdParamOrderType)
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 						else
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 					}
					// 					break;
					// 				case ePlatformXD:
					// 					{
					// 						if (eCPOrderYXD == m_eCmdParamOrderType)
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 						else
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 					}
					// 					break;
					// 				case ePlatformXY:
					// 					{
					// 						if (eCPOrderYXD == m_eCmdParamOrderType)
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 						else
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 					}
					// 					break;
					// 				case ePlatformX:
					// 					{
					// 						if (eCPOrderYXD == m_eCmdParamOrderType)
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 						else
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 					}
					// 					break;
					// 				case ePlatformXDPY:
					// 					{
					// 						if (eCPOrderYXD == m_eCmdParamOrderType)
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 						else
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 					}
					// 					break;
					// 				case ePlatformXDPY1:
					// 					{
					// 						if (eCPOrderYXD == m_eCmdParamOrderType)
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 						else
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 					}
					// 					break;
					// 				case ePlatformYD:
					// 					{
					// 						if (eCPOrderYXD == m_eCmdParamOrderType)
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 						else
					// 						{
					// 							double dParam = 0;
					// 							dParam = platOffset.m_dPosX;
					// 							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
					// 							dParam = platOffset.m_dPosY;
					// 							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					// 							dParam = platOffset.m_dAngle;
					// 							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					// 						}
					// 					}
					// 					break;

				case ePlatformXY1Y2:
					{
						if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
						{
							double dToStartX1 = 0.0;
							double dToStartY1 = 0.0;
							double dToStartY2 = 0.0;

							double dToEndX1 = 0.0;
							double dToEndY1 = 0.0;
							double dToEndY2 = 0.0;

							double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
							double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
							double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

							double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
							double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
							double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

							CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

							pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
								dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

							pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
								dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


							double dParam = 0;
							dParam = dToEndX1 - dToStartX1;
							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = dToEndY1 - dToStartY1;
							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = dToEndY2 - dToStartY2;
							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						}
						else
						{
							return FALSE;
						}
					}
					break;
				case ePlatformX1X2Y:
					{
						if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
						{
							double dToStartX1 = 0.0;
							double dToStartX2 = 0.0;
							double dToStartY1 = 0.0;

							double dToEndX1 = 0.0;
							double dToEndX2 = 0.0;
							double dToEndY1 = 0.0;

							double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffset.m_dPosX;
							double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffset.m_dPosY;
							double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffset.m_dAngle;

							double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
							double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
							double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

							CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

							pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
								dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
							pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
								dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

							//dX1 = dX1 + 5.5;
							//dX2 = dX2 + 5.5;
							//dY1 = dY1 + 5.5;

							double dParam = 0;
							dParam = dToEndY1 - dToStartY1;
							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = dToEndX1 - dToStartX1;
							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = dToEndX2 - dToStartX2;
							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						}
						else
						{
							return FALSE;
						}
					}
					break;
				default:
					{
						if (eCPOrderYXD == m_eCmdParamOrderType)
						{
							double dParam = 0;
							dParam = platOffset.m_dPosX;
							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = platOffset.m_dPosY;
							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = platOffset.m_dAngle;
							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
						}
						else
						{
							double dParam = 0;
							dParam = platOffset.m_dPosX;
							PackPlcParam(vnWriteData[1 + i * 3], dParam, m_CommProtocolParam.m_nCommXUnitExp);
							dParam = platOffset.m_dPosY;
							PackPlcParam(vnWriteData[2 + i * 3], dParam, m_CommProtocolParam.m_nCommYUnitExp);
							dParam = platOffset.m_dAngle;
							PackPlcParam(vnWriteData[3 + i * 3], dParam, m_CommProtocolParam.m_nCommDUnitExp);
						}
					}
				}
			}
		}


		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}
	}

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackRePlcAlignPickReviseResultInfoFACOAxisPos(CString& strInfo, CCoordPos platOffsetRevise, BOOL bResult, CPlatformAxisPos* vpPlatAxisPos)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_bRegType)
	{
		CString strName = m_FACOParam.m_strCmd;
		int nCmdVal = m_FACOParam.m_nCmdVal;
		int nVCmdValue = m_FACOParam.m_nVCmdValue;
		int nParam = 0;


		long nTmpRegAddr = m_nPLCTempBaseRegAddr /*+ atoi(RREG_VISION_PLATFORM_TEMP_POS)*/;
		int nTmpDataNum = 3;
		std::vector<int> vnTmpWriteData;
		vnTmpWriteData.resize(nTmpDataNum);

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (/*bResult == FALSE|| */pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;

				dParam = platOffsetRevise.m_dPosX;
				PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffsetRevise.m_dPosY;
				PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffsetRevise.m_dAngle;
				PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;

				dParam = platOffsetRevise.m_dPosX;
				PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffsetRevise.m_dPosY;
				PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffsetRevise.m_dAngle;
				PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;

						dParam = platOffsetRevise.m_dPosX;
						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffsetRevise.m_dPosY;
						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffsetRevise.m_dAngle;
						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;

						dParam = platOffsetRevise.m_dPosX;
						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffsetRevise.m_dPosY;
						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffsetRevise.m_dAngle;
						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffsetRevise.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffsetRevise.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffsetRevise.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffsetRevise.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffsetRevise.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffsetRevise.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;

						dParam = platOffsetRevise.m_dPosX;
						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffsetRevise.m_dPosY;
						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffsetRevise.m_dAngle;
						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;

						dParam = platOffsetRevise.m_dPosX;
						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffsetRevise.m_dPosY;
						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffsetRevise.m_dAngle;
						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}


		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nTmpRegAddr, nTmpDataNum, vnTmpWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nTmpRegAddr,nTmpDataNum,vnTmpWriteData,TRUE);

	}
	else
	{
		CString strName = m_FACOParam.m_strCmd;
		int nCmdVal = m_FACOParam.m_nCmdVal;
		int nVCmdValue = m_FACOParam.m_nVCmdValue;
		int nParam = 0;

		long nTmpRegAddr = m_nPLCTempBaseRegAddr /*+ atoi(RREG_VISION_PLATFORM_TEMP_POS)*/;
		int nTmpDataNum = 3;
		std::vector<int> vnTmpWriteData;
		vnTmpWriteData.resize(nTmpDataNum);

		m_strCmdName = strName;	


		CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
		pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
		if (/*bResult == FALSE|| */pPlatformXYDAixisPos == NULL || m_pMidPlatformInfo == NULL )
		{
			if (eCPOrderYXD == m_eCmdParamOrderType)
			{
				double dParam = 0;

				dParam = platOffsetRevise.m_dPosX;
				PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffsetRevise.m_dPosY;
				PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffsetRevise.m_dAngle;
				PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}
			else
			{
				double dParam = 0;

				dParam = platOffsetRevise.m_dPosX;
				PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				dParam = platOffsetRevise.m_dPosY;
				PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				dParam = platOffsetRevise.m_dAngle;
				PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
			}

		}
		else
		{
			switch(m_eMidPlatformType)
			{
			case ePlatformXYD:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;

						dParam = platOffsetRevise.m_dPosX;
						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffsetRevise.m_dPosY;
						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffsetRevise.m_dAngle;
						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;

						dParam = platOffsetRevise.m_dPosX;
						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffsetRevise.m_dPosY;
						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffsetRevise.m_dAngle;
						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
				break;

				// 			case ePlatformXYPD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformX:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformXDPY1:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;
				// 			case ePlatformYD:
				// 				{
				// 					if (eCPOrderYXD == m_eCmdParamOrderType)
				// 					{
				// 						double dParam = 0;
				// 
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 					else
				// 					{
				// 						double dParam = 0;
				// 
				// 						dParam = platOffsetRevise.m_dPosX;
				// 						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
				// 						dParam = platOffsetRevise.m_dPosY;
				// 						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
				// 						dParam = platOffsetRevise.m_dAngle;
				// 						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
				// 					}
				// 				}
				// 				break;

			case ePlatformXY1Y2:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartY1 = 0.0;
						double dToStartY2 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndY1 = 0.0;
						double dToEndY2 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffsetRevise.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffsetRevise.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffsetRevise.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartY1, dToStartY2, dToStartX1);

						pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndY1, dToEndY2, dToEndX1);


						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = dToEndY2 - dToStartY2;
						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			case ePlatformX1X2Y:
				{
					if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
					{
						double dToStartX1 = 0.0;
						double dToStartX2 = 0.0;
						double dToStartY1 = 0.0;

						double dToEndX1 = 0.0;
						double dToEndX2 = 0.0;
						double dToEndY1 = 0.0;

						double dFromStartX0 = pPlatformXYDAixisPos->m_dPosX - platOffsetRevise.m_dPosX;
						double dFromStartY0 = pPlatformXYDAixisPos->m_dPosY - platOffsetRevise.m_dPosY;
						double dFromStartD0 = pPlatformXYDAixisPos->m_dAngle - platOffsetRevise.m_dAngle;

						double dFromEndX0 = pPlatformXYDAixisPos->m_dPosX;
						double dFromEndY0 = pPlatformXYDAixisPos->m_dPosY;
						double dFromEndD0 = pPlatformXYDAixisPos->m_dAngle;

						CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromStartX0, dFromStartY0, dFromStartD0, dToStartX1, dToStartX2, dToStartY1);
						pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(
							dFromEndX0, dFromEndY0, dFromEndD0, dToEndX1, dToEndX2, dToEndY1);

						//dX1 = dX1 + 5.5;
						//dX2 = dX2 + 5.5;
						//dY1 = dY1 + 5.5;

						double dParam = 0;
						dParam = dToEndX1 - dToStartX1;
						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndX2 - dToStartX2;
						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = dToEndY1 - dToStartY1;
						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommYUnitExp);
					}
					else
					{
						return FALSE;
					}
				}
				break;
			default:
				{
					if (eCPOrderYXD == m_eCmdParamOrderType)
					{
						double dParam = 0;


						dParam = platOffsetRevise.m_dPosX;
						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffsetRevise.m_dPosY;
						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffsetRevise.m_dAngle;
						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
					else
					{
						double dParam = 0;


						dParam = platOffsetRevise.m_dPosX;
						PackPlcParam(vnTmpWriteData[0], dParam, m_CommProtocolParam.m_nCommXUnitExp);
						dParam = platOffsetRevise.m_dPosY;
						PackPlcParam(vnTmpWriteData[1], dParam, m_CommProtocolParam.m_nCommYUnitExp);
						dParam = platOffsetRevise.m_dAngle;
						PackPlcParam(vnTmpWriteData[2], dParam, m_CommProtocolParam.m_nCommDUnitExp);
					}
				}
			}
		}


		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nTmpRegAddr, nTmpDataNum, vnTmpWriteData,TRUE))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nTmpRegAddr,nTmpDataNum,vnTmpWriteData,TRUE);
	}
	return TRUE;
}

BOOL CCommProtocolXYDFast::PackReTargetSearchFTGTAndALGOrACO(CString& strInfo,BOOL bResult, CPlatformAxisPos* vpPlatAxisPos, CCoordPos* cpOffsetPick)
{
	CString strHead = m_strHead;
	CString strName= m_FTGTParam.m_strCmd;
	CString strParam[16];
	CString strRevise[3];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = 0;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	if (m_pMidPlatformInfo == NULL)
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

			dParam = cpOffsetPick->m_dPosX;
			PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = cpOffsetPick->m_dPosY;
			PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = cpOffsetPick->m_dAngle;
			PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}
		else
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

			dParam = cpOffsetPick->m_dPosX;
			PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = cpOffsetPick->m_dPosY;
			PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = cpOffsetPick->m_dAngle;
			PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
		}

	}
	else
	{
		switch(m_eMidPlatformType)
		{
		case ePlatformXYD:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

					dParam = cpOffsetPick->m_dPosX;
					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = cpOffsetPick->m_dPosY;
					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = cpOffsetPick->m_dAngle;
					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

					dParam = cpOffsetPick->m_dPosX;
					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = cpOffsetPick->m_dPosY;
					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = cpOffsetPick->m_dAngle;
					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
			}
			break;

			// 		case ePlatformXYPD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = cpOffsetPick->m_dPosX;
			// 					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = cpOffsetPick->m_dPosY;
			// 					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = cpOffsetPick->m_dAngle;
			// 					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = cpOffsetPick->m_dPosX;
			// 					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = cpOffsetPick->m_dPosY;
			// 					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = cpOffsetPick->m_dAngle;
			// 					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = cpOffsetPick->m_dPosX;
			// 					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = cpOffsetPick->m_dPosY;
			// 					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = cpOffsetPick->m_dAngle;
			// 					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = cpOffsetPick->m_dPosX;
			// 					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = cpOffsetPick->m_dPosY;
			// 					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = cpOffsetPick->m_dAngle;
			// 					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = cpOffsetPick->m_dPosX;
			// 					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = cpOffsetPick->m_dPosY;
			// 					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = cpOffsetPick->m_dAngle;
			// 					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = cpOffsetPick->m_dPosX;
			// 					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = cpOffsetPick->m_dPosY;
			// 					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = cpOffsetPick->m_dAngle;
			// 					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformX:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = cpOffsetPick->m_dPosX;
			// 					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = cpOffsetPick->m_dPosY;
			// 					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = cpOffsetPick->m_dAngle;
			// 					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = cpOffsetPick->m_dPosX;
			// 					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = cpOffsetPick->m_dPosY;
			// 					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = cpOffsetPick->m_dAngle;
			// 					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXDPY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = cpOffsetPick->m_dPosX;
			// 					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = cpOffsetPick->m_dPosY;
			// 					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = cpOffsetPick->m_dAngle;
			// 					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = cpOffsetPick->m_dPosX;
			// 					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = cpOffsetPick->m_dPosY;
			// 					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = cpOffsetPick->m_dAngle;
			// 					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXDPY1:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformYD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = cpOffsetPick->m_dPosX;
			// 					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = cpOffsetPick->m_dPosY;
			// 					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = cpOffsetPick->m_dAngle;
			// 					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 
			// 					dParam = cpOffsetPick->m_dPosX;
			// 					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = cpOffsetPick->m_dPosY;
			// 					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = cpOffsetPick->m_dAngle;
			// 					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 				}
			// 			}
			// 			break;

		case ePlatformXY1Y2:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dY1 = 0.0;
					double dY2 = 0.0;

					double dX0 = pPlatformXYDAixisPos->m_dPosX;
					double dY0 = pPlatformXYDAixisPos->m_dPosY;
					double dD0 = pPlatformXYDAixisPos->m_dAngle;
					CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(dX0, dY0, dD0, dY1, dY2, dX1);


					double dParam = 0;
					dParam = dX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dY1;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = dY2;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;
		case ePlatformX1X2Y:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dX2 = 0.0;
					double dY1 = 0.0;

					double dX0 = pPlatformXYDAixisPos->m_dPosX;
					double dY0 = pPlatformXYDAixisPos->m_dPosY;
					double dD0 = pPlatformXYDAixisPos->m_dAngle;
					CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(dX0, dY0, dD0, dX1, dX2, dY1);

					//dX1 = dX1 + 5.5;
					//dX2 = dX2 + 5.5;
					//dY1 = dY1 + 5.5;

					double dParam = 0;
					dParam = dY1;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = dX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dX2;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;
		default:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

					dParam = cpOffsetPick->m_dPosX;
					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = cpOffsetPick->m_dPosY;
					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = cpOffsetPick->m_dAngle;
					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);


					dParam = cpOffsetPick->m_dPosX;
					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = cpOffsetPick->m_dPosY;
					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = cpOffsetPick->m_dAngle;
					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
				}
			}
		}
	}
	//构造写命令
	strInfo.Empty();
	if (m_bEnablePackInspectDistance)
	{

		int nAdressIndex=-1;
		double dParam = 0;
		int nParam=0;
		for (int i =0;i<m_vstL2LDistanceResult.size();i++)
		{
			if (m_vstL2LDistanceResult.at(i).m_bPosSearchFinished)
			{
				nAdressIndex+=1;
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[0];
				PackParam(strParam[4+nAdressIndex*3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[1];
				PackParam(strParam[4+nAdressIndex*3+1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);

				BOOL bOK = TRUE;
				for(int j=0;j<2;j++)
				{
					if (m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_nResult[j]!=1)
					{
						bOK=bOK&&FALSE;
					}
				}
				nParam = bOK? 0 : -1;
				PackParam(strParam[4+nAdressIndex*3+2], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
			}

		}
		strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1]+ strBlank + strParam[2]+ strBlank + strParam[3];
		for (int i=0;i<=nAdressIndex;i++)
		{
			strInfo=strInfo+strBlank+strParam[4+3*i]+strBlank+strParam[4+3*i+1]+strBlank+strParam[4+3*i+2];
		}
		strInfo += strBlank + strRevise[0] + strBlank + strRevise[1] + strBlank + strRevise[2];
		strInfo=strInfo+strTail;
		return TRUE;
	}
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1]+ strBlank + strParam[2]+ strBlank + strParam[3]+ 
		strBlank + strRevise[0] + strBlank + strRevise[1] + strBlank + strRevise[2] + strTail;

	return TRUE;
}


BOOL CCommProtocolXYDFast::PackReTargetSearchFTGCAndALGOrACO(CString& strInfo,BOOL bResult, int nSuccessPatIndex,CPlatformAxisPos* vpPlatAxisPos, CCoordPos* cpOffsetPick)
{
	CString strHead = m_strHead;
	CString strName= m_FTGCParam.m_strCmd;
	CString strParam[16];
	CString strRevise[3];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (bResult)
	{	
		nParam = nSuccessPatIndex;
	}
	else
	{
		nParam = -1;
	}
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	CPlatformXYDAxisPos* pPlatformXYDAixisPos; 		
	pPlatformXYDAixisPos = (CPlatformXYDAxisPos*)(vpPlatAxisPos);	
	if (m_pMidPlatformInfo == NULL)
	{
		if (eCPOrderYXD == m_eCmdParamOrderType)
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

			dParam = cpOffsetPick->m_dPosX;
			PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = cpOffsetPick->m_dPosY;
			PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = cpOffsetPick->m_dAngle;
			PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}
		else
		{
			double dParam = 0;
			dParam = pPlatformXYDAixisPos->m_dPosX;
			PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = pPlatformXYDAixisPos->m_dPosY;
			PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = pPlatformXYDAixisPos->m_dAngle;
			PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

			dParam = cpOffsetPick->m_dPosX;
			PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			dParam = cpOffsetPick->m_dPosY;
			PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			dParam = cpOffsetPick->m_dAngle;
			PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

		}

	}
	else
	{
		switch(m_eMidPlatformType)
		{
		case ePlatformXYD:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

					dParam = cpOffsetPick->m_dPosX;
					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = cpOffsetPick->m_dPosY;
					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = cpOffsetPick->m_dAngle;
					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
			}
			break;
			// 		case ePlatformXYPD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = cpOffsetPick->m_dPosX;
			// 					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = cpOffsetPick->m_dPosY;
			// 					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = cpOffsetPick->m_dAngle;
			// 					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = cpOffsetPick->m_dPosX;
			// 					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = cpOffsetPick->m_dPosY;
			// 					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = cpOffsetPick->m_dAngle;
			// 					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = cpOffsetPick->m_dPosX;
			// 					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = cpOffsetPick->m_dPosY;
			// 					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = cpOffsetPick->m_dAngle;
			// 					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = cpOffsetPick->m_dPosX;
			// 					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = cpOffsetPick->m_dPosY;
			// 					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = cpOffsetPick->m_dAngle;
			// 					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = cpOffsetPick->m_dPosX;
			// 					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = cpOffsetPick->m_dPosY;
			// 					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = cpOffsetPick->m_dAngle;
			// 					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = cpOffsetPick->m_dPosX;
			// 					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = cpOffsetPick->m_dPosY;
			// 					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = cpOffsetPick->m_dAngle;
			// 					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformX:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = cpOffsetPick->m_dPosX;
			// 					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = cpOffsetPick->m_dPosY;
			// 					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = cpOffsetPick->m_dAngle;
			// 					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = cpOffsetPick->m_dPosX;
			// 					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = cpOffsetPick->m_dPosY;
			// 					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = cpOffsetPick->m_dAngle;
			// 					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXDPY:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = cpOffsetPick->m_dPosX;
			// 					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = cpOffsetPick->m_dPosY;
			// 					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = cpOffsetPick->m_dAngle;
			// 					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = cpOffsetPick->m_dPosX;
			// 					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = cpOffsetPick->m_dPosY;
			// 					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = cpOffsetPick->m_dAngle;
			// 					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformXDPY1:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;
			// 		case ePlatformYD:
			// 			{
			// 				if (eCPOrderYXD == m_eCmdParamOrderType)
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = cpOffsetPick->m_dPosX;
			// 					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = cpOffsetPick->m_dPosY;
			// 					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = cpOffsetPick->m_dAngle;
			// 					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 				else
			// 				{
			// 					double dParam = 0;
			// 					dParam = pPlatformXYDAixisPos->m_dPosX;
			// 					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dPosY;
			// 					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = pPlatformXYDAixisPos->m_dAngle;
			// 					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 					dParam = cpOffsetPick->m_dPosX;
			// 					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
			// 					dParam = cpOffsetPick->m_dPosY;
			// 					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
			// 					dParam = cpOffsetPick->m_dAngle;
			// 					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);
			// 
			// 				}
			// 			}
			// 			break;

		case ePlatformXY1Y2:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dY1 = 0.0;
					double dY2 = 0.0;

					double dX0 = pPlatformXYDAixisPos->m_dPosX;
					double dY0 = pPlatformXYDAixisPos->m_dPosY;
					double dD0 = pPlatformXYDAixisPos->m_dAngle;
					CPlatformXY1Y2Info *pPlatformXY1Y2Info = (CPlatformXY1Y2Info*)m_pMidPlatformInfo;

					pPlatformXY1Y2Info->ConvertXYDPltfmPosToXY1Y2PltfmPos(dX0, dY0, dD0, dY1, dY2, dX1);


					double dParam = 0;
					dParam = dX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dY1;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = dY2;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;
		case ePlatformX1X2Y:
			{
				if (m_SystemOptionCofing.m_pTempPlatformInfo != NULL)
				{
					double dX1 = 0.0;
					double dX2 = 0.0;
					double dY1 = 0.0;

					double dX0 = pPlatformXYDAixisPos->m_dPosX;
					double dY0 = pPlatformXYDAixisPos->m_dPosY;
					double dD0 = pPlatformXYDAixisPos->m_dAngle;
					CPlatformX1X2YInfo *pPlatformX1X2YInfo = (CPlatformX1X2YInfo*)m_pMidPlatformInfo;

					pPlatformX1X2YInfo->ConvertXYDPltfmPosToX1X2YPltfmPos(dX0, dY0, dD0, dX1, dX2, dY1);

					//dX1 = dX1 + 5.5;
					//dX2 = dX2 + 5.5;
					//dY1 = dY1 + 5.5;

					double dParam = 0;
					dParam = dY1;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = dX1;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = dX2;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				}
				else
				{
					return FALSE;
				}
			}
			break;
		default:
			{
				if (eCPOrderYXD == m_eCmdParamOrderType)
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

					dParam = cpOffsetPick->m_dPosX;
					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = cpOffsetPick->m_dPosY;
					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = cpOffsetPick->m_dAngle;
					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
				else
				{
					double dParam = 0;
					dParam = pPlatformXYDAixisPos->m_dPosX;
					PackParam(strParam[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = pPlatformXYDAixisPos->m_dPosY;
					PackParam(strParam[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = pPlatformXYDAixisPos->m_dAngle;
					PackParam(strParam[3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

					dParam = cpOffsetPick->m_dPosX;
					PackParam(strRevise[0], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
					dParam = cpOffsetPick->m_dPosY;
					PackParam(strRevise[1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommYUnitExp);
					dParam = cpOffsetPick->m_dAngle;
					PackParam(strRevise[2], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommDUnitExp);

				}
			}
		}
	}
	//构造写命令
	strInfo.Empty();
	if (m_bEnablePackInspectDistance)
	{

		int nAdressIndex=-1;
		double dParam = 0;
		int nParam=0;
		for (int i =0;i<m_vstL2LDistanceResult.size();i++)
		{
			if (m_vstL2LDistanceResult.at(i).m_bPosSearchFinished)
			{
				nAdressIndex+=1;
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[0];
				PackParam(strParam[4+nAdressIndex*3], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);
				dParam=m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_dDistanceMM[1];
				PackParam(strParam[4+nAdressIndex*3+1], dParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommXUnitExp);

				BOOL bOK = TRUE;
				for(int j=0;j<2;j++)
				{
					if (m_vstL2LDistanceResult.at(i).m_L2LDistanceResult.m_nResult[j]!=1)
					{
						bOK=bOK&&FALSE;
					}
				}
				nParam = bOK? 0 : -1;
				PackParam(strParam[4+nAdressIndex*3+2], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
			}

		}
		strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1]+ strBlank + strParam[2]+ strBlank + strParam[3];
		for (int i=0;i<=nAdressIndex;i++)
		{
			strInfo=strInfo+strBlank+strParam[4+3*i]+strBlank+strParam[4+3*i+1]+strBlank+strParam[4+3*i+2];
		}
		strInfo += strBlank+ strRevise[0] + strBlank + strRevise[1] + strBlank + strRevise[2];

		strInfo=strInfo+strTail;
		return TRUE;
	}
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1]+ strBlank + strParam[2]+ strBlank + strParam[3]+ strBlank+
		strRevise[0] + strBlank + strRevise[1] + strBlank + strRevise[2] + strTail;

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackPlcReadNewName(CString& strInfo, int nDataNum)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	int nRegNum = 0; // 寄存器数量
	if (nDataNum%2 == 0) // 字符数量为偶数
	{
		nRegNum = nDataNum/2;
	}
	else // 字符数量为奇数
	{
		nRegNum = nDataNum/2 + 1;
	}

	// 无论单字协议或双字协议，读取寄存器中字符时均按照单字协议读取
	// 每个寄存器存放两个字符，第1个字符存在第1个寄存器高8位，第2个字符存在第1个寄存器低8位，第3个字符存在第2个寄存器高8位，第4个字符存在第2个寄存器低8位，以此类推
	// 例如，5个字符ABCDE（对应十六进制数为41/42/43/44/45），保存在100寄存器开头的地址中，那么视觉会读取100-102共三个寄存器地址中数据分别为：4142 4344 45XX，解析出字符串为ABCDE

	if (m_bRegType) // 双字
	{
		long nRegAdrr = m_nPLCTempBaseRegAddr; // 临时寄存器地址
		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nRegNum, FALSE))
		{
			return FALSE;
		}
		SetReadRegTranslateResultInfo(nRegAdrr, nRegNum, FALSE);
	}
	else // 单字
	{
		long nRegAdrr = m_nPLCTempBaseRegAddr; // 临时寄存器地址
		if (!m_pCommProRegBase->PackReadRegInfo(strInfo, nRegAdrr, nRegNum, FALSE))
		{
			return FALSE;
		}
		SetReadRegTranslateResultInfo(nRegAdrr, nRegNum, FALSE);
	}

	return TRUE;
}

BOOL CCommProtocolXYDFast::AnalyzePlcNewName(CString strCmd, int nDataNum, CString& strNewName)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	int nRegNum = 0; // 寄存器数量
	if (nDataNum%2 == 0) // 字符数量为偶数
	{
		nRegNum = nDataNum/2;
	}
	else // 字符数量为奇数
	{
		nRegNum = nDataNum/2 + 1;
	}

	// 无论单字协议或双字协议，读取寄存器中字符时均按照单字协议读取
	// 每个寄存器存放两个字符，第1个字符存在第1个寄存器高8位，第2个字符存在第1个寄存器低8位，第3个字符存在第2个寄存器高8位，第4个字符存在第2个寄存器低8位，以此类推
	// 例如，5个字符ABCDE（对应十六进制数为41/42/43/44/45），保存在100寄存器开头的地址中，那么视觉会读取100-102共三个寄存器地址中数据分别为：4142 4344 45XX，解析出字符串为ABCDE

	// 读取寄存器数据
	std::vector<int> vnReceivedData;
	if (!m_pCommProRegBase->AnalyzeAswReadReg(strCmd, nRegNum, vnReceivedData, FALSE))
	{
		return FALSE;
	}

	// 解析寄存器数据为字符串
	int nTempData, nTempData1, nTempData2;
	CString strTempData, strTempData1, strTempData2;
	for(int i = 0 ; i<nRegNum;i++)
	{
		// 1个寄存器保存的十进制数
		nTempData = vnReceivedData[i];

		//////////////////////////////////////////////////////////////////////////
		// 高8位对应的十进制数
		nTempData1 = (nTempData >> 8) & 0xff;

		// 只对32到127的打印字符解析，其他记为?
		if ((nTempData1 > 31) && (nTempData1 < 128))
		{
			strTempData1.Format(_T("%c"), nTempData1);
		}
		else
		{
			strTempData1 = _T("?");
		}

		// 高8位对应第1个字符
		strTempData += strTempData1;

		//////////////////////////////////////////////////////////////////////////
		// 当解析最后一个寄存器且字符长度为奇数时，不处理低8位
		// 其他情况，处理低8位
		if ((i < nRegNum-1) || ((i == nRegNum-1) && (nDataNum%2 == 0)))
		{
			// 低8位对应的十进制数
			nTempData2 = (nTempData)&0xff;

			// 只对32到127的打印字符解析，其他记为?
			if ((nTempData2 > 31) && (nTempData2 < 128))
			{
				strTempData2.Format(_T("%c"), nTempData2);
			}
			else
			{
				strTempData2 = _T("?");
			}

			// 低8位对应第2个字符
			strTempData += strTempData2;
		}
	}
	strNewName = strTempData;

	return TRUE;
}


int CCommProtocolXYDFast::WordToDoubleWord(int nLowWord,int nHighWord)
{
	//if(IsMitsubishiQProtocol())
	//{//三菱Q寄存器适用
		INT32 nTempWord = 0;				//双字临时变量
		INT16 nTempHighWord,nTempLowWord;	//单字临时变量
		nTempLowWord = nLowWord;
		nTempHighWord = nHighWord;
		INT8 *pLowAddr = (INT8 *)&nTempWord;
		INT8 *pHighAddr = pLowAddr + 2;
		memcpy(pLowAddr,&nTempLowWord,2);	//低位单字拷贝到双字低位
		memcpy(pHighAddr,&nTempHighWord,2);	//高位单字拷贝到双字高位
		return (int)nTempWord;				//将双字返回
	//}
	//else if(0)
	//{//后续可添加其余PLC适用的转换方式

	//}
	//return 0;
}

BOOL CCommProtocolXYDFast::DoubleWordToWord(int nDWord,int &nLowWord,int &nHighWord)
{
	//if(IsMitsubishiQProtocol())
	//{//三菱Q寄存器适用
		INT32 nTempWord = nDWord;			//双字临时变量
		INT16 nTempHighWord,nTempLowWord;	//单字临时变量
		nTempLowWord = 0;
		nTempHighWord = 0;
		INT8 *pLowAddr = (INT8 *)&nTempWord;
		INT8 *pHighAddr = pLowAddr + 2;
		memcpy(&nTempLowWord,pLowAddr,2);	//双字低位拷贝到低位单字
		memcpy(&nTempHighWord,pHighAddr,2);	//双字高位拷贝到高位单字
		nLowWord = nTempLowWord;
		nHighWord = nTempHighWord;
		return TRUE;
	//}
	//else if(0)
	//{//后续可添加其余PLC适用的转换方式

	//}
	//return FALSE;
}

BOOL CCommProtocolXYDFast::PackPlcWriteReg(CString& strInfo, std::vector<int> &vnWriteData,int nRegAddr,bool bRegType,bool bOffsetAddr)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}
	if(bOffsetAddr)
	{//如果是偏移地址，则将地址加到基地址上
		nRegAddr = m_nPLCBaseRegAddr + nRegAddr;
	}
	int  nDataNum = vnWriteData.size();	// 数据量

	if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAddr, nDataNum, vnWriteData,bRegType))
	{
		return FALSE;
	}
	SetWriteRegTranslateResultInfo(nRegAddr,vnWriteData.size(),vnWriteData,bRegType);
	return TRUE;
}

BOOL CCommProtocolXYDFast::AnalyzeAxisInfoInCmdParam(std::vector<int> &vnReceivedData)
{
	if(!m_bReadWriteAxisPosWithCmd)
	{
		return FALSE;
	}
	if(m_bRegType)
	{
		int nDataNum = GetReadDataNum();
		if (vnReceivedData.size() >= nDataNum)
		{//如果参数个数大于等于10，解析轴位置
			CPlatformXYDAxisPos platformXYDAixisPos; 		
			std::vector<int> vnAxisPos;
			vnAxisPos.push_back(vnReceivedData[nDataNum - 3]);
			vnAxisPos.push_back(vnReceivedData[nDataNum - 2]);
			vnAxisPos.push_back(vnReceivedData[nDataNum - 1]);
			if (FALSE == ConvertToPlatformXYDAxisPos(vnAxisPos, &platformXYDAixisPos))
			{
				return FALSE;
			}
			m_CurPlatformXYDAxisPos = platformXYDAixisPos;
			m_bCmdAxisPosReady = TRUE;
			return TRUE;
		}
	}
	else
	{
		int nDataNum = GetReadDataNum();
		if (vnReceivedData.size() >= nDataNum)
		{//如果参数个数大于等于12，解析轴位置
			CPlatformXYDAxisPos platformXYDAixisPos; 		
			std::vector<int> vnAxisPos;
			vnAxisPos.push_back(WordToDoubleWord(vnReceivedData[nDataNum - 6],vnReceivedData[nDataNum - 5]));
			vnAxisPos.push_back(WordToDoubleWord(vnReceivedData[nDataNum - 4],vnReceivedData[nDataNum - 3]));
			vnAxisPos.push_back(WordToDoubleWord(vnReceivedData[nDataNum - 2],vnReceivedData[nDataNum - 1]));
			if (FALSE == ConvertToPlatformXYDAxisPos(vnAxisPos, &platformXYDAixisPos))
			{
				return FALSE;
			}
			m_CurPlatformXYDAxisPos = platformXYDAixisPos;
			m_bCmdAxisPosReady = TRUE;
			return TRUE;
		}
	}
	return FALSE;

}

int CCommProtocolXYDFast::GetReadDataNum()
{
	if(m_bRegType)
	{
		if(m_bReadWriteAxisPosWithCmd)
		{
			return 10;
		}
		else
		{
			return 7;
		}
	}
	else
	{
		if(m_bReadWriteAxisPosWithCmd)
		{
			return 12;
		}
		else
		{
			return 6;
		}
	}
}

BOOL CCommProtocolXYDFast::SaveAxisPosDataNeedSend(std::vector<int> &vnAxisPosData,CString &strInfo)
{
	if(m_bReadWriteAxisPosWithCmd && vnAxisPosData.size() == 3)
	{
		m_vnWriteDataAxisPos = vnAxisPosData;//vnAxisPosData存入m_vWriteDataAxisPos等待与指令参数一并发送
		vnAxisPosData.clear();//清空轴位置，不解析
		strInfo = _T("");//清空strInfo以绕过通信
	}
	return TRUE;
}

BOOL CCommProtocolXYDFast::AttachAxisDataToCmd(std::vector<int> &vnCmdWriteData)
{
	if(!m_bReadWriteAxisPosWithCmd || m_vnWriteDataAxisPos.size()<3)
	{
		return FALSE;
	}
	int nDataNum = GetReadDataNum()-1;
	vnCmdWriteData.resize(nDataNum);//重设数据量，延申至包含轴位置数据段
	if(m_bRegType)
	{//双字，直接将之前保存的轴位置写到数据最后三位
		vnCmdWriteData[nDataNum-3] = m_vnWriteDataAxisPos[0];
		vnCmdWriteData[nDataNum-2] = m_vnWriteDataAxisPos[1];
		vnCmdWriteData[nDataNum-1] = m_vnWriteDataAxisPos[2];
	}
	else
	{//单字，先将之前保存的轴位置分解为单字，然后写到数据段最后六位
		int nLowData,nHighData;
		DoubleWordToWord(m_vnWriteDataAxisPos[0],nLowData,nHighData);
		vnCmdWriteData[nDataNum-6] = nLowData;
		vnCmdWriteData[nDataNum-5] = nHighData;
		DoubleWordToWord(m_vnWriteDataAxisPos[1],nLowData,nHighData);
		vnCmdWriteData[nDataNum-4] = nLowData;
		vnCmdWriteData[nDataNum-3] = nHighData;
		DoubleWordToWord(m_vnWriteDataAxisPos[2],nLowData,nHighData);
		vnCmdWriteData[nDataNum-2] = nLowData;
		vnCmdWriteData[nDataNum-1] = nHighData;
	}
	m_vnWriteDataAxisPos.clear();//使用后立即删除
	return TRUE;
}

BOOL CCommProtocolXYDFast::EnableReadWriteAxisPosWithCmd(BOOL bEnbale)
{
	m_bReadWriteAxisPosWithCmd = bEnbale;
	if(m_bRegType == FALSE)
	{//对于单字，目前仅允许三菱Q系列寄存器使用轴位置随指令一并读写
		if(!IsMitsubishiQProtocol())
		{
			m_bReadWriteAxisPosWithCmd = FALSE;
		}
	}
	return TRUE;
}

BOOL CCommProtocolXYDFast::IsMitsubishiQProtocol()
{
	if(m_eProtocolType == eProRegMitsubishiQSerialAscii			||	// 三菱Q系列PLC的寄存器串口MC(格式4)ASCII协议(一般使用这种)
		m_eProtocolType == eProRegMitsubishiQSerialBinary		||	// 三菱Q系列PLC的寄存器串口MC(格式5)二进制协议(一般使用这种)
		m_eProtocolType == eProRegMitsubishiQSocketAscii		||	// 三菱Q系列PLC的寄存器网口MC（E3）ASCII协议(一般使用这种)
		m_eProtocolType == eProRegMitsubishiQSocketBinary		||	// 三菱Q系列PLC的寄存器网口MC（E3）二进制协议(一般使用这种)
		m_eProtocolType == eProRegMitsubishiQSocketReserved1	||	// 三菱Q系列PLC的寄存器网口UDP MC（E3）ASCII协议(一般使用这种)
		m_eProtocolType == eProRegMitsubishiQSocketAsciiUDP		||	// 三菱Q系列PLC的寄存器网口UDP MC（E3）ASCII协议(一般使用这种)
		m_eProtocolType == eProRegMitsubishiQSocketReserved2	||	// 三菱Q系列PLC的寄存器网口UDP MC（E3）二进制协议(一般使用这种)	eProRegMitsubishiQSocketBinaryUDP	= 36,				// 三菱Q系列PLC的寄存器网口UDP MC（E3）二进制协议(一般使用这种)
		m_eProtocolType == eProRegMitsubishiQSocketBinaryUDP	||	// 三菱Q系列PLC的寄存器网口UDP MC（E3）二进制协议(一般使用这种)	eProRegMitsubishiQSocketBinaryUDP	= 36,				// 三菱Q系列PLC的寄存器网口UDP MC（E3）二进制协议(一般使用这种)
	    m_eProtocolType == eProRegKeyenceSocketPCLink
		)
	{
		return TRUE;
	}
	return FALSE;
}

BOOL CCommProtocolXYDFast::PackRe_InspectQRCode(CString& strInfo,std::vector<int> vCode,BOOL bResult,CString strCode)
{
	int nTempNum = vCode.size();
	CString strHead = m_strHead;
	CString strName= m_FQRIParam.m_strCmd;
	CString strParam[3];
	CString strBlank = m_strSeparator;
	CString strTail = m_strTail;	
	CString strCR = char(0x0D);

	m_strCmdName = strName;

	int nParam = 0;
	if (FALSE == bResult)
	{	
		nParam = -1;
	}

	// strParam[0] : 成功、失败
	PackParam(strParam[0], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);

	// strParam[1] : 码字符串个数
	nParam = nTempNum;
	PackParam(strParam[1], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
	CString strTempInfo = _T("");
	for (int i = 0; i < nTempNum; i++)
	{
		nParam = vCode.at(i);
		PackParam(strParam[2], nParam, m_CommProtocolParam.m_nCommDataLenType, m_CommProtocolParam.m_nCommUnitExp);
		strTempInfo = strTempInfo + strParam[2];
	}

	strInfo.Empty();
	strInfo = strHead + strName + strBlank + strParam[0] + strBlank + strParam[1] + strBlank + strCode + strTail;

	return TRUE;

}

BOOL CCommProtocolXYDFast::PackRePLC_InspectQRCode(CString& strInfo,std::vector<int> vCode,BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	CString strName = m_FQRIParam.m_strCmd;
	int nCmdVal = m_FQRIParam.m_nCmdVal;
	m_strCmdName = strName;	
	int nParam = 0;

	int nTempDataNum = vCode.size();
	// 寄存器首地址
	//long nRegAdrr = m_nPLCTempBaseRegAddr + atoi(RREG_VISION_PLATFORM_TEMP_POS);
	long nRegAdrr = m_nPLCTempBaseRegAddr;

	int  nDataNum = nTempDataNum + 1;	
	std::vector<int> vnWriteData;
	vnWriteData.resize(nDataNum);

	//个数
	nParam = nTempDataNum;
	PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);

	for (int i = 0; i < nTempDataNum; i++)
	{
		nParam = vCode.at(i);
		PackPlcParam(vnWriteData[1 + i], nParam, m_CommProtocolParam.m_nCommUnitExp);
	}

	// 双字：每一个字符占用2个寄存器地址
	// 单字：每一个字符占用1个寄存器地址
	if (m_bRegType) //双字  
	{
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData,TRUE))
		{
			return FALSE;
		}
	}
	else//单字
	{
		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData, FALSE))
		{
			return FALSE;
		}
	}

	return TRUE;
}

BOOL CCommProtocolXYDFast::PackRePlc_InspectQRCodeStatus(CString& strInfo, BOOL bResult)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	CString strName = m_FQRIParam.m_strCmd;
	int nCmdVal = m_FQRIParam.m_nCmdVal;
	int nVCmdValue = m_FQRIParam.m_nVCmdValue;
	m_strCmdName = strName;	
	int nParam = 0;

	if (m_bRegType) //双字
	{
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nCmdVal;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 0 : -1;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,nDataNum,vnWriteData,TRUE);
	}
	else//单字
	{
		long nRegAdrr = m_nPLCBaseRegAddr + atoi(RREG_VISION_CMD_DATA_WORD);	// 寄存器地址
		int  nDataNum = 2;											// 数据量
		std::vector<int> vnWriteData;
		vnWriteData.resize(nDataNum);

		m_strCmdName = strName;	
		nParam = nVCmdValue;
		PackPlcParam(vnWriteData[0], nParam, m_CommProtocolParam.m_nCommUnitExp);
		nParam = bResult ? 1 : 2;
		PackPlcParam(vnWriteData[1], nParam, m_CommProtocolParam.m_nCommUnitExp);

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData, FALSE))
		{
			return FALSE;
		}

		SetWriteRegTranslateResultInfo(nRegAdrr,nDataNum,vnWriteData,FALSE);
	}

	return TRUE;
}

// 打包弯折计算结果
BOOL CCommProtocolXYDFast::PackRePlcWZResult(CString& strInfo, std::vector<double> vdDate,int nOffset)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	int nDataNum = vdDate.size();
	//nDataNum=1;
	if (nDataNum < 0)
	{
		return FALSE;
	}

	if (1)	
	{
		long nRegAdrr = m_nPLCWZRegAddr + nOffset; /*+ atoi(RREG_VISION_PLATFORM_TEMP_POS)*/	// 寄存器地址

		int nWriteData = 0;
		std::vector<int> vnWriteData;
		for (int i=0; i<nDataNum; i++)
			//for (int i=0; i<1; i++)
		{
			PackPlcParam(nWriteData, vdDate.at(i), m_CommProtocolParam.m_nCommXUnitExp);
			vnWriteData.push_back(nWriteData);
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,nDataNum,vnWriteData,TRUE);
	}


	return TRUE;
}

BOOL CCommProtocolXYDFast::PackRePlcYZRResult(CString& strInfo, std::vector<double> vdDate,long nSendAddr)
{
	if (m_pCommProRegBase == NULL)
	{
		return FALSE;
	}

	int nDataNum = vdDate.size();

	if (nDataNum < 0)
	{
		return FALSE;
	}

	if (1)	
	{
		long nRegAdrr = nSendAddr;	// 寄存器地址

		int nWriteData = 0;
		std::vector<int> vnWriteData;
		for (int i=0; i<nDataNum; i++)
		{
			PackPlcParam(nWriteData, vdDate.at(i), m_CommProtocolParam.m_nCommXUnitExp);
			vnWriteData.push_back(nWriteData);
		}

		if (!m_pCommProRegBase->PackWriteRegInfo(strInfo, nRegAdrr, nDataNum, vnWriteData))
		{
			return FALSE;
		}
		SetWriteRegTranslateResultInfo(nRegAdrr,nDataNum,vnWriteData,TRUE);
	}


	return TRUE;
}